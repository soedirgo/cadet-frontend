(this["webpackJsonpcadet-frontend"]=this["webpackJsonpcadet-frontend"]||[]).push([[0],{104:function(e,t,s){"use strict";s.r(t),s.d(t,"bulkUpdateAchievements",(function(){return i})),s.d(t,"bulkUpdateGoals",(function(){return r})),s.d(t,"editAchievement",(function(){return o})),s.d(t,"editGoal",(function(){return c})),s.d(t,"getAchievements",(function(){return d})),s.d(t,"getGoals",(function(){return l})),s.d(t,"getOwnGoals",(function(){return u})),s.d(t,"removeAchievement",(function(){return h})),s.d(t,"removeGoal",(function(){return p})),s.d(t,"saveAchievements",(function(){return g})),s.d(t,"saveGoals",(function(){return m})),s.d(t,"updateGoalProgress",(function(){return b}));var a=s(9),n=s(21);const i=e=>Object(a.action)(n.c,e),r=e=>Object(a.action)(n.d,e),o=e=>Object(a.action)(n.e,e),c=e=>Object(a.action)(n.f,e),d=()=>Object(a.action)(n.h),l=e=>Object(a.action)(n.i,e),u=()=>Object(a.action)(n.j),h=e=>Object(a.action)(n.l,e),p=e=>Object(a.action)(n.m,e),g=e=>Object(a.action)(n.n,e),m=e=>Object(a.action)(n.o,e),b=(e,t)=>Object(a.action)(n.p,{studentId:e,progress:t})},105:function(e,t,s){"use strict";s.r(t),s.d(t,"deleteSourcecastEntry",(function(){return i})),s.d(t,"recordInit",(function(){return r})),s.d(t,"recordInput",(function(){return o})),s.d(t,"resetInputs",(function(){return c})),s.d(t,"timerPause",(function(){return d})),s.d(t,"timerReset",(function(){return l})),s.d(t,"timerResume",(function(){return u})),s.d(t,"timerStart",(function(){return h})),s.d(t,"timerStop",(function(){return p}));var a=s(9),n=s(71);const i=(e,t)=>Object(a.action)(n.a,{id:e,workspaceLocation:t}),r=(e,t)=>Object(a.action)(n.b,{initData:e,workspaceLocation:t}),o=(e,t)=>Object(a.action)(n.c,{input:e,workspaceLocation:t}),c=(e,t)=>Object(a.action)(n.d,{inputs:e,workspaceLocation:t}),d=e=>Object(a.action)(n.e,{timeNow:Date.now(),workspaceLocation:e}),l=e=>Object(a.action)(n.f,{workspaceLocation:e}),u=(e,t)=>Object(a.action)(n.g,{timeBefore:e,timeNow:Date.now(),workspaceLocation:t}),h=e=>Object(a.action)(n.h,{timeNow:Date.now(),workspaceLocation:e}),p=e=>Object(a.action)(n.i,{timeNow:Date.now(),workspaceLocation:e})},111:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i}));const a="FETCH_SOURCECAST_INDEX",n="SET_EDITOR_READONLY",i="UPDATE_SOURCECAST_INDEX"},113:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i}));const a="SAVE_CANVAS",n=":assessmentId(\\d+)?/:questionId(\\d+)?",i=":submissionId(\\d+)?/:questionId(\\d+)?"},115:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a="LOG_OUT"},117:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"d",(function(){return r}));const a="CHANGE_DATE_ASSESSMENT",n="DELETE_ASSESSMENT",i="PUBLISH_ASSESSMENT",r="UPLOAD_ASSESSMENT"},118:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"d",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return r}));const a="PERSISTENCE_OPEN_PICKER",n="PERSISTENCE_SAVE_FILE_AS",i="PERSISTENCE_SAVE_FILE",r="PERSISTENCE_INITIALISE"},119:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"d",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return r}));const a="GITHUB_OPEN_PICKER",n="GITHUB_SAVE_FILE_AS",i="GITHUB_SAVE_FILE",r="GITHUB_INITIALISE"},1212:function(e,t,s){"use strict";s.r(t);var a=s(0),n=(s(547),s(1229)),i=s(88),r=s(196),o=s(189),c=s(36),d=s(31),l=s(27),u=s(35),h=s(227),p=s(102),g=s.n(p),m=s(1),b=s.n(m),j=s(30),y=s(19),O=s(43),v=s.n(O),x=s(1231),f=s(26),S=s(21);const C=new Date,w=e=>void 0!==e&&e<=C,E=e=>{if(void 0===e)return"";const t=e.getDate(),s=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],a=e.getFullYear(),n=e.getHours(),i=e.getMinutes();return`${t} ${s} ${a} ${(n<10?"0":"")+n+":"+(i<10?"0":"")+i}`},A=e=>{const t=e=>(e.getTime()-C.getTime())/36e5,s=e=>t(e)/24;if(void 0===e)return"Unlimited";if((e=>e.getTime()<=C.getTime())(e))return"Expired";const a=Math.ceil((e=>s(e)/7)(e)),n=Math.ceil(s(e)),i=Math.ceil(t(e));let r="";return r=a>1?a+" Weeks":n>1?n+" Days":i>1?i+" Hours":"1 Hour",r};class I{constructor(e){this.achievement=void 0,this.displayDeadline=void 0,this.xp=void 0,this.maxXp=void 0,this.progressFrac=void 0,this.status=void 0,this.children=void 0,this.descendant=void 0;const{deadline:t,prerequisiteUuids:s}=e;this.achievement=e,this.displayDeadline=t,this.xp=0,this.maxXp=0,this.progressFrac=0,this.status=S.b.ACTIVE,this.children=new Set(s),this.descendant=new Set(s)}}var T=class{constructor(e,t){this.nodeList=new Map,this.goalList=new Map,this.textToUuid=new Map,this.titleToUuid=new Map,this.achievementsToDelete=[],this.goalsToDelete=[],this.nodeList=this.constructNodeList(e),this.goalList=this.constructGoalList(t),this.processNodes(),this.processGoals()}getAllAchievements(){return[...this.nodeList.values()].map((e=>e.achievement))}getAllAchievementUuids(){return[...this.nodeList.keys()]}getAllGoals(){return[...this.goalList.values()]}getAllGoalUuids(){return[...this.goalList.keys()]}hasAchievement(e){return this.nodeList.has(e)}getAchievement(e){return this.nodeList.get(e).achievement}hasGoal(e){return this.goalList.has(e)}getGoal(e){return this.goalList.get(e)}getGoalDefinition(e){return this.goalList.get(e)}getAchievementPositionByUuid(e){return this.nodeList.get(e).achievement.position}getAchievementsToDelete(){return this.achievementsToDelete}getGoalsToDelete(){return this.goalsToDelete}resetToDelete(){this.achievementsToDelete=[],this.goalsToDelete=[]}insertAchievement(e){const t=Object(x.a)();return e.uuid=t,this.nodeList.set(t,new I(e)),this.processNodes(),this.normalizePositions(e.uuid,e.position),t}insertGoalDefinition(e){const t=Object(x.a)();return e.uuid=t,this.goalList.set(t,{...e,...S.q}),this.processGoals(),t}modifyAchievement(e){this.nodeList.set(e.uuid,new I(e)),this.processNodes(),this.normalizePositions(e.uuid,e.position)}modifyGoalDefinition(e){this.goalList.set(e.uuid,{...e,...S.q}),this.processNodes(),this.processGoals()}removeAchievement(e){this.nodeList.delete(e),this.nodeList.forEach(((t,s)=>{(t=>t.children.has(e))(t)&&this.nodeList.set(s,(t=>{const s=t.achievement.prerequisiteUuids.filter((t=>t!==e));return t.achievement.prerequisiteUuids=s,new I(t.achievement)})(t))})),this.achievementsToDelete.push(e),this.processNodes(),this.normalizePositions()}removeGoalDefinition(e){const t=t=>{const s=(t=>t.achievement.goalUuids.findIndex((t=>t===e)))(t);-1!==s&&t.achievement.goalUuids.splice(s,1)};this.goalList.delete(e),this.nodeList.forEach((e=>t(e))),this.goalsToDelete.push(e),this.processNodes(),this.processGoals()}listTaskUuids(){return this.getAllAchievements().filter((e=>e.isTask)).map((e=>e.uuid))}listSortedTaskUuids(){return this.getAllAchievements().filter((e=>e.isTask)).sort(((e,t)=>e.position-t.position)).map((e=>e.uuid))}listGoals(e){const{goalUuids:t}=this.getAchievement(e);return t.map((e=>this.getGoal(e)))}listPrerequisiteGoals(e){const t=[];for(const s of this.getImmediateChildren(e)){const{goalUuids:e}=this.getAchievement(s);e.forEach((e=>t.push(e)))}return t.map((e=>this.getGoal(e)))}getUuidByText(e){return this.textToUuid.get(e)}getTextByUuid(e){var t;return null===(t=this.goalList.get(e))||void 0===t?void 0:t.text}getUuidByTitle(e){return this.titleToUuid.get(e)}getTitleByUuid(e){var t;return null===(t=this.nodeList.get(e))||void 0===t?void 0:t.achievement.title}getAchievementXp(e){return this.nodeList.has(e)?this.nodeList.get(e).xp:0}getAchievementMaxXp(e){return this.nodeList.has(e)?this.nodeList.get(e).maxXp:0}getTotalXp(){return this.getAllGoals().reduce(((e,t)=>e+t.xp),0)}getProgressFrac(e){return this.nodeList.has(e)?this.nodeList.get(e).progressFrac:0}getStatus(e){return this.nodeList.has(e)?this.nodeList.get(e).status:S.b.ACTIVE}getDisplayDeadline(e){return this.nodeList.has(e)?this.nodeList.get(e).displayDeadline:void 0}isImmediateChild(e,t){return!!this.nodeList.has(e)&&this.nodeList.get(e).children.has(t)}getImmediateChildren(e){return this.nodeList.has(e)?this.nodeList.get(e).children:new Set}isDescendant(e,t){return!!this.nodeList.has(e)&&this.nodeList.get(e).descendant.has(t)}getDescendants(e){return this.nodeList.has(e)?this.nodeList.get(e).descendant:new Set}listAvailablePrerequisiteUuids(e){return this.getAllAchievementUuids().filter((t=>t!==e&&!this.isDescendant(e,t)&&!this.isDescendant(t,e)))}processNodes(){this.titleToUuid=new Map,this.nodeList.forEach((e=>{const{title:t,uuid:s}=e.achievement;this.titleToUuid.set(t,s),e.achievement.prerequisiteUuids=Object(O.uniq)(e.achievement.prerequisiteUuids),e.achievement.goalUuids=Object(O.uniq)(e.achievement.goalUuids),this.generateDescendant(e),this.generateDisplayDeadline(e),this.generateXpAndMaxXp(e),this.generateProgressFrac(e),this.generateStatus(e)}))}processGoals(){this.textToUuid=new Map,this.goalList.forEach((e=>{const{text:t,uuid:s}=e;this.textToUuid.set(t,s)}))}constructNodeList(e){const t=new Map;return e.forEach((e=>t.set(e.uuid,new I(e)))),t}constructGoalList(e){const t=new Map;return e.forEach((e=>t.set(e.uuid,e))),t}generateDescendant(e){for(const t of e.descendant){if(t===e.achievement.uuid){const{title:t}=e.achievement;Object(f.b)(`Circular dependency detected in achievement ${t}`,3e4)}for(const s of this.getDescendants(t))e.descendant.add(s)}}generateDisplayDeadline(e){const t=[];for(const s of e.descendant){const e=this.getAchievement(s).deadline;t.push(e)}e.displayDeadline=t.reduce(((e,t)=>void 0===t||w(t)?e:void 0===e||w(e)||t<e?t:e),e.displayDeadline)}generateXpAndMaxXp(e){const{goalUuids:t}=e.achievement;e.xp=t.reduce(((e,t)=>e+this.getGoal(t).xp),0),e.maxXp=t.reduce(((e,t)=>e+this.getGoal(t).maxXp),0)}generateProgressFrac(e){const{goalUuids:t}=e.achievement,s=t.reduce(((e,t)=>e+this.getGoal(t).xp),0);e.progressFrac=0===e.maxXp?0:Math.min(s/e.maxXp,1)}generateStatus(e){const{goalUuids:t}=e.achievement,s=0!==t.length&&t.map((e=>this.getGoal(e).completed)).reduce(((e,t)=>e&&t),!0),a=!w(e.displayDeadline);e.status=s?S.b.COMPLETED:a?S.b.ACTIVE:S.b.EXPIRED}normalizePositions(e,t){let s=1;if(this.getAllAchievements().filter((e=>e.isTask)).sort(((e,t)=>e.position-t.position)).forEach((e=>e.position=s++)),this.getAllAchievements().filter((e=>!e.isTask)).forEach((e=>e.position=0)),e&&t&&0!==t){const s=this.getAchievement(e),a=s.position;if(a!==t){const e=this.getAllAchievements().find((e=>e.position===t));e&&(e.position=a,s.position=t)}}}};let k;function N(...e){return{type:"AND",operands:e}}function P(...e){return{type:"OR",operands:e}}!function(e){e.ACHIEVEMENT="achievement",e.ASSESSMENT_GRADING="assessment-grading",e.ASSESSMENT_SUBMISSION="assessment-submission"}(k||(k={}));const R=[{uuid:"0",title:"Rune Master",ability:S.a.CORE,isTask:!0,position:1,prerequisiteUuids:["2","1"],goalUuids:["0"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/rune-master.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Rune Master achievement"}},{uuid:"1",title:"Beyond the Second Dimension",ability:S.a.CORE,deadline:new Date(2020,7,6,12,30,0),isTask:!1,position:0,prerequisiteUuids:[],goalUuids:["1"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/btsd.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Beyond the Second Dimension achievement"}},{uuid:"2",title:"Colorful Carpet",ability:S.a.CORE,deadline:new Date(2020,7,8,9,0,0),isTask:!1,position:0,prerequisiteUuids:[],goalUuids:["2"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/colorful-carpet.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Colorful Carpet achievement"}},{uuid:"3",title:"",ability:S.a.CORE,isTask:!1,position:0,prerequisiteUuids:[],goalUuids:[],cardBackground:"",view:{coverImage:"",description:"",completionText:""}},{uuid:"4",title:"Curve Wizard",ability:S.a.CORE,deadline:new Date(2020,8,15,0,0,0),isTask:!0,position:4,prerequisiteUuids:["5","6"],goalUuids:["3"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/curve-wizard.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Curve Wizard achievement"}},{uuid:"5",title:"Curve Introduction",ability:S.a.CORE,deadline:new Date(2020,7,28,0,0,0),isTask:!1,position:0,prerequisiteUuids:[],goalUuids:["4"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/curve-introduction.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Curve Introduction achievement"}},{uuid:"6",title:"Curve Manipulation",ability:S.a.CORE,deadline:new Date(2020,8,5,0,0,0),isTask:!1,position:0,prerequisiteUuids:[],goalUuids:["5"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/curve-manipulation.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Curve Manipulation achievement"}},{uuid:"21",title:"The Source-rer",ability:S.a.EFFORT,deadline:new Date(2020,7,21,0,0,0),isTask:!0,position:3,prerequisiteUuids:[],goalUuids:["16","18"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/the-source-rer.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed The Source-rer achievement"}},{uuid:"8",title:"Power of Friendship",ability:S.a.COMMUNITY,isTask:!0,position:2,prerequisiteUuids:["9"],goalUuids:[],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/power-of-friendship.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Power of Friendship achievement"}},{uuid:"9",title:"Piazza Guru",ability:S.a.COMMUNITY,isTask:!1,position:0,prerequisiteUuids:[],goalUuids:["8"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/piazza-guru.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed Piazza Guru achievement"}},{uuid:"16",title:"That's the Spirit",ability:S.a.EXPLORATION,isTask:!0,position:5,prerequisiteUuids:[],goalUuids:["14"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/thats-the-spirit.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud",completionText:"Congratulations! You have completed That's the Spirit achievement"}},{uuid:"13",title:"Kool Kidz",ability:S.a.FLEX,isTask:!0,position:6,prerequisiteUuids:[],goalUuids:["11"],cardBackground:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/card-background/default.png",view:{coverImage:"https://source-academy-assets.s3-ap-southeast-1.amazonaws.com/achievement/cover-image/default.png",description:"Diz for teh K00L K1dz",completionText:"U SO G00D"}}],M=[{uuid:"0",text:"Bonus for completing Colorful Carpet & Beyond the Second Dimension Achievements",meta:{type:S.k.BINARY,condition:N({event:k.ASSESSMENT_GRADING,restriction:"M2A"},{event:k.ASSESSMENT_GRADING,restriction:"M2B"}),maxXp:100},xp:0,maxXp:100,completed:!1},{uuid:"1",text:"XP earned from Beyond the Second Dimension Mission",meta:{type:S.k.ASSESSMENT,assessmentNumber:"M2B",requiredCompletionFrac:.5},xp:213,maxXp:250,completed:!0},{uuid:"2",text:"XP earned from Colorful Carpet Mission",meta:{type:S.k.ASSESSMENT,assessmentNumber:"M2A",requiredCompletionFrac:.8},xp:0,maxXp:250,completed:!1},{uuid:"3",text:"Bonus for completing Curve Introduction & Curve Manipulation Achievements",meta:{type:S.k.BINARY,condition:N({event:k.ASSESSMENT_GRADING,restriction:"M3"},{event:k.ASSESSMENT_GRADING,restriction:"M4A"}),maxXp:100},xp:0,maxXp:100,completed:!1},{uuid:"4",text:"XP earned from Curve Introduction Mission",meta:{type:S.k.ASSESSMENT,assessmentNumber:"M3",requiredCompletionFrac:.5},xp:178,maxXp:250,completed:!0},{uuid:"5",text:"XP earned from Curve Manipulation Mission",meta:{type:S.k.ASSESSMENT,assessmentNumber:"M4A",requiredCompletionFrac:.8},xp:191,maxXp:250,completed:!1},{uuid:"16",text:"Submit Source 3 Path",meta:{type:S.k.BINARY,condition:{event:k.ASSESSMENT_SUBMISSION,restriction:"P3"},maxXp:100},xp:100,maxXp:100,completed:!0},{uuid:"18",text:"XP earned from Source 3 Path",meta:{type:S.k.ASSESSMENT,assessmentNumber:"P3",requiredCompletionFrac:1},xp:300,maxXp:300,completed:!0},{uuid:"8",text:"Each Top Voted answer in Piazza gives 10 XP",meta:{type:S.k.MANUAL,maxXp:100},xp:40,maxXp:100,completed:!1},{uuid:"14",text:"Submit 1 PR to Source Academy Github",meta:{type:S.k.MANUAL,maxXp:100},xp:100,maxXp:100,completed:!0},{uuid:"11",text:"Be the Koolest Kidz in SOC by redeeming this 100 XP achievement yourself",meta:{type:S.k.BINARY,condition:!1,maxXp:100},xp:0,maxXp:100,completed:!1}];var L=s(104);const _=b.a.createContext(new T([],[]));let D,G;!function(e){e.RED="#f00",e.BLACK="#000"}(D||(D={})),function(e){e.BLUE="#4df",e.WHITE="#fff"}(G||(G={}));const B=`${y.a.sourceAcademyAssets}/achievement`,U=`${B}/view-background`,F=`${B}/card-background`,H=`${B}/cover-image`,V=e=>{switch(e){case S.a.CORE:return{background:`url(${U}/core.png) no-repeat center/cover`};case S.a.EFFORT:return{background:`url(${U}/effort.png) no-repeat center/cover`};case S.a.EXPLORATION:return{background:`url(${U}/exploration.png) no-repeat center/cover`};case S.a.COMMUNITY:return{background:`url(${U}/community.png) no-repeat center/cover`};case S.a.FLEX:return{background:`url(${U}/flex.png) no-repeat center/cover`};default:return{background:""}}},q=e=>{switch(e){case S.a.CORE:return"#fb0";case S.a.EFFORT:return"#bf6";case S.a.EXPLORATION:return"#9ce";case S.a.COMMUNITY:return"#f68";case S.a.FLEX:return"#fff";default:return""}},X=e=>e===S.a.FLEX?{border:`1px solid ${q(e)}`,boxShadow:"\n          0 0 10px #ff0,   /* yellow */\n          -1px 0 9px #f0f, /* magenta */\n          1px 0 9px #0ff   /* cyan */"}:{border:`1px solid ${q(e)}`,boxShadow:`0 0 10px ${q(e)}`},$=(e,t)=>e===t?G.BLUE:G.WHITE,W=(e,t,s)=>s===S.a.FLEX||e===t?X(s):void 0,z=1e3;var K=s(1214),Y=s(2);const Q={coverImage:`${H}/default.png`,description:"",completionText:""},J={uuid:"",title:"Achievement Title Here",ability:S.a.CORE,isTask:!1,position:0,prerequisiteUuids:[],goalUuids:[],cardBackground:`${F}/default.png`,view:Q};var Z=function(e){const{allowNewUuid:t,setNewUuid:s}=e,n=Object(m.useContext)(_);return Object(a.jsx)(K.b,{className:"command-button",disabled:!t,icon:Y.a.NEW_OBJECT,onClick:()=>s(n.insertAchievement(J)),text:"Create Achievement"})},ee=s(94);var te=function(e){const{deleteItem:t,item:s}=e;return Object(a.jsx)(K.T,{content:"Delete",children:Object(a.jsx)(K.b,{icon:Y.a.TRASH,intent:"danger",onClick:async()=>{await Object(ee.a)({contents:`Are you sure you want to delete '${s}' ?`,negativeLabel:"No",positiveIntent:"danger",positiveLabel:"Yes, delete"})&&t()}})})};var se=function(e){const{discardChanges:t,saveChanges:s}=e;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"Save Changes",children:Object(a.jsx)(K.b,{icon:Y.a.FLOPPY_DISK,intent:"primary",onClick:()=>{s(),Object(f.d)("Saved changes locally")}})}),Object(a.jsx)(K.T,{content:"Discard Changes",children:Object(a.jsx)(K.b,{icon:Y.a.CROSS,intent:"danger",onClick:()=>{t(),Object(f.e)("Discarded changes")}})})]})},ae=s(1225);var ne=function(e){const{changeGoalUuids:t,goalUuids:s}=e,n=Object(m.useContext)(_),i=n.getAllGoalUuids(),r=e=>n.getTextByUuid(e),o=ae.a.ofType(),c=new Set(s),d=new Set(Object(O.without)(i,...s));return Object(a.jsx)(o,{itemRenderer:(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:r(e)},e),items:[...d],noResults:Object(a.jsx)(K.y,{disabled:!0,text:"No available goal"}),onItemSelect:e=>{c.add(e),d.delete(e),t([...c])},selectedItems:[...c],tagInputProps:{onRemove:e=>{var s;void 0!==(s=(e=>n.getUuidByText(e))(e.toString()))&&(c.delete(s),d.add(s),t([...c]))}},tagRenderer:r})},ie=s(1226);var re=function(e){const{changePosition:t,position:s}=e,n=Object(m.useContext)(_).listTaskUuids().length+1,i=[...Array(n+1).keys()],r=ie.a.ofType();return Object(a.jsx)(r,{filterable:!1,itemRenderer:(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:e},e),items:i,onItemSelect:t,children:Object(a.jsx)(K.b,{text:s})})};var oe=function(e){const{changePrerequisiteUuids:t,uuid:s,prerequisiteUuids:n}=e,i=Object(m.useContext)(_),r=i.listAvailablePrerequisiteUuids(s),o=e=>i.getTitleByUuid(e),c=ae.a.ofType(),d=new Set(n),l=new Set(r);return Object(a.jsx)(c,{itemRenderer:(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:o(e)},e),items:[...l],noResults:Object(a.jsx)(K.y,{disabled:!0,text:"No available achievement"}),onItemSelect:e=>{d.add(e),l.delete(e),t([...d])},selectedItems:[...d],tagInputProps:{onRemove:e=>{var s;void 0!==(s=(e=>i.getUuidByTitle(e))(e.toString()))&&(d.delete(s),l.add(s),t([...d]))}},tagRenderer:o})};var ce=function(e){const{changeCardBackground:t,changeGoalUuids:s,changePosition:n,changePrerequisiteUuids:i,editableAchievement:r}=e,{uuid:o,cardBackground:c,goalUuids:d,position:l,prerequisiteUuids:u}=r,[h,p]=Object(m.useState)(!1),g=()=>p(!h);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"More Settings",children:Object(a.jsx)(K.b,{icon:Y.a.WRENCH,onClick:g})}),Object(a.jsx)(K.g,{title:"More Settings",icon:Y.a.WRENCH,isOpen:h,onClose:g,children:Object(a.jsxs)("div",{style:{padding:"0 0.5em"},children:[Object(a.jsx)("h3",{children:"Card Background"}),Object(a.jsx)(K.j,{multiline:!0,onChange:t,placeholder:"Enter card background URL here",value:c}),Object(a.jsx)("h3",{children:"Position"}),Object(a.jsx)("p",{children:"Note: Select position 0 to hide achievement"}),Object(a.jsx)(re,{changePosition:n,position:l}),Object(a.jsx)("h3",{children:"Prerequisites"}),Object(a.jsx)(oe,{changePrerequisiteUuids:i,uuid:o,prerequisiteUuids:u}),Object(a.jsx)("h3",{children:"Goals"}),Object(a.jsx)(ne,{changeGoalUuids:s,goalUuids:d})]})})]})};var de=function(e){const{ability:t,changeAbility:s}=e,n=ie.a.ofType();return Object(a.jsx)(K.T,{content:"Change Ability",children:Object(a.jsx)(n,{filterable:!1,itemRenderer:(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:e},e),items:Object.values(S.a),onItemSelect:s,children:Object(a.jsx)(K.b,{minimal:!0,outlined:!0,text:t})})})};let le;!function(e){e.CHANGE_ABILITY="CHANGE_ABILITY",e.CHANGE_CARD_BACKGROUND="CHANGE_CARD_BACKGROUND",e.CHANGE_DEADLINE="CHANGE_DEADLINE",e.CHANGE_GOAL_UUIDS="CHANGE_GOAL_UUIDS",e.CHANGE_POSITION="CHANGE_POSITION",e.CHANGE_PREREQUISITE_UUIDS="CHANGE_PREREQUISITE_UUIDS",e.CHANGE_RELEASE="CHANGE_RELEASE",e.CHANGE_TITLE="CHANGE_TITLE",e.CHANGE_VIEW="CHANGE_VIEW",e.DELETE_ACHIEVEMENT="DELETE_ACHIEVEMENT",e.DISCARD_CHANGES="DISCARD_CHANGES",e.SAVE_CHANGES="SAVE_CHANGES"}(le||(le={}));var ue=s(415);var he=function(e){const{type:t,date:s,changeDate:n}=e,[i,r]=Object(m.useState)(!1),o=()=>r(!i),c=void 0===s?`No ${t}`:`${E(s)}`;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:c,children:Object(a.jsx)(K.b,{minimal:!0,onClick:o,outlined:!0,children:`${t}`})}),Object(a.jsxs)(K.g,{isCloseButtonShown:!1,isOpen:i,onClose:o,style:{background:"#fff",maxWidth:"max-content",padding:"0.25em",textAlign:"center"},title:`${t}`,children:[Object(a.jsx)(ue.a,{onChange:n,timePickerProps:{showArrowButtons:!0},value:s}),Object(a.jsx)(K.b,{onClick:()=>n(void 0),text:`Remove ${t}`})]})]})};var pe=function(e){const{changeView:t,view:s}=e,{coverImage:n,description:i,completionText:r}=s,[o,c]=Object(m.useState)(!1),d=()=>c(!o);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"Edit View",children:Object(a.jsx)(K.b,{icon:Y.a.WIDGET_HEADER,onClick:d})}),Object(a.jsx)(K.g,{title:"Edit View",icon:Y.a.WIDGET_HEADER,isOpen:o,onClose:d,children:Object(a.jsxs)("div",{style:{padding:"0 0.5em"},children:[Object(a.jsx)("h3",{children:"Cover Image"}),Object(a.jsx)(K.j,{multiline:!0,onChange:e=>t({...s,coverImage:e}),placeholder:"Enter cover image URL here",value:n}),Object(a.jsx)("h3",{children:"Description"}),Object(a.jsx)(K.j,{multiline:!0,onChange:e=>t({...s,description:e}),placeholder:"Enter description here",value:i}),Object(a.jsx)("h3",{children:"Completion Text"}),Object(a.jsx)(K.j,{multiline:!0,onChange:e=>t({...s,completionText:e}),placeholder:"Enter completion text here",value:r})]})})]})};const ge=e=>({editableAchievement:e,isDirty:!1}),me=(e,t)=>{switch(t.type){case le.SAVE_CHANGES:return{...e,isDirty:!1};case le.DISCARD_CHANGES:return ge(t.payload);case le.DELETE_ACHIEVEMENT:return{...e,isDirty:!1};case le.CHANGE_ABILITY:return{editableAchievement:{...e.editableAchievement,ability:t.payload},isDirty:!0};case le.CHANGE_CARD_BACKGROUND:return{editableAchievement:{...e.editableAchievement,cardBackground:t.payload},isDirty:!0};case le.CHANGE_DEADLINE:return{editableAchievement:{...e.editableAchievement,deadline:t.payload},isDirty:!0};case le.CHANGE_GOAL_UUIDS:return{editableAchievement:{...e.editableAchievement,goalUuids:t.payload},isDirty:!0};case le.CHANGE_POSITION:return{editableAchievement:{...e.editableAchievement,isTask:0!==t.payload,position:t.payload},isDirty:!0};case le.CHANGE_PREREQUISITE_UUIDS:return{editableAchievement:{...e.editableAchievement,prerequisiteUuids:t.payload},isDirty:!0};case le.CHANGE_RELEASE:return{editableAchievement:{...e.editableAchievement,release:t.payload},isDirty:!0};case le.CHANGE_TITLE:return{editableAchievement:{...e.editableAchievement,title:t.payload},isDirty:!0};case le.CHANGE_VIEW:return{editableAchievement:{...e.editableAchievement,view:t.payload},isDirty:!0};default:return e}};var be=function(e){const{uuid:t,releaseUuid:s,requestPublish:n}=e,i=Object(m.useContext)(_),r=i.getAchievement(t),o=Object(m.useMemo)((()=>Object(O.cloneDeep)(r)),[r]),[c,d]=Object(m.useReducer)(me,o,ge),{editableAchievement:l,isDirty:u}=c,{ability:h,cardBackground:p,deadline:g,release:b,title:j,view:y}=l;return Object(a.jsxs)("li",{className:"editable-card",style:{background:`url(${p}) center/cover`},children:[Object(a.jsx)("div",{className:"action-button",children:u?Object(a.jsx)(se,{discardChanges:()=>d({type:le.DISCARD_CHANGES,payload:o}),saveChanges:()=>{d({type:le.SAVE_CHANGES}),i.modifyAchievement(l),s(t),n()}}):Object(a.jsx)(te,{deleteItem:()=>{d({type:le.DELETE_ACHIEVEMENT}),i.removeAchievement(t),s(t),n()},item:j})}),Object(a.jsxs)("div",{className:"content",children:[Object(a.jsx)("h3",{className:"title",children:Object(a.jsx)(K.j,{onChange:e=>d({type:le.CHANGE_TITLE,payload:e}),placeholder:"Enter your title here",value:j})}),Object(a.jsxs)("div",{className:"details",children:[Object(a.jsx)(de,{ability:h,changeAbility:e=>d({type:le.CHANGE_ABILITY,payload:e})}),Object(a.jsx)(he,{changeDate:e=>d({type:le.CHANGE_RELEASE,payload:e}),date:b,type:"Release"}),Object(a.jsx)(he,{changeDate:e=>d({type:le.CHANGE_DEADLINE,payload:e}),date:g,type:"Deadline"})]})]}),Object(a.jsxs)("div",{className:"content-button",children:[Object(a.jsx)(pe,{changeView:e=>d({type:le.CHANGE_VIEW,payload:e}),view:y}),Object(a.jsx)(ce,{changeCardBackground:e=>d({type:le.CHANGE_CARD_BACKGROUND,payload:e}),changeGoalUuids:e=>d({type:le.CHANGE_GOAL_UUIDS,payload:e}),changePosition:e=>d({type:le.CHANGE_POSITION,payload:e}),changePrerequisiteUuids:e=>d({type:le.CHANGE_PREREQUISITE_UUIDS,payload:e}),editableAchievement:l})]})]})};var je=function(e){const{requestPublish:t}=e,s=Object(m.useContext)(_),[n,i]=Object(m.useState)(""),r=""===n,o=e=>e===n?i(""):void 0;return Object(a.jsxs)("div",{className:"achievement-editor",children:[Object(a.jsx)("div",{className:"command",children:Object(a.jsx)(Z,{allowNewUuid:r,setNewUuid:i})}),Object(a.jsx)("ul",{className:"achievement-container",children:(c=s.getAllAchievementUuids().sort(((e,t)=>s.getAchievementPositionByUuid(e)-s.getAchievementPositionByUuid(t))),c.map((e=>Object(a.jsx)(be,{uuid:e,releaseUuid:o,requestPublish:t},e))))})]});var c};var ye=function(e){const{filterState:t,icon:s,ownStatus:n}=e,[i,r]=t;return Object(a.jsxs)("div",{className:"filter",onClick:()=>r(n),style:{color:$(i,n)},children:[Object(a.jsx)(K.u,{icon:s,iconSize:30}),Object(a.jsx)("p",{children:n})]})};var Oe=function(){return Object(a.jsxs)("div",{className:"milestone",children:[Object(a.jsx)("h2",{children:"ACHIEVEMENT LEVEL"}),Object(a.jsxs)("div",{className:"details",children:[Object(a.jsxs)("div",{className:"level-badge",children:[Object(a.jsx)("span",{className:"level-icon"}),Object(a.jsx)("p",{children:"36"})]}),Object(a.jsx)("p",{className:"description",children:"Complete CS1101S CA Component"})]}),Object(a.jsxs)("div",{className:"details",children:[Object(a.jsxs)("div",{className:"level-badge",children:[Object(a.jsx)("span",{className:"level-icon"}),Object(a.jsx)("p",{children:"40"})]}),Object(a.jsx)("p",{className:"description",children:"Earn extra 1 MC from CS1010R"})]}),Object(a.jsx)("div",{className:"footer",children:Object(a.jsx)("p",{children:"Note: subject to change"})})]})};var ve=function(e){const{studentXp:t}=e,[s,n]=Object(m.useState)(!1),i=Math.floor(t/z),r=t%z,o=r/z;return Object(a.jsxs)("div",{className:"level",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[Object(a.jsxs)("div",{className:"level-badge",children:[Object(a.jsx)("span",{className:"level-icon"}),Object(a.jsx)("p",{children:i})]}),Object(a.jsxs)("span",{className:"level-progress",children:[Object(a.jsx)(K.J,{animate:!1,className:"progress-bar",stripes:!1,value:o}),Object(a.jsxs)("p",{children:[r," / ",z," XP"]})]}),s&&Object(a.jsx)(Oe,{})]})};var xe=function(e){const{name:t,studio:s}=e,n=Object(m.useContext)(_).getTotalXp();return Object(a.jsxs)("div",{className:"achievement-overview",children:[Object(a.jsx)(ve,{studentXp:n}),Object(a.jsx)("h3",{children:t}),Object(a.jsx)("h3",{children:s})]})},fe=s(112);const Se=new Date(0,0,2).getTime()-new Date(0,0,0).getTime();var Ce=function(e){const{ability:t,deadline:s}=e,n=t===S.a.CORE&&void 0!==s&&!w(s)&&(e=>void 0===e?0:e.getTime()-C.getTime())(s)<=Se?D.RED:D.BLACK;return Object(a.jsxs)("div",{className:"deadline",children:[Object(a.jsx)(K.u,{color:n,icon:Y.a.STOPWATCH}),Object(a.jsx)("p",{style:{color:n},children:A(s)})]})};const we=(e,t)=>(t?"+":"")+e+" XP";var Ee=function(e){const{isBonus:t,xp:s}=e;return Object(a.jsx)("div",{className:"xp",children:0!==s&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.u,{icon:Y.a.BANK_ACCOUNT}),Object(a.jsx)("p",{children:we(s,t)})]})})};var Ae=function(e){const{uuid:t,focusState:s,isDropdownOpen:n,shouldRender:i,toggleDropdown:r}=e,o=Object(m.useContext)(_),[c,d]=s,{ability:l,cardBackground:u,title:h}=o.getAchievement(t),p=o.getDisplayDeadline(t),g=o.getAchievementMaxXp(t),b=o.getProgressFrac(t),j=o.getStatus(t),y=void 0!==n&&0!==o.getImmediateChildren(t).size;return Object(a.jsxs)("div",{className:"achievement-card",onClick:()=>d(t),onClickCapture:r,style:{...W(t,c,l),opacity:i?"100%":"20%",background:`url(${u}) center/cover`},children:[Object(a.jsx)("div",{className:"dropdown-button",children:y&&Object(a.jsx)(K.u,{icon:n?Y.a.CARET_DOWN:Y.a.CARET_RIGHT})}),Object(a.jsxs)("div",{className:"content",children:[Object(a.jsxs)("div",{className:"heading",children:[Object(a.jsx)("h3",{children:h.toUpperCase()}),j===S.b.COMPLETED&&Object(a.jsx)(K.u,{icon:Y.a.CONFIRM,intent:fe.a.SUCCESS,style:{padding:"1em"}})]}),Object(a.jsxs)("div",{className:"details",children:[Object(a.jsx)("div",{className:"ability",children:Object(a.jsx)("p",{children:l})}),Object(a.jsx)(Ce,{ability:l,deadline:p}),Object(a.jsx)(Ee,{isBonus:y,xp:g})]}),Object(a.jsx)(K.J,{animate:!1,className:"progress",intent:1===b?"success":void 0,stripes:!1,value:b})]})]})};var Ie=function(e){const{uuid:t,filterStatus:s,focusState:n}=e,i=Object(m.useContext)(_),r=[...i.getImmediateChildren(t)],o=q(i.getAchievement(t).ability),[c,d]=Object(m.useState)(!1),l=e=>{const t=i.getStatus(e);switch(s){case S.g.ALL:return!0;case S.g.ACTIVE:return t===S.b.ACTIVE;case S.g.COMPLETED:return t===S.b.COMPLETED;default:return!1}};return Object(a.jsx)(a.Fragment,{children:(e=>l(e)||(e=>[...i.getImmediateChildren(e)].reduce(((e,t)=>e||l(t)),!1))(e))(t)&&Object(a.jsxs)("li",{className:"task",children:[Object(a.jsx)(Ae,{uuid:t,focusState:n,isDropdownOpen:c,shouldRender:l(t),toggleDropdown:()=>d(!c)}),Object(a.jsx)(K.f,{isOpen:c,keepChildrenMounted:!0,children:Object(a.jsx)("div",{className:"prerequisite-container",children:r.map((e=>Object(a.jsxs)("div",{className:"prerequisite",children:[Object(a.jsx)("div",{className:"dropdown-lines",style:{borderBottom:`1px solid ${o}`,borderLeft:`1px solid ${o}`}}),Object(a.jsx)(Ae,{uuid:e,focusState:n,shouldRender:l(e)})]},e)))})})]})})};var Te=function(e){const{awardedXp:t,completionText:s}=e;return Object(a.jsxs)("div",{className:"completion",children:[Object(a.jsx)("h1",{children:`AWARDED ${t}XP`}),Object(a.jsx)("p",{children:s})]})};var ke=function(e){const{goals:t}=e;return Object(a.jsx)(a.Fragment,{children:t.map((e=>(e=>{const{uuid:t,text:s,maxXp:n,xp:i}=e;return Object(a.jsxs)("div",{className:"goal",children:[Object(a.jsxs)("div",{className:"goal-badge",children:[Object(a.jsx)("span",{className:"goal-icon"}),Object(a.jsxs)("p",{children:[i," / ",n," XP"]})]}),Object(a.jsx)("p",{children:s})]},t)})(e)))})};var Ne=function(e){const{focusUuid:t}=e,s=Object(m.useContext)(_);if(""===t)return Object(a.jsxs)("div",{className:"no-view",children:[Object(a.jsx)(K.u,{icon:Y.a.MOUNTAIN,iconSize:60}),Object(a.jsx)("h2",{children:"Select an achievement"})]});const n=s.getAchievement(t),{ability:i,deadline:r,title:o,view:c}=n,{coverImage:d,completionText:l,description:u}=c,h=s.getAchievementXp(t),p=s.listGoals(t),g=s.listPrerequisiteGoals(t),b=s.getStatus(t);return Object(a.jsxs)("div",{className:"view",style:{...X(i),...V(i)},children:[Object(a.jsxs)("div",{className:"cover",style:{background:`url(${d}) center/cover`},children:[Object(a.jsx)("h1",{children:o.toUpperCase()}),r&&Object(a.jsx)("p",{children:`Deadline: ${E(r)}`}),Object(a.jsx)("span",{className:"description",children:Object(a.jsx)("p",{children:u})})]}),Object(a.jsx)(ke,{goals:p}),g.length>0&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("hr",{}),Object(a.jsx)(ke,{goals:g})]}),b===S.b.COMPLETED&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("hr",{}),Object(a.jsx)(Te,{awardedXp:h,completionText:l})]})]})};const Pe=(e,t,s)=>e.map((e=>Object(a.jsx)(Ie,{uuid:e,filterStatus:t,focusState:s},e)));var Re=function(e){const{group:t,getAchievements:s,getOwnGoals:n,inferencer:i,name:r}=e;Object(m.useEffect)((()=>{y.b.useAchievementBackend&&(n(),s())}),[s,n]);const o=Object(m.useState)(S.g.ALL),[c]=o,d=Object(m.useState)(""),[l]=d;return Object(a.jsx)(_.Provider,{value:i,children:Object(a.jsxs)("div",{className:"AchievementDashboard",children:[Object(a.jsx)(xe,{name:r||"User",studio:t||"Staff"}),Object(a.jsxs)("div",{className:"achievement-main",children:[Object(a.jsxs)("div",{className:"filter-container",children:[Object(a.jsx)(ye,{filterState:o,icon:Y.a.GLOBE,ownStatus:S.g.ALL}),Object(a.jsx)(ye,{filterState:o,icon:Y.a.LOCATE,ownStatus:S.g.ACTIVE}),Object(a.jsx)(ye,{filterState:o,icon:Y.a.ENDORSED,ownStatus:S.g.COMPLETED})]}),Object(a.jsx)("ul",{className:"task-container",children:Pe(i.listSortedTaskUuids(),c,d)}),Object(a.jsx)("div",{className:"view-container",children:Object(a.jsx)(Ne,{focusUuid:l})})]})]})})};var Me=function(e){const{awaitPublish:t,publishChanges:s}=e,n=Object(m.useContext)(_),[i,r]=Object(m.useReducer)((e=>!e),!1),o=Object(m.useState)(""),[c]=o;return Object(a.jsxs)("div",{className:"achievement-preview",children:[Object(a.jsxs)("div",{className:"command",children:[Object(a.jsx)(K.b,{className:"command-button",icon:i&&Y.a.ARROW_LEFT,rightIcon:!i&&Y.a.ARROW_RIGHT,text:i?"Task":"View",onClick:r}),t&&Object(a.jsx)(K.b,{className:"command-button",icon:Y.a.CLOUD_UPLOAD,intent:"primary",text:"Publish Changes",onClick:s})]}),i?Object(a.jsx)("div",{className:"preview-container",children:Object(a.jsx)(Ne,{focusUuid:c})}):Object(a.jsx)("ul",{className:"preview-container",children:Pe(n.listSortedTaskUuids(),S.g.ALL,o)})]})};let Le;!function(e){e.CHANGE_META="CHANGE_META",e.CHANGE_TEXT="CHANGE_TEXT",e.DELETE_GOAL="DELETE_GOAL",e.DISCARD_CHANGES="DISCARD_CHANGES",e.SAVE_CHANGES="SAVE_CHANGES"}(Le||(Le={}));const _e=e=>{switch(e){case S.k.ASSESSMENT:return{type:S.k.ASSESSMENT,assessmentNumber:"",requiredCompletionFrac:0};case S.k.BINARY:return{type:S.k.BINARY,condition:!1,maxXp:0};case S.k.MANUAL:return{type:S.k.MANUAL,maxXp:0}}},De={uuid:"",text:"Goal Text Here",meta:_e(S.k.MANUAL)};var Ge=function(e){const{assessmentMeta:t,changeMeta:s}=e,{assessmentNumber:n,requiredCompletionFrac:i}=t;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"Assessment Number",children:Object(a.jsx)(K.j,{onChange:e=>s({...t,assessmentNumber:e}),placeholder:"Enter assessment number here",value:n})}),Object(a.jsx)(K.T,{content:"Required Completion Percentage",children:Object(a.jsx)(K.E,{allowNumericCharactersOnly:!0,max:100,min:0,onValueChange:e=>{const a=e/100;s({...t,requiredCompletionFrac:a})},placeholder:"Enter required completion percentage here",rightElement:Object(a.jsx)("p",{children:"%"}),value:100*i})})]})};const Be=ie.a.ofType(),Ue=(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:e},e),Fe=e=>{if("object"===typeof e&&"type"in e){const{type:t,operands:s}=e,a=s.length,n=[];for(let e=0;e<a;e++)n.push(Fe(s[e])),e!==a-1&&n.push(t);return n.flat()}return[JSON.stringify(e)]};var He=function(e){const{binaryMeta:t,changeMeta:s}=e,{condition:n,maxXp:i}=t,r=[],o=[],c=Fe(n);for(let a=0;a<c.length;a++)a%2===0?o[o.length]=c[a]:r[r.length]=c[a];const d=()=>{let e=JSON.parse(o[0]);for(let t=1;t<o.length;t++)e="AND"===r[t-1]?N(e,JSON.parse(o[t])):P(e,JSON.parse(o[t]));s({...t,condition:e})};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"Max XP",children:Object(a.jsx)(K.E,{allowNumericCharactersOnly:!0,leftIcon:Y.a.BANK_ACCOUNT,min:0,onValueChange:e=>s({...t,maxXp:e}),placeholder:"Enter max XP here",value:i})}),c.map(((e,t)=>Object(a.jsx)("div",{children:t%2===0?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"Condition",children:Object(a.jsx)(K.j,{onChange:e=>((e,t)=>{o[t]=e,d()})(e,t/2),multiline:!0,placeholder:"Enter condition here",value:e})}),o.length>1&&Object(a.jsx)(K.T,{content:"Delete Condition",children:Object(a.jsx)(K.b,{intent:"danger",icon:"trash",onClick:()=>(e=>{for(let t=e;t<o.length-1;t++)o[t]=o[t+1],r[t]=r[t+1];o.length=o.length-1,r.length=r.length-1,d()})(t)})})]}):Object(a.jsx)(K.T,{content:"And/Or",children:Object(a.jsx)(Be,{filterable:!1,itemRenderer:Ue,items:["AND","OR"],onItemSelect:e=>((e,t)=>{r[t]=e,d()})(e,(t-1)/2),children:Object(a.jsx)(K.b,{minimal:!0,outlined:!0,text:e})})})},t))),Object(a.jsx)("br",{}),Object(a.jsx)(K.b,{minimal:!0,outlined:!0,text:"Add Condition",onClick:()=>{r.push("AND"),o.push('{"event":"", "restriction":""}'),d()}})]})};var Ve=function(e){const{changeMeta:t,manualMeta:s}=e,{maxXp:n}=s;return Object(a.jsx)(K.T,{content:"Max XP",children:Object(a.jsx)(K.E,{allowNumericCharactersOnly:!0,leftIcon:Y.a.BANK_ACCOUNT,min:0,onValueChange:e=>t({...s,maxXp:e}),placeholder:"Enter max XP here",value:n})})};var qe=function(e){const{changeMeta:t,meta:s}=e,{type:n}=s,i=ie.a.ofType();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.T,{content:"Change Goal Type",children:Object(a.jsx)(i,{filterable:!1,itemRenderer:(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:e},e),items:Object.values(S.k),onItemSelect:e=>t(_e(e)),children:Object(a.jsx)(K.b,{minimal:!0,outlined:!0,text:n})})}),(e=>{switch(e){case S.k.ASSESSMENT:return Object(a.jsx)(Ge,{assessmentMeta:s,changeMeta:t});case S.k.BINARY:return Object(a.jsx)(He,{binaryMeta:s,changeMeta:t});case S.k.MANUAL:return Object(a.jsx)(Ve,{changeMeta:t,manualMeta:s});default:return null}})(n)]})};const Xe=e=>({editableGoal:e,isDirty:!1}),$e=(e,t)=>{switch(t.type){case Le.SAVE_CHANGES:return{...e,isDirty:!1};case Le.DISCARD_CHANGES:return Xe(t.payload);case Le.DELETE_GOAL:return{...e,isDirty:!1};case Le.CHANGE_META:return{editableGoal:{...e.editableGoal,meta:t.payload},isDirty:!0};case Le.CHANGE_TEXT:return{editableGoal:{...e.editableGoal,text:t.payload},isDirty:!0};default:return e}};var We=function(e){const{uuid:t,releaseUuid:s,requestPublish:n}=e,i=Object(m.useContext)(_),r=i.getGoalDefinition(t),o=Object(m.useMemo)((()=>Object(O.cloneDeep)(r)),[r]),[c,d]=Object(m.useReducer)($e,o,Xe),{editableGoal:l,isDirty:u}=c,{meta:h,text:p}=l;return Object(a.jsxs)("li",{className:"editable-goal",children:[Object(a.jsx)("div",{className:"action-button",children:u?Object(a.jsx)(se,{discardChanges:()=>d({type:Le.DISCARD_CHANGES,payload:o}),saveChanges:()=>{d({type:Le.SAVE_CHANGES}),i.modifyGoalDefinition(l),s(t),n()}}):Object(a.jsx)(te,{deleteItem:()=>{d({type:Le.DELETE_GOAL}),i.removeGoalDefinition(t),s(t),n()},item:p})}),Object(a.jsx)("h3",{children:Object(a.jsx)(K.j,{onChange:e=>d({type:Le.CHANGE_TEXT,payload:e}),placeholder:"Enter goal text here",value:p})}),Object(a.jsx)("div",{className:"meta",children:Object(a.jsx)(qe,{changeMeta:e=>d({type:Le.CHANGE_META,payload:e}),meta:h})})]})};var ze=function(e){const{allowNewUuid:t,setNewUuid:s}=e,n=Object(m.useContext)(_);return Object(a.jsx)(K.b,{className:"command-button",disabled:!t,icon:Y.a.NEW_OBJECT,onClick:()=>s(n.insertGoalDefinition(De)),text:"Create Goal"})};var Ke=function(e){const{requestPublish:t}=e,s=Object(m.useContext)(_),[n,i]=Object(m.useState)(""),r=""===n,o=e=>e===n?i(""):void 0;return Object(a.jsxs)("div",{className:"goal-editor",children:[Object(a.jsx)("div",{className:"command",children:Object(a.jsx)(ze,{allowNewUuid:r,setNewUuid:i})}),Object(a.jsx)("ul",{className:"goal-container",children:(c=s.getAllGoalUuids(),c.map((e=>Object(a.jsx)(We,{uuid:e,releaseUuid:o,requestPublish:t},e))))})]});var c};var Ye=function(e){const{bulkUpdateAchievements:t,bulkUpdateGoals:s,getAchievements:n,getOwnGoals:i,removeAchievement:r,removeGoal:o,inferencer:c}=e;Object(m.useEffect)((()=>{y.b.useAchievementBackend&&(n(),i())}),[n,i]);const[d,u]=Object(m.useState)(!1),h=()=>{u(!0),p()},[,p]=Object(m.useReducer)((e=>e+1),0);return Object(a.jsxs)(_.Provider,{value:c,children:[Object(a.jsx)(l.a,{message:"You have unpublished changes. Are you sure you want to leave?",when:d}),Object(a.jsxs)("div",{className:"AchievementControl",children:[Object(a.jsx)(Me,{awaitPublish:d,publishChanges:()=>{s(c.getAllGoals()),t(c.getAllAchievements()),c.getAchievementsToDelete().forEach(r),c.getGoalsToDelete().forEach(o),c.resetToDelete(),u(!1)}}),Object(a.jsx)(je,{requestPublish:h}),Object(a.jsx)(Ke,{requestPublish:h})]})]})};var Qe=Object(d.c)((e=>({inferencer:y.b.useAchievementBackend?new T(e.achievement.achievements,e.achievement.goals):new T(R,M)})),(e=>Object(u.b)({bulkUpdateAchievements:L.bulkUpdateAchievements,bulkUpdateGoals:L.bulkUpdateGoals,getAchievements:L.getAchievements,getOwnGoals:L.getOwnGoals,removeAchievement:L.removeAchievement,removeGoal:L.removeGoal},e)))(Ye);var Je=Object(d.c)((e=>({group:e.session.group,inferencer:y.b.useAchievementBackend?new T(e.achievement.achievements,e.achievement.goals):new T(R,M),name:e.session.name})),(e=>Object(u.b)({getAchievements:L.getAchievements,getOwnGoals:L.getOwnGoals},e)))(Re);const Ze=()=>Object(a.jsx)(l.b,{to:"/404"});var et=function(e){const{role:t}=e,s=t===j.a.Admin||t===j.a.Staff?Qe:Ze;return Object(a.jsxs)(l.e,{children:[Object(a.jsx)(l.c,{exact:!0,path:"/achievement",component:Je}),Object(a.jsx)(l.c,{path:"/achievement/control",component:s}),Object(a.jsx)(l.c,{component:Ze})]})};var tt=Object(d.c)((e=>({role:e.session.role})),(e=>Object(u.b)({},e)))(et),st=s(42),at=s(233),nt=s(132),it=s(5),rt=s(56),ot=s(402),ct=s(75),dt=s.n(ct),lt=s(45),ut=s.p+"static/media/default_cover_image.e2be0724.jpg",ht=s(51),pt=s(15),gt=s(4),mt=s.n(gt),bt=s(65);const jt={},yt=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CADET_LOGGER;function Ot(e,t){var s;yt&&(s={...t,questionId:jt[e],sessionId:e},new Promise(((e,t)=>{ft().then((a=>{const n=a.transaction([xt],"readwrite");n.oncomplete=e,n.onerror=t,n.objectStore(xt).add(s)}))})))}function vt(e,t){const s=Object(x.a)();return jt[s]=e,Ot(s,{...t,type:"init",time:Date.now()}),s}const xt="logs",ft=function(e){let t=null;return()=>t||(t=e(),t)}((()=>new Promise(((e,t)=>{const s=indexedDB.open("evtlogs",1);s.onsuccess=t=>{e(s.result)},s.onerror=e=>{console.error("Failed to get db",e),t(s.error)},s.onupgradeneeded=e=>{(null===e||void 0===e?void 0:e.target).result.createObjectStore(xt,{keyPath:"id",autoIncrement:!0})}}))));var St=s(33),Ct=s(38),wt=s(8);function Et(e){const t=(e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:e.displayName},e.displayName),s=({itemsParentRef:e,renderItem:t})=>{const s=j.h.map(t),n=j.o.map(t);return Object(a.jsxs)(K.w,{ulRef:e,children:[s,Object(a.jsx)(K.y,{text:"Variants",icon:"cog",children:n},"variant-menu")]})},n=ie.a.ofType();return((e,i,r=((e,t)=>{}),o)=>Object(a.jsx)(n,{items:j.m,onItemSelect:r,itemRenderer:t,itemListRenderer:s,filterable:!1,disabled:o||!1,children:Object(a.jsx)(K.b,{className:it.a.MINIMAL,text:Object(j.n)(e,i),rightIcon:o?null:Y.a.DOUBLE_CARET_VERTICAL,disabled:o||!1})}))(e.sourceChapter,e.sourceVariant,e.handleChapterSelect,e.disabled||!1)}const At={className:"",fullWidth:!1,iconOnRight:!1,intent:fe.a.NONE,minimal:!0};var It=(e,t,s=null,n={},i=!1)=>{const r={...At,...n},o={disabled:i};if(o.fill=void 0!==r.fullWidth&&r.fullWidth,o.intent=void 0===r.intent?fe.a.NONE:r.intent,o.minimal=void 0!==r.minimal&&r.minimal,o.className=r.className,o.type=r.type,t){const e=Object(a.jsx)(K.u,{icon:t,color:r.iconColor?r.iconColor:void 0});r.iconOnRight?o.rightIcon=e:o.icon=e}return s&&(o.onClick=s),Object(a.jsx)(K.b,{...o,children:e})};function Tt(e){return It("Clear",Y.a.REMOVE,e.handleReplOutputClear)}function kt(e){return e.isRunning?null:Object(a.jsx)(ot.a,{content:"...or press shift-enter in the REPL",children:It("Eval",Y.a.CODE,e.handleReplEval)})}function Nt(e){return It("Return to Academy",Y.a.ARROW_RIGHT,e.onClick,{iconOnRight:!0})}function Pt(e){return e.questionProgress[0]===e.questionProgress[1]?Object(a.jsx)(Nt,{onClick:e.onClickReturn},"return_to_academy"):It("Next",Y.a.ARROW_RIGHT,e.onClickNext,{iconOnRight:!0})}function Rt(e){return e.questionProgress[0]<=1?null:It("Previous",Y.a.ARROW_LEFT,e.onClick)}function Mt(e){return It(`Question ${e.questionProgress[0]} of ${e.questionProgress[1]}  `,null,null,{},!0)}function Lt(e){return It("Reset",Y.a.REPEAT,e.onClick)}function _t(e){return Object(a.jsx)(ot.a,{content:"...or press shift-enter in the editor",placement:rt.a.TOP,children:It("Run",Y.a.PLAY,e.handleEditorEval)})}function Dt(e){const t=e.hasUnsavedChanges?{intent:fe.a.WARNING,minimal:!1}:{};return It("Save",Y.a.FLOPPY_DISK,e.onClickSave,t)}var Gt=s(404);const Bt=e=>{const t=new Gt.Converter({tables:!0,simplifiedAutoLink:e.simplifiedAutoLink,strikethrough:e.strikethrough,tasklists:e.tasklists,openLinksInNewWindow:e.openLinksInNewWindow});return Object(a.jsx)("div",{className:mt()(e.className?e.className:"md",it.a.RUNNING_TEXT),dangerouslySetInnerHTML:{__html:t.makeHtml(e.content)}})};var Ut=m.memo(Bt),Ft=s(1232);var Ht=function(e){return Object(a.jsxs)("div",{className:"ControlBar",children:[Object(a.jsx)("div",{className:mt()("ControlBar_editor",it.a.BUTTON_GROUP),children:e.editorButtons}),e.flowButtons&&Object(a.jsx)("div",{className:mt()("ControlBar_flow",it.a.BUTTON_GROUP),children:e.flowButtons}),Object(a.jsx)("div",{className:mt()("ControlBar_editingWorkspace",it.a.BUTTON_GROUP),children:e.editingWorkspaceButtons})]})},Vt=s(110),qt=(s(640),s(335),s(254),s(116)),Xt=s.n(qt),$t=s(100);const Wt=(...e)=>t=>e.forEach((e=>{"function"===typeof e?e(t):e&&"object"===typeof e&&(e.current=t)}));function zt(e,t){const[s,a]=b.a.useState(t);return b.a.useEffect((()=>{(async()=>{const t=await e();a(t)})()}),[e]),{value:s,setValue:a}}function Kt(e){const[t,s]=b.a.useState(e);return{value:t,setValue:s,inputProps:{value:t,onChange:e=>{s(e.target.value)}}}}const Yt={evaluate:{win:"Shift-Enter",mac:"Shift-Enter"},navigate:{win:"Ctrl-B",mac:"Command-B"},refactor:{win:"Ctrl-M",mac:"Command-M"},highlightScope:{win:"Ctrl-Shift-H",mac:"Command-Shift-H"},typeInferenceDisplay:{win:"Ctrl-Shift-M",mac:"Command-Shift-M"}};var Qt=s(40);var Jt=(e,t,s,a)=>{const n=m.useRef(e);n.current=e;const i=m.useRef([]),r=m.useCallback((()=>{setTimeout((()=>{if(!a.current)return;const e=a.current.editor,t=e.session,s=t.getValue(),r=n.current.sourceChapter,o=e.getCursorPosition();if(!t||!t.bgTokenizer)return;i.current.forEach((e=>{t.removeMarker(e)}));const c=Object(Qt.getAllOccurrencesInScope)(s,Object(Qt.createContext)(r),{line:o.row+1,column:o.column}).map((e=>new Vt.Range(e.start.line-1,e.start.column,e.end.line-1,e.end.column)));i.current=c.map((e=>t.addMarker(e,"ace_variable_highlighting","text")))}),10)}),[a]),o=m.useCallback((()=>{if(!a.current)return;const e=a.current.editor,t=e.getValue(),s=n.current.sourceChapter,r=e.getCursorPosition(),o=Object(Qt.getScope)(t,Object(Qt.createContext)(s),{line:r.row+1,column:r.column});0!==o.length&&o.forEach((t=>{i.current.push(e.session.addMarker(new Vt.Range(t.start.line-1,t.start.column,t.end.line-1,t.end.column),"ace_selection","text"))}))}),[a]),{onChange:c,onCursorChange:d}=t;t.onChange=m.useCallback(((e,t)=>{r(),c&&c(e,t)}),[r,c]),t.onCursorChange=m.useCallback(((e,t)=>{r(),d&&d(e,t)}),[r,d]),s.highlightScope=o},Zt=s(151);var es=(e,t,s,a)=>{const n=m.useRef(e);n.current=e;const i=m.useCallback((()=>{const e=a.current.editor,t=e.selection.getCursor(),s=e.session.getTokenAt(t.row,t.column),{sourceChapter:i,handleDeclarationNavigate:r}=n.current;r(e.getCursorPosition());const o=e.selection.getCursor();if(o.row!==t.row||o.column!==t.column)return;if(Object(Qt.hasDeclaration)(e.getValue(),Object(Qt.createContext)(i),{line:o.row+1,column:o.column}))return;const c=y.a.sourceDocs,d="default"===n.current.sourceVariant?"":`_${n.current.sourceVariant}`,l=void 0===n.current.externalLibraryName?"NONE":n.current.externalLibraryName,u="ALL"===n.current.externalLibraryName?"External%20libraries":l;Zt.a.externalLibraries[l].some((e=>e.caption===(s&&s.value)))?null!==s&&(/\bsupport.function\b/.test(s.type)||/\bbuiltinconsts\b/.test(s.type))&&window.open(`${c}${u}/global.html#${s.value}`):null!==s&&(/\bsupport.function\b/.test(s.type)||/\bbuiltinconsts\b/.test(s.type))&&window.open(`${c}source_${i}${d}/global.html#${s.value}`),null!==s&&/\bstorage.type\b/.test(s.type)&&window.open(`${c}source_${i}.pdf`)}),[a]);s.navigate=i};var ts=(e,t,s,a)=>{const{sourceChapter:n}=e,i=m.useCallback((()=>{const e=a.current.editor;if(!e)return;const t=e.getValue(),s=e.getCursorPosition(),i=Object(Qt.getAllOccurrencesInScope)(t,Object(Qt.createContext)(n),{line:s.row+1,column:s.column}),r=e.getSelection();i.map((e=>new Vt.Range(e.start.line-1,e.start.column,e.end.line-1,e.end.column))).forEach((e=>r.addRange(e)))}),[a,n]);s.refactor=i},ss=s(405),as=s.n(ss);const ns={"http:":"ws:","https:":"wss:"};function is(e,t){const s=new URL(e,y.b.sharedbBackendUrl);return t&&(s.protocol=ns[s.protocol]),s.toString()}async function rs(e){const t=await fetch(is(e));return t&&t.ok}var os=(e,t,s,a)=>{const n=m.useRef(e);n.current=e;const{editorSessionId:r}=e;m.useEffect((()=>{if(!r)return;const e=a.current.editor,t=new as.a(r,{WsUrl:is(r,!0),pluginWsUrl:null,namespace:"sa"});t.on("ready",(()=>{t.add(e,[],[]),n.current.handleSetSharedbConnected(!0)})),t.on("error",((e,t)=>{console.error("ShareAce error",t),i.a(t)}));const s=t.WS;let o;return o=setInterval((async()=>{if(null!==t)try{await rs(r)||(clearInterval(o),s.close())}catch{s.reconnect()}}),5e3),s.addEventListener("open",(()=>{n.current.handleSetSharedbConnected(!0)})),s.addEventListener("close",(()=>{n.current.handleSetSharedbConnected(!1)})),()=>{clearInterval(o);for(const e of Object.values(t.connections))e.unlisten();t.WS.close()}}),[r,a])};var cs=(e,t,s,a)=>{const{sourceChapter:n,handleSendReplInputToOutput:i}=e,r=m.useCallback((()=>{const e=a.current.editor,t=e.getValue(),s=e.getCursorPosition(),r=e.session.getTokenAt(s.row,s.column);let o;if(i){if(s&&r){if("comment"===r.type)return;const e=Object(Qt.getTypeInformation)(t,Object(Qt.createContext)(n),{line:s.row+1,column:s.column},r.value);o=(e=>e.split("\n").filter((e=>""!==e)).map((e=>"// "+e)).join("\n"))(e),0===e.length&&(o="// type information not found")}else o="// invalid token. Please put cursor on an identifier.";i(o)}}),[a,i,n]);s.typeInferenceDisplay=r},ds=s(179);const ls=(e,t,s)=>{var a;"function"!==typeof(null===(a=ace.define.modules[`ace/mode/${us(e,t,s)}`])||void 0===a?void 0:a.Mode)&&(Object(ds.HighlightRulesSelector)(e,t,s,Zt.a.externalLibraries[s]),Object(ds.ModeSelector)(e,t,s))},us=(e,t,s)=>`source${e}${t}${s}`,hs=["onSelectionChange","onCursorChange","onInput","onLoad","onValidate","onBeforeLoad","onChange","onSelection","onCopy","onPaste","onFocus","onBlur","onScroll"],ps={goGreen:()=>{}},gs=m.memo(m.forwardRef((function(e,t){const s=m.useRef(null),n=m.useRef(e.handleEditorUpdateBreakpoints),i=m.useRef(e.handlePromptAutocomplete);m.useEffect((()=>{n.current=e.handleEditorUpdateBreakpoints,i.current=e.handlePromptAutocomplete}),[e.handleEditorUpdateBreakpoints,e.handlePromptAutocomplete]),m.useEffect((()=>(/iPhone|iPad|iPod/.test(navigator.userAgent)&&(document.body.style.position="fixed",document.body.style.width="100%"),()=>{document.body.style.position="",document.body.style.width=""})),[]);const[r,o,c]=[e.sourceChapter||1,e.sourceVariant||"default",e.externalLibraryName||"NONE"];ls(r,o,c),m.useLayoutEffect((()=>{if(!s.current)return;const e=s.current.editor,t=e.getSession();var a,r;e.on("gutterclick",(a=(...e)=>n.current(...e),e=>{const t=e.domEvent.target;if(-1===t.className.indexOf("ace_gutter-cell")||!e.editor.isFocused()||e.clientX>35+t.getBoundingClientRect().left)return;const s=e.getDocumentPosition().row,n=e.editor.session.getLine(s);void 0!==e.editor.session.getBreakpoints()[s]||0===n.length||n.includes("//")||n.includes("debugger;")?e.editor.session.clearBreakpoint(s):e.editor.session.setBreakpoint(s,void 0),e.stop(),a(e.editor.session.getBreakpoints())})),t.on("changeAnnotation",(e=>()=>{const t=e.getAnnotations();let s=0;for(const e of t)"info"===e.type&&(e.type="error",e.className="ace_error",s++);0!==s&&e.setAnnotations(t)})(t)),Object(Vt.require)("ace/ext/language_tools").setCompleters([(r=(...e)=>i.current(...e),{getCompletions:(e,t,s,a,n)=>{a&&/\d/.test(a.charAt(0))?n():r(s.row+1,s.column,n)}})])}),[]),m.useLayoutEffect((()=>{if(!s.current)return;const t=e.newCursorPosition;var a,n;t&&(a=s.current.editor,n=t,a.selection.clearSelection(),a.moveCursorToPosition(n),a.renderer.showCursor(),a.renderer.scrollCursorIntoView(n,.5))}),[e.newCursorPosition]);const{handleUpdateHasUnsavedChanges:d,handleEditorValueChange:l,isEditorAutorun:u,handleEditorEval:h}=e,p={evaluate:h},g={className:"react-ace",editorProps:{$blockScrolling:1/0},markers:m.useMemo((()=>e.highlightedLines.map((e=>({startRow:e[0],startCol:0,endRow:e[1],endCol:1,className:"myMarker",type:"fullLine"})))),[e.highlightedLines]),fontSize:17,height:"100%",highlightActiveLine:!1,mode:us(r,o,c),theme:"source",value:e.editorValue,width:"100%",setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,fontFamily:"'Inconsolata', 'Consolas', monospace"}},[b]=m.useState(e.hooks);if(b)for(const a of b)a(e,g,p,s);const j=g.onChange;return g.onChange=m.useCallback(((e,t)=>{if(!s.current)return;l(e),d&&d(!0);const a=s.current.editor.getSession().getAnnotations();u&&0===a.length&&h(),j&&j(e,t)}),[l,d,u,j,h]),g.commands=Object.entries(p).filter((([e,t])=>t)).map((([e,t])=>({name:e,bindKey:Yt[e],exec:t}))),hs.forEach((t=>{const s=e[t];if(s){const e=g[t];g[t]=e?function(...t){e(...t),s(...t)}:s}})),Object(a.jsx)($t.HotKeys,{className:"Editor",handlers:ps,children:Object(a.jsx)("div",{className:"row editor-react-ace",children:Object(a.jsx)(Xt.a,{...g,ref:Wt(s,t)})})})}))),ms=[Jt,es,cs,os,ts];var bs=m.forwardRef(((e,t)=>Object(a.jsx)(gs,{...e,hooks:ms,ref:t})));class js extends m.PureComponent{constructor(...e){super(...e),this.onButtonClickFactory=e=>t=>{e!==this.props.mcq.answer&&this.props.handleMCQSubmit(e);if(null!==this.props.mcq.solution&&this.props.mcq.choices[e].hint){const t=Object(a.jsx)(Ut,{className:"markdown-notification",content:this.props.mcq.choices[e].hint});e===this.props.mcq.solution?Object(f.d)(t,4e3):Object(f.e)(t,4e3)}},this.getButtonIntent=(e,t,s)=>{const a=e===t,n=a&&null!==s&&e===s;return null===s?fe.a.NONE:a&&n?fe.a.SUCCESS:a&&!n?fe.a.DANGER:fe.a.NONE}}render(){const e=this.props.mcq.choices.map(((e,t)=>Object(a.jsx)(K.b,{className:"mcq-option col-xs-12",active:t===this.props.mcq.answer,intent:this.getButtonIntent(t,this.props.mcq.answer,this.props.mcq.solution),onClick:this.onButtonClickFactory(t),minimal:!0,children:Object(a.jsx)(Ut,{content:e.content})},t)));return Object(a.jsx)("div",{className:"MCQChooser row",children:Object(a.jsx)(K.e,{className:"mcq-content-parent col-xs-12 middle-xs",children:Object(a.jsx)("div",{className:"row mcq-options-parent between-xs",children:e})})})}}var ys=js,Os=s(23),vs=s(235),xs=s.n(vs);class fs extends m.Component{constructor(...e){super(...e),this.$parent=null}componentDidMount(){this.$parent.appendChild(this.props.canvas),this.props.canvas.hidden=!1}render(){return Object(a.jsx)("div",{ref:e=>this.$parent=e,className:"canvas-container"})}}var Ss=fs;const Cs=m.forwardRef(((e,t)=>{const s=document.getElementById("replInputButtom"),n=e.handleBrowseHistoryDown,i=e.handleBrowseHistoryUp;m.useEffect((()=>{s&&(s.clientWidth>=window.innerWidth-50||s.scrollIntoView())})),ls(e.sourceChapter,e.sourceVariant,e.externalLibrary);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Xt.a,{className:"repl-react-ace react-ace",mode:us(e.sourceChapter,e.sourceVariant,e.externalLibrary),theme:"source",height:"1px",width:"100%",value:e.replValue,onChange:e.handleReplValueChange,commands:[{name:"browseHistoryDown",bindKey:{win:"Down",mac:"Down"},exec:n},{name:"browseHistoryUp",bindKey:{win:"Up",mac:"Up"},exec:i},{name:"evaluate",bindKey:{win:"Shift-Enter",mac:"Shift-Enter"},exec:()=>{s&&(s.scrollIntoView(),e.handleReplEval())}}],minLines:1,maxLines:20,fontSize:17,highlightActiveLine:!1,showGutter:!1,showPrintMargin:!1,setOptions:{fontFamily:"'Inconsolata', 'Consolas', monospace"},ref:t}),Object(a.jsx)("div",{className:mt()(it.a.BUTTON_GROUP,it.a.DARK),children:e.replButtons}),Object(a.jsx)(dt.a,{minWidth:769,children:Object(a.jsx)("div",{className:"replInputBottom",id:"replInputBottom"})})]})})),ws=m.forwardRef(((e,t)=>{const s=e.output.map(((t,s)=>Object(a.jsx)(Es,{output:t,usingSubst:e.usingSubst||!1},s)));return Object(a.jsx)("div",{className:"Repl",style:{display:e.hidden?"none":void 0},children:Object(a.jsxs)("div",{className:"repl-output-parent",children:[s,!e.inputHidden&&Object(a.jsx)($t.HotKeys,{className:mt()("repl-input-parent","row",it.a.CARD,it.a.ELEVATION_0),handlers:Is,children:Object(a.jsx)(Cs,{...e,ref:t})})]})})})),Es=e=>{switch(e.output.type){case"code":return Object(a.jsx)(K.e,{children:Object(a.jsx)(K.I,{className:"codeOutput",children:e.output.value})});case"running":return Object(a.jsx)(K.e,{children:Object(a.jsx)(K.I,{className:"logOutput",children:e.output.consoleLogs.join("\n")})});case"result":return e.usingSubst&&e.output.value instanceof Array?Object(a.jsx)(K.e,{children:Object(a.jsx)(K.I,{className:"logOutput",children:"Check out the substituter tab!"})}):0===e.output.consoleLogs.length?Object(a.jsx)(K.e,{children:Object(a.jsx)(K.I,{className:"resultOutput",children:As(e.output.value)})}):Object(a.jsxs)(K.e,{children:[Object(a.jsx)(K.I,{className:"logOutput",children:e.output.consoleLogs.join("\n")}),Object(a.jsx)(K.I,{className:"resultOutput",children:As(e.output.value)})]});case"errors":return 0===e.output.consoleLogs.length?Object(a.jsx)(K.e,{children:Object(a.jsx)(K.I,{className:"errorOutput",children:Object(Qt.parseError)(e.output.errors)})}):Object(a.jsxs)(K.e,{children:[Object(a.jsx)(K.I,{className:"logOutput",children:e.output.consoleLogs.join("\n")}),Object(a.jsx)("br",{}),Object(a.jsx)(K.I,{className:"errorOutput",children:Object(Qt.parseError)(e.output.errors)})]});default:return Object(a.jsx)(K.e,{children:"''"})}},As=e=>{const t=window.ShapeDrawn;return"undefined"!==typeof t&&e instanceof t?Object(a.jsx)(Ss,{canvas:e.$canvas}):Object(bt.stringify)(e)},Is={goGreen:()=>{}};var Ts=ws;var ks=b.a.forwardRef(((e,t)=>Object(a.jsx)(xs.a,{axis:"y",handle:"#dragHandle",position:e.position,bounds:{top:-500,left:0,right:0,bottom:0},onDrag:e.onDrag,disabled:e.disabled,children:Object(a.jsxs)("div",{className:"mobile-draggable",children:[e.disabled?Object(a.jsx)("div",{className:"handle disabled",id:"draghandle",children:["1","2","3"].map((e=>Object(a.jsx)("div",{className:"circle"},e)))}):Object(a.jsx)("div",{className:"handle enabled",id:"dragHandle",children:["1","2","3"].map((e=>Object(a.jsx)("div",{className:"circle"},e)))}),Object(a.jsx)("div",{className:"REPL-content",children:Object(a.jsx)(Ts,{...e.replProps,ref:t})})]})}))),Ns=s(407),Ps=s.n(Ns);var Rs=e=>{const[t,s]=b.a.useState(!1),[n,i]=b.a.useState("\u1438"),[r,o]=b.a.useState({x:0,y:0}),[c,d]=b.a.useState(1),l=e=>{e.preventDefault()},u={onKeyPress:t=>{if(!e.editorRef.current)return;const s=e.editorRef.current.editor;"{arrowleft}"===t?s.navigateLeft():"{arrowright}"===t?s.navigateRight():"{bksp}"===t?s.remove("left"):"{tab}"===t?s.insert("\t"):["+","-","*","/","%","=>","===","&&","||"].includes(t)?s.insert(" "+t+" "):s.insert(t)},baseClass:"simple-keyboard-shortcut",layout:{default:["{ } ( ) \" ' _ => ;","{tab} && || ! < > = ===","+ - * / % // {arrowleft} {arrowright}"]},buttonTheme:[{class:"mobile-navigation",buttons:"{arrowleft} {arrowright}"},{class:"big-buttons",buttons:"=== &&"}],theme:"hg-theme-default",preventMouseDownDefault:!0,disableCaretPositioning:!1};return Object(a.jsx)(xs.a,{axis:"y",handle:"#floating-dragHandle",position:r,bounds:{top:-200,left:0,right:0,bottom:200},onDrag:(e,t)=>{o(t)},children:Object(a.jsxs)("div",{className:"mobile-floating-keyboard",id:"mobile-floating-toggle",children:[Object(a.jsx)("button",{className:"mobile-floating-toggle",onClick:e=>{t?(document.getElementById("mobile-keyboard-toggle").style.setProperty("display","none"),document.getElementById("mobile-floating-toggle").style.setProperty("width","42px"),document.getElementById("mobile-floating-toggle").style.setProperty("opacity","0.6"),i("\u1438"),s(!1)):(document.getElementById("mobile-keyboard-toggle").style.setProperty("display","flex"),document.getElementById("mobile-floating-toggle").style.setProperty("width","99vw"),document.getElementById("mobile-floating-toggle").style.setProperty("opacity","1"),i("\u1433"),s(!0))},onMouseDown:l,children:n}),Object(a.jsxs)("div",{className:"mobile-keyboard-toggle-container",id:"mobile-keyboard-toggle",children:[Object(a.jsx)("div",{className:"mobile-keyboard-container",children:Object(a.jsx)(Ps.a,{...u})}),Object(a.jsx)("button",{className:"mobile-keyboard-row-toggle",onClick:e=>{d((c+1)%3);const t=document.getElementsByClassName("simple-keyboard-shortcut");Array.from(t)[0].style.top=45*-c+"px"},onMouseDown:l,children:"\u2938"})]}),Object(a.jsx)("div",{id:"floating-dragHandle",children:":"})]})})};const Ms=new Map,Ls=e=>{const t=[..._s(e).filter((t=>t.toSpawn(e))).map((e=>(e.id=Os.b.module,e)))];return e.workspaceLocation&&Ms.set(e.workspaceLocation,t.map((e=>e.label))),t},_s=e=>{var t;const s=null===(t=e.context)||void 0===t?void 0:t.modules;if(null==s)return[];return s.map((e=>e(b.a))).map((t=>({...t,body:t.body(e)})))};var Ds=s(297);var Gs=e=>{const t=Object(a.jsxs)("div",{className:"mobile-control-bar",children:[e.editorButtons,e.flowButtons,e.editingWorkspaceButtons]});return Object(a.jsx)(Ds.a,{content:t,autoFocus:!1,children:Object(a.jsx)(K.b,{icon:Y.a.COG,className:mt()(it.a.MINIMAL,"mobile-control-bar-button")})})};var Bs=e=>{const{tabs:t,defaultSelectedTabId:s,selectedTabId:n,handleActiveTabChange:i,onChange:r}=e,[o,c]=b.a.useState(t),l=/iPhone|iPod/.test(navigator.platform);b.a.useEffect((()=>{i(s||t[0].id)}),[]);const u=Object(d.f)((t=>e.workspaceLocation&&t.workspaces[e.workspaceLocation].debuggerContext));b.a.useEffect((()=>{const e=[...t],s=e.pop(),a=e.concat(Ls(u||{}));a.push(s),c(a)}),[t,u]);const h=e=>`${e}-icon`,p=b.a.useMemo((()=>o.map((t=>((e,t)=>{const s=void 0===e.id?e.label:e.id,n=Object(a.jsx)(ot.a,{content:e.label,onOpening:()=>{var e;l&&(null===(e=document.getElementById(h(s)))||void 0===e||e.click())},children:Object(a.jsx)("div",{className:"side-content-tooltip",id:h(s),children:Object(a.jsx)(K.u,{icon:e.iconName,iconSize:20})})});return Object(a.jsx)(K.O,{id:s,title:n,disabled:e.disabled,className:"side-content-tab"},s)})(t,e.workspaceLocation)))),[o,e.workspaceLocation,l]),g=b.a.useCallback(((t,s,a)=>{const n=e=>{const t=h(e),s=document.getElementById(t);s&&s.classList.remove("side-content-tab-alert")};var o;(void 0===r||r(t,s,a),n(s),t===Os.b.mobileEditor)&&(null===(o=e.editorRef.current)||void 0===o||o.editor.renderer.updateFull());s!==Os.b.substVisualizer&&s!==Os.b.autograder||t!==Os.b.mobileEditorRun?t===Os.b.mobileEditorRun?(e.handleEditorEval(),e.handleShowRepl()):(i(t),e.handleHideRepl()):e.handleEditorEval(),t===Os.b.substVisualizer||s===Os.b.substVisualizer&&t===Os.b.mobileEditorRun?e.disableRepl(!0):e.disableRepl(!1)}),[i,r,e]);return Object(a.jsxs)(a.Fragment,{children:[[...o.map((t=>((e,t)=>{const s=t?{...e.body,props:{...e.body.props,workspaceLocation:t}}:e.body;if(e.id!==Os.b.mobileEditorRun)return e.id===Os.b.mobileEditor?n===Os.b.mobileEditor||n===Os.b.mobileEditorRun?Object(a.jsx)("div",{className:"mobile-editor-panel",children:s},"editor"):Object(a.jsx)("div",{className:"mobile-unselected-panel",children:s},"editor"):e.id===n?Object(a.jsx)("div",{className:"mobile-selected-panel",children:s},e.id):Object(a.jsx)("div",{className:"mobile-unselected-panel",children:s},e.id)})(t,e.workspaceLocation)))],Object(a.jsx)("div",{className:"mobile-tabs-container",children:Object(a.jsxs)(K.P,{id:"mobile-side-content",onChange:g,defaultSelectedTabId:e.defaultSelectedTabId,renderActiveTabPanelOnly:e.renderActiveTabPanelOnly,selectedTabId:e.selectedTabId,className:mt()(it.a.DARK,"mobile-side-content"),children:[p,"playground"===e.workspaceLocation&&Object(a.jsx)(Gs,{...e.mobileControlBarProps})]})})]})};var Us=e=>{const t=/Android/.test(navigator.platform),s=Object(ct.useMediaQuery)({orientation:"portrait"}),n=/iPhone|iPad|iPod|Android/.test(navigator.userAgent),[i,r]=b.a.useState({x:0,y:0}),[o,c]=b.a.useState(!1);Ft.a.onlyShowFocusOnTabs(),b.a.useEffect((()=>("assessment"===e.mobileSideContentProps.workspaceLocation&&document.documentElement.style.setProperty("--mobile-panel-height","calc(100% - 100px - 1.1rem)"),()=>{document.documentElement.style.setProperty("--mobile-panel-height","calc(100% - 70px)")})),[]),b.a.useEffect((()=>{if(s&&t){document.documentElement.style.setProperty("overflow","auto");document.querySelector("meta[name=viewport]").setAttribute("content","height="+window.innerHeight+", width=device-width")}return()=>{if(t){document.documentElement.style.setProperty("overflow","hidden");document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}m()}}),[s,t]);const d=b.a.useRef(null),u=b.a.useRef(null),h=b.a.useRef(null),[p,g]=b.a.useState(h);b.a.useEffect((()=>{var e,t,s,a;null===(e=d.current)||void 0===e||e.editor.on("focus",(()=>{g(d)})),null===(t=u.current)||void 0===t||t.editor.on("focus",(()=>{g(u)}));const n=()=>g(h);null===(s=d.current)||void 0===s||s.editor.on("blur",n),null===(a=u.current)||void 0===a||a.editor.on("blur",n)}),[]);const m=()=>{document.documentElement.style.setProperty("--mobile-repl-height","0px"),r({x:0,y:0})},j={handleShowRepl:()=>{document.documentElement.style.setProperty("--mobile-repl-height",Math.max(300,0)+"px"),r({x:0,y:-300})},handleHideRepl:m,disableRepl:c},y=b.a.useMemo((()=>({label:"Editor",iconName:Y.a.EDIT,body:e.customEditor?e.customEditor:e.editorProps?Object(a.jsx)(bs,{...e.editorProps,ref:d}):Object(a.jsx)(ys,{...e.mcqProps}),id:Os.b.mobileEditor,toSpawn:()=>!0})),[e.customEditor,e.editorProps,e.mcqProps]),O=b.a.useMemo((()=>({label:"Run",iconName:Y.a.PLAY,body:Object(a.jsx)("div",{}),id:Os.b.mobileEditorRun,toSpawn:()=>!0})),[]);return Object(a.jsxs)("div",{className:"workspace mobile-workspace",children:[e.hasUnsavedChanges?Object(a.jsx)(l.a,{message:"You have changes that may not be saved. Are you sure you want to leave?"}):null,Object(a.jsx)(K.g,{isOpen:!s&&n,canEscapeKeyClose:!1,canOutsideClickClose:!1,isCloseButtonShown:!1,title:"Please turn back to portrait orientation!"}),"assessment"===e.mobileSideContentProps.workspaceLocation&&Object(a.jsx)(Ht,{...e.mobileSideContentProps.mobileControlBarProps}),Object(a.jsx)(Bs,{...{...e.mobileSideContentProps,tabs:[y,...e.mobileSideContentProps.tabs,O]},...j,editorRef:d}),Object(a.jsx)(ks,{position:i,onDrag:(e,t)=>{document.documentElement.style.setProperty("--mobile-repl-height",Math.max(-t.y,0)+"px"),r(t)},disabled:o,replProps:e.replProps,ref:u},"repl"),Object(a.jsx)(Rs,{editorRef:p})]})};var Fs=e=>{const{index:t,result:s}=e;return Object(a.jsx)("div",{className:mt()("ResultCard","pass"===s.resultType?"correct":"wrong"),children:Object(a.jsxs)(K.e,{elevation:nt.a.ONE,children:[Object(a.jsxs)("div",{className:"result-data",children:[Object(a.jsx)("div",{className:"result-idx",children:t+1}),Object(a.jsx)("div",{className:"result-status",children:s.resultType.toUpperCase()})]}),Object(a.jsx)(K.I,{className:"result-expected",children:s.expected}),Object(a.jsx)(K.I,{className:"result-actual",children:"error"===s.resultType?(n=s.errors,n.map((e=>{switch(e.errorType){case"timeout":return"[TIMEOUT] Submission exceeded time limit for this test case.";case"syntax":return`[SYNTAX] Line ${e.line}: Error: ${e.errorExplanation}`;case"systemError":return`[RUNTIME] ${e.errorMessage}`;default:return`[UNKNOWN] Autograder error: type ${e.errorType}`}})).join("\n\n")):s.actual})]})});var n};const Hs=e=>{const t=window.ShapeDrawn;return"undefined"!==typeof t&&e instanceof t?Object(a.jsx)(Ss,{canvas:e.$canvas}):Object(bt.stringify)(e)};var Vs=e=>{const{index:t,testcase:s,handleTestcaseEval:n}=e,i=m.useMemo((()=>{const e=void 0!==s.result||s.errors,t=Object(bt.stringify)(s.result)===s.answer;return{correct:e&&t,wrong:e&&!t,private:s.type===wt.g.private}}),[s]),r=m.useCallback((()=>{n(t)}),[t,n]);return Object(a.jsx)("div",{className:mt()("AutograderCard",i),children:Object(a.jsx)(K.e,{className:it.a.INTERACTIVE,elevation:nt.a.ONE,onClick:r,children:s.type===wt.g.hidden?Object(a.jsx)(K.I,{className:"testcase-placeholder",children:"Hidden testcase"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.I,{className:"testcase-program",children:s.program}),Object(a.jsx)(K.I,{className:"testcase-expected",children:s.answer}),Object(a.jsx)(K.I,{className:"testcase-actual",children:s.errors?Object(Qt.parseError)(s.errors):void 0!==s.result?Hs(s.result):"No Answer"})]})})})};const qs=Object(a.jsxs)("div",{className:"autograder-help-tooltip",children:[Object(a.jsx)("p",{children:"Click on each testcase below to execute it with the program in the editor."}),Object(a.jsx)("p",{children:"To execute all testcases at once, evaluate the program in the editor with this tab active."}),Object(a.jsx)("p",{children:"A green or red background indicates a passed or failed testcase respectively."}),Object(a.jsx)("p",{children:"Private testcases (only visible to staff when grading) have a grey background."})]}),Xs=(e,t)=>Object(a.jsxs)("div",{className:e,children:[t,Object(a.jsx)(K.u,{icon:Y.a.CARET_DOWN})]}),$s=Object(a.jsxs)("div",{className:"testcases-header",children:[Xs("header-fn","Testcase"),Xs("header-expected","Expected result"),Xs("header-actual","Actual result")]}),Ws=Object(a.jsxs)("div",{className:"results-header",children:[Object(a.jsxs)("div",{className:"header-data",children:[Xs("header-sn","S/N"),Xs("header-status","Testcase status")]}),Xs("header-expected","Expected result"),Xs("header-actual","Actual result")]}),zs=(e,t,s)=>It(e,t?Y.a.CARET_DOWN:Y.a.CARET_RIGHT,s,{className:"collapse-button",minimal:!0});var Ks=e=>{const[t,s]=m.useState(!0),[n,i]=m.useState(!0),{testcases:r,autogradingResults:o,handleTestcaseEval:c}=e,d=m.useMemo((()=>r.length>0?Object(a.jsxs)("div",{className:"testcaseCards",children:[$s,r.map(((e,t)=>Object(a.jsx)(Vs,{index:t,testcase:e,handleTestcaseEval:c},t)))]}):Object(a.jsx)("div",{className:"noResults",children:"There are no testcases provided for this question."})),[r,c]),l=m.useMemo((()=>o.length>0?Object(a.jsxs)("div",{children:[Ws,o.map(((e,t)=>Object(a.jsx)(Fs,{index:t,result:e},t)))]}):Object(a.jsx)("div",{className:"noResults",children:"There are no results to show."})),[o]),u=m.useCallback((()=>{s(!t)}),[t]),h=m.useCallback((()=>i(!n)),[n]);return Object(a.jsxs)("div",{className:"Autograder",children:[Object(a.jsxs)(K.b,{className:"collapse-button",icon:t?Y.a.CARET_DOWN:Y.a.CARET_RIGHT,minimal:!0,onClick:u,children:[Object(a.jsx)("span",{children:"Testcases"}),Object(a.jsx)(ot.a,{content:qs,placement:K.H.LEFT,children:Object(a.jsx)(K.u,{icon:Y.a.HELP})})]}),Object(a.jsx)(K.f,{isOpen:t,keepChildrenMounted:!0,children:d}),zs("Autograder Results",n,h),Object(a.jsx)(K.f,{isOpen:n,keepChildrenMounted:!0,children:l})]})};class Ys extends m.Component{constructor(...e){super(...e),this.$container=null}shouldComponentUpdate(){return!1}componentDidMount(){window.ToneMatrix&&window.ToneMatrix.initialise_matrix(this.$container)}handleClear(){window.ToneMatrix.clear_matrix()}handleRandomise(){window.ToneMatrix.randomise_matrix()}render(){return Object(a.jsxs)("div",{className:"sa-tone-matrix",children:[Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:mt()("controls","col-xs-12",it.a.DARK,it.a.BUTTON_GROUP),children:[Object(a.jsx)(K.b,{id:"clear-matrix",onClick:this.handleClear,children:"Clear"}),Object(a.jsx)(K.b,{id:"randomise-matrix",onClick:this.handleRandomise,children:"Randomise"})]})}),Object(a.jsx)("div",{className:"row",children:Object(a.jsx)("div",{className:"col-xs-12",ref:e=>this.$container=e})})]})}}var Qs=Ys;class Js extends m.Component{constructor(e){super(e),this.$video=null,this.$canvas=null,this.setupVideoService=()=>{const e=window._VD;this.$video&&this.$canvas&&e&&(e.init(this.$video,this.$canvas,this.printError),this.setState({width:window._WIDTH,height:window._HEIGHT,FPS:window._FPS,mode:"video",needSetup:!1}))},this.printError=(e,t)=>{t?this.props.replChange(Object(Qt.parseError)(e)):this.props.replChange(e)},this.closeVideo=()=>{var e;null===(e=window._VD)||void 0===e||e.deinit()},this.handleStartVideo=()=>{var e;null===(e=window._VD)||void 0===e||e.startVideo()},this.handleSnapPicture=()=>{var e;null===(e=window._VD)||void 0===e||e.snapPicture()},this.handleCloseVideo=()=>{var e;null===(e=window._VD)||void 0===e||e.stopVideo()},this.handleWidthChange=e=>{e>0&&e<=500&&(this.setState({width:e,height:this.state.height}),this.handleUpdateDimensions(e,this.state.height))},this.handleHeightChange=e=>{e>0&&e<=500&&(this.setState({width:this.state.width,height:e}),this.handleUpdateDimensions(this.state.width,e))},this.handleFPSChange=e=>{var t;e>2&&e<30&&(this.setState({FPS:e}),null===(t=window._VD)||void 0===t||t.updateFPS(e))},this.handleUpdateDimensions=(e,t)=>{var s;null===(s=window._VD)||void 0===s||s.updateDimensions(e,t)},this.swapModes=e=>()=>{switch(e){case"video":this.setState((e=>({...e,mode:"still"})),this.handleSnapPicture);break;case"still":this.setState((e=>({...e,mode:"video"})),this.handleStartVideo)}},this.state={width:window._WIDTH,height:window._HEIGHT,FPS:window._FPS,mode:"video",needSetup:!0}}componentDidMount(){this.setupVideoService(),window.addEventListener("beforeunload",this.closeVideo)}componentWillUnmount(){this.closeVideo(),window.removeEventListener("beforeunload",this.closeVideo)}render(){const e="video"===this.state.mode,t="still"===this.state.mode;return Object(a.jsxs)("div",{className:"sa-video",children:[this.state.needSetup?Object(a.jsxs)("div",{children:[Object(a.jsx)("p",{children:"Looks like the video did not have time to load. Click the button below to activate."}),Object(a.jsx)(K.b,{className:"sa-live-video-button",text:"Start Video",onClick:this.setupVideoService}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]}):Object(a.jsx)("div",{}),Object(a.jsxs)("div",{className:"sa-video-header",children:[Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsxs)(K.c,{children:[Object(a.jsx)(K.b,{className:"sa-live-video-button",icon:Y.a.VIDEO,active:e,onClick:this.swapModes(this.state.mode),text:"Live Video"}),Object(a.jsx)(K.b,{className:"sa-still-image-button",icon:Y.a.CAMERA,active:t,onClick:t?this.handleSnapPicture:this.swapModes(this.state.mode),text:"Still Image"})]})}),Object(a.jsx)(K.h,{}),Object(a.jsxs)("div",{className:"sa-video-header-element",children:[Object(a.jsx)("div",{className:"sa-video-header-numeric-input",children:Object(a.jsx)(ot.a,{content:"Change width",children:Object(a.jsx)(K.E,{leftIcon:Y.a.HORIZONTAL_DISTRIBUTION,style:{width:70},value:this.state.width,onValueChange:this.handleWidthChange,minorStepSize:1,stepSize:10,majorStepSize:100,max:500})})}),Object(a.jsx)("div",{className:"sa-video-header-numeric-input",children:Object(a.jsx)(ot.a,{content:"Change height",children:Object(a.jsx)(K.E,{leftIcon:Y.a.VERTICAL_DISTRIBUTION,style:{width:70},value:this.state.height,onValueChange:this.handleHeightChange,minorStepSize:1,stepSize:10,majorStepSize:100,max:500})})}),Object(a.jsx)("div",{className:"sa-video-header-numeric-input",children:Object(a.jsx)(ot.a,{content:"Change FPS",children:Object(a.jsx)(K.E,{leftIcon:Y.a.STOPWATCH,style:{width:60},value:this.state.FPS,onValueChange:this.handleFPSChange,minorStepSize:null,stepSize:1,majorStepSize:null,max:30,min:2})})})]})]}),Object(a.jsxs)("div",{className:"sa-video-element",children:[Object(a.jsx)("video",{ref:e=>this.$video=e,style:{display:"none"},autoPlay:!0,width:window._WIDTH,height:window._HEIGHT}),Object(a.jsx)("canvas",{ref:e=>this.$canvas=e,width:window._WIDTH,height:window._HEIGHT})]}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{style:{fontFamily:"courier"},children:"Note: Is video lagging? Switch to 'still image' or adjust FPS rate!"})]})}}var Zs=Js,ea=s(55);const ta=e=>e===wt.a.Sidequest?"quests":e.toLowerCase().concat("s"),sa=e=>{if(void 0===e)return null;const t=parseInt(e,10);return Number.isInteger(t)?t:null};var aa=s(299);var na=e=>{const{tabs:t,defaultSelectedTabId:s,handleActiveTabChange:n,onChange:i}=e,[r,o]=m.useState(t);m.useEffect((()=>{n(s||t[0].id)}),[]);const c=Object(d.f)((t=>e.workspaceLocation&&t.workspaces[e.workspaceLocation].debuggerContext));m.useEffect((()=>{const e=t.concat(Ls(c||{}));o(e)}),[t,c]);const l=e=>`${e}-icon`,u=m.useMemo((()=>r.map((t=>((e,t)=>{const s=void 0===e.id||e.id===Os.b.module?e.label:e.id,n=Object(a.jsx)(ot.a,{content:e.label,children:Object(a.jsx)("div",{className:(i=e.id,i===Os.b.module?"side-content-tooltip side-content-tab-alert":"side-content-tooltip"),id:l(s),children:Object(a.jsx)(K.u,{icon:e.iconName,iconSize:20})})});var i;const r=t?{...e.body,props:{...e.body.props,workspaceLocation:t}}:e.body,o=Object(a.jsx)("div",{className:"side-content-text",children:r});return Object(a.jsx)(K.O,{id:s,title:n,panel:o,disabled:e.disabled,className:"side-content-tab"},s)})(t,e.workspaceLocation)))),[r,e.workspaceLocation]),h=m.useCallback(((e,t,s)=>{const a=e=>{const t=l(e),s=document.getElementById(t);s&&s.classList.remove("side-content-tab-alert")};n(e),void 0===i||i(e,t,s),a(t)}),[n,i]);return Object(a.jsx)("div",{className:"side-content",children:Object(a.jsx)(K.e,{children:Object(a.jsx)("div",{className:"side-content-tabs",children:Object(a.jsx)(K.P,{id:"side-content-tabs",onChange:h,defaultSelectedTabId:e.defaultSelectedTabId,renderActiveTabPanelOnly:e.renderActiveTabPanelOnly,selectedTabId:e.selectedTabId,children:u})})})})};const ia={top:!1,right:!0,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},ra={top:!1,right:!1,bottom:!0,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1};var oa=e=>{const t=m.useRef(null),s=m.useRef(null),n=m.useRef(null),i=m.useRef(null);Ft.a.onlyShowFocusOnTabs(),m.useEffect((()=>{e.sideContentIsResizeable&&null===n.current&&(n.current=i.current.clientHeight)}));const r=(e,a,n)=>{const i=n.clientWidth/window.innerWidth*100;i>95?s.current.updateSize({width:"100%",height:"100%"}):i<5&&s.current.updateSize({width:"0%",height:"100%"}),t.current.style.marginRight=i<5?"0.5rem":"0"},o=(e,t,s)=>{n.current=i.current.clientHeight>n.current?i.current.clientHeight:n.current;const a=s.clientHeight,r=s.parentNode.clientHeight;a+n.current+2>r?i.current.style.display="none":i.current.style.display="initial"},c=Object(a.jsx)(na,{...e.sideContentProps}),d=Object(a.jsxs)(aa.a,{bounds:"parent",className:"resize-side-content",enable:ra,onResize:o,onResizeStop:(t,s,a,n)=>e.handleSideContentHeightChange(a.clientHeight),children:[c,Object(a.jsx)("div",{className:"side-content-divider",ref:i})]});return Object(a.jsxs)("div",{className:"workspace",children:[e.hasUnsavedChanges?Object(a.jsx)(l.a,{message:"You have changes that may not be saved. Are you sure you want to leave?"}):null,Object(a.jsx)(Ht,{...{...e.controlBarProps}}),Object(a.jsxs)("div",{className:"row workspace-parent",children:[Object(a.jsx)("div",{className:"editor-divider",ref:t}),Object(a.jsx)(aa.a,{className:"resize-editor left-parent",enable:ia,minWidth:0,onResize:r,onResizeStop:(t,s,a,n)=>e.handleEditorWidthChange(100*n.width/window.innerWidth),ref:s,size:{width:e.editorWidth,height:"100%"},as:void 0,children:(e=>e.customEditor?e.customEditor:e.editorProps?Object(a.jsx)(bs,{...e.editorProps}):Object(a.jsx)(ys,{...e.mcqProps}))(e)}),Object(a.jsxs)("div",{className:"right-parent",children:[void 0===e.sideContentIsResizeable||e.sideContentIsResizeable?d:c,Object(a.jsx)(Ts,{...e.replProps})]})]})]})};const ca=e=>{const t=g()(e),s=g()();return t.isBefore(s)},da=e=>g()(e).format("Do MMMM, HH:mm");class la extends m.Component{render(){return Object(a.jsx)("div",{className:"GradingResult",children:Object(a.jsxs)("div",{className:"grading-result-table",children:[Object(a.jsx)(K.t,{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Grade:"}),Object(a.jsx)("td",{children:Object(a.jsxs)(K.R,{children:[this.props.grade," / ",this.props.maxGrade]})})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"XP:"}),Object(a.jsx)("td",{children:Object(a.jsxs)(K.R,{children:[this.props.xp," / ",this.props.maxXp]})})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Comments:"}),Object(a.jsx)("td",{children:!this.props.comments&&Object(a.jsx)(K.R,{children:"None"})})]})]})}),this.props.comments&&Object(a.jsx)(K.t,{children:Object(a.jsx)("tbody",{children:Object(a.jsx)("tr",{children:Object(a.jsxs)("td",{children:[Object(a.jsx)(K.h,{}),Object(a.jsx)(Ut,{content:this.props.comments,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,openLinksInNewWindow:!0}),Object(a.jsx)(K.h,{})]})})})}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{className:"grading-result-info",children:Object(a.jsxs)(K.R,{children:["Graded by ",Object(a.jsx)("b",{children:this.props.graderName})," on ",da(this.props.gradedAt)]})})]})})}}var ua=la;var ha=e=>{var t,s,n;const[i,r]=m.useState(!1),[o,c]=m.useState(!1),[d,l]=m.useState(""),[u,h]=m.useState(Os.b.questionOverview),p=Object(ct.useMediaQuery)({maxWidth:768});m.useEffect((()=>{e.handleEditorValueChange("")}),[]),m.useEffect((()=>{if(e.handleAssessmentFetch(e.assessmentId),0===e.questionId&&e.notAttempted&&r(!0),!e.assessment)return;let t=e.questionId;e.questionId>=e.assessment.questions.length&&(t=e.assessment.questions.length-1);const s=e.assessment.questions[t];let a="";s.type===wt.e.programming&&(a=s.answer?s.answer:s.solutionTemplate),e.handleEditorValueChange(a)}),[]),m.useEffect((()=>{j()})),m.useEffect((()=>{p||u!==Os.b.mobileEditor&&u!==Os.b.mobileEditorRun||(h(Os.b.questionOverview),e.handleActiveTabChange(Os.b.questionOverview))}),[p,e,u]);const g=e=>{Ot(d,e)},b=()=>{e.handleEditorEval();const t={time:Date.now(),type:"keyboardCommand",data:St.a.run};g(t)},j=()=>{if(void 0===e.assessment)return;const t=e.assessmentId,s=e.questionId;if(e.storedAssessmentId===t&&e.storedQuestionId===s)return;const a=e.assessment.questions[s];let n=[],i="",r="",o="",c=[];if(a.type===wt.e.programming){const t=a;var u,h;if(n=t.autogradingResults,r=t.prepend,o=t.postpend,c=t.testcases,i=t.answer,i||(i=t.solutionTemplate),!d)l(vt(`${e.assessment.number}/${e.questionId}`,{chapter:a.library.chapter,externalLibrary:(null===a||void 0===a||null===(u=a.library)||void 0===u||null===(h=u.external)||void 0===h?void 0:h.name)||"NONE",editorValue:i}))}e.handleEditorUpdateBreakpoints([]),e.handleUpdateCurrentAssessmentId(t,s),e.handleResetWorkspace({autogradingResults:n,editorPrepend:r,editorValue:i,editorPostpend:o,editorTestcases:c}),e.handleClearContext(a.library,!0),e.handleUpdateHasUnsavedChanges(!1),i&&e.handleEditorValueChange(i)},v=(e,t)=>{const s=void 0!==e.assessment.questions[t].grader,n=[{label:`Task ${t+1}`,iconName:Y.a.NINJA,body:Object(a.jsx)(Ut,{className:"sidecontent-overview",content:e.assessment.questions[t].content}),id:Os.b.questionOverview,toSpawn:()=>!0},{label:`${e.assessment.category} Briefing`,iconName:Y.a.BRIEFCASE,body:Object(a.jsx)(Ut,{className:"sidecontent-overview",content:e.assessment.longSummary}),id:Os.b.briefing,toSpawn:()=>!0},{label:`${e.assessment.category} Autograder`,iconName:Y.a.AIRPLANE,body:Object(a.jsx)(Ks,{testcases:e.editorTestcases,autogradingResults:s||"Path"===e.assessment.category?e.autogradingResults:[],handleTestcaseEval:e.handleTestcaseEval}),id:Os.b.autograder,toSpawn:()=>!0}];s&&n.push({label:"Report Card",iconName:Y.a.TICK,body:Object(a.jsx)(ua,{graderName:e.assessment.questions[t].grader.name,gradedAt:e.assessment.questions[t].gradedAt,xp:e.assessment.questions[t].xp,grade:e.assessment.questions[t].grade,maxGrade:e.assessment.questions[t].maxGrade,maxXp:e.assessment.questions[t].maxXp,comments:e.assessment.questions[t].comments}),id:Os.b.grading,toSpawn:()=>!0});const i=e.assessment.questions[t].library.external;i.symbols.includes("get_matrix")&&n.push({label:"Tone Matrix",iconName:Y.a.GRID_VIEW,body:Object(a.jsx)(Qs,{}),id:Os.b.toneMatrix,toSpawn:()=>!0}),i.name!==Ct.a.PIXNFLIX&&i.name!==Ct.a.ALL||n.push({label:"Video Display",iconName:Y.a.MOBILE_VIDEO,body:Object(a.jsx)(Zs,{replChange:e.handleSendReplInputToOutput}),id:Os.b.videoDisplay,toSpawn:()=>!0});return{handleActiveTabChange:e.handleActiveTabChange,defaultSelectedTabId:s?Os.b.grading:u,selectedTabId:u,tabs:n,onChange:(e,t,s)=>{e!==t&&h(e)},workspaceLocation:"assessment"}},x=t=>{const s=`/academy/${ta(e.assessment.category)}`,n=s+`/${e.assessment.id.toString()}`,i=[t+1,e.assessment.questions.length],r=()=>{ea.a.push(n+`/${(t+1).toString()}`),p&&h(Os.b.questionOverview)},o=()=>ea.a.push(s),d=s=>()=>{const a=e.assessment.questions.filter((e=>null!==e.answer)).length-1;if(t<a)return s();const n=e.assessment.questions[t];if(n.type===wt.e.mcq){if(n.answer!==n.solution)return Object(f.e)("Your MCQ solution is incorrect!",750)}else if(n.type===wt.e.programming){if(!e.editorTestcases.reduce(((e,t)=>e&&Object(bt.stringify)(t.result)===t.answer),!0))return Object(f.e)("Your solution has not passed all testcases!",750)}return s()},l=Object(a.jsx)(Pt,{onClickNext:e.assessment.category===wt.a.Path?d(r):r,onClickReturn:e.assessment.category===wt.a.Path?d(o):o,questionProgress:i},"next_question"),u=Object(a.jsx)(Rt,{onClick:()=>{ea.a.push(n+`/${(t-1).toString()}`),p&&h(Os.b.questionOverview)},questionProgress:i},"previous_question"),g=Object(a.jsx)(Mt,{questionProgress:i},"question_view"),m=e.assessment.questions[t].type!==wt.e.mcq?Object(a.jsx)(Lt,{onClick:()=>{c(!0)}},"reset_template"):null,j=Object(a.jsx)(_t,{handleEditorEval:b},"run"),O=e.canSave&&e.assessment.questions[t].type!==wt.e.mcq?Object(a.jsx)(Dt,{hasUnsavedChanges:e.hasUnsavedChanges,onClickSave:()=>e.handleSave(e.assessment.questions[t].id,e.editorValue)},"save"):null,v=Object(a.jsx)(Et,{handleChapterSelect:()=>{},sourceChapter:e.assessment.questions[t].library.chapter,sourceVariant:y.b.defaultSourceVariant,disabled:!0},"chapter");return{editorButtons:p?[O,m]:[j,O,m,v],flowButtons:[u,g,l]}};if(void 0===e.assessment||0===e.assessment.questions.length)return Object(a.jsx)(K.D,{className:mt()("WorkspaceParent",it.a.DARK),description:"Getting mission ready...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_LARGE})});const S=Object(a.jsx)(K.g,{className:"assessment-briefing",isOpen:i,children:Object(a.jsxs)(K.e,{children:[Object(a.jsx)(Ut,{content:e.assessment.longSummary}),Object(a.jsx)(K.b,{className:"assessment-briefing-button",onClick:()=>r(!1),text:"Continue"})]})}),C=()=>c(!1),w=Object(a.jsxs)(K.g,{className:"assessment-reset",icon:Y.a.ERROR,isCloseButtonShown:!0,isOpen:o,onClose:C,title:"Confirmation: Reset editor?",children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsx)(Ut,{content:"Are you sure you want to reset the template?"}),Object(a.jsx)(Ut,{content:"*Note this will not affect the saved copy of your program, unless you save over it.*"})]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)(K.c,{children:[It("Cancel",null,C,{minimal:!1}),It("Confirm",null,(()=>{C(),e.handleEditorValueChange(e.assessment.questions[E].solutionTemplate),e.handleUpdateHasUnsavedChanges(!0)}),{minimal:!1,intent:fe.a.DANGER})]})})]}),E=e.questionId>=e.assessment.questions.length?e.assessment.questions.length-1:e.questionId,A=e.assessment.questions[E],I=A.type===wt.e.programming?{editorSessionId:"",editorValue:e.editorValue,handleDeclarationNavigate:e.handleDeclarationNavigate,handleEditorEval:e.handleEditorEval,handleEditorValueChange:e.handleEditorValueChange,handleUpdateHasUnsavedChanges:e.handleUpdateHasUnsavedChanges,breakpoints:e.breakpoints,highlightedLines:e.highlightedLines,newCursorPosition:e.newCursorPosition,handleEditorUpdateBreakpoints:e.handleEditorUpdateBreakpoints,handlePromptAutocomplete:e.handlePromptAutocomplete,isEditorAutorun:!1,onChange:(t,s)=>{e.handleUpdateHasUnsavedChanges&&e.handleUpdateHasUnsavedChanges(!0),e.handleEditorValueChange(t);const a={time:Date.now(),type:"codeDelta",data:s};g(a)},onCursorChange:e=>{const t={time:Date.now(),type:"cursorPositionChange",data:e.getCursor()};g(t)},onSelectionChange:e=>{const t=e.getRange(),s=e.isBackwards();if(!Object(O.isEqual)(t.start,t.end)){const e={time:Date.now(),type:"selectionRangeData",data:{range:t,isBackwards:s}};g(e)}}}:void 0,T={mcq:A,handleMCQSubmit:t=>e.handleSave(e.assessment.questions[E].id,t)},k={handleBrowseHistoryDown:e.handleBrowseHistoryDown,handleBrowseHistoryUp:e.handleBrowseHistoryUp,handleReplEval:e.handleReplEval,handleReplValueChange:e.handleReplValueChange,output:e.output,replValue:e.replValue,sourceChapter:(null===A||void 0===A||null===(t=A.library)||void 0===t?void 0:t.chapter)||4,sourceVariant:"default",externalLibrary:(null===A||void 0===A||null===(s=A.library)||void 0===s||null===(n=s.external)||void 0===n?void 0:n.name)||"NONE",replButtons:(()=>{const t=Object(a.jsx)(Tt,{handleReplOutputClear:e.handleReplOutputClear},"clear_repl");return[Object(a.jsx)(kt,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl"),t]})()},N={controlBarProps:x(E),editorProps:I,editorHeight:e.editorHeight,editorWidth:e.editorWidth,handleEditorHeightChange:e.handleEditorHeightChange,handleEditorWidthChange:e.handleEditorWidthChange,handleSideContentHeightChange:e.handleSideContentHeightChange,hasUnsavedChanges:e.hasUnsavedChanges,mcqProps:T,sideContentHeight:e.sideContentHeight,sideContentProps:v(e,E),replProps:k},P={editorProps:I,hasUnsavedChanges:e.hasUnsavedChanges,mcqProps:T,replProps:k,mobileSideContentProps:(t=>({mobileControlBarProps:{...x(t)},...v(e,t),onChange:(e,t,s)=>{e!==t&&(t===Os.b.autograder&&e===Os.b.mobileEditorRun||h(e))},selectedTabId:u,handleEditorEval:b}))(E)};return Object(a.jsxs)("div",{className:mt()("WorkspaceParent",it.a.DARK),children:[S,w,p?Object(a.jsx)(Us,{...P}):Object(a.jsx)(oa,{...N})]})};const pa="assessment";var ga=Object(d.c)(((e,t)=>({assessment:e.session.assessments.get(t.assessmentId),autogradingResults:e.workspaces.assessment.autogradingResults,editorPrepend:e.workspaces.assessment.editorPrepend,editorValue:e.workspaces.assessment.editorValue,editorPostpend:e.workspaces.assessment.editorPostpend,editorTestcases:e.workspaces.assessment.editorTestcases,editorHeight:e.workspaces.assessment.editorHeight,editorWidth:e.workspaces.assessment.editorWidth,breakpoints:e.workspaces.assessment.breakpoints,highlightedLines:e.workspaces.assessment.highlightedLines,hasUnsavedChanges:e.workspaces.assessment.hasUnsavedChanges,isRunning:e.workspaces.assessment.isRunning,isDebugging:e.workspaces.assessment.isDebugging,enableDebugging:e.workspaces.assessment.enableDebugging,newCursorPosition:e.workspaces.assessment.newCursorPosition,output:e.workspaces.assessment.output,replValue:e.workspaces.assessment.replValue,sideContentHeight:e.workspaces.assessment.sideContentHeight,storedAssessmentId:e.workspaces.assessment.currentAssessment,storedQuestionId:e.workspaces.assessment.currentQuestion})),(e=>Object(u.b)({handleActiveTabChange:e=>Object(pt.updateActiveTab)(e,pa),handleAssessmentFetch:st.fetchAssessment,handleBrowseHistoryDown:()=>Object(pt.browseReplHistoryDown)(pa),handleBrowseHistoryUp:()=>Object(pt.browseReplHistoryUp)(pa),handleClearContext:(e,t)=>Object(pt.beginClearContext)(pa,e,t),handleDeclarationNavigate:e=>Object(pt.navigateToDeclaration)(pa,e),handleEditorEval:()=>Object(pt.evalEditor)(pa),handleEditorValueChange:e=>Object(pt.updateEditorValue)(e,pa),handleEditorHeightChange:e=>Object(pt.changeEditorHeight)(e,pa),handleEditorWidthChange:e=>Object(pt.changeEditorWidth)(e.toString(),pa),handleEditorUpdateBreakpoints:e=>Object(pt.setEditorBreakpoint)(e,pa),handleInterruptEval:()=>Object(ht.beginInterruptExecution)(pa),handleReplEval:()=>Object(pt.evalRepl)(pa),handleReplOutputClear:()=>Object(pt.clearReplOutput)(pa),handleReplValueChange:e=>Object(pt.updateReplValue)(e,pa),handleSendReplInputToOutput:e=>Object(pt.sendReplInputToOutput)(e,pa),handleResetWorkspace:e=>Object(pt.resetWorkspace)(pa,e),handleSave:st.submitAnswer,handleSideContentHeightChange:e=>Object(pt.changeSideContentHeight)(e,pa),handleTestcaseEval:e=>Object(pt.evalTestcase)(pa,e),handleUpdateHasUnsavedChanges:e=>Object(pt.updateHasUnsavedChanges)(pa,e),handleUpdateCurrentAssessmentId:pt.updateCurrentAssessmentId,handleDebuggerPause:()=>Object(ht.beginDebuggerPause)(pa),handleDebuggerResume:()=>Object(ht.debuggerResume)(pa),handleDebuggerReset:()=>Object(ht.debuggerReset)(pa),handlePromptAutocomplete:(e,t,s)=>Object(pt.promptAutocomplete)(pa,e,t,s)},e)))(ha);class ma extends m.Component{componentDidMount(){this.props.loadContentDispatch()}render(){return Object(a.jsx)("div",{className:"ContentDisplay row center-xs",children:Object(a.jsx)("div",{className:(this.props.fullWidth?"col-md-12":"col-md-10 col-xs-11")+" contentdisplay-content-parent",children:Object(a.jsx)(K.e,{className:"contentdisplay-content",elevation:nt.a.THREE,children:this.props.display})})})}}var ba=ma;function ja(e){return t=>t.filter((t=>!t.submission_id&&t.assessment_id===e))}function ya(e){return t=>t.filter((t=>t.submission_id===e))}function Oa(e){return t=>t.filter((t=>"Grading"===e?void 0!==t.submission_id:!t.submission_id&&e===t.assessment_type))}var va=s(82);const xa=e=>{switch(e){case va.a.new:return"This assessment is new.";case va.a.deadline:return"This assessment is closing soon.";case va.a.autograded:return"This assessment has been autograded.";case va.a.submitted:return"This submission is new.";case va.a.unsubmitted:return"This assessment has been unsubmitted.";case va.a.graded:return"This assessment has been manually graded.";case va.a.new_message:return"There are new messages.";default:return"Unknown notification"}};var fa=e=>{const t=e.notificationFilter?e.notificationFilter(e.notifications):e.notifications;if(!t.length)return null;const s=Object(a.jsx)(K.Q,{intent:fe.a.DANGER,round:!0,large:e.large,children:t.length});if(!e.disableHover){const n=t=>Object(a.jsx)(K.Q,{className:"row badge-tag",minimal:!0,multiline:!0,onRemove:()=>{return e.handleAcknowledgeNotifications((s=t.id,e=>e.filter((e=>e.id===s))));var s},children:xa(t.type)},`${t.id}`),i=Object(a.jsx)("div",{className:"col",children:t.map(n)});return Object(a.jsx)(Ds.a,{className:e.className,content:i,interactionKind:K.G.HOVER,placement:rt.a.RIGHT,hoverOpenDelay:50,hoverCloseDelay:50,lazy:!0,children:s})}return s};var Sa=Object(d.c)((e=>({notifications:e.session.notifications})),(e=>Object(u.b)({handleAcknowledgeNotifications:st.acknowledgeNotifications},e)))(fa);const Ca=e=>{let t,s,n;switch(e){case wt.d.graded:t=Y.a.TICK,s=fe.a.SUCCESS,n="Fully graded";break;case wt.d.grading:t=Y.a.TIME,s=fe.a.WARNING,n="Grading in progress";break;case wt.d.none:t=Y.a.CROSS,s=fe.a.DANGER,n="Not graded yet";break;default:t=Y.a.DISABLE,s=fe.a.PRIMARY,n="Not applicable"}return Object(a.jsx)(ot.a,{className:"listing-title-tooltip",content:n,placement:rt.a.RIGHT,children:Object(a.jsx)(K.u,{icon:t,intent:s})})},wa=(e,t,s)=>It(e,t?Y.a.CARET_DOWN:Y.a.CARET_RIGHT,s,{minimal:!0,className:"collapse-button"});var Ea=e=>{const t=Object(ct.useMediaQuery)({maxWidth:768}),[s,n]=m.useState(null),[i,r]=m.useState(!1),[o,c]=m.useState(!0),[d,l]=m.useState(!0),u=()=>r(!i),h=()=>c(!o),p=()=>l(!d),g=()=>n(null),b=e=>Object(O.sortBy)(e,[e=>-e.id]),j=(e,t)=>Object(a.jsxs)(K.b,{disabled:e.status!==wt.b.attempted,icon:Y.a.CONFIRM,intent:e.status===wt.b.attempted?fe.a.DANGER:fe.a.NONE,minimal:!0,onClick:()=>n(e),children:[Object(a.jsx)("span",{className:"custom-hidden-xxxs",children:"Finalize"}),Object(a.jsx)("span",{className:"custom-hidden-xxs",children:" Submission"})]}),v=t=>{let s,n,i="";switch(t.status){case wt.b.not_attempted:s=Y.a.PLAY,n="Attempt";break;case wt.b.attempting:s=Y.a.PLAY,n="Continue",i=" Attempt";break;case wt.b.attempted:s=Y.a.EDIT,n="Review",i=" Attempt";break;case wt.b.submitted:s=Y.a.EYE_OPEN,n="Review",i=" Submission";break;default:s=Y.a.PLAY,n="Review"}return Object(a.jsx)(lt.b,{to:`/academy/${ta(t.category)}/${t.id.toString()}/${y.b.defaultQuestionId}`,children:Object(a.jsxs)(K.b,{icon:s,minimal:!0,onClick:()=>e.handleAcknowledgeNotifications(ja(t.id)),children:[Object(a.jsx)("span",{className:"custom-hidden-xxxs",children:n}),Object(a.jsx)("span",{className:"custom-hidden-xxs",children:i})]})})},x=(e,s,n,i)=>{const r="graded"===e.gradingStatus||"Path"===e.category,o=t?5:3;return Object(a.jsx)("div",{children:Object(a.jsxs)(K.e,{className:"row listing",elevation:nt.a.ONE,children:[Object(a.jsxs)("div",{className:`col-xs-${String(o)} listing-picture`,children:[Object(a.jsx)(Sa,{className:"badge",notificationFilter:ja(e.id),large:!0}),Object(a.jsx)("img",{alt:"Assessment",className:`cover-image-${e.status}`,src:e.coverImage?e.coverImage:ut})]}),Object(a.jsxs)("div",{className:`col-xs-${String(12-o)} listing-text`,children:[f(e,s,i),Object(a.jsx)("div",{className:"listing-grade",children:Object(a.jsx)(K.r,{children:r?`Grade: ${e.grade} / ${e.maxGrade}`:`Max Grade: ${e.maxGrade}`})}),Object(a.jsx)("div",{className:"listing-xp",children:Object(a.jsx)(K.r,{children:r?`XP: ${e.xp} / ${e.maxXp}`:`Max XP: ${e.maxXp}`})}),Object(a.jsx)("div",{className:"listing-description",children:Object(a.jsx)(Ut,{content:e.shortSummary})}),Object(a.jsxs)("div",{className:"listing-footer",children:[Object(a.jsxs)(K.R,{className:"listing-due-date",children:[Object(a.jsx)(K.u,{className:"listing-due-icon",iconSize:12,icon:Y.a.TIME}),ca(e.openAt)?`Due: ${da(e.closeAt)}`:`Opens at: ${da(e.openAt)}`]}),Object(a.jsx)("div",{className:"listing-button",children:n?v(e):null})]})]})]})},s)},f=(e,t,s)=>Object(a.jsxs)("div",{className:"listing-header",children:[Object(a.jsx)(K.R,{ellipsize:!0,children:Object(a.jsxs)(K.p,{className:"listing-title",children:[e.title,e.private?Object(a.jsx)(ot.a,{className:"listing-title-tooltip",content:"This assessment is password-protected.",children:Object(a.jsx)(K.u,{icon:"lock"})}):null,s?Ca(e.gradingStatus):null]})}),Object(a.jsx)("div",{className:"listing-button",children:j(e)})]}),{assessmentOverviews:S,isStudent:C}=e,w=sa(e.match.params.assessmentId),E=sa(e.match.params.questionId)||y.b.defaultQuestionId;if(null!==w&&void 0!==S){const t=S.filter((e=>e.id===w))[0],s={assessmentId:w,questionId:E,notAttempted:t.status===wt.b.not_attempted,canSave:!e.isStudent||t.status!==wt.b.submitted&&!ca(t.closeAt)};return Object(a.jsx)(ga,{...s})}let A;if(void 0===S)A=Object(a.jsx)(K.D,{description:"Fetching assessment...",icon:Object(a.jsx)(K.M,{})});else if(0===S.length)A=Object(a.jsx)(K.D,{title:"There are no assessments.",icon:Y.a.FLAME});else{const e=e=>!ca(e.closeAt)&&!ca(e.openAt),t=b(S.filter(e)).map(((e,t)=>x(e,t,!C,!1))),s=e=>!ca(e.closeAt)&&ca(e.openAt)&&e.status!==wt.b.submitted,n=b(S.filter((e=>s(e)))).map(((e,t)=>x(e,t,!0,!1))),r=b(S.filter((t=>!s(t)&&!e(t)))).map(((e,t)=>x(e,t,!0,!0))),c=Object(a.jsxs)(a.Fragment,{children:[wa("Upcoming",d,p),Object(a.jsx)(K.f,{isOpen:d,children:t})]}),l=Object(a.jsxs)(a.Fragment,{children:[wa("Open",o,h),Object(a.jsx)(K.f,{isOpen:o,children:n})]}),g=Object(a.jsxs)(a.Fragment,{children:[wa("Closed",i,u),Object(a.jsx)(K.f,{isOpen:i,children:r})]});A=Object(a.jsxs)(a.Fragment,{children:[t.length>0?c:null,n.length>0?l:null,r.length>0?g:null]})}const I=s?Object(a.jsxs)("p",{children:["You are about to finalise your submission for the ",s.category.toLowerCase()," ",Object(a.jsxs)("i",{children:['"',s.title,'"']}),"."]}):Object(a.jsx)("p",{children:"You are about to finalise your submission."}),T=Object(a.jsxs)(a.Fragment,{children:[I,Object(a.jsxs)("p",{children:["Finalising your submission early grants you additional XP, but"," ",Object(a.jsx)("span",{className:"warning",children:"this action is irreversible."})]})]}),k=Object(a.jsxs)(K.g,{className:"betcha-dialog",icon:Y.a.ERROR,isCloseButtonShown:!0,isOpen:null!==s,onClose:g,title:"Finalise submission?",children:[Object(a.jsx)("div",{className:it.a.DIALOG_BODY,children:Object(a.jsx)(K.R,{children:T})}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)(K.c,{children:[It("Cancel",null,g,{minimal:!1}),It("Finalise",null,(()=>{s&&(e.handleSubmitAssessment(s.id),g())}),{minimal:!1,intent:fe.a.DANGER})]})})]});return Object(a.jsxs)("div",{className:"Assessment",children:[Object(a.jsx)(ba,{display:A,loadContentDispatch:e.handleAssessmentOverviewFetch}),k]})};var Aa=Object(l.h)(Object(d.c)(((e,t)=>({assessmentOverviews:e.session.assessmentOverviews?e.session.assessmentOverviews.filter((e=>e.category===t.assessmentCategory)):void 0,isStudent:!e.session.role||e.session.role===j.a.Student})),(e=>Object(u.b)({handleAcknowledgeNotifications:st.acknowledgeNotifications,handleAssessmentOverviewFetch:st.fetchAssessmentOverviews,handleSubmitAssessment:st.submitAssessment},e)))(Ea)),Ia=s(113),Ta=s(236),ka=(s(217),s(262),s(131));class Na extends m.Component{constructor(e){super(e),this.columnDefs=void 0,this.defaultColumnDefs=void 0,this.gridApi=void 0,this.handleFetchGradingSummary=()=>{this.props.handleFetchGradingSummary()},this.onGridReady=e=>{this.gridApi=e.api},this.resizeGrid=()=>{this.gridApi&&this.gridApi.sizeColumnsToFit()},this.columnDefs=[{headerName:"Group",field:"groupName",width:80,sort:"asc"},{headerName:"Avenger",field:"leaderName"},{headerName:"Ungraded Missions",field:"ungradedMissions"},{headerName:"Submitted Missions",field:"submittedMissions"},{headerName:"Ungraded Quests",field:"ungradedSidequests"},{headerName:"Submitted Quests",field:"submittedSidequests"}],this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0}}componentDidUpdate(e){this.gridApi&&this.props.gradingSummary.length!==e.gradingSummary.length&&this.gridApi.setRowData(this.props.gradingSummary)}render(){const e=Object(a.jsx)("div",{className:"Dashboard",children:Object(a.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(a.jsx)(ka.AgGridReact,{domLayout:"autoHeight",columnDefs:this.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,onGridSizeChanged:this.resizeGrid,rowData:this.props.gradingSummary,rowHeight:30,suppressCellSelection:!0,suppressMovableColumns:!0})})});return Object(a.jsx)("div",{children:Object(a.jsx)(ba,{display:e,loadContentDispatch:this.handleFetchGradingSummary})})}}var Pa=Na;var Ra=Object(d.c)((e=>({gradingSummary:e.dashboard.gradingSummary})),(e=>Object(u.b)({handleFetchGradingSummary:Ta.fetchGroupGradingSummary},e)))(Pa),Ma=s(125);var La={zektonFont:{key:"zekton",pngPath:"../assets/zekton.png",fntPath:"../assets/zekton.fnt"},zektonDarkFont:{key:"zektonDark",pngPath:"../assets/zekton_dark.png",fntPath:"../assets/zekton.fnt"},alienCowsFont:{key:"alienAndCows",pngPath:"../assets/alien_and_cows.png",fntPath:"../assets/alien_and_cows.fnt"},alienLeagueFont:{key:"alienLeague",pngPath:"../assets/alien_league.png",fntPath:"../assets/alien_league.fnt"},pixelFont:{key:"pixel",pngPath:"../assets/pixel.png",fntPath:"../assets/pixel.fnt"}};const _a={assetsFolder:y.a.sourceAcademyAssets,fadeDuration:600,nullFunction:()=>{},nullInteractionId:"",nullSequenceNumber:-1,popUpDuration:1e3,defaultAssetPath:"/ui/wristDeviceButton.png",defaultFontStyle:{key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},defaultCursor:""},Da={x:1920,y:1080},Ga={x:Da.x/2,y:Da.y/2},Ba={navy:"#03092c",lightBlue:"#ece1fb",offWhite:"#bbc1c9",white:"#ffffff",darkGrey:"#333333",lightGrey:"#555555",blue:"#1133ff",darkBlue:"#0d2440",orange:"#ff9933",yellow:"#ffee33",red:"0#ff0000",maroon:"#142B2E",black:"#000000",purple:"#dd33dd",paleYellow:"#f6ffbd"},Ua=O.mapValues(Ba,(e=>parseInt(e.slice(1),16)));let Fa;function Ha({direction:e=Fa.Row,numOfItems:t,maxXSpace:s=Da.x,maxYSpace:a=Da.y,numItemLimit:n=0,redistributeLast:i=!0}){let r=n||t;const o=Math.ceil(t/r);return O.times(t,(n=>{const c=n%r,d=Math.floor(n/r);return i&&d===o-1&&(r=t%o||r),e===Fa.Row?[Va(Da.x,s,c,r),Va(Da.y,a,d,o)]:[Va(Da.x,s,d,o),Va(Da.y,a,c,r)]}))}function Va(e,t,s,a){const n=t/a;return(e-t+n)/2+n*s}function qa({numOfItems:e,xSpacing:t=30,ySpacing:s=30}){const a=new Array;for(let n=0;n<e;n++)a.push([n*t,n*s]);return a}!function(e){e.Row="Row",e.Column="Column"}(Fa||(Fa={}));const Xa={fontFamily:"Verdana",fontSize:"15px",fill:Ba.lightBlue,align:"left",wordWrap:{width:290}};class $a extends Phaser.GameObjects.Container{constructor(e,t,s,a,n=300){super(e,t,s),this.renderTextHover(a,n)}renderTextHover(e,t){const s=parseInt(Xa.fontSize.substring(0,Xa.fontSize.length-2)),a=e.length*s*.75,n=Math.min(a,t),i=new Phaser.GameObjects.Text(this.scene,30,10,e,{...Xa,wordWrap:{width:n-10}}),r=new Phaser.GameObjects.Rectangle(this.scene,20,0,n,i.getBounds().bottom+10,Ua.darkBlue).setOrigin(0,0).setAlpha(.8);this.add([r,i]),this.setVisible(!1)}}var Wa=$a;const za=(e,t,{x:s,y:a,oriX:n,oriY:i},r)=>new Phaser.GameObjects.BitmapText(e,s,a,r.key,t,r.size,r.align).setOrigin(n,i),Ka={key:La.alienLeagueFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},Ya={key:La.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},Qa={key:La.alienLeagueFont.key,size:50,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Ja={key:La.zektonFont.key,size:18,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},Za={fontFamily:"Verdana",fontSize:"18px",fill:Ba.lightBlue,align:"center",lineSpacing:10,wordWrap:{width:500}},en={id:"default-award",assetKey:_a.nullInteractionId,assetPath:_a.nullInteractionId,title:_a.nullInteractionId,description:"There is no asset associated with this award.",completed:!1},tn=.3*-Da.x,sn=.05*-Da.y,an=sn+275;var nn={arrow:{x:.08*Da.x,y:.34*Da.y,xOffset:80,xScale:.4,yScale:.3},backButton:{y:.3*Da.y},itemsPerPage:7,list:{yStart:.31*-Da.y,ySpace:100},listTextConfig:{x:.09*-Da.x,y:0,oriX:0,oriY:.55},noPreviewTextConfig:{x:tn,y:-40,oriX:.5,oriY:.5},page:{yStart:.3*-Da.y,ySpace:150},pageTextConfig:{x:.3*Da.x,y:0,oriX:.1,oriY:.5},preview:{descText:{yOffset:320},rect:{dim:430,x:tn,y:sn,xOffset:30,yOffset:15},key:{x:tn,y:an,width:430,height:35},keyTagTextConfig:{x:tn-205,y:an,oriX:0,oriY:.5},keyTextConfig:{x:tn-90,y:an,oriX:0,oriY:.5},explanation:{x:tn-150,y:sn+200},titleTextConfig:{x:tn+20,y:sn-275,oriX:.5,oriY:.5}}};const rn=e=>e.map((e=>on(e))),on=e=>{const t=$o.getInstance().getAwardsMapping().get(e);return t||{...en,title:e}};let cn,dn;!function(e){e.Image="Image",e.Sprite="Sprite"}(cn||(cn={})),function(e){e.Background="Background",e.Object="Object"}(dn||(dn={}));var ln={spaceshipBg:{type:cn.Image,key:"spaceship-bg",path:"/locations/spaceshipBackground.png"},saBanner:{type:cn.Image,key:"sa-banner",path:"/ui/sourceAcadBannerOneLine.png"},shortButton:{type:cn.Image,key:"short-button",path:"/ui/shortButton.png"},mediumButton:{type:cn.Image,key:"med-button",path:"/ui/mediumButton.png"},longButton:{type:cn.Image,key:"long-button",path:"/ui/longButton.png"},topButton:{type:cn.Image,key:"top-button",path:"/ui/topButton.png"},speechBox:{type:cn.Image,key:"speechBox",path:"/ui/speechbox.png"},speakerBox:{type:cn.Image,key:"speakerBox",path:"/ui/speakerBox.png"},defaultLocationImg:{type:cn.Image,key:"loc-default",path:"/ui/defaultLocation.jpg"},locationPreviewFrame:{type:cn.Image,key:"loc-preview-frame",path:"/ui/locationPreviewFrame.png"},locationPreviewFill:{type:cn.Image,key:"loc-preview-fill",path:"/ui/locationPreviewFill.png"},talkOptButton:{type:cn.Image,key:"talk-opt-button",path:"/ui/talkOptButton.png"},talkOptCheck:{type:cn.Image,key:"talk-opt-check",path:"/ui/talkOptCheck.png"},modeMenuBanner:{type:cn.Image,key:"mode-banner",path:"/ui/modeMenuBanner.png"},popUpFrame:{type:cn.Image,key:"pop-up-frame",path:"/ui/popUpFrame.png"},mediumBox:{type:cn.Image,key:"medium-box",path:"/ui/mediumBox.png"},diamond:{type:cn.Image,key:"diamond",path:"/ui/zircon.png"},arrow:{type:cn.Image,key:"arrow",path:"/ui/arrow.png"},cookies:{type:cn.Image,key:"cookies",path:"/images/cookies.png"},scrollFrame:{type:cn.Image,key:"scroll-frame",path:"/ui/scrollFrame.png"},messageBar:{type:cn.Image,key:"message-bar",path:"/ui/messageBg.png"},escapeMenuBackground:{type:cn.Image,key:"escape-bg",path:"/ui/escapeMenu.png"},awardsMenu:{type:cn.Image,key:"award-bg",path:"/ui/collectiblesBg.png"},awardsBanner:{type:cn.Image,key:"award-banner",path:"/ui/awardsBanner.png"},awardsPageChosen:{type:cn.Image,key:"award-pg-chosen",path:"/ui/collectiblesPageOptChosen.png"},awardsPage:{type:cn.Image,key:"award-pg-opt",path:"/ui/collectiblesPageOpt.png"},awardsBackground:{type:cn.Image,key:"award-hall-bg",path:"/ui/awardsHall.png"},chapterRepeatButton:{type:cn.Image,key:"chapter-repeat",path:"/ui/chapterRepeat.png"},chapterContinueButton:{type:cn.Image,key:"chapter-continue",path:"/ui/chapterContinue.png"},chapterSelectFrame:{type:cn.Image,key:"chapter-select-frame",path:"/ui/chapterSelectionFrame.png"},chapterSelectBorder:{type:cn.Image,key:"chapter-select-border",path:"/ui/chapterSelectionBorder.png"},chapterSelectArrow:{type:cn.Image,key:"chapter-select-arrow",path:"/ui/chapSelectArrow.png"},mainMenuOptBanner:{type:cn.Image,key:"menu-option",path:"/ui/menuOption.png"},settingBanner:{type:cn.Image,key:"settings-bg",path:"/ui/settingsBg.png"},settingOption:{type:cn.Image,key:"settings-opt",path:"/ui/settingsOption.png"},verifiedFrame:{type:cn.Image,key:"verified-frame",path:"/ui/verifiedFrame.png"},sourceCrashedPod:{type:cn.Image,key:"source-crashed-pod",path:"/locations/sourceCrashedPod.png"},squareKeyboardIcon:{type:cn.Image,key:"keyboard-key-square",path:"/ui/keyboardKeyIcon.png"},medKeyboardIcon:{type:cn.Image,key:"keyboard-key-medium",path:"/ui/TabIcon.png"}};const un={volume:0,ease:"Power2"};let hn;!function(e){e[e.SFX=0]="SFX",e[e.BGM=1]="BGM"}(hn||(hn={}));var pn={buttonHover:{key:"btn-hover",path:"/sfx/buttonHover.mp3",config:{volume:.1},soundType:hn.SFX},buttonClick:{key:"btn-click",path:"/sfx/buttonClick.mp3",config:{volume:.1},soundType:hn.SFX},radioButtonClick:{key:"radio-btn-click",path:"/sfx/radioButtonClick.mp3",config:{volume:.15},soundType:hn.SFX},dialogueAdvance:{key:"dialogue-advance",path:"/sfx/dialogueAdvance.mp3",config:{volume:.3},soundType:hn.SFX},popUpEnter:{key:"pop-up-enter",path:"/sfx/popUpEnter.mp3",config:{volume:.35},soundType:hn.SFX},popUpExit:{key:"pop-up-exit",path:"/sfx/popUpExit.mp3",config:{volume:.35},soundType:hn.SFX},menuEnter:{key:"menu-enter",path:"/sfx/menuEnter.mp3",config:{volume:.5},soundType:hn.SFX},menuExit:{key:"menu-exit",path:"/sfx/menuExit.mp3",config:{volume:.5},soundType:hn.SFX},modeEnter:{key:"mode-enter",path:"/sfx/modeEnter.mp3",config:{volume:.1},soundType:hn.SFX},notifEnter:{key:"notif-enter",path:"/sfx/notifEnter.mp3",config:{volume:.25},soundType:hn.SFX},notifExit:{key:"notif-exit",path:"/sfx/notifExit.mp3",config:{volume:.25},soundType:hn.SFX},radioStatic:{key:"radio-static",path:"/sfx/radioStatic.mp3",config:{volume:.1},soundType:hn.SFX},galacticHarmony:{key:"galactic-harmony",path:"/bgm/GalacticHarmony.mp3",config:{volume:.25,loop:!0},soundType:hn.BGM}};let gn;!function(e){e[e.Effects=0]="Effects",e[e.Background=1]="Background",e[e.Character=2]="Character",e[e.Speaker=3]="Speaker",e[e.PopUp=4]="PopUp",e[e.Dialogue=5]="Dialogue",e[e.SpeakerBox=6]="SpeakerBox",e[e.UI=7]="UI",e[e.Objects=8]="Objects",e[e.BBox=9]="BBox",e[e.Escape=10]="Escape",e[e.Selector=11]="Selector",e[e.Collectibles=12]="Collectibles"}(gn||(gn={}));const mn=[gn.Background,gn.Selector,gn.Collectibles,gn.Objects,gn.BBox,gn.Character,gn.Speaker,gn.PopUp,gn.Dialogue,gn.SpeakerBox,gn.UI,gn.Effects,gn.Escape];function bn(e){return new Promise((t=>setTimeout(t,e)))}function jn(e,t,s){return Math.min(Math.max(e,t),s)}function yn(e){return _a.assetsFolder+e}function On(e,t){if(void 0===e)throw new Error(t||"Object not found");return e}const vn=(e,t=_a.fadeDuration)=>({alpha:0,targets:e,duration:t,ease:"Power2"}),xn=(e,t=_a.fadeDuration)=>({alpha:1,targets:e,duration:t,ease:"Power2"});function fn(e,t,{fadeDuration:s}={}){t&&(e.add.tween(vn([t],s||_a.fadeDuration)),setTimeout((()=>t.destroy()),s||_a.fadeDuration))}function Sn(e){return new Phaser.GameObjects.Rectangle(e,Ga.x,Ga.y,Da.x,Da.y,0)}function Cn(e,t){let s=0;const a=setInterval((()=>{s%2!==0?(t.setAlpha(0),e.tweens.add(xn([t],250))):(t.setAlpha(1),e.tweens.add(vn([t],250))),s++}),500);return function(){s=0,clearInterval(a)}}const wn={y:0,duration:300,ease:"Power2"},En={y:-Da.y,duration:250,ease:"Power2"},An={x:0,duration:350,ease:"Power2"},In={x:-Da.x,duration:350,ease:"Power2"},Tn={x:0,duration:500,ease:"Power2"},kn={x:Da.x,duration:500,ease:"Power2"},Nn={x:20,y:100,oriX:0,oriY:.5},Pn={key:La.zektonFont.key,size:20,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT};const Rn={prompt:{x:30,y:60,xPad:30,yPad:10},rect:{x:10,y:760,width:Da.x-20},text:{xPad:100,yPad:70},speakerTextConfig:{x:320,y:745,oriX:.5,oriY:.5}},Mn={fontFamily:"Verdana",fontSize:"30px",fill:Ba.lightBlue,align:"left",lineSpacing:10,wordWrap:{width:Rn.rect.width-2*Rn.text.xPad-2*Rn.rect.x}},Ln={key:La.zektonFont.key,size:36,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var _n=Rn;var Dn=function(e,{x:t=0,y:s=0,textStyle:a={},typeWriterInterval:n=1}){const i=new Phaser.GameObjects.Text(e,t,s,"",a);let r,o="",c=0;const d=()=>{r&&clearInterval(r)};return{container:i,changeLine:e=>{e&&(o=e,i.text="",c=0,d(),r=setInterval((()=>{i.text+=o[c++],c===o.length&&clearInterval(r)}),n))},clearTyping:d}};var Gn=class{constructor(e){this.typewriter=void 0,this.dialogueBox=void 0,this.blinkingDiamond=void 0;const t=zn.getInstance().getGameManager();var s;this.dialogueBox=(s=t,new Phaser.GameObjects.Image(s,Ga.x,Ga.y,ln.speechBox.key).setAlpha(.9)).setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.typewriter=function(e,t){return Dn(e,{x:_n.rect.x+_n.text.xPad,y:_n.rect.y+_n.text.yPad,textStyle:t})}(t,e),this.blinkingDiamond=this.drawDiamond(t)}getDialogueContainer(){const e=zn.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0);return t.add([this.dialogueBox,this.blinkingDiamond.container,this.typewriter.container]),t}drawDiamond(e){const t=new Phaser.GameObjects.Image(e,Da.x-_n.prompt.x-_n.prompt.xPad,Da.y-_n.prompt.y-_n.prompt.yPad,ln.diamond.key).setDisplaySize(_n.prompt.x,_n.prompt.y);return{container:t,clearBlink:Cn(e,t)}}getDialogueBox(){return this.dialogueBox}destroy(){const e=zn.getInstance().getGameManager();this.typewriter.clearTyping(),this.blinkingDiamond.clearBlink(),this.getDialogueBox().off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),fn(e,this.getDialogueContainer())}changeText(e){this.typewriter.changeLine(e)}};const Bn={key:La.alienLeagueFont.key,size:100,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Un={x:Ga.x,y:_n.rect.y+2*Bn.size,oriX:.5,oriY:.9};function Fn(e,{assetKey:t,message:s="",textConfig:a={x:0,y:0,oriX:0,oriY:0},bitMapTextStyle:n=_a.defaultFontStyle,onDown:i=_a.nullFunction,onUp:r=_a.nullFunction,onHover:o=_a.nullFunction,onOut:c=_a.nullFunction,onPointerMove:d=_a.nullFunction,onHoverEffect:l=!0,onClickSound:u=pn.buttonClick.key,onHoverSound:h=pn.buttonHover.key}){const p=new Phaser.GameObjects.Container(e,0,0),g=new Phaser.GameObjects.Sprite(e,0,0,t);g.setInteractive({pixelPerfect:!0,useHandCursor:!0}),g.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{$o.getInstance().getSoundManager().playSound(u),r()})),g.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>{$o.getInstance().getSoundManager().playSound(h),l&&p.setAlpha(1),o()})),g.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>{l&&p.setAlpha(.9),c()})),g.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(()=>{i()})),g.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,((e,t,s)=>{d(e,t,s)}));const m=za(e,s,a,n);return p.add([g,m]),l&&p.setAlpha(.9),p}const Hn={textPad:20,textConfig:{x:15,y:-15,oriX:.5,oriY:.5},y:100,width:450,yInterval:100},Vn={fontFamily:"Verdana",fontSize:"20px",fill:Ba.offWhite,align:"right",lineSpacing:10,wordWrap:{width:Hn.width-2*Hn.textPad}},qn={key:La.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};async function Xn(e,t,s){const a=new Phaser.GameObjects.Container(e,0,0),n=new Phaser.GameObjects.Text(e,Da.x-Hn.textPad,Hn.y,t,Vn).setOrigin(1,0),i=new Phaser.GameObjects.Rectangle(e,Da.x,Hn.y-Hn.textPad,Hn.width,.5*n.getBounds().bottom+Hn.textPad,Ua.darkBlue,.8).setOrigin(1,0),r=new Phaser.GameObjects.Rectangle(e,Da.x,Hn.y-Hn.textPad,Hn.width,.5*i.getBounds().bottom+(s.length+.5)*Hn.yInterval,Ua.lightBlue,.2).setOrigin(1,0);a.add([r,i,n]);const o=qa({numOfItems:s.length,xSpacing:0,ySpacing:Hn.yInterval});zn.getInstance().addToLayer(gn.UI,a);const c=new Promise((t=>{a.add(s.map(((s,n)=>Fn(e,{assetKey:ln.mediumButton.key,message:s,textConfig:Hn.textConfig,bitMapTextStyle:qn,onUp:()=>{a.destroy(),t(n)}}).setPosition(Da.x-Hn.width/2,o[n][1]+i.getBounds().bottom+75))))}));a.setPosition(Da.x,0),$o.getInstance().getSoundManager().playSound(pn.notifEnter.key),e.add.tween({targets:a,alpha:1,...Tn}),await bn(Tn.duration);const d=await c;return $o.getInstance().getSoundManager().playSound(pn.notifExit.key),e.add.tween({targets:a,alpha:1,...kn}),await bn(kn.duration),fn(e,a,{fadeDuration:_a.fadeDuration}),d}let $n;!function(e){e.Move="Move",e.Explore="Explore",e.Talk="Talk",e.Menu="Menu",e.EscapeMenu="EscapeMenu",e.None="None",e.Sequence="Sequence",e.AwardMenu="AwardMenu"}($n||($n={}));class Wn{constructor(){this.gameManager=void 0,this.getGameManager=()=>On(this.gameManager),this.gameManager=void 0}static getInstance(){return Wn.instance||(Wn.instance=new Wn),Wn.instance}setGameManager(e){this.gameManager=e}getCurrLocId(){return this.getGameManager().currentLocationId}getLocationAtId(e){return this.getGameManager().getStateManager().getGameMap().getLocationAtId(e)}async changeLocationTo(e){await this.getGameManager().changeLocationTo(e)}getLocationModes(e){return this.getGameManager().getStateManager().getLocationModes(e)}addLocationMode(e,t){this.getGameManager().getStateManager().addLocationMode(e,t)}removeLocationMode(e,t){this.getGameManager().getStateManager().removeLocationMode(e,t)}hasTriggeredInteraction(e){return this.getGameManager().getStateManager().hasTriggeredInteraction(e)}triggerStateChangeAction(e){this.getGameManager().getStateManager().triggerStateChangeAction(e)}triggerInteraction(e){this.getGameManager().getStateManager().triggerInteraction(e)}watchGameItemType(e,t){this.getGameManager().getStateManager().watchGameItemType(e,t)}getGameMap(){return this.getGameManager().getStateManager().getGameMap()}getGameItemsInLocation(e,t){return this.getGameManager().getStateManager().getGameItemsInLocation(e,t)}addItem(e,t,s){this.getGameManager().getStateManager().addItem(e,t,s)}removeItem(e,t,s){return this.getGameManager().getStateManager().removeItem(e,t,s)}makeObjectGlow(e,t){this.getGameManager().getObjectManager().makeObjectGlow(e,t)}makeObjectBlink(e,t){this.getGameManager().getObjectManager().makeObjectBlink(e,t)}setObjProperty(e,t){this.getGameManager().getStateManager().setObjProperty(e,t)}renderObjectLayerContainer(e){this.getGameManager().getObjectManager().renderObjectsLayerContainer(e)}getAllActivatables(){return[...this.getGameManager().getObjectManager().getActivatables(),...this.getGameManager().getBBoxManager().getActivatables()]}setBBoxProperty(e,t){this.getGameManager().getStateManager().setBBoxProperty(e,t)}renderBBoxLayerContainer(e){this.getGameManager().getBBoxManager().renderBBoxLayerContainer(e)}isAllComplete(){return this.getGameManager().getStateManager().isAllComplete()}isObjectiveComplete(e){return this.getGameManager().getStateManager().isObjectiveComplete(e)}areObjectivesComplete(e){return this.getGameManager().getStateManager().areObjectivesComplete(e)}completeObjective(e){this.getGameManager().getStateManager().completeObjective(e)}addCollectible(e){$o.getInstance().getUserStateManager().addCollectible(e)}async isInUserState(e,t){return $o.getInstance().getUserStateManager().isInUserState(e,t)}clearSeveralLayers(e){this.getGameManager().getLayerManager().clearSeveralLayers(e)}addToLayer(e,t){this.getGameManager().getLayerManager().addToLayer(e,t)}showLayer(e){this.getGameManager().getLayerManager().showLayer(e)}hideLayer(e){this.getGameManager().getLayerManager().hideLayer(e)}async fadeInLayer(e,t){await this.getGameManager().getLayerManager().fadeInLayer(e,t)}async fadeOutLayer(e,t){await this.getGameManager().getLayerManager().fadeOutLayer(e,t)}async bringUpUpdateNotif(e){await async function(e,t){const s=new Gn({}),a=s.getDialogueContainer();e.getLayerManager().addToLayer(gn.Effects,a),e.getLayerManager().fadeInLayer(gn.Effects);const n=za(e,t,Un,Bn).setAlpha(0);a.add(n),$o.getInstance().getSoundManager().playSound(pn.notifEnter.key),e.add.tween(xn([n],2*_a.fadeDuration)),await bn(2*_a.fadeDuration);const i=new Promise((t=>{s.getDialogueBox().on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{$o.getInstance().getSoundManager().playSound(pn.notifExit.key),fn(e,n,{fadeDuration:_a.fadeDuration/4}),s.destroy(),t()}))}));await i}(this.getGameManager(),e)}async processGameActions(e){await this.getGameManager().getPhaseManager().pushPhase($n.Sequence),await this.getGameManager().getActionManager().processGameActions(e),await this.getGameManager().getPhaseManager().popPhase()}async processGameActionsInSamePhase(e){await this.getGameManager().getActionManager().processGameActions(e)}async showDialogue(e){await this.getGameManager().getPhaseManager().pushPhase($n.Sequence),await this.getGameManager().getDialogueManager().showDialogue(e),await this.getGameManager().getPhaseManager().popPhase()}async showDialogueInSamePhase(e){await this.getGameManager().getDialogueManager().showDialogue(e)}async obtainCollectible(e){!async function(e,t){const s=new Phaser.GameObjects.Container(e,0,0),a=new Phaser.GameObjects.Sprite(e,0,100,ln.messageBar.key);a.setScale(1.5,.8);const n=za(e,t,Nn,Pn);s.add([a,n]),e.getLayerManager().addToLayer(gn.Effects,s),s.setPosition(-Da.x,0),s.setAlpha(0),$o.getInstance().getSoundManager().playSound(pn.notifEnter.key),e.add.tween({targets:s,alpha:1,...An}),await bn(An.duration+3e3),$o.getInstance().getSoundManager().playSound(pn.notifExit.key),e.add.tween({targets:s,alpha:1,...In}),await bn(In.duration),fn(e,s,{fadeDuration:_a.fadeDuration})}(this.getGameManager(),`Obtained ${on(e).title}`),$o.getInstance().getUserStateManager().addCollectible(e)}displayPopUp(e,t,s,a){this.getGameManager().getPopupManager().displayPopUp(e,t,s,a)}destroyAllPopUps(){this.getGameManager().getPopupManager().destroyAllPopUps()}async destroyPopUp(e){this.getGameManager().getPopupManager().destroyPopUp(e)}async saveGame(){await this.getGameManager().getSaveManager().saveGame()}async saveSettings(e){await this.getGameManager().getSaveManager().saveSettings(e)}getLoadedUserState(){return this.getGameManager().getSaveManager().getLoadedUserState()}getSoundManager(){return $o.getInstance().getSoundManager()}playSound(e){$o.getInstance().getSoundManager().playSound(e)}playBgMusic(e){$o.getInstance().getSoundManager().playBgMusic(e)}async stopAllSound(){$o.getInstance().getSoundManager().stopAllSound()}pauseCurrBgMusic(){$o.getInstance().getSoundManager().pauseCurrBgMusic()}continueCurrBgMusic(){$o.getInstance().getSoundManager().continueCurrBgMusic()}applySoundSettings(e){$o.getInstance().getSoundManager().applyUserSettings(e)}loadSounds(e){$o.getInstance().getSoundManager().loadSounds(e)}startAnimation(e,t,s){const a=this.getAssetByKey(this.getGameMap().getAssetKeyFromId(e));this.getGameManager().getAnimationManager().displayAnimation(a,t,s)}stopAnimation(e){const t=this.getAssetByKey(this.getGameMap().getAssetKeyFromId(e));this.getGameManager().getAnimationManager().stopAnimation(t)}setDefaultCursor(e){this.getGameManager().getInputManager().setDefaultCursor(e)}enableKeyboardInput(e){this.getGameManager().getInputManager().enableKeyboardInput(e)}enableMouseInput(e){this.getGameManager().getInputManager().enableMouseInput(e)}enableSprite(e,t){t?this.getGameManager().input.enable(e):this.getGameManager().input.disable(e)}async popPhase(){await this.getGameManager().getPhaseManager().popPhase()}async pushPhase(e){await this.getGameManager().getPhaseManager().pushPhase(e)}async swapPhase(e){await this.getGameManager().getPhaseManager().swapPhase(e)}isCurrentPhase(e){return this.getGameManager().getPhaseManager().isCurrentPhase(e)}renderBackgroundLayerContainer(e){this.getGameManager().getBackgroundManager().renderBackgroundLayerContainer(e)}async promptNavigateToAssessment(e){0===await Xn(Wn.getInstance().getGameManager(),"Are you ready for the challenge?",["Yes","No"])&&(window.open(`/academy/missions/${e}/0`,"blank"),window.focus())}createCharacterSprite(e,t,s){return this.getGameManager().getCharacterManager().createCharacterSprite(e,t,s)}moveCharacter(e,t,s){this.getGameManager().getStateManager().moveCharacter(e,t,s)}updateCharacter(e,t){this.getGameManager().getStateManager().updateCharacter(e,t)}getDialogueById(e){return On(this.getGameMap().getDialogueMap().get(e))}getCharacterById(e){return On(this.getGameMap().getCharacterMap().get(e))}getActionById(e){return On(this.getGameMap().getActionMap().get(e))}getObjectById(e){return On(this.getGameMap().getObjectPropMap().get(e))}getBBoxById(e){return On(this.getGameMap().getBBoxPropMap().get(e))}getAssetByKey(e){return this.getGameMap().getAssetByKey(e)}}Wn.instance=void 0;var zn=Wn;let Kn,Yn,Qn,Jn,Zn;!function(e){e.UserState="UserState",e.ChecklistState="ChecklistState"}(Kn||(Kn={})),function(e){e.collectibles="collectibles",e.assessments="assessments",e.achievements="achievements"}(Yn||(Yn={}));!function(e){e.MoveCharacter="MoveCharacter",e.UpdateCharacter="UpdateCharacter",e.ObtainCollectible="ObtainCollectible",e.CompleteObjective="CompleteObjective",e.PreviewLocation="PreviewLocation",e.AddItem="AddItem",e.RemoveItem="RemoveItem",e.ShowDialogue="ShowDialogue",e.ChangeBackground="ChangeBackground",e.StartAnimation="StartAnimation",e.StopAnimation="StopAnimation",e.RemoveLocationMode="RemoveLocationMode",e.AddLocationMode="AddLocationMode",e.AddPopup="AddPopup",e.MakeObjectBlink="MakeObjectBlink",e.MakeObjectGlow="MakeObjectGlow",e.PlayBGM="PlayBGM",e.PlaySFX="PlaySFX",e.ShowObjectLayer="ShowObjectLayer",e.NavigateToAssessment="NavigateToAssessment",e.Delay="Delay"}(Qn||(Qn={}));class ei{static async executeGameAction(e,t){const s=zn.getInstance();switch(e){case Qn.AddItem:return void s.addItem(t.gameItemType,t.locationId,t.id);case Qn.RemoveItem:return void s.removeItem(t.gameItemType,t.locationId,t.id);case Qn.AddLocationMode:return void s.addLocationMode(t.locationId,t.mode);case Qn.RemoveLocationMode:return void s.removeLocationMode(t.locationId,t.mode);case Qn.MoveCharacter:return void s.moveCharacter(t.id,t.locationId,t.position);case Qn.UpdateCharacter:return void s.updateCharacter(t.id,t.expression);case Qn.ChangeBackground:return void s.renderBackgroundLayerContainer(t.id);case Qn.StartAnimation:return void s.startAnimation(t.id,t.startFrame,t.frameRate);case Qn.StopAnimation:return void s.stopAnimation(t.id);case Qn.PreviewLocation:return s.renderBackgroundLayerContainer(t.id),s.renderObjectLayerContainer(t.id),void s.renderBBoxLayerContainer(t.id);case Qn.ObtainCollectible:return void s.obtainCollectible(t.id);case Qn.CompleteObjective:return void s.completeObjective(t.id);case Qn.ShowDialogue:return void(s.isCurrentPhase($n.Sequence)?await s.showDialogueInSamePhase(t.id):await s.showDialogue(t.id));case Qn.AddPopup:return void await s.displayPopUp(t.id,t.position,t.duration,t.size);case Qn.MakeObjectBlink:return void await s.makeObjectBlink(t.id,t.turnOn);case Qn.MakeObjectGlow:return void await s.makeObjectGlow(t.id,t.turnOn);case Qn.PlayBGM:return void $o.getInstance().getSoundManager().playBgMusic(t.id);case Qn.PlaySFX:return void await $o.getInstance().getSoundManager().playSound(t.id);case Qn.ShowObjectLayer:return void(t.show?s.showLayer(gn.Objects):s.hideLayer(gn.Objects));case Qn.NavigateToAssessment:return void await s.promptNavigateToAssessment(t.assessmentId);case Qn.Delay:return void await bn(t.duration);default:return}}static isStateChangeAction(e){switch(e){case Qn.AddItem:case Qn.RemoveItem:case Qn.AddLocationMode:case Qn.RemoveLocationMode:case Qn.MoveCharacter:case Qn.UpdateCharacter:return!0;case Qn.NavigateToAssessment:case Qn.PreviewLocation:case Qn.ChangeBackground:case Qn.StartAnimation:case Qn.StopAnimation:case Qn.ObtainCollectible:case Qn.CompleteObjective:case Qn.ShowDialogue:case Qn.AddPopup:case Qn.MakeObjectBlink:case Qn.MakeObjectGlow:case Qn.PlayBGM:case Qn.PlaySFX:case Qn.ShowObjectLayer:case Qn.Delay:return!1}}}class ti{async fastForwardGameActions(e){if(e)for(const t of e){const{actionType:e,actionParams:s}=zn.getInstance().getActionById(t);await ei.executeGameAction(e,s)}}async processGameActions(e){if(e){for(const t of e)await this.processGameAction(t);await zn.getInstance().saveGame()}}async processGameAction(e){const{actionType:t,actionParams:s,actionConditions:a,isRepeatable:n,interactionId:i}=zn.getInstance().getActionById(e);await this.checkCanPlayAction(n,i,a)&&(await ei.executeGameAction(t,s),ei.isStateChangeAction(t)&&zn.getInstance().triggerStateChangeAction(e),zn.getInstance().triggerInteraction(e))}async checkCanPlayAction(e,t,s){return(e||!zn.getInstance().hasTriggeredInteraction(t))&&await class{static async checkAllConditionsSatisfied(e){return(await Promise.all(e.map((async e=>await this.checkConditionSatisfied(e))))).every((e=>!0===e))}static async checkConditionSatisfied(e){const{state:t,conditionParams:s,boolean:a}=e;switch(t){case Kn.UserState:return await zn.getInstance().isInUserState(s.userStateType,s.id)===a;case Kn.ChecklistState:return zn.getInstance().isObjectiveComplete(s.id)===a;default:return!0}}}.checkAllConditionsSatisfied(s)}}!function(e){e.navigation="navigation",e.talkTopics="talkTopics",e.dialogues="dialogues",e.objects="objects",e.boundingBoxes="boundingBoxes",e.characters="characters",e.actions="actions",e.bgmKey="bgmKey",e.collectibles="collectibles"}(Jn||(Jn={}));class si{constructor(){this.game=zn.getInstance().getGameManager(),this.animationInstanceMap=new Map,this.isSprite=e=>e.type===cn.Sprite}createImage(e,t){var s,a,n,i;switch(e.type){case cn.Sprite:return this.createAnimation(e,(null===(s=e.config)||void 0===s?void 0:s.start)||0,(null===(a=e.config)||void 0===a?void 0:a.frameRate)||20),this.getAnimation(e);case cn.Image:return new Phaser.GameObjects.Image(this.game,(null===e||void 0===e||null===(n=e.config)||void 0===n?void 0:n.centreX)||0,(null===e||void 0===e||null===(i=e.config)||void 0===i?void 0:i.centreY)||0,t)}}displayAnimation(e,t,s){var a;const n=zn.getInstance().getAssetByKey(e.path);switch(n&&n.config&&(n.config.start=t,n.config.frameRate=s),null===(a=n.config)||void 0===a?void 0:a.animType){case dn.Object:const t=zn.getInstance().getCurrLocId();zn.getInstance().addItem(Jn.objects,t,e.key);break;case dn.Background:zn.getInstance().renderBackgroundLayerContainer(e.path)}}createAnimation(e,t,s){if(this.isSprite(e)){var a,n,i;this.removeAnimation(e);const r=new Phaser.GameObjects.Sprite(this.game,(null===(a=e.config)||void 0===a?void 0:a.centreX)||0,(null===(n=e.config)||void 0===n?void 0:n.centreY)||0,e.path),o={key:e.path,frames:this.game.anims.generateFrameNumbers(e.path,{start:t,end:(null===(i=e.config)||void 0===i?void 0:i.endFrame)||0,first:0}),frameRate:s,repeat:-1};this.game.anims.create(o),this.animationInstanceMap.set(e.key,r)}}startAnimation(e){this.isSprite(e)&&this.getAnimation(e).play(e.path)}stopAnimation(e){const t=this.animationInstanceMap.get(e.key);this.isSprite(e)&&t&&t.anims&&t.anims.stop()}removeAnimation(e){const t=this.animationInstanceMap.get(e.key);t&&(this.game.anims.remove(e.path),t.destroy(),this.animationInstanceMap.delete(e.key))}getAnimation(e){return On(this.animationInstanceMap.get(e.key),`Image: ${e.path} not found`)}}function ai(e,t,s){const a=e.displayHeight/e.displayWidth;t?(e.displayWidth=t,e.displayHeight=s||t*a):(e.displayWidth=s/a,e.displayHeight=s)}function ni(e,t,s){e.displayWidth>e.displayHeight?ai(e,0,s):ai(e,t)}function ii(e,t,s){e.displayWidth>e.displayHeight?ai(e,t):ai(e,0,s)}!function(e){e.Collectibles="Collectibles",e.Achievements="Achievements"}(Zn||(Zn={}));var ri=class{constructor(e){this.scene=void 0,this.uiContainer=void 0,this.previewContainer=void 0,this.itemsContainer=void 0,this.pageChosenContainer=void 0,this.currActivePage=void 0,this.activePageNumber=void 0,this.getSoundManager=()=>$o.getInstance().getSoundManager(),this.getUserStateManager=()=>$o.getInstance().getUserStateManager(),this.scene=e,this.activePageNumber=new Map,this.currActivePage=Zn.Collectibles,this.scene.getPhaseManager().addPhaseToMap($n.AwardMenu,this),Object.keys(Zn).forEach(((e,t)=>{const s=e;this.activePageNumber.set(s,0)}))}setPage(e){if(this.uiContainer){this.itemsContainer&&this.itemsContainer.destroy(),this.pageChosenContainer&&this.pageChosenContainer.destroy(),this.currActivePage=e,this.itemsContainer=this.createItemsContainer(),this.uiContainer.add(this.itemsContainer);const t=this.getPageOptPositions(),s=Object.keys(Zn).findIndex((t=>t===e)),a=new Phaser.GameObjects.Sprite(this.scene,t[s][0],t[s][1]+nn.page.yStart,ln.awardsPageChosen.key);this.pageChosenContainer=new Phaser.GameObjects.Container(this.scene,0,0,[a]),this.uiContainer.add(this.pageChosenContainer),this.setPreview()}}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=new Phaser.GameObjects.Rectangle(this.scene,0,0,Da.x,4*Da.y,0).setAlpha(.7).setInteractive(),s=new Phaser.GameObjects.Image(this.scene,0,0,ln.awardsMenu.key);e.add([t,s]);const a=Object.keys(Zn).map(((e,t)=>({text:e,callback:()=>this.setPage(e)}))),n=this.getPageOptPositions();e.add(a.map(((e,t)=>this.createPageOpt(e.text,n[t][0],n[t][1]+nn.page.yStart,e.callback))));const i=this.createPageOpt("Back",0,nn.backButton.y,(async()=>{this.scene.getPhaseManager().isCurrentPhase($n.AwardMenu)&&await this.scene.getPhaseManager().popPhase()}));e.add(i);const r=Fn(this.scene,{assetKey:ln.arrow.key,onUp:()=>this.nextPage(!1)}).setScale(nn.arrow.yScale,nn.arrow.yScale).setRotation(-90*Math.PI/180).setPosition(nn.arrow.x-nn.arrow.xOffset,nn.arrow.y),o=Fn(this.scene,{assetKey:ln.arrow.key,onUp:()=>this.nextPage(!0)}).setScale(nn.arrow.xScale,nn.arrow.yScale).setRotation(90*Math.PI/180).setPosition(nn.arrow.x+nn.arrow.xOffset,nn.arrow.y);e.add([r,o]);const c=new Phaser.GameObjects.Sprite(this.scene,nn.preview.rect.x,nn.preview.rect.y,ln.popUpFrame.key).setScale(1.2);return e.add(c),e.add(function(e){const t=new Phaser.GameObjects.Container(e,nn.preview.rect.xOffset,nn.preview.rect.yOffset),s=nn.preview.key,a=new Phaser.GameObjects.Rectangle(e,s.x,s.y,s.width,s.height,Ua.lightBlue,.1),n=new Phaser.GameObjects.Rectangle(e,s.x-s.width*a.originX*.75,s.y,s.width/4,s.height,Ua.lightBlue,.2),i=za(e,"asset key",nn.preview.keyTagTextConfig,Ja),r=new Wa(e,nn.preview.explanation.x,nn.preview.explanation.y,"Asset key can be used to include the asset into your room by using 'create_award' function.");return n.setInteractive(),n.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>r.setVisible(!0))),n.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>r.setVisible(!1))),t.add([a,n,i,r]),t}(this.scene)),e}getPageOptPositions(){return qa({numOfItems:Object.keys(Zn).length,xSpacing:0,ySpacing:nn.page.ySpace})}setPreview(e){if(this.uiContainer){if(this.previewContainer&&this.previewContainer.destroy(),!e)return;let t;if(this.previewContainer=new Phaser.GameObjects.Container(this.scene,nn.preview.rect.xOffset,nn.preview.rect.yOffset),e.assetKey===_a.nullInteractionId)t=za(this.scene,"No preview available",nn.noPreviewTextConfig,Ja);else{const s=nn.preview.rect;t=new Phaser.GameObjects.Sprite(this.scene,0,0,e.assetKey),ii(t,s.dim,s.dim),t.setPosition(s.x,s.y)}const s=za(this.scene,e.title,nn.preview.titleTextConfig,Qa),a=new Phaser.GameObjects.Text(this.scene,nn.preview.rect.x,nn.preview.rect.y+nn.preview.descText.yOffset,e.description,Za).setOrigin(.5,0),n=!1===e.completed?"":e.assetKey,i=za(this.scene,n,nn.preview.keyTextConfig,Ja),r=new Phaser.GameObjects.Rectangle(this.scene,nn.preview.rect.x,nn.preview.rect.y,nn.preview.rect.dim,nn.preview.rect.dim,0).setAlpha(e.completed?0:.8);this.previewContainer.add([t,r,s,a,i]),this.uiContainer.add(this.previewContainer)}}nextPage(e){const t=this.activePageNumber.get(this.currActivePage),s=jn(e?t+1:t-1,0,Number.MAX_SAFE_INTEGER);this.getItems(s).length>0&&(this.activePageNumber.set(this.currActivePage,s),this.setPage(this.currActivePage))}createPageOpt(e,t,s,a){return Fn(this.scene,{assetKey:ln.awardsPage.key,message:e,textConfig:nn.pageTextConfig,bitMapTextStyle:Ka,onUp:a}).setPosition(t,s)}createItemsContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=this.getItems(this.activePageNumber.get(this.currActivePage)),s=qa({numOfItems:t.length,xSpacing:0,ySpacing:nn.list.ySpace});return e.add(t.map(((e,t)=>this.createItemButton(e.title,s[t][0],s[t][1]+nn.list.yStart,(()=>this.setPreview(e)),!1!==e.completed)))),e}createItemButton(e,t,s,a,n){const i=Fn(this.scene,{assetKey:ln.awardsBanner.key,message:e,textConfig:nn.listTextConfig,bitMapTextStyle:Ya,onUp:a,onHoverEffect:n}).setPosition(t,s);return n||i.setAlpha(.5),i}getItems(e){let t;switch(this.currActivePage){case Zn.Achievements:t=this.getUserStateManager().getAchievements();break;case Zn.Collectibles:t=this.getUserStateManager().getCollectibles();break;default:t=[]}const s=rn(t),a=e*nn.itemsPerPage;return s.slice(a,a+nn.itemsPerPage)}async activateUI(){this.uiContainer=this.createUIContainer(),this.scene.getLayerManager().addToLayer(gn.UI,this.uiContainer),this.getSoundManager().playSound(pn.menuEnter.key),this.setPage(this.currActivePage),this.uiContainer.setPosition(Ga.x,-Da.y),this.scene.tweens.add({targets:this.uiContainer,...wn,y:Ga.y})}async deactivateUI(){this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,this.uiContainer.y),this.getSoundManager().playSound(pn.menuExit.key),this.scene.tweens.add({targets:this.uiContainer,...En}),await bn(En.duration),fn(this.scene,this.uiContainer,{fadeDuration:50}))}};class oi{constructor(){this.currentBackground=void 0}renderBackgroundLayerContainer(e){const t=zn.getInstance().getLocationAtId(e).assetKey;this.renderBackgroundImage(t)}renderBackgroundImage(e){zn.getInstance().clearSeveralLayers([gn.Background]),this.currentBackground=zn.getInstance().getAssetByKey(e);const t=zn.getInstance().getGameManager().getAnimationManager();let s;this.currentBackground&&(s=t.createImage(this.currentBackground,e),t.startAnimation(this.currentBackground),ni(s,Da.x,Da.y),zn.getInstance().addToLayer(gn.Background,s),zn.getInstance().fadeInLayer(gn.Background))}}var ci=class{constructor(){this.bboxes=void 0,this.bboxes=new Map,zn.getInstance().watchGameItemType(Jn.boundingBoxes,this)}renderBBoxLayerContainer(e){zn.getInstance().clearSeveralLayers([gn.BBox]);const t=zn.getInstance().getGameItemsInLocation(Jn.boundingBoxes,e);this.bboxes.clear(),t.map((e=>this.handleAdd(e)))}createBBox(e){const t=zn.getInstance().getGameManager(),{x:s,y:a,width:n,height:i,actionIds:r,interactionId:o}=e,c=new Phaser.GameObjects.Rectangle(t,s,a,n,i,0,0);return e.isInteractive&&c.setInteractive(),{sprite:c,clickArea:c,actionIds:r,interactionId:o}}handleAdd(e){const t=zn.getInstance().getBBoxById(e),s=this.createBBox(t);return zn.getInstance().addToLayer(gn.BBox,s.sprite),this.bboxes.set(e,s),!0}handleMutate(e){return this.handleDelete(e)&&this.handleAdd(e)}handleDelete(e){const t=this.bboxes.get(e);return!!t&&(this.bboxes.delete(e),t.sprite.destroy(),!0)}getActivatables(){return Array.from(this.bboxes.values())}};var di={charWidth:600,charRect:{x:{Left:350,Middle:Ga.x,Right:Da.x-350}}};class li{constructor(){this.characterSpriteMap=void 0,this.characterSpriteMap=new Map,zn.getInstance().watchGameItemType(Jn.characters,this)}renderCharacterLayerContainer(e){const t=zn.getInstance().getGameItemsInLocation(Jn.characters,e);this.characterSpriteMap.clear(),t.map((e=>this.handleAdd(e)))}createCharacterSprite(e,t,s){const a=zn.getInstance().getCharacterById(e),{defaultPosition:n,defaultExpression:i,expressions:r,scale:o}=a,c=di.charRect.x[s||n],d=r.get(t||i),l=new Phaser.GameObjects.Image(zn.getInstance().getGameManager(),c,Da.y,d).setOrigin(.5,1);return ai(l,di.charWidth*o),l}handleAdd(e){const t=this.createCharacterSprite(e);return zn.getInstance().addToLayer(gn.Character,t),this.characterSpriteMap.set(e,t),!0}handleMutate(e){return this.handleDelete(e)&&this.handleAdd(e)}handleDelete(e){const t=this.characterSpriteMap.get(e);return!!t&&(this.characterSpriteMap.delete(e),t.destroy(),!0)}}class ui{constructor(e){this.currPart=void 0,this.currLineNum=void 0,this.dialogueContent=void 0,this.dialogueContent=e,this.currPart=e.keys().next().value,this.currLineNum=0}generateNextLine(){const e=this.dialogueContent.get(this.currPart)[this.currLineNum];if(!e||!e.line)return{line:""};if(e.goto){if(!this.dialogueContent.get(e.goto))return{line:""};this.currPart=e.goto,this.currLineNum=0}else this.currLineNum++;return e}updateCurrPart(e){this.currPart=e,this.currLineNum=0}}let hi,pi;!function(e){e.Left="Left",e.Middle="Middle",e.Right="Right"}(hi||(hi={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(pi||(pi={}));class gi{static splitToParagraph(e){const t=[];return e.forEach((e=>{if(e.startsWith("\t")||e.startsWith("    ")){const s=e.startsWith("\t")?e.slice(1):e.slice(4);if(0===t.length)return void console.error("Unexpected tabs");t[t.length-1][1].push(s)}else t.push([e.trim(),[]])})),t}static mapByHeader(e,t){const s=new Map;if(!t(e[0]))return s.set("0",e),s;let a="";return e.forEach((e=>{if(t(e))return a=e,void s.set(e,[]);s.get(a).push(e)})),s}static splitWithLimit(e,t,s){let a=[];if(s){let n="";for(let i=0;i<e.length;i++){const r=e[i];r===t&&a.length<s?(a.push(n),n=""):n+=r}a.push(n)}else a=e.split(t);return a.map((e=>e.trim()))}static splitByChar(e,t){return e.split(t).map((e=>e.trim()))}static splitToLines(e){return e.split("\n").map((e=>e.trimRight())).filter((e=>""!==e))}static splitToLinesAndRemoveComments(e){return this.removeMultiLineComments(e.split("\n"),"/*","*/").map((e=>this.removeSingleLineComment(e,"//"))).map((e=>e.trimRight())).filter((e=>""!==e))}static removeSingleLineComment(e,t,s=!0){const a=e.indexOf(t);return-1===a?e:s?e.slice(0,a):e.slice(a+t.length)}static removeMultiLineComments(e,t,s){const a=[];let n=!1;for(let i=0;i<e.length;i++){const r=e[i],o=[],c=this.findAllInstances(r,t),d=this.findAllInstances(r,s);let l=-1,u=0,h=0,p=n?[0]:[];for(;u<c.length||h<d.length;){const e=l;l=n?d[h++]+s.length:c[u++],l<=e?(console.error(`Comment mismatch: Line ${i+1},  Pos ${l+1}`),l=e):(p.push(l),n=!n),2===p.length&&(o.push([p[0],p[1]]),p=[])}1===p.length&&o.push([p[0],r.length]),a.push(this.removeCommentRegions(r,o))}return a}static removeCommentRegions(e,t){let s="",a=0;return t.forEach((t=>{s+=e.slice(a,t[0]),a=t[1]})),s+=e.slice(a,e.length),s}static findAllInstances(e,t){const s=[];let a=e.indexOf(t);for(;-1!==a;)s.push(a),a=e.indexOf(t,a+1);return s}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static toCapitalizedWords(e){return(e.match(/[A-Za-z][a-z]*/g)||[]).map(gi.capitalize).join(" ")}static toIntString(e){return Math.floor(e).toString()}static isEmptyString(e){return e===_a.nullInteractionId}}class mi{constructor(){this.currentSpeakerId=void 0,this.getUsername=()=>$o.getInstance().getAccountInfo().name}changeSpeakerTo(e){void 0!==e&&(this.currentSpeakerId&&zn.getInstance().clearSeveralLayers([gn.Speaker,gn.SpeakerBox]),this.showNewSpeaker(e))}showNewSpeaker(e){e&&(this.drawSpeakerSprite(e),this.drawSpeakerBox(e.speakerId))}drawSpeakerBox(e){if("narrator"===e)return;const t="you"===e?this.createSpeakerBox(this.getUsername(),hi.Right):this.createSpeakerBox(zn.getInstance().getCharacterById(e).name,hi.Left);zn.getInstance().addToLayer(gn.SpeakerBox,t)}drawSpeakerSprite({speakerId:e,speakerPosition:t,expression:s}){if(this.currentSpeakerId=e,"you"===e||"narrator"===e)return;const a=zn.getInstance().createCharacterSprite(e,s,t);zn.getInstance().addToLayer(gn.Speaker,a)}createSpeakerBox(e,t){const s=zn.getInstance().getGameManager(),a=new Phaser.GameObjects.Container(s,0,0),n=new Phaser.GameObjects.Image(s,Ga.x,Ga.y,ln.speakerBox.key).setAlpha(.8),i=za(s,"",_n.speakerTextConfig,Ln);return t===hi.Right&&(n.displayWidth*=-1,i.x=Da.x-i.x),a.add([n,i]),i.text=gi.capitalize(e),a}}class bi{constructor(){this.speakerRenderer=void 0,this.dialogueRenderer=void 0,this.dialogueGenerator=void 0,this.getDialogueGenerator=()=>this.dialogueGenerator,this.getDialogueRenderer=()=>this.dialogueRenderer,this.getSpeakerRenderer=()=>this.speakerRenderer,this.getUsername=()=>$o.getInstance().getAccountInfo().name}async showDialogue(e){const t=zn.getInstance().getDialogueById(e);this.dialogueRenderer=new Gn(Mn),this.dialogueGenerator=new ui(t.content),this.speakerRenderer=new mi,zn.getInstance().addToLayer(gn.Dialogue,this.dialogueRenderer.getDialogueContainer()),zn.getInstance().fadeInLayer(gn.Dialogue),await new Promise((e=>this.playWholeDialogue(e))),this.getDialogueRenderer().destroy(),this.getSpeakerRenderer().changeSpeakerTo(null)}async playWholeDialogue(e){await this.showNextLine(e),this.getDialogueRenderer().getDialogueBox().on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(async()=>await this.showNextLine(e)))}async showNextLine(e){zn.getInstance().playSound(pn.dialogueAdvance.key);const{line:t,speakerDetail:s,actionIds:a,prompt:n}=this.getDialogueGenerator().generateNextLine(),i=t.replace("{name}",this.getUsername());if(this.getDialogueRenderer().changeText(i),this.getSpeakerRenderer().changeSpeakerTo(s),zn.getInstance().enableSprite(this.getDialogueRenderer().getDialogueBox(),!1),n){const e=await Xn(zn.getInstance().getGameManager(),n.promptTitle,n.choices.map((e=>e[0])));this.getDialogueGenerator().updateCurrPart(n.choices[e][1])}await zn.getInstance().processGameActionsInSamePhase(a),zn.getInstance().enableSprite(this.getDialogueRenderer().getDialogueBox(),!0),t||e()}}const ji=Ga.x-160,yi=Ga.y,Oi=ji+10,vi=yi+10;function xi(e){let t,s,a;e.load.on("start",(()=>{a=e.add.existing(Sn(e)),t=e.add.graphics(),s=e.add.graphics(),s.fillStyle(2236962,.8),s.fillRect(ji,yi,320,50)})),e.load.on("progress",(e=>{t.clear(),t.fillStyle(16777215,1),t.fillRect(Oi,vi,300*e,30)})),e.load.on("complete",(function(){t.destroy(),s.destroy(),a.destroy()}))}class fi extends Phaser.GameObjects.Container{constructor(e,{choices:t,defaultChoiceIdx:s=0,maxXSpace:a=Da.x,radioChoiceConfig:n={circleDim:20,checkedDim:10,outlineThickness:5},choiceTextConfig:i={x:0,y:0,oriX:.5,oriY:.5},bitmapTextStyle:r=_a.defaultFontStyle},o,c,d=pn.radioButtonClick.key){super(e,o,c),this.buttonClickSoundKey=void 0,this.activeChoice=void 0,this.activeChoiceIdx=void 0,this.choices=void 0,this.buttonPositions=void 0,this.radioChoiceConfig=void 0,this.choiceTextConfig=void 0,this.bitmapTextStyle=void 0,this.activeChoiceIdx=s,this.choices=t,this.choiceTextConfig=i,this.bitmapTextStyle=r,this.radioChoiceConfig=n,this.buttonClickSoundKey=d;const l=this.getRadioButtons(t);this.buttonPositions=Ha({numOfItems:l.length,maxXSpace:a}),this.renderRadioButtons(l,this.buttonPositions,this.radioChoiceConfig),this.activate(s)}getRadioButtons(e){return e.map(((e,t)=>({text:e,callback:()=>this.activate(t)})))}renderRadioButtons(e,t,s){this.add(e.map(((e,a)=>this.createRadioButton(t[a][0],t[a][1],e.callback,s))))}createRadioButton(e,t,s,a){return new Phaser.GameObjects.Ellipse(this.scene,e,t,a.circleDim,a.circleDim,Ua.lightBlue).setStrokeStyle(a.outlineThickness,Ua.darkBlue).setInteractive({useHandCursor:!0}).addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{$o.getInstance().getSoundManager().playSound(this.buttonClickSoundKey),s()}))}activate(e){this.activeChoiceIdx=e,this.activeChoice&&this.activeChoice.destroy(),this.activeChoice=new Phaser.GameObjects.Container(this.scene,this.buttonPositions[e][0],this.buttonPositions[e][1]);const t=za(this.scene,this.choices[e],this.choiceTextConfig,this.bitmapTextStyle),s=new Phaser.GameObjects.Ellipse(this.scene,0,0,this.radioChoiceConfig.checkedDim,this.radioChoiceConfig.checkedDim,Ua.darkBlue);this.activeChoice.add([t,s]),this.add(this.activeChoice)}getValueIdx(){return this.activeChoiceIdx}getChoices(){return this.choices}getChosenChoice(){return this.activeChoiceIdx<this.choices.length?this.choices[this.activeChoiceIdx]:_a.nullInteractionId}}var Si=fi;const Ci={key:La.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},wi={key:La.zektonFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Ei={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var Ai={optHeaderTextConfig:{x:.25*Da.x,y:0,oriX:.5,oriY:.75},opt:{x:140,xSpace:.4*Da.x,ySpace:.7*Da.y},radioButtonsTextConfig:{x:0,y:-50,oriX:.5,oriY:.25},volContainerOpts:["0","0.25","0.5","1.0","1.5","2.0"]};const Ii={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Ti={key:La.zektonFont.key,size:20,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},ki={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var Ni={button:{y:.15*Da.y},escapeOptTextConfig:{x:0,y:0,oriX:.37,oriY:.75},settings:{yOffset:.1*-Ga.y,ySpace:.3*Da.y},settingsTextConfig:{x:.38*Da.x,y:.1*-Ga.y,oriX:0,oriY:.5},radioButtons:{xSpace:.2*Da.x},radioChoiceTextConfig:{x:0,y:-45,oriX:.5,oriY:.25},volOpt:{x:.05*Da.x}};var Pi=class{constructor(e){this.bgmVolumeRadioButtons=void 0,this.sfxVolumeRadioButtons=void 0,this.scene=void 0,this.getSoundManager=()=>$o.getInstance().getSoundManager(),this.getSettingsSaveManager=()=>$o.getInstance().getSaveManager(),this.scene=e,this.scene.getPhaseManager().addPhaseToMap($n.EscapeMenu,this)}createUIContainer(){const e=new Phaser.GameObjects.Container(this.scene,0,0),t=new Phaser.GameObjects.Image(this.scene,Ga.x,Ga.y,ln.escapeMenuBackground.key).setDisplaySize(Da.x,Da.y).setInteractive({pixelPerfect:!0});e.add(t);const s=this.getSettings(),a=Ha({direction:Fa.Column,numOfItems:s.length,maxYSpace:Ni.settings.ySpace});e.add(s.map(((e,t)=>za(this.scene,e,{...Ni.settingsTextConfig,y:a[t][1]+Ni.settingsTextConfig.y},ki))));const{bgmVolume:n,sfxVolume:i}=this.getSettingsSaveManager().getSettings(),r=Ai.volContainerOpts.findIndex((e=>parseFloat(e)===i)),o=Ai.volContainerOpts.findIndex((e=>parseFloat(e)===n));this.sfxVolumeRadioButtons=this.createSettingsRadioOptions(r,a[0][1]),this.bgmVolumeRadioButtons=this.createSettingsRadioOptions(o,a[1][1]),e.add([this.sfxVolumeRadioButtons,this.bgmVolumeRadioButtons]);const c=this.getOptButtons(),d=Ha({numOfItems:c.length});return e.add(c.map(((e,t)=>this.createEscapeOptButton(e.text,d[t][0],d[t][1]+Ni.button.y,e.callback)))),e}getSettings(){return["SFX","BGM"]}createSettingsRadioOptions(e,t){return new Si(this.scene,{choices:Ai.volContainerOpts,defaultChoiceIdx:e,maxXSpace:Ni.radioButtons.xSpace,radioChoiceConfig:{circleDim:15,checkedDim:10,outlineThickness:3},choiceTextConfig:Ni.radioChoiceTextConfig,bitmapTextStyle:Ti},Ni.volOpt.x,-Ga.y+t+Ni.settings.yOffset)}getOptButtons(){return[{text:"Main Menu",callback:()=>{this.cleanUp(),$o.getInstance().isGameType(Xo.Simulator)?this.scene.scene.start("StorySimulatorMenu"):this.scene.scene.start("MainMenu")}},{text:"Continue",callback:async()=>{this.scene.getPhaseManager().isCurrentPhase($n.EscapeMenu)&&await this.scene.getPhaseManager().popPhase()}},{text:"Apply Settings",callback:()=>this.applySettings()}]}createEscapeOptButton(e,t,s,a){return Fn(this.scene,{assetKey:ln.mediumButton.key,message:e,textConfig:Ni.escapeOptTextConfig,bitMapTextStyle:Ii,onUp:a}).setPosition(t,s)}async applySettings(){const e=this.sfxVolumeRadioButtons?parseFloat(this.sfxVolumeRadioButtons.getChosenChoice()):1,t={bgmVolume:this.bgmVolumeRadioButtons?parseFloat(this.bgmVolumeRadioButtons.getChosenChoice()):1,sfxVolume:e};await this.getSettingsSaveManager().saveSettings(t),$o.getInstance().getSoundManager().applyUserSettings(t)}cleanUp(){this.scene.getInputManager().clearListeners(),this.scene.getLayerManager().clearAllLayers()}activateUI(){const e=this.createUIContainer();this.getSoundManager().playSound(pn.menuEnter.key),this.scene.getLayerManager().addToLayer(gn.Escape,e)}deactivateUI(){this.getSoundManager().playSound(pn.menuExit.key),this.scene.getLayerManager().clearSeveralLayers([gn.Escape])}};var Ri=class{constructor(e){this.scene=void 0,this.keyboardListeners=void 0,this.eventListeners=void 0,this.keyboardListeners=[],this.eventListeners=[],this.scene=e}setDefaultCursor(e){this.scene.input.setDefaultCursor(e)}enableMouseInput(e){this.scene.input.mouse.enabled=e}enableKeyboardInput(e){this.scene.input.keyboard.enabled=e}registerKeyboardListener(e,t,s){const a=this.scene.input.keyboard.addKey(e).addListener(t,s);this.keyboardListeners.push(a)}registerEventListener(e,t){const s=this.scene.input.addListener(e,t);this.eventListeners.concat(s)}clearListeners(){this.keyboardListeners.forEach((e=>e.removeAllListeners())),this.eventListeners.forEach((e=>e.removeAllListeners()))}};var Mi=class{constructor(e){this.layers=void 0,this.layers=new Map(mn.map((t=>[t,new Phaser.GameObjects.Container(e,0,0)]))),this.layers.forEach((t=>e.add.existing(t)))}getLayer(e){return this.layers.get(e)}hideLayer(e){const t=this.layers.get(e);t&&t.setVisible(!1)&&t.setAlpha(0)}showLayer(e){const t=this.layers.get(e);t&&t.setVisible(!0)&&t.setAlpha(1)}async fadeInLayer(e,t=_a.fadeDuration){const s=zn.getInstance().getGameManager(),a=this.layers.get(e);a.setVisible(!0),a.setAlpha(0),s.tweens.add(xn([a],t)),await bn(t)}async fadeOutLayer(e,t=_a.fadeDuration){const s=zn.getInstance().getGameManager(),a=this.layers.get(e);a.setVisible(!0),a.setAlpha(1),s.tweens.add(vn([a],t)),await bn(t)}addToLayer(e,t){const s=this.layers.get(e);s&&s.add(t)}clearSeveralLayers(e){e.forEach((e=>this.clearLayerContents(e)))}clearAllLayers(){this.layers.forEach(((e,t)=>this.clearLayerContents(t)))}clearLayerContents(e){const t=this.layers.get(e);if(t)for(;t.list.length;)t.list[0].destroy()}};class Li{constructor(e,t,s,a,n,i){this.scene=void 0,this.container=void 0,this.imageGlow=void 0,this.clickArea=void 0,this.glowClearer=void 0,this.blinkClearer=void 0,this.scene=e,this.container=new Phaser.GameObjects.Container(e,t,s),this.imageGlow=new Phaser.GameObjects.Image(e,0,0,a).setAlpha(0).setBlendMode(Phaser.BlendModes.ADD),this.clickArea=new Phaser.GameObjects.Image(e,0,0,a).setAlpha(.01).setInteractive({pixelPerfect:!0});const r=zn.getInstance().getGameMap().getMapAssets().get(a),o=zn.getInstance().getGameManager().getAnimationManager();if(r){const e=o.createImage(r,a);switch(null===r||void 0===r?void 0:r.type){case cn.Sprite:this.clickArea.setAlpha(0),o.startAnimation(r);break;case cn.Image:n&&(ai(e,n,i),ai(this.imageGlow,n,i),ai(this.clickArea,n,i))}this.container.add([e,this.imageGlow,this.clickArea])}}startGlow(){this.glowClearer&&this.glowClearer(),this.glowClearer=Cn(this.scene,this.imageGlow),this.imageGlow.setAlpha(1)}clearGlow(){this.glowClearer&&this.glowClearer(),this.imageGlow.setAlpha(0)}startBlink(){this.blinkClearer=Cn(this.scene,this.getContainer())}clearBlink(){this.getContainer().setAlpha(1),this.blinkClearer&&this.blinkClearer()}getContainer(){return this.container}getClickArea(){return this.clickArea}}var _i=class{constructor(){this.objects=void 0,this.objects=new Map,zn.getInstance().watchGameItemType(Jn.objects,this)}renderObjectsLayerContainer(e){zn.getInstance().clearSeveralLayers([gn.Objects]);const t=zn.getInstance().getGameItemsInLocation(Jn.objects,e);this.objects.clear(),t.map((e=>this.handleAdd(e)))}makeObjectGlow(e,t){const s=this.objects.get(e);s&&(t?s.sprite.startGlow():s.sprite.clearGlow())}makeObjectBlink(e,t){const s=this.objects.get(e);s&&(t?s.sprite.startBlink():s.sprite.clearBlink())}createObject(e){const t=zn.getInstance().getGameManager(),{assetKey:s,x:a,y:n,width:i,height:r,actionIds:o,interactionId:c}=e,d=new Li(t,a,n,s,i,r);return{sprite:d,clickArea:d.getClickArea(),actionIds:o,interactionId:c}}handleAdd(e){const t=zn.getInstance().getObjectById(e),s=this.createObject(t);return zn.getInstance().addToLayer(gn.Objects,s.sprite.getContainer()),this.objects.set(e,s),!0}handleMutate(e){return this.handleDelete(e)&&this.handleAdd(e)}handleDelete(e){const t=this.objects.get(e);return!!t&&(this.objects.delete(e),t.sprite.getContainer().destroy(),!0)}getActivatables(){return Array.from(this.objects.values())}};class Di{constructor(e,t){this.phaseMap=void 0,this.phaseStack=void 0,this.inputManager=void 0,this.interruptCheckCallback=void 0,this.interruptTransitionCallback=void 0,this.transitionCallback=void 0,this.phaseStack=[$n.None],this.phaseMap=e,this.interruptCheckCallback=()=>!1,this.interruptTransitionCallback=async()=>_a.nullFunction(),this.transitionCallback=_a.nullFunction,this.inputManager=t}addPhaseToMap(e,t){this.phaseMap.set(e,t)}setInterruptCheckCallback(e){this.interruptCheckCallback=e}setInterruptCallback(e){this.interruptTransitionCallback=e}setCallback(e){this.transitionCallback=e}async popPhase(){const e=this.phaseStack.pop();await this.executePhaseTransition(e,this.getCurrentPhase())}async pushPhase(e){const t=this.getCurrentPhase();e===t||this.isCurrentPhase($n.EscapeMenu)||(this.phaseStack.push(e),await this.executePhaseTransition(t,e))}async swapPhase(e){const t=this.getCurrentPhase();e===t||this.isCurrentPhase($n.EscapeMenu)||(this.phaseStack.pop(),this.phaseStack.push(e),await this.executePhaseTransition(t,e))}async executePhaseTransition(e,t){if(this.inputManager.enableKeyboardInput(!1),this.inputManager.enableMouseInput(!1),await this.phaseMap.get(e).deactivateUI(),this.interruptCheckCallback(e,t))return this.inputManager.enableMouseInput(!0),this.inputManager.enableKeyboardInput(!0),void await this.interruptTransitionCallback(e,t);this.transitionCallback(e,t),await this.phaseMap.get(t).activateUI(),this.inputManager.enableMouseInput(!0),this.inputManager.enableKeyboardInput(!0)}isCurrentPhase(e){return this.getCurrentPhase()===e}getCurrentPhase(){return this.phaseStack.length||(this.phaseStack=[$n.None]),this.phaseStack[this.phaseStack.length-1]}}var Gi={image:{xOffset:20,yOffset:20},rect:{x:{Left:400,Middle:Ga.x,Right:Da.x-400},y:{Small:325,Medium:350,Large:420},scale:{Small:.7,Medium:1,Large:1.5},width:280,height:280},tweenDuration:300};var Bi=class{constructor(){this.currPopUp=void 0,this.currPopUp=new Map}async displayPopUp(e,t,s=_a.popUpDuration,a=pi.Medium){this.destroyPopUp(t);const n=zn.getInstance().getGameManager(),i=new Phaser.GameObjects.Container(n,0,0),r=new Phaser.GameObjects.Image(n,Gi.rect.x[t],Gi.rect.y[a],ln.popUpFrame.key).setScale(Gi.rect.scale[a]),o=this.getAssetKey(e);if(!o)return;const c=new Phaser.GameObjects.Image(n,Gi.rect.x[t]+Gi.image.xOffset,Gi.rect.y[a]+Gi.image.yOffset,o);ii(c,Gi.rect.width*Gi.rect.scale[a],Gi.rect.height*Gi.rect.scale[a]),i.add([r,c]),this.currPopUp.set(t,i),zn.getInstance().addToLayer(gn.PopUp,i),zn.getInstance().playSound(pn.popUpEnter.key),i.setActive(!0),i.setVisible(!0),i.setScale(1,0),n.tweens.add(((e,t=500)=>({scaleY:1,targets:e,duration:t,ease:"Power1"}))([i],Gi.tweenDuration)),await bn(Gi.tweenDuration),setTimeout((()=>this.destroyPopUp(t)),s)}destroyAllPopUps(){this.currPopUp.forEach(((e,t,s)=>{this.destroyPopUp(t)}))}async destroyPopUp(e){const t=this.currPopUp.get(e);t&&(zn.getInstance().getGameManager().tweens.add(((e,t=500)=>({scaleY:0,targets:e,duration:t,ease:"Power1"}))([t],Gi.tweenDuration)),await bn(Gi.tweenDuration),t.setVisible(!1),t.setActive(!1),t.destroy(),this.currPopUp.delete(e),zn.getInstance().playSound(pn.popUpExit.key))}getAssetKey(e){const t=zn.getInstance().getGameMap().getObjectPropMap().get(e);if(t)return t.assetKey}};const Ui=()=>({lastCheckpointPlayed:0,currentLocation:void 0,currentPhase:$n.Menu,chapterNewlyCompleted:!1,completedObjectives:[],triggeredInteractions:[],triggeredStateChangeActions:[]});function Fi(e){return Array.from(e).filter((([e,t])=>t)).map((([e])=>e))}var Hi=class{constructor(e){this.subscribers=void 0,this.gameMap=void 0,this.checkpointObjective=void 0,this.chapterNewlyCompleted=void 0,this.updatedLocations=void 0,this.triggeredInteractions=void 0,this.triggeredStateChangeActions=void 0,this.getGameMap=()=>this.gameMap,this.getCharacterAtId=e=>On(this.gameMap.getCharacterMap().get(e)),this.getSaveManager=()=>$o.getInstance().getSaveManager(),this.getChapterNewlyCompleted=()=>this.chapterNewlyCompleted,this.subscribers=new Map,this.gameMap=e.map,this.checkpointObjective=e.objectives,this.chapterNewlyCompleted=!1,this.updatedLocations=new Set(this.gameMap.getLocationIds()),this.triggeredInteractions=new Map,this.triggeredStateChangeActions=[],this.loadStatesFromSaveManager()}loadStatesFromSaveManager(){this.triggeredStateChangeActions=this.getSaveManager().getTriggeredStateChangeActions(),this.getSaveManager().getTriggeredInteractions().forEach((e=>this.triggerInteraction(e))),this.getSaveManager().getCompletedObjectives().forEach((e=>this.checkpointObjective.setObjective(e,!0))),this.chapterNewlyCompleted=this.getSaveManager().getChapterNewlyCompleted()}watchGameItemType(e,t){this.subscribers.set(e,t)}getSubscriberForItemType(e){return On(this.subscribers.get(e))}triggerInteraction(e){this.triggeredInteractions.set(e,!0)}triggerStateChangeAction(e){this.triggeredStateChangeActions.push(e)}hasTriggeredInteraction(e){return this.triggeredInteractions.get(e)}addLocationNotif(e){this.updatedLocations.add(e)}removeLocationNotif(e){this.updatedLocations.delete(e)}hasLocationNotif(e){return this.updatedLocations.has(e)}isCurrentLocation(e){return e===zn.getInstance().getCurrLocId()}getLocationModes(e){return Array.from(this.gameMap.getLocationAtId(e).modes)||[]}addLocationMode(e,t){this.gameMap.getLocationAtId(e).modes.add(t),!this.isCurrentLocation(e)&&this.addLocationNotif(e)}removeLocationMode(e,t){this.gameMap.getLocationAtId(e).modes.delete(t),!this.isCurrentLocation(e)&&this.addLocationNotif(e)}getGameItemsInLocation(e,t){return Array.from(this.gameMap.getLocationAtId(t)[e])||[]}addItem(e,t,s){this.gameMap.getLocationAtId(t)[e].add(s),this.isCurrentLocation(t)?this.getSubscriberForItemType(e).handleAdd(s):this.addLocationNotif(t)}removeItem(e,t,s){this.gameMap.getLocationAtId(t)[e].delete(s),this.isCurrentLocation(t)?this.getSubscriberForItemType(e).handleDelete(s):this.addLocationNotif(t)}setObjProperty(e,t){this.gameMap.setItemInMap(Jn.objects,e,t),this.gameMap.getLocations().forEach(((t,s)=>{t.objects.has(e)&&(this.isCurrentLocation(s)?this.getSubscriberForItemType(Jn.objects).handleMutate(e):this.addLocationNotif(s))}))}setBBoxProperty(e,t){this.gameMap.setItemInMap(Jn.boundingBoxes,e,t),this.gameMap.getLocations().forEach(((t,s)=>{t.boundingBoxes.has(e)&&(this.isCurrentLocation(s)?this.getSubscriberForItemType(Jn.boundingBoxes).handleMutate(e):this.addLocationNotif(s))}))}moveCharacter(e,t,s){this.getCharacterAtId(e).defaultPosition=s,this.gameMap.getLocations().forEach(((t,s)=>{t.characters.has(e)&&this.removeItem(Jn.characters,s,e)})),this.addItem(Jn.characters,t,e)}updateCharacter(e,t){this.getCharacterAtId(e).defaultExpression=t,this.gameMap.getLocations().forEach(((t,s)=>{t.characters.has(e)&&(this.isCurrentLocation(s)?this.getSubscriberForItemType(Jn.characters).handleMutate(e):this.addLocationNotif(s))}))}isAllComplete(){return this.checkpointObjective.isAllComplete()}isObjectiveComplete(e){const t=this.checkpointObjective.getObjectiveState(e);return!(void 0!==t&&!t)}areObjectivesComplete(e){let t=!0;return e.forEach((e=>t=t&&this.isObjectiveComplete(e))),t}completeObjective(e){this.checkpointObjective.setObjective(e,!0)}getCompletedObjectives(){return Fi(this.checkpointObjective.getObjectives())}getTriggeredInteractions(){return Fi(this.triggeredInteractions)}getTriggeredStateChangeActions(){return this.triggeredStateChangeActions}};const Vi=.975*-Ga.y,qi={key:La.zektonDarkFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};class Xi extends Phaser.GameObjects.Container{constructor(e,t){super(e,0,0),this.renderBackButton(t)}renderBackButton(e){const t=Fn(this.scene,{assetKey:ln.topButton.key,message:"Back",textConfig:{x:0,y:Vi,oriX:.5,oriY:.25},bitMapTextStyle:qi,onUp:e}).setPosition(Ga.x,Ga.y);this.add(t)}}var $i=Xi;var Wi={normal:`url(${_a.assetsFolder}/ui/magnifying.png), pointer`,hover:`url(${_a.assetsFolder}/ui/magnifying_trigg.png), pointer`,checked:`url(${_a.assetsFolder}/ui/magnifying_check.png), pointer`};var zi=class{constructor(){this.uiContainer=void 0}createUIContainer(){const e=zn.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),s=new $i(e,(async()=>await zn.getInstance().swapPhase($n.Menu)));return t.add(s),t}async activateUI(){const e=zn.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),zn.getInstance().addToLayer(gn.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,-Da.y),this.enableInteractions(),e.tweens.add({targets:this.uiContainer,...wn}),zn.getInstance().setDefaultCursor(Wi.normal),zn.getInstance().playSound(pn.modeEnter.key)}async deactivateUI(){const e=zn.getInstance().getGameManager();zn.getInstance().setDefaultCursor(_a.defaultCursor),this.disableInteractions(),this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...En}),await bn(500),fn(e,this.uiContainer))}enableInteractions(){zn.getInstance().getAllActivatables().forEach((e=>{e.actionIds&&e.actionIds.length&&(e.clickArea.on("pointerout",(()=>this.explorePointerOut())),e.clickArea.on("pointerover",(()=>this.explorePointerOver(e.interactionId))),e.clickArea.on("pointerup",(async()=>{this.explorePointerUp(e.interactionId),await zn.getInstance().processGameActions(e.actionIds)})))}))}disableInteractions(){zn.getInstance().getAllActivatables().forEach((e=>{e.clickArea.off("pointerout"),e.clickArea.off("pointerover"),e.clickArea.off("pointerup")}))}explorePointerOver(e){zn.getInstance().hasTriggeredInteraction(e)?zn.getInstance().setDefaultCursor(Wi.checked):zn.getInstance().setDefaultCursor(Wi.hover)}explorePointerOut(){zn.getInstance().setDefaultCursor(Wi.normal)}explorePointerUp(e){zn.getInstance().setDefaultCursor(_a.defaultCursor),zn.getInstance().triggerInteraction(e),zn.getInstance().setDefaultCursor(Wi.normal)}};let Ki;!function(e){e.Move="Move",e.Explore="Explore",e.Talk="Talk",e.Menu="Menu"}(Ki||(Ki={}));const Yi={Move:$n.Move,Explore:$n.Explore,Talk:$n.Talk,Menu:$n.Menu},Qi={key:La.zektonFont.key,size:45,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var Ji={button:{yOffset:.3*Da.y},entryTweenProps:{y:0,duration:500,ease:"Power2"},exitTweenProps:{y:.4*Da.y,duration:300,ease:"Power2"}};var Zi=class{constructor(){this.uiContainer=void 0}getLatestLocationModes(){const e=zn.getInstance().getCurrLocId();let t=zn.getInstance().getLocationModes(e);return 0===zn.getInstance().getGameItemsInLocation(Jn.talkTopics,e).length&&(t=t.filter((e=>e!==Ki.Talk))),t}createUIContainer(){const e=zn.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),s=new Phaser.GameObjects.Image(e,Ga.x,Ga.y,ln.modeMenuBanner.key);t.add(s);const a=this.getLatestLocationModes(),n=this.getModeButtons(a),i=Ha({numOfItems:n.length});return t.add(n.map(((e,t)=>this.createModeButton(e.text,i[t][0],i[t][1]+Ji.button.yOffset,e.callback)))),t}getModeButtons(e){return e.sort().map((e=>({text:e,callback:async()=>await zn.getInstance().swapPhase(Yi[e])})))}createModeButton(e,t,s,a){return Fn(zn.getInstance().getGameManager(),{assetKey:ln.shortButton.key,message:e,textConfig:{x:0,y:0,oriX:.5,oriY:.25},bitMapTextStyle:Qi,onUp:a}).setPosition(t,s)}async activateUI(){const e=zn.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),zn.getInstance().addToLayer(gn.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,Da.y),e.tweens.add({targets:this.uiContainer,...Ji.entryTweenProps}),await bn(500),zn.getInstance().playSound(pn.modeEnter.key)}async deactivateUI(){const e=zn.getInstance().getGameManager();this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...Ji.exitTweenProps}),await bn(500),fn(e,this.uiContainer))}};const er={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var tr={button:{xOffSet:.25*Da.x,ySpace:.8*Da.y},preview:{rect:{x:.3125*Da.x,y:.515*Da.y,width:.473*Da.x,height:.56*Da.y},frame:{x:.3*Da.x}}};var sr=class{constructor(){this.uiContainer=void 0}setPreview(e,t){e.setTexture(t).setDisplaySize(tr.preview.rect.width,tr.preview.rect.height).setPosition(tr.preview.rect.x,tr.preview.rect.y)}getLatestNavigations(){return zn.getInstance().getGameItemsInLocation(Jn.navigation,zn.getInstance().getCurrLocId())}createUIContainer(){const e=zn.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),s=new Phaser.GameObjects.Sprite(e,tr.preview.frame.x,Ga.y,ln.locationPreviewFrame.key),a=new Phaser.GameObjects.Sprite(e,Ga.x,Ga.y,ln.locationPreviewFill.key);t.add([s,a]);const n=this.getLatestNavigations(),i=this.getMoveButtons(n,a),r=Ha({numOfItems:i.length,numItemLimit:1,maxYSpace:tr.button.ySpace});t.add(i.map(((e,t)=>this.createMoveButton(e.text,r[t][0]+tr.button.xOffSet,r[t][1],e.callback,e.onHover,e.onOut))));const o=new $i(e,(async()=>await zn.getInstance().swapPhase($n.Menu)));return t.add(o),this.setPreview(a,ln.defaultLocationImg.key),t}getMoveButtons(e,t){const s=e=>this.setPreview(t,e),a=()=>this.setPreview(t,ln.defaultLocationImg.key);return e.map((e=>{const t=zn.getInstance().getLocationAtId(e);return{text:t.name,callback:async()=>{await zn.getInstance().swapPhase($n.Sequence),await zn.getInstance().changeLocationTo(e)},onHover:()=>s(t.assetKey),onOut:()=>a()}}))}createMoveButton(e,t,s,a,n,i){return Fn(zn.getInstance().getGameManager(),{assetKey:ln.longButton.key,message:e,textConfig:{x:0,y:0,oriX:.4,oriY:.15},bitMapTextStyle:er,onUp:a,onHover:n,onOut:i}).setPosition(t,s)}async activateUI(){const e=zn.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),zn.getInstance().addToLayer(gn.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,-Da.y),e.tweens.add({targets:this.uiContainer,...wn}),zn.getInstance().playSound(pn.modeEnter.key)}async deactivateUI(){const e=zn.getInstance().getGameManager();this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...En}),await bn(500),fn(e,this.uiContainer))}};var ar=class{activateUI(){}deactivateUI(){}};const nr={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var ir={button:{ySpace:.7*Da.y}};var rr=class{constructor(){this.uiContainer=void 0}getLatestTalkTopics(){return zn.getInstance().getGameItemsInLocation(Jn.talkTopics,zn.getInstance().getCurrLocId())}createUIContainer(){const e=zn.getInstance().getGameManager(),t=new Phaser.GameObjects.Container(e,0,0),s=this.getLatestTalkTopics(),a=this.getTalkTopicButtons(s),n=Ha({direction:Fa.Column,numOfItems:a.length,maxYSpace:ir.button.ySpace});t.add(a.map(((e,t)=>this.createTalkTopicButton(e.text,n[t][0],n[t][1],e.callback)))),a.forEach(((s,a)=>{const i=new Phaser.GameObjects.Sprite(e,n[a][0],n[a][1],ln.talkOptCheck.key);!!s.interactionId&&zn.getInstance().hasTriggeredInteraction(s.interactionId)&&t.add(i)}));const i=new $i(e,(async()=>await zn.getInstance().swapPhase($n.Menu)));return t.add(i),t}getTalkTopicButtons(e){return e.map((e=>({text:On(zn.getInstance().getDialogueById(e)).title,callback:async()=>{zn.getInstance().triggerInteraction(e),await zn.getInstance().showDialogue(e)},interactionId:e})))}createTalkTopicButton(e,t,s,a){return Fn(zn.getInstance().getGameManager(),{assetKey:ln.talkOptButton.key,message:e,textConfig:{x:0,y:0,oriX:.5,oriY:.2},bitMapTextStyle:nr,onUp:a}).setPosition(t,s)}async activateUI(){const e=zn.getInstance().getGameManager();this.uiContainer=this.createUIContainer(),zn.getInstance().addToLayer(gn.UI,this.uiContainer),this.uiContainer.setPosition(this.uiContainer.x,-Da.y),e.tweens.add({targets:this.uiContainer,...wn}),zn.getInstance().playSound(pn.modeEnter.key)}async deactivateUI(){const e=zn.getInstance().getGameManager();this.uiContainer&&(this.uiContainer.setPosition(this.uiContainer.x,0),e.tweens.add({targets:this.uiContainer,...En}),await bn(500),fn(e,this.uiContainer))}};class or extends Phaser.Scene{constructor(){super("GameManager"),this.currentLocationId=void 0,this.hasTransitioned=void 0,this.stateManager=void 0,this.layerManager=void 0,this.objectManager=void 0,this.characterManager=void 0,this.dialogueManager=void 0,this.actionManager=void 0,this.boundingBoxManager=void 0,this.popUpManager=void 0,this.phaseManager=void 0,this.backgroundManager=void 0,this.animationManager=void 0,this.inputManager=void 0,this.escapeManager=void 0,this.awardManager=void 0,this.getSaveManager=()=>$o.getInstance().getSaveManager(),this.getStateManager=()=>On(this.stateManager),this.getObjectManager=()=>On(this.objectManager),this.getDialogueManager=()=>On(this.dialogueManager),this.getCharacterManager=()=>On(this.characterManager),this.getBBoxManager=()=>On(this.boundingBoxManager),this.getActionManager=()=>On(this.actionManager),this.getInputManager=()=>On(this.inputManager),this.getLayerManager=()=>On(this.layerManager),this.getPhaseManager=()=>On(this.phaseManager),this.getBackgroundManager=()=>On(this.backgroundManager),this.getAnimationManager=()=>On(this.animationManager),this.getPopupManager=()=>On(this.popUpManager),this.getEscapeManager=()=>On(this.escapeManager),this.getAwardManager=()=>On(this.awardManager),this.currentLocationId=_a.nullInteractionId,this.hasTransitioned=!1}init({gameCheckpoint:e,continueGame:t,chapterNum:s,checkpointNum:a}){zn.getInstance().setGameManager(this),$o.getInstance().setCurrentSceneRef(this),this.getSaveManager().registerGameInfo(s,a,t),this.currentLocationId=this.getSaveManager().getLoadedLocation()||e.startingLoc,this.hasTransitioned=!1,this.stateManager=new Hi(e),this.layerManager=new Mi(this),this.inputManager=new Ri(this),this.phaseManager=new Di(new Map([[$n.Menu,new Zi],[$n.Move,new sr],[$n.Explore,new zi],[$n.Talk,new rr],[$n.Sequence,new ar],[$n.None,new ar]]),this.inputManager),this.characterManager=new li,this.objectManager=new _i,this.dialogueManager=new bi,this.actionManager=new ti,this.boundingBoxManager=new ci,this.backgroundManager=new oi,this.animationManager=new si,this.popUpManager=new Bi,this.escapeManager=new Pi(this),this.awardManager=new ri(this)}preload(){xi(this),this.getPhaseManager().setInterruptCheckCallback(((e,t)=>this.transitionChecker(e,t))),this.getPhaseManager().setInterruptCallback((async(e,t)=>await this.checkpointTransition())),this.getPhaseManager().setCallback((async(e,t)=>await this.handleCharacterLayer(e,t))),this.preloadLocationsAssets(),this.bindKeyboardTriggers()}preloadLocationsAssets(){const e=this.getStateManager().getGameMap();zn.getInstance().loadSounds(e.getSoundAssets()),e.getMapAssets().forEach(((e,t)=>{this.loadImage(e,t)}))}loadImage(e,t){switch(e.type){case cn.Image:this.load.image(t,yn(e.path));break;case cn.Sprite:this.load.spritesheet(t,yn(e.path),e.config)}}async create(){zn.getInstance().hideLayer(gn.Character),await this.changeLocationTo(this.currentLocationId,!0),await zn.getInstance().saveGame()}async renderLocation(e,t){const s=zn.getInstance().getLocationAtId(e);await zn.getInstance().playBgMusic(s.bgmKey),this.getBackgroundManager().renderBackgroundLayerContainer(e),this.getObjectManager().renderObjectsLayerContainer(e),this.getBBoxManager().renderBBoxLayerContainer(e),this.getCharacterManager().renderCharacterLayerContainer(e),await this.getPhaseManager().swapPhase($n.Sequence),t&&(await this.getActionManager().fastForwardGameActions(this.getStateManager().getTriggeredStateChangeActions()),await this.getActionManager().processGameActions(this.getStateManager().getGameMap().getGameStartActions())),await this.getActionManager().processGameActions(s.actionIds),this.getStateManager().hasLocationNotif(e)&&(await zn.getInstance().bringUpUpdateNotif(s.name),this.getStateManager().removeLocationNotif(e)),this.getPhaseManager().isCurrentPhase($n.Sequence)&&await this.getPhaseManager().swapPhase($n.Menu)}async changeLocationTo(e,t=!1){this.currentLocationId=e,await(async(e,t,s,a)=>{const n=Sn(e);e.getLayerManager().addToLayer(gn.Effects,n),n.setAlpha(0),e.tweens.add(xn([n],t)),await bn(t),await a(),await bn(s),n.setAlpha(1),e.tweens.add(vn([n],t)),await bn(t),n.destroy()})(this,300,500,(async()=>{await this.getLayerManager().clearAllLayers(),await this.renderLocation(e,t)})),this.getStateManager().triggerInteraction(e)}bindKeyboardTriggers(){this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.ESC,"up",(async()=>{this.getPhaseManager().isCurrentPhase($n.EscapeMenu)?await this.getPhaseManager().popPhase():await this.getPhaseManager().pushPhase($n.EscapeMenu)})),this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.TAB,"up",(async()=>{this.getPhaseManager().isCurrentPhase($n.AwardMenu)?await this.getPhaseManager().popPhase():await this.getPhaseManager().pushPhase($n.AwardMenu)}))}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}transitionChecker(e,t){return!this.hasTransitioned&&t!==$n.Sequence&&zn.getInstance().isAllComplete()&&!this.getStateManager().getChapterNewlyCompleted()}async checkpointTransition(){this.hasTransitioned=!0,await this.getActionManager().processGameActions(this.getStateManager().getGameMap().getCheckpointCompleteActions()),this.getInputManager().setDefaultCursor(_a.defaultCursor),this.getInputManager().enableMouseInput(!0),this.getInputManager().enableKeyboardInput(!0),this.tweens.add(xn([Sn(this).setAlpha(0)],_a.fadeDuration)),await bn(_a.fadeDuration),this.cleanUp(),this.scene.start("CheckpointTransition")}async handleCharacterLayer(e,t){e===$n.Menu&&zn.getInstance().fadeOutLayer(gn.Character),t===$n.Menu&&zn.getInstance().fadeInLayer(gn.Character)}}var cr=or;class dr{constructor(){this.fullSaveState=void 0,this.chapterNum=void 0,this.checkpointNum=void 0,this.getTriggeredStateChangeActions=()=>this.getGameSaveState().triggeredStateChangeActions,this.getTriggeredInteractions=()=>this.getGameSaveState().triggeredInteractions,this.getCompletedObjectives=()=>this.getGameSaveState().completedObjectives,this.getLoadedPhase=()=>this.getGameSaveState().currentPhase,this.getChapterNewlyCompleted=()=>this.getGameSaveState().chapterNewlyCompleted,this.getChapterNum=()=>On(this.chapterNum),this.getCheckpointNum=()=>On(this.checkpointNum),this.getFullSaveState=()=>this.fullSaveState,this.fullSaveState={gameSaveStates:{},userSaveState:{collectibles:[],settings:{bgmVolume:1,sfxVolume:1},recentlyPlayedCheckpoint:[-1,-1],largestCompletedChapter:-1}}}async loadLastSaveState(){this.fullSaveState=await async function(){const e={method:"GET",headers:Ko($o.getInstance().getAccountInfo().accessToken)},t=await fetch(`${y.b.backendUrl}/v1/user/`,e),s=await t.text(),a=JSON.parse(s).gameStates;return v.a.isEmpty(a)?{gameSaveStates:{},userSaveState:{collectibles:[],settings:{bgmVolume:1,sfxVolume:1},recentlyPlayedCheckpoint:[-1,-1],largestCompletedChapter:-1}}:a}()}registerGameInfo(e,t,s){this.chapterNum=e,this.checkpointNum=t,s||(this.fullSaveState.gameSaveStates[e]=Ui())}async saveGame(){$o.getInstance().getCurrentSceneRef()instanceof cr&&(this.fullSaveState=function(e,t,s){const a=zn.getInstance().getGameManager(),n=a.getStateManager(),i=a.getPhaseManager();return{gameSaveStates:{...e.gameSaveStates,[t]:{lastCheckpointPlayed:s,currentLocation:a.currentLocationId,currentPhase:i.getCurrentPhase(),chapterNewlyCompleted:n.getChapterNewlyCompleted(),completedObjectives:n.getCompletedObjectives(),triggeredInteractions:n.getTriggeredInteractions(),triggeredStateChangeActions:n.getTriggeredStateChangeActions()}},userSaveState:{settings:e.userSaveState.settings,recentlyPlayedCheckpoint:[t,s],collectibles:$o.getInstance().getUserStateManager().getCollectibles(),largestCompletedChapter:e.userSaveState.largestCompletedChapter}}}(this.fullSaveState,this.getChapterNum(),this.getCheckpointNum()),await zo(this.fullSaveState))}async saveChapterComplete(e){this.fullSaveState.gameSaveStates[e].chapterNewlyCompleted=!0,e>this.getLargestCompletedChapterNum()&&(this.fullSaveState.userSaveState.largestCompletedChapter=e),await zo(this.fullSaveState)}async saveSettings(e){this.fullSaveState.userSaveState.settings=e,await zo(this.fullSaveState)}getSettings(){return this.fullSaveState.userSaveState.settings}getLoadedUserState(){return this.fullSaveState.userSaveState}getLargestCompletedChapterNum(){return this.fullSaveState.userSaveState.largestCompletedChapter}getGameSaveState(){return this.fullSaveState.gameSaveStates[this.getChapterNum()]||Ui()}getLoadedLocation(){return this.getGameSaveState().currentLocation}getChapterSaveState(e){return this.fullSaveState.gameSaveStates[e]||Ui()}}const lr={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};const ur=["Clang. Thud. One hit to the wall, one hit to my flesh.","","They told me I was to be the pillar of this","spaceship - who knew they meant it literally?","- A. Halim"],hr=["I blink synchronously with the screen;","I breathe as the machine steams on and off.","","Behind this closed space, my very blood fuels","these engines - hoping for you to find me.","- T. S. Chong"],pr=80,gr=5e3;function mr(e,t,s,a,n=50,i=50){const r=new Phaser.GameObjects.Rectangle(e,s,a,n,i,0,0),o="A"===t?ur:hr;r.setInteractive({useHandCursor:!0}),r.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>async function(e,t){const s=Sn(e).setInteractive().setAlpha(0),a=qa({numOfItems:t.length,xSpacing:0,ySpacing:pr}),n={x:Ga.x,y:0,oriX:.5,oriY:.5},i=Ga.y-t.length*pr*.5;e.getLayerManager().addToLayer(gn.Effects,s),e.add.tween(xn([s],_a.fadeDuration)),$o.getInstance().getSoundManager().playSound(pn.radioStatic.key),await bn(_a.fadeDuration),t.forEach(((t,s)=>{const r=function(e,t,s={x:0,y:0,oriX:.5,oriY:.5},a=lr,n=4,i=5,r=3){const o=[];for(let c=0;c<n;c++){const n={x:s.x+i*Math.random(),y:s.y+r*Math.random(),oriX:s.oriX,oriY:s.oriY},c=za(e,t,n,a);c.setAlpha(.4).setBlendMode(Phaser.BlendModes.SCREEN),o.push(c)}return o.forEach((t=>{e.tweens.add({targets:t,x:t.x+i*Math.random(),y:t.y+r*Math.random(),alpha:.5,duration:20,yoyo:!0,loop:-1,loopDelay:1e3*Math.random()})})),o}(e,t,{...n,y:a[s][1]+i});r.forEach((t=>e.getLayerManager().addToLayer(gn.Effects,t))),setTimeout((()=>r.forEach((e=>e.destroy()))),gr)})),await bn(gr),fn(e,s)}(e,o))),e.getLayerManager().addToLayer(gn.UI,r)}const br={scrollSpeed:20,tileDim:2048,maxAwardsPerCol:2,arrow:{xOffset:875},award:{xSpace:300,yStart:300,ySpace:Ga.y-50,dim:200},awardInfo:{width:300},banner:{xOffset:.28*-Da.x},bannerTextConfig:{x:30,y:0,oriX:0,oriY:.5}},jr={key:La.alienLeagueFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT},yr={fontFamily:"Verdana",fontSize:"30px",fill:Ba.lightBlue,align:"center",wordWrap:{width:br.award.dim-20}},Or={fontFamily:"Verdana",fontSize:"20px",fill:Ba.lightBlue,align:"left",wordWrap:{width:br.awardInfo.width-20}},vr={fontFamily:"Verdana",fontSize:"15px",fill:Ba.offWhite,align:"left",wordWrap:{width:br.awardInfo.width-20}},xr={fontFamily:"Verdana",fontSize:"15px",fill:Ba.lightBlue,align:"left",wordWrap:{width:br.awardInfo.width-20}};class fr extends Phaser.Scene{constructor(){super("AwardsHall"),this.layerManager=void 0,this.inputManager=void 0,this.backgroundTile=void 0,this.awardsContainer=void 0,this.isScrollLeft=void 0,this.isScrollRight=void 0,this.scrollLim=void 0,this.awardXSpace=void 0,this.getUserStateManager=()=>$o.getInstance().getUserStateManager(),this.getInputManager=()=>On(this.inputManager),this.getLayerManager=()=>On(this.layerManager),$o.getInstance().setCurrentSceneRef(this),this.isScrollLeft=!1,this.isScrollRight=!1,this.scrollLim=0,this.awardXSpace=0}init(){this.layerManager=new Mi(this),this.inputManager=new Ri(this)}preload(){xi(this)}async create(){const e=this.getUserStateManager().getAchievements().length,t=this.getUserStateManager().getCollectibles().length;this.awardXSpace=Math.ceil(Math.max(e,t)/br.maxAwardsPerCol)*br.award.xSpace,this.scrollLim=this.awardXSpace<Da.x?0:this.awardXSpace-Da.x,this.renderBackground(),this.renderAwards(),mr(this,"A",.95*Da.x,.99*Da.y)}update(){if(!this.backgroundTile||!this.awardsContainer)return;let e=this.awardsContainer.x;this.isScrollRight?e-=br.scrollSpeed:this.isScrollLeft&&(e+=br.scrollSpeed),e=jn(e,-this.scrollLim,0),this.backgroundTile.tilePositionX=-e,this.awardsContainer.x=e}renderBackground(){this.backgroundTile&&this.backgroundTile.destroy(),this.backgroundTile=new Phaser.GameObjects.TileSprite(this,0,0,br.tileDim,br.tileDim,ln.awardsBackground.key).setOrigin(0,.25),this.getLayerManager().addToLayer(gn.Background,this.backgroundTile);const e=["Achievements","Collectibles"],t=Ha({direction:Fa.Column,numOfItems:e.length});e.forEach(((e,s)=>{const a=this.createBanner(e,t[s][1]);this.getLayerManager().addToLayer(gn.UI,a)}));const s=Fn(this,{assetKey:ln.chapterSelectArrow.key,onDown:()=>this.isScrollLeft=!0,onUp:()=>this.isScrollLeft=!1,onOut:()=>this.isScrollLeft=!1}).setPosition(Ga.x-br.arrow.xOffset,Ga.y),a=Fn(this,{assetKey:ln.chapterSelectArrow.key,onDown:()=>this.isScrollRight=!0,onUp:()=>this.isScrollRight=!1,onOut:()=>this.isScrollRight=!1}).setPosition(Ga.x+br.arrow.xOffset,Ga.y).setScale(-1,1),n=new $i(this,(()=>{this.cleanUp(),this.scene.start("MainMenu")}));this.getLayerManager().addToLayer(gn.UI,s),this.getLayerManager().addToLayer(gn.UI,a),this.getLayerManager().addToLayer(gn.UI,n)}renderAwards(){this.awardsContainer&&this.awardsContainer.destroy(),this.awardsContainer=new Phaser.GameObjects.Container(this,0,0);const e=this.getAwards(this.getUserStateManager().getAchievements()),t=Ha({direction:Fa.Column,numOfItems:e.length,numItemLimit:br.maxAwardsPerCol,redistributeLast:!1,maxXSpace:this.awardXSpace,maxYSpace:br.award.ySpace});this.awardsContainer.add(e.map(((e,s)=>this.createAward(e,t[s][0],t[s][1]+br.award.yStart-Ga.y))));const s=this.getAwards(this.getUserStateManager().getCollectibles()),a=Ha({direction:Fa.Column,numOfItems:s.length,numItemLimit:br.maxAwardsPerCol,redistributeLast:!1,maxXSpace:this.awardXSpace,maxYSpace:br.award.ySpace});this.awardsContainer.add(s.map(((e,t)=>this.createAward(e,a[t][0],a[t][1]+br.award.yStart)))),this.getLayerManager().addToLayer(gn.Objects,this.awardsContainer)}getAwards(e){return rn(e)}createAward(e,t,s){const a=new Phaser.GameObjects.Container(this,t,s);let n;if(e.assetKey===_a.nullInteractionId){n=new Phaser.GameObjects.Rectangle(this,0,0,br.award.dim,br.award.dim,Ua.darkBlue,.8),n.setInteractive();const t=new Phaser.GameObjects.Text(this,0,0,e.title,yr).setOrigin(.5,.5);a.add([n,t])}else n=new Phaser.GameObjects.Sprite(this,0,0,e.assetKey).setOrigin(.5),ii(n,br.award.dim,br.award.dim),n.setInteractive({pixelPerfect:!0,useHandCursor:!0}),a.add(n);const i=new Phaser.GameObjects.Rectangle(this,0,0,br.award.dim,br.award.dim,0).setAlpha(e.completed?0:.8);a.add(i);const r=((e,t)=>{const s=new Phaser.GameObjects.Container(e,0,0),a=new Phaser.GameObjects.Text(e,20,20,t.title,Or),n=new Phaser.GameObjects.Text(e,20,a.getBounds().bottom+20,t.assetKey,vr),i=new Phaser.GameObjects.Text(e,20,n.getBounds().bottom+20,t.description,xr),r=new Phaser.GameObjects.Rectangle(e,0,0,br.awardInfo.width,i.getBounds().bottom+20,Ua.darkBlue).setOrigin(0,0).setAlpha(.8),o=new Phaser.GameObjects.Sprite(e,br.awardInfo.width/2,0,ln.scrollFrame.key),c=new Phaser.GameObjects.Sprite(e,br.awardInfo.width/2,r.getBounds().bottom,ln.scrollFrame.key);return s.add([r,a,i,o,c]),t.completed&&s.add(n),s.setVisible(!1),s})(this,e);return n.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>r.setVisible(!0))),n.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>r.setVisible(!1))),n.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,(e=>{r.x=e.x+10,r.y=e.y-10})),this.getLayerManager().addToLayer(gn.UI,r),a}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}createBanner(e,t){const s=new Phaser.GameObjects.Container(this,0,t),a=new Phaser.GameObjects.Sprite(this,br.banner.xOffset,0,ln.awardsPage.key),n=za(this,e,br.bannerTextConfig,jr);return s.add([a,n]),s}}var Sr=fr;const Cr={keyTextConfig:{x:Ga.x-100,y:0,oriX:.5,oriY:.5},keyDescTextConfig:{x:Ga.x+100,y:0,oriX:.5,oriY:.5},key:{yStart:.9*Ga.y,yInterval:150},icon:{x:Ga.x-100}},wr={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Er={key:La.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};class Ar extends Phaser.Scene{constructor(){super("Bindings"),this.layerManager=void 0,this.inputManager=void 0,this.getInputManager=()=>On(this.inputManager),this.getLayerManager=()=>On(this.layerManager)}init(){this.layerManager=new Mi(this),this.inputManager=new Ri(this)}create(){this.renderBackground(),this.renderBindings()}renderBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,ln.spaceshipBg.key),t=new Phaser.GameObjects.Rectangle(this,Ga.x,Ga.y,Da.x,Da.y,0).setAlpha(.3);this.getLayerManager().addToLayer(gn.Background,e),this.getLayerManager().addToLayer(gn.Background,t)}renderBindings(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getBindings(),s=qa({numOfItems:t.length,xSpacing:0,ySpacing:Cr.key.yInterval});e.add(t.map(((e,t)=>this.createBinding(e.key,e.text,s[t][0],s[t][1]+Cr.key.yStart))));const a=new $i(this,(()=>{this.getLayerManager().clearAllLayers(),this.scene.start("MainMenu")}));this.getLayerManager().addToLayer(gn.UI,e),this.getLayerManager().addToLayer(gn.UI,a)}getBindings(){return[{key:"Esc",text:"Escape Menu"},{key:"Tab",text:"Awards Menu"}]}createBinding(e,t,s,a){const n=new Phaser.GameObjects.Container(this,s,a),i=new Phaser.GameObjects.Sprite(this,Cr.icon.x,0,ln.squareKeyboardIcon.key);switch(e){case"Tab":i.setTexture(ln.medKeyboardIcon.key)}const r=za(this,e,Cr.keyTextConfig,wr),o=za(this,t,Cr.keyDescTextConfig,Er);return n.add([i,r,o]),n}}var Ir=Ar;const Tr=(e,t,s)=>new Promise((a=>{"__MISSING"!==e.textures.get(t).key?a(t):(e.load.image(t,s),e.load.once(`filecomplete-image-${t}`,a),e.load.once("loaderror",a),e.load.start())})),kr=(e,t,s)=>new Promise((a=>{e.cache.text.exists(t)?a(t):(e.load.text(t,s),e.load.once(`filecomplete-text-${t}`,a),e.load.start())})),Nr={key:La.zektonFont.key,size:25,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Pr={key:La.zektonFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var Rr={arrow:{xOffset:875},button:{xOffset:100,yOffset:200},frame:{xOffset:15,yOffset:-10},scrollSpeed:20,indexTextConfig:{x:0,y:-160,oriX:.5,oriY:.5},titleTextConfig:{x:0,y:-100,oriX:.5,oriY:.5},maskRect:{x:0-Ga.x,y:100-Ga.y,width:Da.x-0,height:Da.y-200},imageRect:{width:500,height:700},imageDist:650,chapComplete:{y:20,height:60,text:"Chapter Completed"}};const Mr=e=>`${_a.assetsFolder}/stories/${e}`,Lr={defaultCheckpoint:{key:"default-chap",path:Mr("defaultCheckpoint.txt")},awardsMapping:{key:"awards-mapping",path:Mr("awardsMapping.txt")},roomPreviewMapping:{key:"room-prev-mapping",path:Mr("roomPreviewMapping.txt")}},_r={defaultCheckpoint:{key:"mock-default-chap",path:"../assets/mockDefaultCheckpoint.txt"},awardsMapping:{key:"mock-awards-mapping",path:"../assets/mockAwardsMapping.txt"},roomPreviewMapping:{key:"mock-room-prev-mapping",path:"../assets/mockRoomPreviewMapping.txt"}};var Dr=Lr;var Gr=class{constructor(){this.soundAssets=void 0,this.mapAssets=void 0,this.locations=void 0,this.dialogues=void 0,this.objects=void 0,this.boundingBoxes=void 0,this.characters=void 0,this.actions=void 0,this.gameStartActions=void 0,this.checkpointCompleteActions=void 0,this.getLocationAtId=e=>On(this.locations.get(e),`Location ${e} was not found!`),this.getAssetByKey=e=>On(this.mapAssets.get(e),`Asset ${e} not found!`),this.soundAssets=[],this.mapAssets=new Map,this.locations=new Map,this.dialogues=new Map,this.objects=new Map,this.boundingBoxes=new Map,this.characters=new Map,this.actions=new Map,this.gameStartActions=[],this.checkpointCompleteActions=[]}addSoundAsset(e){this.soundAssets.push(e)}addMapAsset(e,t){this.mapAssets.set(e,t)}getMapAssets(){return this.mapAssets}addLocation(e,t){this.locations.set(e,t)}setModesAt(e,t){this.getLocationAtId(e).modes=new Set(t)}setNavigationFrom(e,t){this.getLocationAtId(e).navigation=new Set(t)}getNavigationFrom(e){return this.getLocationAtId(e).navigation}setGameStartActions(e){this.gameStartActions=e}setCheckpointCompleteActions(e){this.checkpointCompleteActions=e}getGameStartActions(){return this.gameStartActions}getCheckpointCompleteActions(){return this.checkpointCompleteActions}getLocations(){return this.locations}getObjectPropMap(){return this.objects}getBBoxPropMap(){return this.boundingBoxes}getDialogueMap(){return this.dialogues}getCharacterMap(){return this.characters}getActionMap(){return this.actions}getSoundAssets(){return this.soundAssets}setItemInMap(e,t,s){this[e].set(t,s)}addItemToLocation(e,t,s){this.getLocationAtId(e)[t].add(s)}setBGMusicAt(e,t){this.getLocationAtId(e).bgmKey=t}getLocationIds(){return Array.from(this.locations.keys())}getAssetKeyFromId(e){var t,s;return On((null===(t=this.objects.get(e))||void 0===t?void 0:t.assetKey)||(null===(s=this.locations.get(e))||void 0===s?void 0:s.assetKey),`Id ${e} not found!`)}};var Br=class{constructor(){this.objective=void 0,this.totalNumOfObjectives=void 0,this.numOfCompletedObjectives=void 0,this.objective=new Map,this.totalNumOfObjectives=0,this.numOfCompletedObjectives=0}setObjective(e,t){const s=this.objective.get(e);this.objective.set(e,t),void 0!==s&&s!==t&&this.numOfCompletedObjectives++}addObjective(e){this.objective.set(e,!1),this.totalNumOfObjectives++}addObjectives(e){e.forEach((e=>this.addObjective(e)))}isAllComplete(){return this.numOfCompletedObjectives>=this.totalNumOfObjectives}getObjectiveState(e){return this.objective.get(e)}getObjectives(){return this.objective}setObjectives(e){this.objective=e}};const Ur={small:pi.Small,medium:pi.Medium,large:pi.Large},Fr={left:hi.Left,middle:hi.Middle,right:hi.Right},Hr={talk:Ki.Talk,explore:Ki.Explore,move:Ki.Move,menu:Ki.Menu},Vr={navigation:Jn.navigation,talkTopics:Jn.talkTopics,objects:Jn.objects,boundingBoxes:Jn.boundingBoxes,characters:Jn.characters,actions:Jn.actions,bgmKey:Jn.bgmKey,collectibles:Jn.collectibles},qr={move_character:Qn.MoveCharacter,update_character:Qn.UpdateCharacter,obtain_collectible:Qn.ObtainCollectible,complete_objective:Qn.CompleteObjective,add_item:Qn.AddItem,remove_item:Qn.RemoveItem,change_background:Qn.ChangeBackground,start_animation:Qn.StartAnimation,stop_animation:Qn.StopAnimation,show_dialogue:Qn.ShowDialogue,add_mode:Qn.AddLocationMode,remove_mode:Qn.RemoveLocationMode,add_popup:Qn.AddPopup,make_object_glow:Qn.MakeObjectGlow,make_object_blink:Qn.MakeObjectBlink,play_bgm:Qn.PlayBGM,play_sfx:Qn.PlaySFX,preview_location:Qn.PreviewLocation,show_object_layer:Qn.ShowObjectLayer,navigate_to_assessment:Qn.NavigateToAssessment,delay:Qn.Delay},Xr={checklist:Kn.ChecklistState,userstate:Kn.UserState},$r={assessments:Yn.assessments,achievements:Yn.achievements,collectibles:Yn.collectibles};class Wr{static stringToSize(e){return Ur[e]||pi.Medium}static stringToPosition(e){return Fr[e]||hi.Middle}static stringToGameMode(e){return On(Hr[e],`Invalid location mode, ${e}`)}static stringToActionType(e){return On(qr[e],`Invalid action type, ${e}`)}static stringToGameStateStorage(e){return On(Xr[e],`Invalid condition type, ${e}`)}static stringToGameItemType(e){return On(Vr[e],`Invalid entity type, ${e}`)}static stringToBoolean(e){return"false"!==e}static stringToUserStateType(e){return On($r[e],`Invalid user state type ${e}`)}}let zr;!function(e){e.locations="locations",e.objectives="objectives",e.bgms="bgms",e.sfxs="sfxs"}(zr||(zr={}));class Kr{constructor(){this.gameItemAsserts=void 0,this.gameEntityAsserts=void 0,this.gameAnimAsserts=void 0,this.gameAnimMaps=[co.checkpoint.map.getLocations(),co.checkpoint.map[Jn.objects]],this.allItemIds=void 0,this.gameItemAsserts=new Map,this.gameEntityAsserts=new Map,this.gameAnimAsserts=[],this.allItemIds=new Set}registerId(e){if(this.allItemIds.has(e))throw new Error(`Duplicate item id ${e}`);this.allItemIds.add(e)}verifyAssertions(){this.verifyGameItemAssert(),this.verifyGameEntityAsserts(),this.verifyGameAnimAsserts()}assertItemType(e,t,s){e===Jn.talkTopics&&(e=Jn.dialogues),this.gameItemAsserts.get(e)||this.gameItemAsserts.set(e,[]),this.gameItemAsserts.get(e).push({itemId:t,actionType:s})}verifyGameItemAssert(){this.gameItemAsserts.forEach(((e,t)=>{e.forEach((e=>{const{itemId:s,actionType:a}=e;if(!co.checkpoint.map[t].has(s))throw a&&this.actionAssertionError(s,t,a),new Error(`Cannot find id "${s}" under ${t} entity type`)}))}))}assertItemTypes(e,t,s){t.forEach((t=>this.assertItemType(e,t,s)))}assertEntityType(e,t,s){this.gameEntityAsserts.get(e)||this.gameEntityAsserts.set(e,[]),this.gameEntityAsserts.get(e).push({itemId:t,actionType:s})}verifyGameEntityAsserts(){this.gameEntityAsserts.forEach(((e,t)=>{e.forEach((e=>{const{itemId:s,actionType:a}=e;switch(t){case zr.locations:co.checkpoint.map.getLocationAtId(s);break;case zr.objectives:if(void 0===co.checkpoint.objectives.getObjectives().get(s))throw a&&this.actionAssertionError(s,t,a),new Error(`Cannot find objective id "${s}"`);break;case zr.bgms:const e=co.checkpoint.map.getSoundAssets().filter((e=>e.soundType===hn.BGM&&e.key===s)).length;if(0===e)throw new Error(`Cannot find bgm key "${s}"`);if(e>1)throw new Error(`More than 1 bgm key "${s}"`);break;case zr.sfxs:const n=co.checkpoint.map.getSoundAssets().filter((e=>e.soundType===hn.SFX&&e.key===s)).length;if(0===n)throw new Error(`Cannot find sfx key "${s}"`);if(n>1)throw new Error(`More than 1 sfx key "${s}"`)}}))}))}assertAnimType(e,t){this.gameAnimAsserts.push({itemId:e,actionType:t})}verifyGameAnimAsserts(){this.gameAnimAsserts.forEach((e=>{const{itemId:t,actionType:s}=e;let a=!1;this.gameAnimMaps.forEach((e=>{e.get(t)&&(a=!0)})),a||this.actionAssertionError(t,"locationId or itemId",s)}))}actionAssertionError(e,t,s){throw new Error(`Expected type of "${t}" as argument for "${s}", obtained "${e}" which is either undefined or the wrong id.`)}}class Yr{static parseActions(e){return e.map((e=>this.parseAction(e)))}static parseAction(e){const[t,s]=gi.splitByChar(e,"if"),a=this.parseActionContent(t);return s&&(a.actionConditions=gi.splitByChar(s,"AND").map((e=>class{static parse(e){const t="!"===e[0];t&&(e=e.slice(1));const[s,...a]=gi.splitByChar(e,".");switch(Wr.stringToGameStateStorage(s)){case Kn.ChecklistState:return co.validator.assertEntityType(zr.objectives,a[0]),{state:Kn.ChecklistState,conditionParams:{id:a[0]},boolean:!t};case Kn.UserState:return{state:Kn.UserState,conditionParams:{userStateType:Wr.stringToUserStateType(a[0]),id:a[1]},boolean:!t};default:throw new Error("Parsing error: Invalid condition param")}}}.parse(e)))),co.checkpoint.map.setItemInMap(Jn.actions,a.interactionId,a),a.interactionId}static parseActionContent(e){const[t,s]=gi.splitByChar(e,"(");let a=!1,n=t;"*"===t[t.length-1]&&(a=!0,n=n.slice(0,-1));const i=Wr.stringToActionType(n),r=gi.splitByChar(s.slice(0,-1),","),o={};switch(i){case Qn.ObtainCollectible:o.id=r[0];break;case Qn.CompleteObjective:o.id=r[0],co.validator.assertEntityType(zr.objectives,r[0],n);break;case Qn.PreviewLocation:case Qn.ChangeBackground:o.id=r[0],co.validator.assertEntityType(zr.locations,r[0],n);break;case Qn.StartAnimation:o.id=r[0],o.startFrame=+r[1],o.frameRate=+r[2],o.assetCategory=r[3],co.validator.assertAnimType(r[0],n);break;case Qn.StopAnimation:o.id=r[0],co.validator.assertAnimType(r[0],n);break;case Qn.ShowDialogue:o.id=r[0],co.validator.assertItemType(Jn.dialogues,r[0],n);break;case Qn.AddItem:case Qn.RemoveItem:const e=Wr.stringToGameItemType(r[0]);o.gameItemType=e,o.locationId=r[1],co.validator.assertEntityType(zr.locations,r[1],n),o.id=r[2],co.validator.assertItemType(e,r[2],n);break;case Qn.AddLocationMode:case Qn.RemoveLocationMode:co.validator.assertEntityType(zr.locations,r[0],n),o.locationId=r[0],o.mode=Wr.stringToGameMode(r[1]);break;case Qn.AddPopup:co.validator.assertItemType(Jn.objects,r[0],n),o.id=r[0],o.position=Wr.stringToPosition(r[1]),r[2]&&(o.duration=1e3*parseInt(r[2])),r[3]&&(o.size=Wr.stringToSize(r[3]));break;case Qn.MakeObjectBlink:case Qn.MakeObjectGlow:co.validator.assertItemType(Jn.objects,r[0],n),o.id=r[0],o.turnOn=Wr.stringToBoolean(r[1]);break;case Qn.PlayBGM:o.id=r[0],co.validator.assertEntityType(zr.bgms,r[0],n);break;case Qn.PlaySFX:o.id=r[0],co.validator.assertEntityType(zr.sfxs,r[0],n);break;case Qn.ShowObjectLayer:o.show=Wr.stringToBoolean(r[0]);break;case Qn.UpdateCharacter:co.validator.assertItemType(Jn.characters,r[0],n),o.id=r[0],o.expression=r[1];break;case Qn.MoveCharacter:co.validator.assertItemType(Jn.characters,r[0],n),co.validator.assertEntityType(zr.locations,r[1],n),o.id=r[0],o.locationId=r[1],o.position=Wr.stringToPosition(r[2]);break;case Qn.NavigateToAssessment:o.assessmentId=r[0];break;case Qn.Delay:o.duration=1e3*parseInt(r[0])}return{actionType:i,actionParams:o,actionConditions:[],interactionId:co.generateActionId(),isInteractive:!1,isRepeatable:a}}}class Qr{static parsePrompt(e,t){return{promptTitle:e.split("prompt:")[1].trim(),choices:t.map(this.splitChoice)}}static splitChoice(e){const t=gi.splitWithLimit(e,"->",0);return[t[0].trim(),t[1].split(" ")[1].trim()]}}class Jr{static parse(e,t){t.forEach((t=>this.parseCharacterDetails(e,t)))}static characterAssetKey(e,t){return e+"-"+t}static characterAssetPath(e,t){return`/avatars/${e}/${e}.${t}.png`}static parseCharacterDetails(e,t){const s="+"===t[0];s&&(t=t.slice(1));const[a,n,i,r,o]=gi.splitByChar(t,",");co.validator.registerId(a);const c=new Map,d={id:a,name:n,expressions:c,defaultExpression:i,defaultPosition:Wr.stringToPosition(r),scale:o?parseFloat(o):1};c.set(i,this.characterAssetKey(a,i)),co.checkpoint.map.addMapAsset(this.characterAssetKey(a,i),{type:cn.Image,path:this.characterAssetPath(a,i),key:a}),co.checkpoint.map.setItemInMap(Jn.characters,a,d),s&&co.checkpoint.map.addItemToLocation(e,Jn.characters,a)}}class Zr{static parse(e){const[t,s,a]=gi.splitByChar(e.slice(1),","),n=Wr.stringToPosition(a);return this.addCharacterExprToMap(t,s),{speakerId:t,expression:s,speakerPosition:n}}static addCharacterExprToMap(e,t){if("you"===e||"narrator"===e)return;const s=co.checkpoint.map.getCharacterMap().get(e);if(!s)throw new Error(`Character "${e}" not in map`);const a=t||s.defaultExpression;s.expressions.set(t,Jr.characterAssetKey(e,t||a)),co.checkpoint.map.addMapAsset(Jr.characterAssetKey(e,a),{path:Jr.characterAssetPath(e,a),type:cn.Image,key:e})}}const eo=e=>new RegExp(/^[0-9]+$/).test(e),to=e=>new RegExp(/^goto [0-9]+$/).test(e),so=e=>e&&("\t"===e[0]||"    "===e.slice(0,4)),ao=e=>e&&"@"===e[0],no=e=>e.trim().startsWith("prompt:"),io=e=>new RegExp(/-> +goto/).test(e);class ro{static parse(e,t,s){t.forEach(((t,a)=>{const[n,i,r]=gi.splitByChar(t,",");co.validator.registerId(n),co.checkpoint.map.addSoundAsset({key:n,path:i,config:{volume:parseFloat(r),loop:s===hn.BGM},soundType:s}),s===hn.BGM&&0===a&&co.checkpoint.map.setBGMusicAt(e,n)}))}}class oo{static generateActionId(){return oo.actionIdNum++,`action#${oo.actionIdNum}`}static init(){oo.actionIdNum=0,oo.checkpoint={map:new Gr,startingLoc:"",objectives:new Br},oo.validator=new Kr}static parse(e,t=!1){t||oo.init();const s=gi.splitToLinesAndRemoveComments(e);gi.splitToParagraph(s).forEach((([e,t])=>{0===t.length&&e.includes(":")?oo.parseCheckpointConfig(e):oo.parseCheckpointParagraphs(e,t)||class{static parse(e,t){const s=co.checkpoint.map.getLocationAtId(e);gi.splitToParagraph(t).forEach((([e,t])=>{0===t.length&&e.includes(":")?this.parseLocationConfig(s,e):this.parseLocationParagraphs(s,e,t)}))}static parseLocationConfig(e,t){const[s,a]=gi.splitByChar(t,":"),n=gi.splitByChar(a,",");switch(s){case"modes":n.forEach((t=>{const s=Wr.stringToGameMode(t);e.modes.add(s)}));break;case"nav":n.forEach((t=>{co.validator.assertEntityType(zr.locations,t),e.navigation.add(t)}));break;case"talkTopics":const t=n;co.validator.assertItemTypes(Jn.dialogues,t),e.talkTopics=new Set(t);break;default:throw new Error(`Invalid config key "${s}" specified under location "${e.id}"`)}}static parseLocationParagraphs(e,t,s){switch(t){case"objects":(class{static parse(e,t){gi.splitToParagraph(t).forEach((([t,s])=>{const a=this.parseObjectConfig(e,t);s.length&&(a.isInteractive=!0,a.actionIds=Yr.parseActions(s))}))}static objectAssetKey(e){return e}static objectPath(e){return e}static parseObjectConfig(e,t){const s="+"===t[0];s&&(t=t.slice(1));const[a,n,i,r,o,c,d,l]=gi.splitByChar(t,",");co.validator.registerId(a);const u={assetKey:this.objectAssetKey(n),x:parseInt(i),y:parseInt(r),width:parseInt(o)||void 0,height:parseInt(c)||void 0,isInteractive:!1,interactionId:a};return co.checkpoint.map.addMapAsset(this.objectAssetKey(n),{type:cn[d]||cn.Image,key:a,path:this.objectPath(n),config:{frameHeight:parseInt(c)||-1,frameWidth:parseInt(o)||-1,centreX:0,centreY:0,endFrame:parseInt(l)-1||0,animType:dn.Object}}),co.checkpoint.map.setItemInMap(Jn.objects,a,u),s&&co.checkpoint.map.addItemToLocation(e,Jn.objects,a),u}}).parse(e.id,s);break;case"boundingBoxes":(class{static parse(e,t){gi.splitToParagraph(t).forEach((([t,s])=>{const a=this.parseBBoxConfig(e,t);s.length&&(a.isInteractive=!0,a.actionIds=Yr.parseActions(s))}))}static parseBBoxConfig(e,t){const s="+"===t[0];s&&(t=t.slice(1));const[a,n,i,r,o]=gi.splitByChar(t,","),c={x:parseInt(n),y:parseInt(i),width:parseInt(r),height:parseInt(o),isInteractive:!1,interactionId:a};return co.validator.registerId(a),co.checkpoint.map.setItemInMap(Jn.boundingBoxes,a,c),s&&co.checkpoint.map.addItemToLocation(e,Jn.boundingBoxes,a),c}}).parse(e.id,s);break;case"characters":Jr.parse(e.id,s);break;case"bgm":ro.parse(e.id,s,hn.BGM);break;case"sfx":ro.parse(e.id,s,hn.SFX);break;case"actions":e.actionIds=Yr.parseActions(s);break;default:throw new Error(`Invalid location paragraph header "${t}"`)}}}.parse(e,t)})),oo.validator.verifyAssertions()}static parseCheckpointConfig(e){const[t,s]=gi.splitByChar(e,":");switch(t){case"startingLoc":oo.validator.assertEntityType(zr.locations,s),oo.checkpoint.startingLoc=s;break;default:throw new Error(`Invalid checkpoint config key, "${e}"`)}}static parseCheckpointParagraphs(e,t){switch(e){case"objectives":oo.checkpoint.objectives.addObjectives(t);break;case"locations":(class{static parse(e){e.forEach((e=>{const[t,s,a,n,i]=gi.splitByChar(e,",");co.validator.registerId(t),co.checkpoint.map.addLocation(t,{id:"",name:"",assetKey:"",modes:new Set([]),navigation:new Set([]),talkTopics:new Set([]),objects:new Set([]),boundingBoxes:new Set([]),bgmKey:"",characters:new Set([]),id:t,name:a,assetKey:this.locationAssetKey(s)}),co.checkpoint.map.addMapAsset(this.locationAssetKey(s),{type:cn[n]||cn.Image,key:t,path:this.locationPath(s),config:{frameWidth:Da.x,frameHeight:Da.y,centreX:Ga.x,centreY:Ga.y,endFrame:parseInt(i)-1||0,animType:dn.Background}})}))}static locationAssetKey(e){return e}static locationPath(e){return e}}).parse(t);break;case"gameStartActions":oo.checkpoint.map.setGameStartActions(Yr.parseActions(t));break;case"checkpointCompleteActions":oo.checkpoint.map.setCheckpointCompleteActions(Yr.parseActions(t));break;case"dialogues":(class{static parse(e){gi.splitToParagraph(e).forEach((([e,t])=>{0!==t.length?this.parseDialogue(e,t):console.error("No dialogue found for dialogueId")}))}static parseDialogue(e,t){const[s,a]=gi.splitWithLimit(e,",",1);co.validator.registerId(s);const n={title:a,content:this.parseDialogueContent(t)};n.title||(n.title=gi.toCapitalizedWords(s)),co.checkpoint.map.setItemInMap(Jn.dialogues,s,n)}static parseDialogueContent(e){return function(e,t){const s=new Map;return e.forEach(((e,a)=>{const n=t(e,a);s.set(a,n)})),s}(gi.mapByHeader(e,eo),this.createDialogueLines)}static createDialogueLines(e){const t=[];let s=0;for(;s!==e.length;){const a=e[s];switch(!0){case to(a):t[t.length-1].goto=a.split(" ")[1];break;case no(a):const n=a,i=[];for(;e[s+1]&&io(e[s+1]);)s++,i.push(e[s].trim());const r=Qr.parsePrompt(n,i);t[t.length-1].prompt=r;break;case so(a):const o=t[t.length-1];!o.actionIds&&(o.actionIds=[]),o.actionIds.push(Yr.parseAction(a));break;case ao(a):s++;const c=e[s];if(!c)throw new Error("Parsing error: Cannot change speaker without next line");t.push({line:c}),t[t.length-1].speakerDetail=Zr.parse(a);break;default:t.push({line:a})}s++}return t}}).parse(t);break;default:return!1}return!0}}oo.checkpoint=void 0,oo.actionIdNum=void 0,oo.validator=void 0;var co=oo;async function lo(e,t,s){const a=$o.getInstance().getIsUsingMock()?_r:Dr,n=$o.getInstance().getCurrentSceneRef(),i=$o.getInstance().getGameChapters()[t].filenames[s];if(!i)return;await kr(n,i,i),await kr(n,a.defaultCheckpoint.key,a.defaultCheckpoint.path);const r=n.cache.text.get(i),o=n.cache.text.get(a.defaultCheckpoint.key);co.parse(o),co.parse(r,!0);const c=co.checkpoint;n.scene.start("GameManager",{gameCheckpoint:c,continueGame:e,chapterNum:t,checkpointNum:s})}async function uo(){const e=$o.getInstance().getCurrentSceneRef(),t=$o.getInstance().getSSChapterSimFilenames();if(!t.length)return void e.scene.start("StorySimulatorMenu");const s=t.pop();await kr(e,s,Mr(s)),await kr(e,Dr.defaultCheckpoint.key,Dr.defaultCheckpoint.path);const a=e.cache.text.get(s),n=e.cache.text.get(Dr.defaultCheckpoint.key);co.parse(n),co.parse(a,!0);const i=co.checkpoint;return e.scene.start("GameManager",{gameCheckpoint:i,chapterNum:-1,checkpointNum:-1}),!0}function ho(e,{title:t,imageUrl:s},a){const[n,i]=[Ga.x+Rr.imageDist*a,Ga.y];const r=new Phaser.GameObjects.Container(e,n,i),o=a<=$o.getInstance().getSaveManager().getLargestCompletedChapterNum(),c=new Phaser.GameObjects.Image(e,0,0,s).setDisplaySize(Rr.imageRect.width,Rr.imageRect.height),d=new Phaser.GameObjects.Sprite(e,Rr.frame.xOffset,Rr.frame.yOffset,ln.chapterSelectFrame.key).setScale(.99),l=new Phaser.GameObjects.Rectangle(e,0,Rr.chapComplete.y,Rr.imageRect.width,Rr.chapComplete.height,0).setOrigin(.5).setAlpha(.7).setInteractive().setVisible(o),u=za(e,Rr.chapComplete.text,{x:0,y:Rr.chapComplete.y,oriX:.5,oriY:.5},Nr).setVisible(o),h=new Wa(e,Rr.button.xOffset+10,Rr.button.yOffset-50,"Reset progress"),p=new Wa(e,10-Rr.button.xOffset,Rr.button.yOffset-50,"Play/Continue"),g=Fn(e,{assetKey:ln.chapterRepeatButton.key,onUp:async()=>await lo(!1,a,0),onHover:()=>h.setVisible(!0),onOut:()=>h.setVisible(!1)}).setPosition(Rr.button.xOffset,Rr.button.yOffset),m=$o.getInstance().getSaveManager().getChapterSaveState(a).lastCheckpointPlayed,b=Fn(e,{assetKey:ln.chapterContinueButton.key,onUp:async()=>await lo(!0,a,m),onHover:()=>p.setVisible(!0),onOut:()=>p.setVisible(!1)}).setPosition(-Rr.button.xOffset,Rr.button.yOffset),j=za(e,`Chapter ${a}`,Rr.indexTextConfig,Nr),y=za(e,t,Rr.titleTextConfig,Pr),O=a<=$o.getInstance().getSaveManager().getLargestCompletedChapterNum()+1,v=new Phaser.GameObjects.Rectangle(e,0,0,Rr.imageRect.width,Rr.imageRect.height,0).setOrigin(.5).setAlpha(O?0:.8).setInteractive();return r.add([c,d,l,u,g,b,h,p,j,y,v]),r}class po extends Phaser.Scene{constructor(){super("ChapterSelect"),this.layerManager=void 0,this.chapterContainer=void 0,this.backButtonContainer=void 0,this.autoScrolling=void 0,this.isScrollLeft=void 0,this.isScrollRight=void 0,this.getGameChapters=()=>$o.getInstance().getGameChapters(),this.getLayerManager=()=>On(this.layerManager),this.chapterContainer=void 0,this.backButtonContainer=void 0,this.autoScrolling=!0,this.isScrollLeft=!1,this.isScrollRight=!1}preload(){xi(this)}async create(){$o.getInstance().setCurrentSceneRef(this),this.layerManager=new Mi(this),await this.preloadChapterAssets(),this.renderBackground(),this.renderChapters(),this.autoScroll()}update(){if(!this.chapterContainer||this.autoScrolling)return;let e=this.chapterContainer.x;this.isScrollRight?e-=Rr.scrollSpeed:this.isScrollLeft&&(e+=Rr.scrollSpeed),this.chapterContainer.x=jn(e,-Rr.imageDist*(this.getGameChapters().length-1),0)}cleanUp(){this.getLayerManager().clearAllLayers()}async preloadChapterAssets(){await Promise.all(this.getGameChapters().map((async e=>await Tr(this,e.imageUrl,yn(e.imageUrl)))))}renderBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,ln.spaceshipBg.key),t=new Phaser.GameObjects.Rectangle(this,Ga.x,Ga.y,Da.x,Da.y,0).setAlpha(.3);this.getLayerManager().addToLayer(gn.Background,e),this.getLayerManager().addToLayer(gn.Background,t)}renderChapters(){this.backButtonContainer=new $i(this,(()=>{this.cleanUp(),this.scene.start("MainMenu")})),this.chapterContainer=this.createChapterContainer();const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,ln.chapterSelectBorder.key),t=Fn(this,{assetKey:ln.chapterSelectArrow.key,onDown:()=>this.isScrollLeft=!0,onUp:()=>this.isScrollLeft=!1,onOut:()=>this.isScrollLeft=!1}).setPosition(Ga.x-Rr.arrow.xOffset,Ga.y),s=Fn(this,{assetKey:ln.chapterSelectArrow.key,onDown:()=>this.isScrollRight=!0,onUp:()=>this.isScrollRight=!1,onOut:()=>this.isScrollRight=!1}).setPosition(Ga.x+Rr.arrow.xOffset,Ga.y).setScale(-1,1);this.getLayerManager().addToLayer(gn.UI,this.chapterContainer),this.getLayerManager().addToLayer(gn.UI,this.backButtonContainer),this.getLayerManager().addToLayer(gn.UI,e),this.getLayerManager().addToLayer(gn.UI,t),this.getLayerManager().addToLayer(gn.UI,s)}createChapterContainer(){const e=new Phaser.GameObjects.Container(this,0,0);return e.add(this.getGameChapters().map(((e,t)=>ho(this,e,t)))),e}async autoScroll(){const e=Math.min($o.getInstance().getSaveManager().getLargestCompletedChapterNum()+1,this.getGameChapters().length-1);await this.scrollToIndex(e),this.autoScrolling=!1}async scrollToIndex(e){if(!this.chapterContainer)return;const t=-e*Rr.imageDist;this.tweens.add({targets:this.chapterContainer,x:t,ease:"Power2",duration:800}),await bn(800)}}var go=po;const mo={key:La.alienCowsFont.key,size:80,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},bo=1500;var jo={text:{chapter:"Chapter completed.",checkpoint:"Checkpoint reached."},transitionTextConfig:{x:Ga.x,y:Ga.y,oriX:.5,oriY:.5},tweenDuration:bo,entryTween:{alpha:1,duration:bo,ease:"Power2"},exitTween:{alpha:0,duration:bo,ease:"Power2"}};class yo extends Phaser.Scene{constructor(){super("CheckpointTransition")}preload(){$o.getInstance().setCurrentSceneRef(this)}async create(){if($o.getInstance().isGameType(Xo.Simulator))return await this.showTransitionText(jo.text.checkpoint),void await uo();const e=$o.getInstance().getSaveManager().getFullSaveState(),t=$o.getInstance().getGameChapters(),[s,a]=e.userSaveState.recentlyPlayedCheckpoint;return this.isLastCheckpoint(t,s,a)?(await $o.getInstance().getSaveManager().saveChapterComplete(s),await this.showTransitionText(jo.text.chapter),this.isLastChapter(t,s)?void this.scene.start("ChapterSelect"):void await lo(!0,s+1,0)):(await this.showTransitionText(jo.text.checkpoint),void await lo(!1,s,a+1))}async showTransitionText(e){const t=za(this,e,jo.transitionTextConfig,mo).setAlpha(0);this.add.existing(t),this.tweens.add({targets:t,...jo.entryTween}),await bn(2*jo.tweenDuration),this.tweens.add({targets:t,...jo.exitTween}),await bn(jo.tweenDuration)}isLastCheckpoint(e,t,s){return s>=e[t].filenames.length-1}isLastChapter(e,t){return t>=e.length-1}}var Oo=yo;const vo={key:La.zektonFont.key,size:30,align:Phaser.GameObjects.BitmapText.ALIGN_RIGHT};var xo={text:{chapterSelect:"Play Chapter",studentRoom:"Go to My Room",awards:"Awards Hall",settings:"Settings",bindings:"Key Bindings"},button:{ySpace:.5*Da.y},buttonTextConfig:{x:600,y:0,oriX:1,oriY:.1},banner:{xHide:300},onFocusTween:{x:Ga.x+200,duration:200,ease:"Power2"},outFocusTween:{x:Ga.x+300,duration:200,ease:"Power2"},saBanner:{x:.3*Da.x,y:.9*Da.y}};class fo extends Phaser.Scene{constructor(){super("MainMenu"),this.layerManager=void 0,this.getLayerManager=()=>On(this.layerManager)}async create(){$o.getInstance().setCurrentSceneRef(this),this.layerManager=new Mi(this),this.renderBackground(),this.renderOptionButtons(),mr(this,"T",1.12*Ga.x,1.1*Ga.y),$o.getInstance().getSoundManager().playBgMusic(pn.galacticHarmony.key)}renderBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,ln.spaceshipBg.key).setDisplaySize(Da.x,Da.y),t=Sn(this).setAlpha(.15),s=new Phaser.GameObjects.Image(this,xo.saBanner.x,xo.saBanner.y,ln.saBanner.key).setAlpha(.7);this.getLayerManager().addToLayer(gn.Background,e),this.getLayerManager().addToLayer(gn.Background,t),this.getLayerManager().addToLayer(gn.Background,s)}renderOptionButtons(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getOptionButtons(),s=Ha({direction:Fa.Column,numOfItems:t.length,maxYSpace:xo.button.ySpace});e.add(t.map(((e,t)=>this.createOptionButton(e.text,s[t][0]+xo.banner.xHide,s[t][1],e.callback)))),this.getLayerManager().addToLayer(gn.UI,e)}createOptionButton(e,t,s,a){const n=e=>{this.tweens.add({targets:e,...xo.onFocusTween})},i=e=>{this.tweens.add({targets:e,...xo.outFocusTween})},r=Fn(this,{assetKey:ln.mainMenuOptBanner.key,message:e,textConfig:xo.buttonTextConfig,bitMapTextStyle:vo,onUp:a,onHover:()=>n(r),onOut:()=>i(r),onHoverEffect:!1}).setPosition(t,s);return r}getOptionButtons(){return[{text:xo.text.chapterSelect,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("ChapterSelect")}},{text:xo.text.awards,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("AwardsHall")}},{text:xo.text.studentRoom,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("RoomPreview")}},{text:xo.text.settings,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("Settings")}},{text:xo.text.bindings,callback:()=>{this.getLayerManager().clearAllLayers(),this.scene.start("Bindings")}}]}}var So=fo,Co=s(73);const wo='\nimport { prepend_remote_url, get_screen_width, get_screen_height, load_image, create_image, create_text, create_rect, add, set_display_size, set_alpha, set_origin } from \'game\';\n\nfunction preload() {\n    load_image("galaxy", prepend_remote_url("/locations/galaxy/normal.png"));\n}\n\nfunction create() {\n    const width = get_screen_width();\n    const height = get_screen_height();\n    const centre_x = width / 2;\n    const centre_y = height / 2;\n\n    const image = create_image(centre_x, centre_y, "galaxy");\n    const image_resized = set_display_size(image, width, height);\n\n    const black_tint = create_rect(centre_x, centre_y, width, height, 0x000011);\n    const black_tint_alpha = set_alpha(black_tint, 0.5);\n\n    const text = create_text(centre_x, centre_y, "Unable to fetch mission!");\n    const text_repos = set_origin(text, 0.5, 0.5);\n\n    add(image_resized);\n    add(black_tint_alpha);\n    add(text_repos);\n}\n\nfunction update() {}\n',Eo={key:La.pixelFont.key,size:20,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER},Ao="MYROOM",Io="VERIFIED",To={width:128,height:50},ko={x:64,y:0,oriX:.5,oriY:.55};var No=s(32);async function Po(){const e=await async function(){const e=(await Object(No.m)($o.getInstance().getAccountInfo())||[]).find((e=>e.number===Ao));return e?e.id:0}();return function(e){if(e){const t=e.questions[0],s=t.answer;return s||t.solutionTemplate}return wo}(await Object(No.l)(e,$o.getInstance().getAccountInfo()))}class Ro extends Phaser.Scene{constructor(){super("RoomPreview"),this.layerManager=void 0,this.inputManager=void 0,this.phaseManager=void 0,this.escapeManager=void 0,this.awardManager=void 0,this.studentCode=void 0,this.preloadImageMap=void 0,this.preloadSoundMap=void 0,this.preloadSpritesheetMap=void 0,this.verifCont=void 0,this.context=void 0,this.getVerifCont=()=>On(this.verifCont),this.getUserStateManager=()=>$o.getInstance().getUserStateManager(),this.getInputManager=()=>On(this.inputManager),this.getLayerManager=()=>On(this.layerManager),this.getPhaseManager=()=>On(this.phaseManager),this.getEscapeManager=()=>On(this.escapeManager),this.getAwardManager=()=>On(this.awardManager),this.preloadImageMap=new Map,this.preloadSoundMap=new Map,this.preloadSpritesheetMap=new Map,this.studentCode=wo}init(){$o.getInstance().setCurrentSceneRef(this),this.studentCode=$o.getInstance().getRoomCode(),this.createContext()}preload(){xi(this),this.verifCont=(e=>{const t=new Phaser.GameObjects.Container(e,0,0),s=new Phaser.GameObjects.Rectangle(e,0,0,To.width,To.height,Ua.darkBlue).setOrigin(0,.5).setAlpha(.8),a=new Phaser.GameObjects.Sprite(e,0,0,ln.verifiedFrame.key).setOrigin(0,.5),n=new Phaser.GameObjects.Rectangle(e,0,.5*-s.height,s.width,.05*s.height,Ua.offWhite).setOrigin(0,0),i=za(e,Io,ko,Eo).setBlendMode(Phaser.BlendModes.DIFFERENCE);return e.tweens.add({targets:n,alpha:.2,y:.35*s.height,duration:2e3,ease:"Power0",yoyo:!0,loop:-1}),t.add([s,i,n,a]),t.setVisible(!1),t})(this)}async create(){await this.eval(this.studentCode),this.renderDefaultBackground(),await this.eval("preload();"),await Promise.all(Array.from(this.preloadImageMap).map((async([e,t])=>{await Tr(this,e,t)}))),await Promise.all(Array.from(this.preloadSoundMap).map((async([e,t])=>{var s,a,n;await(s=this,a=e,n=t,new Promise((e=>{null!==s.sound.get(a)?e(a):(s.load.audio(a,n),s.load.once(`filecomplete-sound-${a}`,e),s.load.start())})))}))),await Promise.all(Array.from(this.preloadSpritesheetMap).map((async([e,[t,s]])=>{await((e,t,s,a)=>new Promise((n=>{"__MISSING"!==e.textures.get(t).key?n(t):(e.load.spritesheet(t,s,a),e.load.once(`filecomplete-spritesheet-${t}`,n),e.load.once("loaderror",n),e.load.start())})))(this,e,t,s)}))),await this.eval("create();"),$o.getInstance().getSoundManager().playBgMusic(_a.nullInteractionId),this.initialiseManagers(),this.bindKeyboardTriggers(),this.getLayerManager().addToLayer(gn.UI,this.getVerifCont())}update(){this.context.nativeStorage.globals=this.context.nativeStorage.globals.previousScope,this.eval("update();")}createContext(){this.context=Object(Co.a)(4,[],"playground","default",{scene:this,phaser:Phaser,preloadImageMap:this.preloadImageMap,preloadSoundMap:this.preloadSoundMap,preloadSpritesheetMap:this.preloadSpritesheetMap,remotePath:_a.assetsFolder,screenSize:Da,createAward:(e,t,s)=>this.createAward(e,t,s)})}async eval(e){await Object(Qt.runInContext)(e,this.context)}bindKeyboardTriggers(){this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.ESC,"up",(async()=>{this.getPhaseManager().isCurrentPhase($n.EscapeMenu)?await this.getPhaseManager().popPhase():await this.getPhaseManager().pushPhase($n.EscapeMenu)})),this.getInputManager().registerKeyboardListener(Phaser.Input.Keyboard.KeyCodes.TAB,"up",(async()=>{this.getPhaseManager().isCurrentPhase($n.AwardMenu)?await this.getPhaseManager().popPhase():await this.getPhaseManager().pushPhase($n.AwardMenu)}))}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}createAward(e,t,s){const a=this.getUserStateManager().getAchievements(),n=this.getUserStateManager().getCollectibles();if(a.includes(s)||n.includes(s)){const a=on(s),n=new Phaser.GameObjects.Sprite(this,e,t,a.assetKey);return this.attachVerificationTag(n)}return new Phaser.GameObjects.Sprite(this,e,t,ln.cookies.key)}attachVerificationTag(e){const t=this.getVerifCont();return e.setInteractive({pixelPerfect:!0,useHandCursor:!0}),e.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OVER,(()=>t.setVisible(!0))),e.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>t.setVisible(!1))),e.addListener(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,(e=>{t.x=e.x+10,t.y=e.y-10})),e}renderDefaultBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,this.getDefaultBackgroundKey());ni(e,Da.x,Da.y),this.add.existing(e)}getDefaultBackgroundKey(){const e=this.getUserStateManager().getAssessments().reverse(),t=$o.getInstance().getRoomPreviewMapping();for(let s=0;s<e.length;s++)if(t.has(e[s]))return e[s];return ln.sourceCrashedPod.key}initialiseManagers(){this.layerManager=new Mi(this),this.inputManager=new Ri(this),this.phaseManager=new Di(new Map([[$n.None,new ar]]),this.inputManager),this.escapeManager=new Pi(this),this.awardManager=new ri(this)}}class Mo extends Phaser.Scene{constructor(){super("Settings"),this.bgmVolumeRadioButtons=void 0,this.sfxVolumeRadioButtons=void 0,this.layerManager=void 0,this.getSaveManager=()=>$o.getInstance().getSaveManager(),this.getLayerManager=()=>On(this.layerManager)}async create(){$o.getInstance().setCurrentSceneRef(this),this.layerManager=new Mi(this),this.renderBackground(),this.renderOptions()}renderBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,ln.spaceshipBg.key),t=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,ln.settingBanner.key);this.getLayerManager().addToLayer(gn.Background,e),this.getLayerManager().addToLayer(gn.Background,t)}renderOptions(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getSettingsHeader(),s=Ha({direction:Fa.Column,numOfItems:t.length,maxYSpace:Ai.opt.ySpace});e.add(t.map(((e,t)=>this.createOptionHeader(e,s[t][1]))));const{bgmVolume:a,sfxVolume:n}=this.getSaveManager().getSettings(),i=Ai.volContainerOpts.findIndex((e=>parseFloat(e)===n)),r=Ai.volContainerOpts.findIndex((e=>parseFloat(e)===a));this.sfxVolumeRadioButtons=this.createOptRadioOptions(i,s[0][1]),this.bgmVolumeRadioButtons=this.createOptRadioOptions(r,s[1][1]);const o=Fn(this,{assetKey:ln.mediumButton.key,message:"Apply Settings",textConfig:{x:0,y:0,oriX:.33,oriY:.85},bitMapTextStyle:Ei,onUp:()=>this.applySettings()}).setPosition(Ga.x,.925*Da.y),c=new $i(this,(()=>{this.getLayerManager().clearAllLayers(),this.scene.start("MainMenu")}));this.getLayerManager().addToLayer(gn.UI,e),this.getLayerManager().addToLayer(gn.UI,this.sfxVolumeRadioButtons),this.getLayerManager().addToLayer(gn.UI,this.bgmVolumeRadioButtons),this.getLayerManager().addToLayer(gn.UI,o),this.getLayerManager().addToLayer(gn.UI,c)}getSettingsHeader(){return["SFX","BGM"]}createOptionHeader(e,t){const s=new Phaser.GameObjects.Container(this,0,t),a=new Phaser.GameObjects.Image(this,Ga.x,0,ln.settingOption.key),n=za(this,e,Ai.optHeaderTextConfig,wi);return s.add([a,n]),s}createOptRadioOptions(e,t){return new Si(this,{choices:Ai.volContainerOpts,defaultChoiceIdx:e,maxXSpace:Ai.opt.xSpace,choiceTextConfig:Ai.radioButtonsTextConfig,bitmapTextStyle:Ci},Ai.opt.x,-Ga.y+t)}async applySettings(){const e=this.sfxVolumeRadioButtons?parseFloat(this.sfxVolumeRadioButtons.getChosenChoice()):1,t=this.bgmVolumeRadioButtons?parseFloat(this.bgmVolumeRadioButtons.getChosenChoice()):1;await this.getSaveManager().saveSettings({bgmVolume:t,sfxVolume:e}),$o.getInstance().getSoundManager().applyUserSettings(this.getSaveManager().getSettings())}}var Lo=Mo;var _o=class{constructor(){this.soundAssetMap=void 0,this.bgmVol=void 0,this.sfxVol=void 0,this.currBgMusicKey=void 0,this.currBgMusic=void 0,this.getBaseSoundManager=()=>this.getCurrentScene().sound,this.getCurrentScene=()=>On($o.getInstance().getCurrentSceneRef()),this.soundAssetMap=new Map,this.bgmVol=1,this.sfxVol=1,this.currBgMusicKey=_a.nullInteractionId}applyUserSettings(e){if(this.bgmVol=void 0!==e.bgmVolume?e.bgmVolume:1,this.sfxVol=void 0!==e.sfxVolume?e.sfxVolume:1,this.currBgMusic&&this.currBgMusic.isPlaying){const e=On(this.getSoundAsset(this.currBgMusicKey)),t=void 0!==e.config.volume?e.config.volume:1;this.currBgMusic.setVolume(t*this.bgmVol)}}addSoundAsset(e){this.soundAssetMap.set(e.key,e)}getSoundAsset(e){return this.soundAssetMap.get(e)}loadSounds(e){e.forEach((e=>{this.addSoundAsset(e),this.loadSound(e.key,yn(e.path))}))}loadSoundAssetMap(e){Object.values(e).forEach((e=>{this.addSoundAsset(e),this.loadSound(e.key,yn(e.path))}))}loadSound(e,t){this.getCurrentScene().load.audio(e,t)}playSound(e){const t=this.getSoundAsset(e);if(t){const e=void 0!==t.config.volume?t.config.volume:1;this.getBaseSoundManager().play(t.key,{...t.config,volume:e*this.sfxVol})}}playBgMusic(e,t){if(!$o.getInstance().isMounted)return;if(this.currBgMusicKey===e)return;if(e===_a.nullInteractionId&&this.currBgMusic)return this.fadeOutAndDestroyMusic(this.currBgMusic,t),this.currBgMusic=void 0,void(this.currBgMusicKey=e);this.currBgMusic&&this.fadeOutAndDestroyMusic(this.currBgMusic);const s=On(this.getSoundAsset(e)),a=void 0!==s.config.volume?s.config.volume:1;this.currBgMusic=this.getBaseSoundManager().add(s.key,{...s.config,volume:a*this.bgmVol}),this.currBgMusicKey=s.key,this.currBgMusic.play()}fadeOutAndDestroyMusic(e,t=1e3){this.getCurrentScene().tweens.add({targets:e,...un,duration:t}),setTimeout((()=>e.destroy()),2*t)}stopAllSound(){this.getBaseSoundManager().stopAll()}pauseCurrBgMusic(){this.getCurrentScene()&&this.currBgMusic&&this.currBgMusic.isPlaying&&this.currBgMusic.pause()}continueCurrBgMusic(){this.getCurrentScene()&&this.currBgMusic&&this.currBgMusic.isPaused&&this.currBgMusic.play()}};var Do=[{title:"Spaceship Emergency",imageUrl:"/locations/planet-y-orbit/crashing.png",filenames:["../assets/mockChapter0.txt","../assets/mockChapter0.1.txt"]},{title:"Alien Attack",imageUrl:"/locations/telebay/emergency.png",filenames:["../assets/mockChapter1.txt"]},{title:"Jedi Master",imageUrl:"/locations/classroom/normal.png",filenames:["../assets/mockChapter2.txt"]}];class Go{static parse(e){Go.awardsMapping=new Map;const t=gi.splitToLines(e);return gi.splitToParagraph(t).forEach((([,e])=>{Go.parseAwardParagraphs(e)})),this.awardsMapping}static parseAwardParagraphs(e){gi.splitToParagraph(e).forEach((([e,t])=>{const[s,a,n,i]=gi.splitWithLimit(t[0],",",3);Go.awardsMapping.set(e,{id:e,assetKey:s,assetPath:yn(a),title:n,description:i,completed:!0})}))}}Go.awardsMapping=void 0;var Bo=Go;class Uo{static parse(e){Uo.backgroundMapping=new Map;const t=gi.splitToLines(e);return gi.splitToParagraph(t).forEach((([e,t])=>{Uo.backgroundMapping.set(e,yn(t[0]))})),Uo.backgroundMapping}}Uo.backgroundMapping=void 0;var Fo=Uo;class Ho extends Phaser.Scene{constructor(){super("Entry")}preload(){$o.getInstance().setCurrentSceneRef(this),this.preloadAssets(),xi(this)}async create(){await $o.getInstance().loadGameChapters(),await $o.getInstance().loadRoomCode(),await $o.getInstance().getSaveManager().loadLastSaveState(),await $o.getInstance().getUserStateManager().loadUserState(),await this.preloadAwards(),await this.preloadRoomPreviewBackgrounds(),this.applyLoadedSettings(),this.scene.start("MainMenu")}applyLoadedSettings(){const e=$o.getInstance().getSaveManager().getSettings();$o.getInstance().getSoundManager().applyUserSettings(e)}async preloadAwards(){const e=this.cache.text.get(Dr.awardsMapping.key),t=Bo.parse(e);$o.getInstance().setAwardsMapping(t),await Promise.all(Array.from(t.values()).map((async e=>await Tr(this,e.assetKey,e.assetPath))))}async preloadRoomPreviewBackgrounds(){const e=this.cache.text.get(Dr.roomPreviewMapping.key),t=Fo.parse(e);$o.getInstance().setRoomPreviewMapping(t),await Promise.all(Array.from(t.entries()).map((async([e,t])=>await Tr(this,e,t))))}preloadAssets(){$o.getInstance().getSoundManager().loadSoundAssetMap(pn),Object.values(ln).forEach((e=>this.load.image(e.key,yn(e.path)))),Object.values(La).forEach((e=>this.load.bitmapFont(e.key,e.pngPath,e.fntPath))),Object.values(Dr).forEach((e=>this.load.text(e.key,e.path)))}}var Vo=Ho;class qo{constructor(){this.collectibles=void 0,this.achievements=void 0,this.assessments=void 0,this.getCollectibles=()=>Array.from(this.collectibles),this.getAchievements=()=>Array.from(this.achievements),this.getAssessments=()=>Array.from(this.assessments),this.collectibles=new Set([]),this.achievements=new Set([]),this.assessments=new Set([])}async loadUserState(){$o.getInstance().isGameType(Xo.Simulator)||(await this.loadAchievements(),await this.loadAssessments(),this.collectibles=new Set($o.getInstance().getSaveManager().getLoadedUserState().collectibles))}addCollectible(e){this.collectibles.add(e)}async loadAssessments(){const e=await Object(No.m)($o.getInstance().getAccountInfo());this.assessments=new Set((e||[]).filter((e=>"submitted"===e.status)).sort(((e,t)=>e.closeAt<=t.closeAt?-1:1)).map((e=>e.id.toString())))}async isInUserState(e,t){if($o.getInstance().isGameType(Xo.Game))return this[e].has(t);return 0===await Xn(zn.getInstance().getGameManager(),`${gi.capitalize(e)} ${t}?`,["Yes","No"])}async loadAchievements(){const e=$o.getInstance().getAchievements(),t=$o.getInstance().getGoals(),s=new Map;t.forEach((e=>s.set(e.uuid,e))),e.forEach((e=>{const t=e.uuid.toString(),a=e.goalUuids.reduce(((e,t)=>e&&s.get(t).completed),!0),n=on(t);let i;i=n?{...n,completed:a}:{id:t,assetKey:_a.nullInteractionId,assetPath:_a.nullInteractionId,title:e.title,description:e.view.description,completed:a},$o.getInstance().addAwardMapping(t,i),this.achievements.add(t)}))}}let Xo;!function(e){e.Simulator="Simulator",e.Game="Game"}(Xo||(Xo={}));class $o extends Ma.Game{constructor(e,t){super(e),this.global=void 0,this.isMounted=void 0,this.getAwardsMapping=()=>On(this.global.awardsMapping),this.getAccountInfo=()=>On(this.global.accountInfo),this.getAchievements=()=>On(this.global.achievements),this.getSoundManager=()=>On(this.global.soundManager),this.getGoals=()=>On(this.global.goals),this.getRoomPreviewMapping=()=>On(this.global.roomPreviewMapping),this.getUserStateManager=()=>On(this.global.userStateManager),this.getSaveManager=()=>On(this.global.saveManager),this.getCurrentSceneRef=()=>On(this.global.currentSceneRef),this.isGameType=e=>this.global.gameType===e,this.getSSChapterSimFilenames=()=>this.global.ssChapterSimFilenames,this.getIsUsingMock=()=>this.global.isUsingMock,this.getRoomCode=()=>this.global.roomCode,this.getGameChapters=()=>this.global.isUsingMock?Do:this.global.gameChapters,$o.instance=this,this.isMounted=!0,this.global={awardsMapping:new Map,accountInfo:void 0,achievements:void 0,currentSceneRef:void 0,gameChapters:[],gameType:t,goals:void 0,isUsingMock:!1,roomCode:"",roomPreviewMapping:new Map,saveManager:new dr,setStorySimState:_a.nullFunction,soundManager:new _o,ssChapterSimFilenames:[],userStateManager:new qo}}stopAllSounds(){this.sound.stopAll()}setAccountInfo(e){this.global.accountInfo=e}setAchievements(e){this.global.achievements=e}setAwardsMapping(e){this.global.awardsMapping=e}addAwardMapping(e,t){this.global.awardsMapping.set(e,t)}setGoals(e){this.global.goals=e}setStorySimStateSetter(e){this.setStorySimState=e}setRoomPreviewMapping(e){this.global.roomPreviewMapping=e}async loadGameChapters(){this.global.gameChapters=await async function(){const e=await Object(No.M)("stories","GET",{accessToken:$o.getInstance().getAccountInfo().accessToken,refreshToken:$o.getInstance().getAccountInfo().refreshToken,shouldAutoLogout:!1,shouldRefresh:!0});if(!e)return[];const t=200===e.status?await e.json():[],s=v.a.sortBy(t,(e=>new Date(e.openAt)));return s.forEach((e=>e.filenames=e.filenames.map(Mr))),s}()}async loadRoomCode(){this.global.roomCode=await Po()}setStorySimState(e){this.global.setStorySimState(e)}setCurrentSceneRef(e){this.global.currentSceneRef=e}toggleUsingMock(e){this.global.isUsingMock=void 0===e?!this.global.isUsingMock:e}setChapterSimStack(e){this.global.ssChapterSimFilenames=e.reverse()}}$o.instance=void 0,$o.getInstance=()=>On($o.instance);const Wo={debug:!0,type:Ma.CANVAS,width:Da.x,height:Da.y,physics:{default:"arcade"},scale:{mode:Ma.Scale.FIT,parent:"game-display"},fps:{target:24},scene:[Vo,So,Lo,go,cr,Oo,Sr,Ro,Ir]};async function zo(e){if("student"!==$o.getInstance().getAccountInfo().role)return;const t={method:"PUT",headers:Ko($o.getInstance().getAccountInfo().accessToken),body:JSON.stringify({gameStates:e})},s=await fetch(`${y.b.backendUrl}/v1/user/game_states`,t);return s&&s.ok?s:void 0}function Ko(e){const t=new Headers;return t.append("Accept","application/json"),t.append("Authorization",`Bearer ${e}`),t.append("Content-Type","application/json"),t}var Yo=function(){const e=Object(d.f)((e=>e.session)),[t,s]=m.useState(!1),[n,i]=m.useState(!1);return m.useEffect((()=>{const e=new $o(Wo,Xo.Game);return()=>{e.isMounted=!1,e.stopAllSounds(),e.destroy(!0)}}),[]),m.useEffect((()=>{$o.getInstance().setAccountInfo(e),$o.getInstance().setAchievements([]),$o.getInstance().setGoals([])}),[e]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{id:"game-display"}),t&&Object(a.jsxs)("div",{className:"Horizontal",children:[Object(a.jsx)("button",{onClick:async()=>{await zo({}),alert("Game cleared! Please refresh")},children:"Clear data"}),Object(a.jsx)("button",{onClick:()=>{i(!n),$o.getInstance().toggleUsingMock()},children:n?"Use Game Chapters":"Use Mock Chapters"})]})]})},Qo=s(388);function Jo(e){return t=>Object(a.jsx)(K.a,{onClick:s=>{try{e.onClick&&e.onClick(s)}catch(a){throw s.preventDefault(),a}s.defaultPrevented||0!==s.button||e.target&&"_self"!==e.target||s.metaKey||s.altKey||s.ctrlKey||s.shiftKey||(s.preventDefault(),t.navigate())},href:t.href,...e})}function Zo({to:e,replace:t,...s}){return Object(a.jsx)(lt.a,{to:e,replace:t,component:Jo(s)})}class ec extends m.Component{constructor(e){super(e),this.handleConfirmUnsubmit=async()=>{await Object(ee.a)({contents:"Are you sure you want to unsubmit?",positiveIntent:"danger",positiveLabel:"Unsubmit"})&&this.props.handleUnsubmitSubmission(this.props.data.submissionId)},this.handleConfirmReautograde=async()=>{await Object(ee.a)({contents:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("p",{children:"Reautograde this submission?"}),Object(a.jsx)("p",{children:"Note: all manual adjustments will be reset to 0."})]}),positiveIntent:"danger",positiveLabel:"Reautograde"})&&this.props.handleReautogradeSubmission(this.props.data.submissionId)},this.state={isAlertOpen:!1}}render(){const e=this.props.userId&&this.props.userId===this.props.data.studentId,t=e||"submitted"===this.props.data.submissionStatus,s="submitted"===this.props.data.submissionStatus&&this.props.userId&&(this.props.userId===this.props.data.groupLeaderId||e||this.props.role===j.a.Admin);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Zo,{to:`/academy/grading/${this.props.data.submissionId}`,icon:"annotation",minimal:!0,title:"Grade"}),Object(a.jsx)(K.b,{icon:"refresh",minimal:!0,onClick:this.handleConfirmReautograde,disabled:!t,title:"Reautograde"}),Object(a.jsx)(K.b,{icon:"arrow-left",minimal:!0,onClick:this.handleConfirmUnsubmit,disabled:!s,title:"Unsubmit"})]})}}var tc=ec;class sc extends m.Component{render(){if(this.props.data.maxGrade){const e=`Initial Grade: ${this.props.data.initialGrade}\n        (${this.props.data.gradeAdjustment>=0?"+":""}${this.props.data.gradeAdjustment} adj.)`;return Object(a.jsx)("div",{children:Object(a.jsx)(ot.a,{content:e,placement:rt.a.LEFT,hoverOpenDelay:10,lazy:!0,children:`${this.props.data.currentGrade} / ${this.props.data.maxGrade}`})})}return Object(a.jsx)("div",{children:"N/A"})}}var ac=sc;class nc extends m.Component{render(){let e,t,s;switch(this.props.data.gradingStatus){case wt.d.graded:e=Y.a.TICK,t=`Fully graded: ${this.props.data.gradedCount} of\n          ${this.props.data.questionCount}`,s=fe.a.SUCCESS;break;case wt.d.grading:e=Y.a.TIME,t=`Partially graded: ${this.props.data.gradedCount} of\n          ${this.props.data.questionCount}`,s=fe.a.WARNING;break;case wt.d.none:e=Y.a.CROSS,t=`Not graded: ${this.props.data.gradedCount} of\n          ${this.props.data.questionCount}`,s=fe.a.DANGER;break;default:e=Y.a.DISABLE,t="Not applicable",s=fe.a.PRIMARY}return Object(a.jsx)("div",{children:Object(a.jsx)(ot.a,{content:t,placement:rt.a.LEFT,hoverOpenDelay:10,lazy:!0,children:Object(a.jsx)(K.u,{icon:e,intent:s})})})}}var ic=nc,rc=s(287),oc=s.n(rc);const cc="grading-editor-button";class dc extends m.Component{constructor(e){super(e),this.validateGradesBeforeSave=e=>()=>{const t=sa(this.state.gradeAdjustmentInput||void 0)||void 0,s=this.props.initialGrade+(t||0),a=sa(this.state.xpAdjustmentInput||void 0)||void 0,n=this.props.initialXp+(a||0);s<0||s>this.props.maxGrade?Object(f.e)(`Grade ${s.toString()} is out of bounds. Maximum grade is ${this.props.maxGrade.toString()}.`):n<0||n>this.props.maxXp?Object(f.e)(`XP ${n.toString()} is out of bounds. Maximum xp is ${this.props.maxXp.toString()}.`):e(this.props.submissionId,this.props.questionId,t,a,this.state.editorValue)},this.onClickSaveAndContinue=(e,t,s,a,n)=>{this.setState({...this.state,currentlySaving:!0},(()=>{this.props.handleGradingSaveAndContinue(e,t,s,a,n)}))},this.onClickReautogradeAnswer=async()=>{await Object(ee.a)({contents:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("p",{children:"Reautograde this answer?"}),Object(a.jsx)("p",{children:"Note: manual adjustments will be reset to 0."})]}),positiveLabel:"Reautograde",positiveIntent:"danger"})&&this.props.handleReautogradeAnswer(this.props.submissionId,this.props.questionId)},this.discardChanges=()=>{this.hasUnsavedChanges()&&!window.confirm("This will reset the editor. Are you sure?")||this.setState({...this.state,gradeAdjustmentInput:this.props.gradeAdjustment.toString(),xpAdjustmentInput:this.props.xpAdjustment.toString(),editorValue:this.props.comments||""},(()=>{Object(f.d)("Discarded!",1e3)}))},this.onGradeAdjustmentInputChange=(e,t)=>{this.setState({...this.state,gradeAdjustmentInput:t,xpAdjustmentInput:String(Math.round(e/this.props.maxGrade*this.props.maxXp)||0)})},this.onXpAdjustmentInputChange=(e,t)=>{this.setState({...this.state,xpAdjustmentInput:t})},this.handleEditorValueChange=e=>{this.setState({...this.state,editorValue:e})},this.hasUnsavedChanges=()=>{const e=sa(this.state.gradeAdjustmentInput||void 0),t=sa(this.state.xpAdjustmentInput||void 0);return this.props.gradeAdjustment!==e||this.props.xpAdjustment!==t||this.props.comments!==this.state.editorValue},this.generateMarkdownPreview=e=>Promise.resolve(Object(a.jsx)(Ut,{content:e,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,openLinksInNewWindow:!0})),this.state=this.makeInitialState()}render(){const e=this.hasUnsavedChanges(),t={intent:e?fe.a.WARNING:fe.a.NONE,minimal:!e,className:cc},s={intent:e?fe.a.DANGER:fe.a.NONE,minimal:!e,className:cc},n={intent:e?fe.a.SUCCESS:fe.a.NONE,minimal:!e,className:cc},i=this.props.initialGrade+(sa(this.state.gradeAdjustmentInput||void 0)||0),r=this.props.initialXp+(sa(this.state.xpAdjustmentInput||void 0)||0),o=`${this.props.initialGrade>0?"-":""}${this.props.initialGrade} to ${this.props.maxGrade-this.props.initialGrade}`,c=`${this.props.initialXp>0?"-":""}${this.props.initialXp} to ${this.props.maxXp-this.props.initialXp}`;return Object(a.jsxs)("div",{className:"GradingEditor",children:[!this.state.currentlySaving&&e?Object(a.jsx)(l.a,{message:"You have unsaved changes. Are you sure you want to leave?"}):null,Object(a.jsx)("div",{className:"grading-editor-header",children:Object(a.jsxs)(K.o,{children:["Currently Grading: ",this.props.studentName]})}),null!==this.props.solution?Object(a.jsx)("div",{className:"grading-editor-marking-scheme",children:Object(a.jsxs)(K.I,{children:[this.props.solution.toString()," "]})}):null,Object(a.jsxs)("div",{className:"grading-editor-container",children:[Object(a.jsxs)("div",{className:"grading-editor-grades",children:[Object(a.jsxs)("div",{className:"autograder-grade",children:[Object(a.jsx)("div",{children:"Autograder grade:"}),Object(a.jsxs)("div",{children:[`${this.props.initialGrade} / ${this.props.maxGrade}`," ",Object(a.jsx)(K.b,{icon:"refresh",small:!0,minimal:!0,onClick:this.onClickReautogradeAnswer})]})]}),Object(a.jsxs)("div",{className:"grade-adjustment",children:[Object(a.jsx)("div",{children:"Grade adjustment:"}),Object(a.jsx)("div",{children:Object(a.jsx)(K.E,{className:"adjustment-input",onValueChange:this.onGradeAdjustmentInputChange,value:this.state.gradeAdjustmentInput||"",buttonPosition:rt.a.RIGHT,fill:!0,placeholder:o,intent:i<0||i>this.props.maxGrade?fe.a.DANGER:fe.a.NONE,min:0-this.props.initialGrade,max:this.props.maxGrade>this.props.initialGrade?this.props.maxGrade-this.props.initialGrade:void 0})})]}),Object(a.jsxs)("div",{className:"final-grade",children:[Object(a.jsx)("div",{children:"Final grade:"}),Object(a.jsx)("div",{children:`${i} / ${this.props.maxGrade}`})]})]}),Object(a.jsxs)("div",{className:"grading-editor-xp",children:[Object(a.jsxs)("div",{className:"autograder-grade",children:[Object(a.jsx)("div",{children:"Autograder XP:"}),Object(a.jsx)("div",{children:`${this.props.initialXp} / ${this.props.maxXp}`})]}),Object(a.jsxs)("div",{className:"grade-adjustment",children:[Object(a.jsx)("div",{children:"XP adjustment:"}),Object(a.jsx)("div",{children:Object(a.jsx)(K.E,{className:"adjustment-input",onValueChange:this.onXpAdjustmentInputChange,value:this.state.xpAdjustmentInput||"",buttonPosition:rt.a.RIGHT,fill:!0,placeholder:c,intent:r<0||r>this.props.maxXp?fe.a.DANGER:fe.a.NONE,min:0-this.props.initialXp,max:this.props.maxXp>this.props.initialXp?this.props.maxXp-this.props.initialXp:void 0})})]}),Object(a.jsxs)("div",{className:"final-grade",children:[Object(a.jsx)("div",{children:"Final XP:"}),Object(a.jsx)("div",{children:`${r} / ${this.props.maxXp}`})]})]})]}),Object(a.jsx)("div",{className:"react-mde-parent",children:Object(a.jsx)(oc.a,{value:this.state.editorValue||"",onChange:this.handleEditorValueChange,selectedTab:this.state.selectedTab,onTabChange:e=>this.setState({...this.state,selectedTab:e}),generateMarkdownPreview:this.generateMarkdownPreview,minEditorHeight:200,maxEditorHeight:1e3,minPreviewHeight:240,getIcon:this.blueprintIconProvider})}),"write"===this.state.selectedTab&&Object(a.jsxs)("div",{className:"grading-editor-draft-buttons",children:[Object(a.jsx)("div",{className:"grading-editor-save-button",children:It("Save Changes",Y.a.FLOPPY_DISK,this.validateGradesBeforeSave(this.props.handleGradingSave),t)}),Object(a.jsx)("div",{className:"grading-editor-discard-button",children:It("Discard Changes",Y.a.TRASH,this.discardChanges,s)})]}),Object(a.jsx)("div",{className:"grading-editor-save-continue-button",children:It("Save and Continue",Y.a.UPDATED,this.validateGradesBeforeSave(this.onClickSaveAndContinue),n)}),this.props.graderName&&this.props.gradedAt&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.h,{}),Object(a.jsxs)("div",{className:"grading-editor-last-graded-details",children:["Last edited by ",Object(a.jsx)("b",{children:this.props.graderName})," on ",da(this.props.gradedAt)]})]})]})}componentDidUpdate(e,t){e.submissionId===this.props.submissionId&&e.questionId===this.props.questionId||this.setState(this.makeInitialState())}blueprintIconProvider(e){const t=lc(e);return Object(a.jsx)(K.u,{icon:t.iconName,htmlTitle:t.title})}makeInitialState(){return{gradeAdjustmentInput:this.props.gradeAdjustment.toString(),xpAdjustmentInput:this.props.xpAdjustment.toString(),editorValue:this.props.comments,selectedTab:"write",currentlySaving:!1}}}const lc=e=>{switch(e){case"header":return{iconName:Y.a.HEADER,title:"Header Styles"};case"bold":return{iconName:Y.a.BOLD,title:"Bold"};case"italic":return{iconName:Y.a.ITALIC,title:"Italic"};case"strikethrough":return{iconName:Y.a.STRIKETHROUGH,title:"Strikethrough"};case"link":return{iconName:Y.a.LINK,title:"Link"};case"quote":return{iconName:Y.a.CITATION,title:"Quote"};case"code":return{iconName:Y.a.CODE,title:"Monospaced"};case"image":return{iconName:Y.a.MEDIA,title:"Image"};case"unordered-list":return{iconName:Y.a.UNGROUP_OBJECTS,title:"Bullets"};case"ordered-list":return{iconName:Y.a.NUMBERED_LIST,title:"Numbering"};case"checked-list":return{iconName:Y.a.SQUARE,title:"Checkboxes"};default:return{iconName:Y.a.HELP}}};var uc=dc;var hc=Object(d.c)(null,(e=>Object(u.b)({handleGradingSave:st.submitGrading,handleGradingSaveAndContinue:st.submitGradingAndContinue,handleReautogradeAnswer:st.reautogradeAnswer},e)))(uc);class pc extends m.Component{constructor(...e){super(...e),this.sideContentProps=(e,t)=>{const s=[{label:`Grading: Question ${t+1}`,iconName:Y.a.TICK,body:Object(a.jsx)(hc,{solution:e.grading[t].question.solution,questionId:e.grading[t].question.id,submissionId:e.submissionId,initialGrade:e.grading[t].grade.grade,gradeAdjustment:e.grading[t].grade.gradeAdjustment,maxGrade:e.grading[t].question.maxGrade,initialXp:e.grading[t].grade.xp,xpAdjustment:e.grading[t].grade.xpAdjustment,maxXp:e.grading[t].question.maxXp,studentName:e.grading[t].student.name,comments:e.grading[t].grade.comments,graderName:e.grading[t].grade.grader?e.grading[t].grade.grader.name:void 0,gradedAt:e.grading[t].grade.grader?e.grading[t].grade.gradedAt:void 0}),id:Os.b.grading,toSpawn:()=>!0},{label:`Task ${t+1}`,iconName:Y.a.NINJA,body:Object(a.jsx)(Ut,{content:e.grading[t].question.content}),id:Os.b.questionOverview,toSpawn:()=>!0},{label:"Autograder",iconName:Y.a.AIRPLANE,body:Object(a.jsx)(Ks,{testcases:e.editorTestcases,autogradingResults:e.autogradingResults,handleTestcaseEval:this.props.handleTestcaseEval}),id:Os.b.autograder,toSpawn:()=>!0}],n=e.grading[t].question.library.external;n.symbols.includes("get_matrix")&&s.push({label:"Tone Matrix",iconName:Y.a.GRID_VIEW,body:Object(a.jsx)(Qs,{}),id:Os.b.toneMatrix,toSpawn:()=>!0}),n.name!==Ct.a.PIXNFLIX&&n.name!==Ct.a.ALL||s.push({label:"Video Display",iconName:Y.a.MOBILE_VIDEO,body:Object(a.jsx)(Zs,{replChange:e.handleSendReplInputToOutput}),id:Os.b.videoDisplay,toSpawn:()=>!0});return{handleActiveTabChange:e.handleActiveTabChange,tabs:s,workspaceLocation:"grading"}},this.controlBarProps=e=>{const t="/academy/grading",s=`/academy/grading/${this.props.submissionId}`,n=[e+1,this.props.grading.length],i=Object(a.jsx)(Pt,{onClickNext:()=>ea.a.push(s+`/${(e+1).toString()}`),onClickReturn:()=>ea.a.push(t),questionProgress:n},"next_question"),r=Object(a.jsx)(Rt,{onClick:()=>ea.a.push(s+`/${(e-1).toString()}`),questionProgress:n},"previous_question"),o=Object(a.jsx)(Mt,{questionProgress:n},"question_view");return{editorButtons:[Object(a.jsx)(_t,{handleEditorEval:this.props.handleEditorEval},"run")],flowButtons:[r,o,i]}}}componentDidMount(){if(this.props.handleGradingFetch(this.props.submissionId),!this.props.grading)return;let e=this.props.questionId;this.props.questionId>=this.props.grading.length&&(e=this.props.grading.length-1);const t=this.props.grading[e].question;let s="";t.type===wt.e.programming&&(s=t.answer?t.answer:t.solutionTemplate||""),this.props.handleEditorValueChange(s)}componentDidUpdate(){if(void 0===this.props.grading)return;const e=this.props.questionId;void 0===this.props.grading[e]?ea.a.push("/academy/grading"):this.checkWorkspaceReset(this.props)}render(){var e,t,s,n,i,r;if(void 0===this.props.grading)return Object(a.jsx)(K.D,{className:mt()("WorkspaceParent",it.a.DARK),description:"Getting assessment ready...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_LARGE})});const o=this.props.questionId>=this.props.grading.length?this.props.grading.length-1:this.props.questionId,c=this.props.grading[o].question,d={controlBarProps:this.controlBarProps(o),editorProps:c.type===wt.e.programming?{editorSessionId:"",editorValue:this.props.editorValue,handleDeclarationNavigate:this.props.handleDeclarationNavigate,handleEditorEval:this.props.handleEditorEval,handleEditorValueChange:this.props.handleEditorValueChange,breakpoints:this.props.breakpoints,highlightedLines:this.props.highlightedLines,newCursorPosition:this.props.newCursorPosition,handleEditorUpdateBreakpoints:this.props.handleEditorUpdateBreakpoints,handlePromptAutocomplete:this.props.handlePromptAutocomplete,isEditorAutorun:!1,sourceChapter:(null===c||void 0===c||null===(e=c.library)||void 0===e?void 0:e.chapter)||4,sourceVariant:"default",externalLibraryName:(null===c||void 0===c||null===(t=c.library)||void 0===t||null===(s=t.external)||void 0===s?void 0:s.name)||"NONE"}:void 0,editorHeight:this.props.editorHeight,editorWidth:this.props.editorWidth,handleEditorHeightChange:this.props.handleEditorHeightChange,handleEditorWidthChange:this.props.handleEditorWidthChange,handleSideContentHeightChange:this.props.handleSideContentHeightChange,mcqProps:{mcq:c,handleMCQSubmit:e=>{}},sideContentHeight:this.props.sideContentHeight,sideContentProps:this.sideContentProps(this.props,o),replProps:{handleBrowseHistoryDown:this.props.handleBrowseHistoryDown,handleBrowseHistoryUp:this.props.handleBrowseHistoryUp,handleReplEval:this.props.handleReplEval,handleReplValueChange:this.props.handleReplValueChange,output:this.props.output,replValue:this.props.replValue,sourceChapter:(null===c||void 0===c||null===(n=c.library)||void 0===n?void 0:n.chapter)||4,sourceVariant:"default",externalLibrary:(null===c||void 0===c||null===(i=c.library)||void 0===i||null===(r=i.external)||void 0===r?void 0:r.name)||"NONE",replButtons:this.replButtons()}};return Object(a.jsx)("div",{className:mt()("WorkspaceParent",it.a.DARK),children:Object(a.jsx)(oa,{...d})})}checkWorkspaceReset(e){const t=e.submissionId,s=e.questionId;if(e.storedSubmissionId===t&&e.storedQuestionId===s)return;const a=e.grading[s].question;let n=[],i="",r="",o="",c=[];if(a.type===wt.e.programming){const e=a;n=e.autogradingResults,r=e.prepend,o=e.postpend,c=e.testcases,i=e.answer,i||(i=e.solutionTemplate)}e.handleEditorUpdateBreakpoints([]),e.handleUpdateCurrentSubmissionId(t,s),e.handleResetWorkspace({autogradingResults:n,editorPrepend:r,editorValue:i,editorPostpend:o,editorTestcases:c}),e.handleClearContext(a.library,!0),e.handleUpdateHasUnsavedChanges(!1),i&&e.handleEditorValueChange(i)}replButtons(){const e=Object(a.jsx)(Tt,{handleReplOutputClear:this.props.handleReplOutputClear},"clear_repl");return[Object(a.jsx)(kt,{handleReplEval:this.props.handleReplEval,isRunning:this.props.isRunning},"eval_repl"),e]}}var gc=pc;const mc="grading";var bc=Object(d.c)(((e,t)=>({autogradingResults:e.workspaces.grading.autogradingResults,editorPrepend:e.workspaces.grading.editorPrepend,editorValue:e.workspaces.grading.editorValue,editorPostpend:e.workspaces.grading.editorPostpend,editorTestcases:e.workspaces.grading.editorTestcases,editorHeight:e.workspaces.grading.editorHeight,editorWidth:e.workspaces.grading.editorWidth,breakpoints:e.workspaces.grading.breakpoints,highlightedLines:e.workspaces.grading.highlightedLines,grading:e.session.gradings.get(t.submissionId),hasUnsavedChanges:e.workspaces.grading.hasUnsavedChanges,isRunning:e.workspaces.grading.isRunning,isDebugging:e.workspaces.grading.isDebugging,enableDebugging:e.workspaces.grading.enableDebugging,newCursorPosition:e.workspaces.grading.newCursorPosition,output:e.workspaces.grading.output,replValue:e.workspaces.grading.replValue,sideContentHeight:e.workspaces.grading.sideContentHeight,storedSubmissionId:e.workspaces.grading.currentSubmission,storedQuestionId:e.workspaces.grading.currentQuestion})),(e=>Object(u.b)({handleActiveTabChange:e=>Object(pt.updateActiveTab)(e,mc),handleBrowseHistoryDown:()=>Object(pt.browseReplHistoryDown)(mc),handleBrowseHistoryUp:()=>Object(pt.browseReplHistoryUp)(mc),handleClearContext:(e,t)=>Object(pt.beginClearContext)(mc,e,t),handleDeclarationNavigate:e=>Object(pt.navigateToDeclaration)(mc,e),handleEditorEval:()=>Object(pt.evalEditor)(mc),handleEditorValueChange:e=>Object(pt.updateEditorValue)(e,mc),handleEditorHeightChange:e=>Object(pt.changeEditorHeight)(e,mc),handleEditorWidthChange:e=>Object(pt.changeEditorWidth)(e.toString(),mc),handleEditorUpdateBreakpoints:e=>Object(pt.setEditorBreakpoint)(e,mc),handleGradingFetch:st.fetchGrading,handleInterruptEval:()=>Object(ht.beginInterruptExecution)(mc),handleReplEval:()=>Object(pt.evalRepl)(mc),handleReplOutputClear:()=>Object(pt.clearReplOutput)(mc),handleReplValueChange:e=>Object(pt.updateReplValue)(e,mc),handleSendReplInputToOutput:e=>Object(pt.sendReplInputToOutput)(e,mc),handleResetWorkspace:e=>Object(pt.resetWorkspace)(mc,e),handleSideContentHeightChange:e=>Object(pt.changeSideContentHeight)(e,mc),handleTestcaseEval:e=>Object(pt.evalTestcase)(mc,e),handleUpdateCurrentSubmissionId:pt.updateCurrentSubmissionId,handleUpdateHasUnsavedChanges:e=>Object(pt.updateHasUnsavedChanges)(mc,e),handleDebuggerPause:()=>Object(ht.beginDebuggerPause)(mc),handleDebuggerResume:()=>Object(ht.debuggerResume)(mc),handleDebuggerReset:()=>Object(ht.debuggerReset)(mc),handlePromptAutocomplete:(e,t,s)=>Object(pt.promptAutocomplete)(mc,e,t,s)},e)))(gc);class jc extends m.Component{render(){if(this.props.data.maxXp||this.props.data.xpBonus){const e=`Initial XP: ${this.props.data.initialXp}\n        (${this.props.data.xpBonus>0?`+${this.props.data.xpBonus} bonus `:""}\n        ${this.props.data.xpAdjustment>=0?"+":""}${this.props.data.xpAdjustment} adj.)`;return Object(a.jsx)("div",{children:Object(a.jsx)(ot.a,{content:e,placement:rt.a.LEFT,hoverOpenDelay:10,lazy:!0,children:`${this.props.data.currentXp+this.props.data.xpBonus} / ${this.props.data.maxXp}`})})}return Object(a.jsx)("div",{children:"No Exp"})}}var yc=jc;class Oc extends m.Component{constructor(e){super(e),this.columnDefs=void 0,this.defaultColumnDefs=void 0,this.gridApi=void 0,this.GradingStatus=e=>Object(a.jsx)(ic,{data:e.data}),this.GradingMarks=e=>Object(a.jsx)(ac,{data:e.data}),this.NotificationBadgeCell=e=>Object(a.jsx)(Sa,{notificationFilter:ya(e.data.submissionId)}),this.GradingExp=e=>Object(a.jsx)(yc,{data:e.data}),this.resizeGrid=()=>{this.gridApi&&this.gridApi.sizeColumnsToFit()},this.updatePaginationState=()=>{if(this.gridApi){const e=this.gridApi.paginationGetTotalPages(),t=0===e?0:this.gridApi.paginationGetCurrentPage()+1;this.setState({currPage:t,maxPages:e,rowCountString:this.formatRowCountString(25,t,e,this.gridApi.paginationGetRowCount()),isBackDisabled:0===e||1===t,isForwardDisabled:0===e||t===e})}},this.formatRowCountString=(e,t,s,a)=>0===s?"(none)":t!==s?`(#${e*t-24} - #${e*t})`:`(#${e*t-24} - #${a})`,this.handleFilterChange=e=>{const t=e.target.value;this.setState({filterValue:t})},this.handleFilterKeypress=e=>{"Enter"===e.key&&this.handleApplyFilter()},this.handleApplyFilter=()=>{this.gridApi&&this.gridApi.setQuickFilter(this.state.filterValue)},this.handleGroupsFilter=()=>{this.gridApi&&(this.setState({groupFilterEnabled:!this.state.groupFilterEnabled}),this.props.handleFetchGradingOverviews(this.state.groupFilterEnabled))},this.onGridReady=e=>{this.gridApi=e.api,this.gridApi.sizeColumnsToFit(),this.updatePaginationState()},this.exportCSV=()=>{this.gridApi&&this.gridApi.exportDataAsCsv({fileName:`SA submissions (${(new Date).toISOString()}).csv`,columnKeys:["assessmentName","assessmentCategory","studentName","groupName","submissionStatus","gradingStatus","questionCount","gradedCount","initialGrade","gradeAdjustment","currentGrade","maxGrade","initialXp","xpAdjustment","currentXp","maxXp","xpBonus"]})},this.changePaginationView=e=>()=>{if(this.gridApi)switch(e){case"first":return this.gridApi.paginationGoToFirstPage();case"prev":return this.gridApi.paginationGoToPreviousPage();case"next":return this.gridApi.paginationGoToNextPage();case"last":return this.gridApi.paginationGoToLastPage()}},this.sortSubmissionsByNotifications=()=>this.props.gradingOverviews?this.props.gradingOverviews.map((e=>({...e,notifications:ya(e.submissionId)(this.props.notifications)}))).sort(((e,t)=>t.notifications.length-e.notifications.length)):[],this.columnDefs=[{headerName:"",field:"notifications",cellRendererFramework:this.NotificationBadgeCell,width:30,filter:!1,resizable:!1,sortable:!1,suppressSizeToFit:!0},{headerName:"Assessment Name",field:"assessmentName"},{headerName:"Category",field:"assessmentCategory",maxWidth:100},{headerName:"Student Name",field:"studentName"},{headerName:"Group",field:"groupName",maxWidth:100},{headerName:"Status",field:"submissionStatus",maxWidth:100,valueFormatter:e=>{const t=e.value;return t.charAt(0).toUpperCase()+t.slice(1)},cellStyle:e=>"submitted"===e.data.submissionStatus?{backgroundColor:Qo.a.GREEN5}:{backgroundColor:Qo.a.RED5}},{headerName:"Grading",field:"gradingStatus",cellRendererFramework:this.GradingStatus,maxWidth:110},{headerName:"Grade",field:"",cellRendererFramework:this.GradingMarks,maxWidth:100,cellStyle:e=>e.data.currentGrade<e.data.maxGrade?{backgroundColor:Qo.a.RED5}:{},comparator:(e,t,s,a,n)=>s&&a?s.data.currentGrade-a.data.currentGrade:e-t},{headerName:"XP",field:"",cellRendererFramework:this.GradingExp,maxWidth:100,comparator:(e,t,s,a,n)=>s&&a?s.data.currentXp-a.data.currentXp:e-t},{headerName:"Actions",colId:"Actions",width:120,field:"",cellRendererFramework:tc,cellRendererParams:{userId:this.props.userId,handleUnsubmitSubmission:this.props.handleUnsubmitSubmission,handleReautogradeSubmission:this.props.handleReautogradeSubmission,role:this.props.role},filter:!1,resizable:!1,sortable:!1,suppressSizeToFit:!0,cellStyle:{padding:0}},{headerName:"Question Count",field:"questionCount",hide:!0},{headerName:"Questions Graded",field:"gradedCount",hide:!0},{headerName:"Initial Grade",field:"initialGrade",hide:!0},{headerName:"Grade Adjustment",field:"gradeAdjustment",hide:!0},{headerName:"Initial XP",field:"initialXp",hide:!0},{headerName:"XP Adjustment",field:"xpAdjustment",hide:!0},{headerName:"Current Grade",field:"currentGrade",hide:!0},{headerName:"Max Grade",field:"maxGrade",hide:!0},{headerName:"Current XP (excl. bonus)",field:"currentXp",hide:!0},{headerName:"Max XP",field:"maxXp",hide:!0},{headerName:"Bonus XP",field:"xpBonus",hide:!0}],this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0},this.state={filterValue:"",groupFilterEnabled:!1,currPage:1,maxPages:1,rowCountString:"(none)",isBackDisabled:!0,isForwardDisabled:!0}}render(){const e=sa(this.props.match.params.submissionId),t=sa(this.props.match.params.questionId)||0;if(null!==e){const s={submissionId:e,questionId:t};return Object(a.jsx)(bc,{...s})}const s=Object(a.jsx)(K.D,{className:"Grading",description:"Fetching submissions...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_LARGE})}),n=this.sortSubmissionsByNotifications(),i=Object(a.jsxs)("div",{className:"grading-controls",children:[Object(a.jsx)(K.l,{label:"Filter:",labelFor:"text-input",inline:!0,children:Object(a.jsx)(K.v,{id:"filterBar",large:!1,leftIcon:"filter",placeholder:"Enter any text (e.g. mission)",value:this.state.filterValue,onChange:this.handleFilterChange,onKeyPress:this.handleFilterKeypress,onBlur:this.handleApplyFilter})}),Object(a.jsxs)("div",{className:"GridControls ag-grid-controls",children:[Object(a.jsx)("div",{className:"left-controls",children:Object(a.jsx)(K.b,{active:this.state.groupFilterEnabled,icon:Y.a.GIT_REPO,intent:this.state.groupFilterEnabled?fe.a.PRIMARY:fe.a.NONE,onClick:this.handleGroupsFilter,children:Object(a.jsx)("span",{className:"hidden-xs",children:"Show all groups"})})}),Object(a.jsxs)("div",{className:"centre-controls",children:[Object(a.jsx)(K.b,{icon:Y.a.CHEVRON_BACKWARD,onClick:this.changePaginationView("first"),minimal:!0,disabled:this.state.isBackDisabled}),Object(a.jsx)(K.b,{icon:Y.a.CHEVRON_LEFT,onClick:this.changePaginationView("prev"),minimal:!0,disabled:this.state.isBackDisabled}),Object(a.jsxs)(K.b,{className:"pagination-details hidden-xs",disabled:!0,minimal:!0,children:[Object(a.jsx)("div",{children:`Page ${this.state.currPage} of ${this.state.maxPages}`}),Object(a.jsx)("div",{children:this.state.rowCountString})]}),Object(a.jsx)(K.b,{icon:Y.a.CHEVRON_RIGHT,onClick:this.changePaginationView("next"),minimal:!0,disabled:this.state.isForwardDisabled}),Object(a.jsx)(K.b,{icon:Y.a.CHEVRON_FORWARD,onClick:this.changePaginationView("last"),minimal:!0,disabled:this.state.isForwardDisabled})]}),Object(a.jsx)("div",{className:"right-controls",children:Object(a.jsx)(K.b,{icon:Y.a.EXPORT,onClick:this.exportCSV,children:Object(a.jsx)("span",{className:"hidden-xs",children:"Export to CSV"})})})]})]}),r=Object(a.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(a.jsx)(ka.AgGridReact,{domLayout:"autoHeight",columnDefs:this.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,onGridSizeChanged:this.resizeGrid,onPaginationChanged:this.updatePaginationState,rowData:n,rowHeight:30,pagination:!0,paginationPageSize:25,suppressCellSelection:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0})}),o=Object(a.jsxs)("div",{className:"Grading",children:[i,Object(a.jsx)(K.h,{}),r]});return Object(a.jsx)("div",{children:Object(a.jsx)(ba,{loadContentDispatch:this.props.handleFetchGradingOverviews,display:void 0===this.props.gradingOverviews?s:o,fullWidth:!1})})}componentDidUpdate(e,t){this.gridApi&&this.props.notifications.length!==e.notifications.length&&this.gridApi.setRowData(this.sortSubmissionsByNotifications())}}var vc=Oc;var xc=Object(d.c)((e=>({gradingOverviews:e.session.gradingOverviews,userId:e.session.userId,notifications:e.session.notifications,role:e.session.role})),(e=>Object(u.b)({handleAcknowledgeNotifications:st.acknowledgeNotifications,handleFetchGradingOverviews:st.fetchGradingOverviews,handleUnsubmitSubmission:st.unsubmitSubmission,handleReautogradeSubmission:st.reautogradeSubmission},e)))(vc),fc=s(155);var Sc=e=>{const{handleFetchSublanguage:t,handleUpdateSublanguage:s}=e;m.useEffect((()=>{t()}),[t]);const{sourceChapter:n,sourceVariant:i}=e,[r,o]=m.useState(j.m[0]),[c,d]=m.useState(!1),l=m.useCallback((e=>{d(!0),o(e)}),[d,o]),u=m.useCallback((()=>{d(!1)}),[d]),h=m.useCallback((()=>{d(!1),s(r)}),[r,d,s]),p=m.useCallback(((e,{handleClick:t})=>Object(a.jsx)(K.y,{onClick:t,text:e.displayName},e.displayName)),[]),g=m.useCallback((({itemsParentRef:e,renderItem:t})=>{const s=j.h.map(t),n=j.o.map(t);return Object(a.jsxs)(K.w,{ulRef:e,children:[s,Object(a.jsx)(K.y,{text:"Variants",icon:"cog",children:n},"variant-menu")]})}),[]),b=ie.a.ofType(),y=Object(a.jsxs)(K.g,{canEscapeKeyClose:!0,canOutsideClickClose:!0,className:"change-default-lang-dialog",icon:Y.a.ERROR,isCloseButtonShown:!0,isOpen:c,onClose:u,title:"Updating default Source sublanguage",children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:["Are you sure you want to update the ",Object(a.jsx)("b",{children:"default Playground Source sublanguage"})," from"," ",Object(j.n)(n,i)," to ",Object(a.jsx)("b",{children:r.displayName}),"?"]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[It("Cancel",null,u,{minimal:!1}),It("Confirm",null,h,{minimal:!1,intent:fe.a.DANGER})]})})]});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(b,{items:j.m,onItemSelect:l,itemRenderer:p,itemListRenderer:g,filterable:!1,children:Object(a.jsxs)(K.b,{rightIcon:Y.a.DOUBLE_CARET_VERTICAL,children:[Object(a.jsx)("span",{className:"hidden-xs hidden-sm",children:"Default sublanguage: "}),Object(a.jsx)("span",{children:Object(j.n)(n,i)})]})}),y]})};var Cc=Object(d.c)((e=>({sourceChapter:e.workspaces.playground.context.chapter,sourceVariant:e.workspaces.playground.context.variant})),(e=>Object(u.b)({handleFetchSublanguage:pt.fetchSublanguage,handleUpdateSublanguage:pt.changeSublanguage},e)))(Sc);var wc=e=>{const[t,s]=m.useState(!1),n=m.useCallback((()=>s(!0)),[]),i=m.useCallback((()=>s(!1)),[]),{handleDeleteAssessment:r,data:o}=e,c=m.useCallback((()=>{const{id:e}=o;r(e),i()}),[o,i,r]);return Object(a.jsxs)(a.Fragment,{children:[It("",Y.a.TRASH,n),Object(a.jsxs)(K.g,{icon:Y.a.WARNING_SIGN,isOpen:t,onClose:i,title:"Deleting assessment",canOutsideClickClose:!0,children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsxs)("p",{children:["Are you sure you want to ",Object(a.jsx)("b",{children:"delete"})," the assessment ",Object(a.jsx)("i",{children:o.title}),"?"]}),Object(a.jsx)("p",{children:Object(a.jsx)("b",{children:"All submissions and their answers will be deleted as well."})})]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[It("Cancel",Y.a.CROSS,i,{minimal:!1}),It("Confirm",Y.a.TRASH,c,{minimal:!1,intent:fe.a.DANGER})]})})]})]})},Ec=s(416);var Ac=e=>{const[t,s]=m.useState(void 0),[n,i]=m.useState(!1),[r,o]=m.useState(!1),{handleUploadAssessment:c}=e,d=m.useCallback((()=>{t&&(c(t,r),o(!1)),s(void 0)}),[t,r,c]),l=m.useCallback((()=>s(void 0)),[s]),u=m.useCallback((e=>{s(e[0]),o(!1)}),[s]),h=m.useCallback((e=>{e.length>1&&Object(f.e)("Uploading multiple files at once is not currently supported!",2e3)}),[]),{getRootProps:p,getInputProps:g,isFocused:b,isDragActive:j,isDragAccept:y,isDragReject:O}=Object(Ec.a)({multiple:!1,onDropAccepted:u,onDropRejected:h}),v=m.useMemo((()=>mt()("dropzone-base",b||j?"dropzone-active":void 0,y?"dropzone-accept":void 0,O?"dropzone-reject":void 0)),[b,j,y,O]),x=m.useCallback((()=>{r?o(!1):i(!0)}),[r,i,o]),S=m.useMemo((()=>Object(a.jsx)("div",{className:"toggle-button-wrapper",children:Object(a.jsx)(K.N,{checked:r,onChange:x})})),[r,x]),C=m.useCallback((()=>{o(!0),i(!1)}),[o]),w=m.useCallback((()=>{i(!1)}),[i]),E=m.useMemo((()=>Object(a.jsxs)("div",{className:"dropzone-controls",children:[It("Yes",Y.a.CONFIRM,C,{minimal:!1,intent:fe.a.DANGER}),It("No",Y.a.CROSS,w,{minimal:!1})]})),[w,C]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.e,{elevation:nt.a.TWO,interactive:!0,children:Object(a.jsxs)("div",{...p({className:v}),children:[Object(a.jsx)("input",{...g()}),Object(a.jsx)("p",{children:"Drag 'n' drop a file here, or click to select a file"})]})}),t&&Object(a.jsxs)(K.e,{className:"dropzone-prompt",elevation:nt.a.TWO,interactive:!0,children:[Object(a.jsx)("h3",{children:null===t||void 0===t?void 0:t.name}),!n&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"dropzone-controls",children:[It("Confirm Upload",Y.a.UPLOAD,d,{minimal:!1,intent:fe.a.DANGER}),It("Cancel Upload",Y.a.DELETE,l,{minimal:!1})]}),Object(a.jsxs)("div",{className:"dropzone-controls",children:[Object(a.jsx)("p",{children:"Force update opened assessment"}),S]})]}),n&&Object(a.jsx)("p",{children:"Are you sure that you want to force update the assessment?"}),n&&E]})]})},Ic=s(1233);var Tc=e=>{const t=new Date(2010,0,0),s=new Date(2030,11,31),{data:n,forOpenDate:i}=e,r=m.useMemo((()=>i?n.openAt:n.closeAt),[n.closeAt,n.openAt,i]),[o,c]=m.useState(!1),[d,l]=m.useState(new Date(r)),u=m.useCallback((()=>c(!0)),[]),h=m.useCallback((()=>c(!1)),[]),{handleAssessmentChangeDate:p}=e,g=m.useCallback((()=>{if(d){const{id:e,openAt:t,closeAt:s}=n;p(e,i?d.toISOString():t,i?s:d.toISOString()),h()}else Object(f.e)("No date and time selected!",2e3),l(new Date(r))}),[n,i,d,r,p,h]),b=m.useCallback((e=>l(e)),[]),j=m.useCallback((()=>{Object(f.e)("Failed to parse date string! Defaulting to current date.",2e3),l(new Date(r))}),[r]),y=Object(a.jsx)(Ic.a,{formatDate:e=>e.toLocaleString(),onChange:b,onError:j,parseDate:e=>new Date(e),placeholder:"MM/DD/YYYY, HH:mm:ss (AM/PM) or select a date",value:d,timePrecision:"second",fill:!0,minDate:t,maxDate:s,closeOnSelection:!1});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{className:"date-cell-text",children:da(r)}),It("",Y.a.EDIT,u),Object(a.jsxs)(K.g,{icon:Y.a.INFO_SIGN,isOpen:o,onClose:h,title:"Updating assessment settings",canOutsideClickClose:!0,children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsxs)("p",{children:[i?"Opening":"Closing"," date and time:"]}),y]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[It("Cancel",Y.a.CROSS,h,{minimal:!1}),It("Confirm",Y.a.TICK,g,{minimal:!1,intent:fe.a.DANGER})]})})]})]})};var kc=e=>{const{data:t}=e,[s,n]=m.useState(!1),[i]=m.useState(!!t.isPublished),r=m.useCallback((()=>n(!0)),[]),o=m.useCallback((()=>n(!1)),[]),{handlePublishAssessment:c}=e,d=m.useCallback((()=>{const{id:e}=t;c(!i,e),o()}),[t,i,o,c]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.N,{className:"publish-cell",checked:i,onChange:r}),Object(a.jsxs)(K.g,{icon:Y.a.WARNING_SIGN,isOpen:s,onClose:o,title:(i?"Unpublish":"Publish")+" assessment",canOutsideClickClose:!0,children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsxs)("p",{children:["Are you sure you want to ",Object(a.jsx)("b",{children:i?"unpublish":"publish"})," the assessment"," ",Object(a.jsx)("i",{children:t.title}),"?"]}),i?Object(a.jsx)("p",{children:Object(a.jsx)("b",{children:"This will hide the assessment for students and prevent them from uploading new answers. Admins and staff are not affected."})}):null]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[It("Cancel",Y.a.CROSS,o,{minimal:!1}),It("Confirm",Y.a.CONFIRM,d,{minimal:!1,intent:fe.a.DANGER})]})})]})]})};class Nc extends m.Component{constructor(e){super(e),this.columnDefs=void 0,this.defaultColumnDefs=void 0,this.gridApi=void 0,this.conditionallyFetchAssessmentOverviews=()=>{this.props.assessmentOverviews||this.props.handleAssessmentOverviewFetch()},this.dateFilterComparator=(e,t)=>{const s=new Date(t);return s<e?-1:s>e?1:0},this.onGridReady=e=>{this.gridApi=e.api,this.gridApi.sizeColumnsToFit(),this.gridApi.setSortModel([{colId:"openAt",sort:"desc"},{colId:"closeAt",sort:"desc"}])},this.resizeGrid=()=>{this.gridApi&&this.gridApi.sizeColumnsToFit()},this.toggleDropzone=()=>{this.setState({showDropzone:!this.state.showDropzone})},this.state={showDropzone:!1},this.columnDefs=[{field:"number",headerName:"ID",width:50},{headerName:"Title",field:"title"},{headerName:"Category",field:"category",width:100},{headerName:"Open Date",field:"openAt",filter:"agDateColumnFilter",filterParams:{comparator:this.dateFilterComparator,inRangeInclusive:!0},sortingOrder:["desc","asc",null],cellRendererFramework:Tc,cellRendererParams:{handleAssessmentChangeDate:this.props.handleAssessmentChangeDate,forOpenDate:!0},width:150},{headerName:"Close Date",field:"closeAt",filter:"agDateColumnFilter",filterParams:{comparator:this.dateFilterComparator,inRangeInclusive:!0},sortingOrder:["desc","asc",null],cellRendererFramework:Tc,cellRendererParams:{handleAssessmentChangeDate:this.props.handleAssessmentChangeDate,forOpenDate:!1},width:150},{headerName:"Publish",field:"",cellRendererFramework:kc,cellRendererParams:{handlePublishAssessment:this.props.handlePublishAssessment},width:100,filter:!1,resizable:!1,sortable:!1,cellStyle:{padding:0}},{headerName:"Delete",field:"",cellRendererFramework:wc,cellRendererParams:{handleDeleteAssessment:this.props.handleDeleteAssessment},width:100,filter:!1,resizable:!1,sortable:!1,cellStyle:{padding:0}}],this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0}}render(){const e=Object(a.jsxs)("div",{className:"GridControls ground-control-controls",children:[Object(a.jsx)(K.b,{active:this.state.showDropzone,icon:Y.a.CLOUD_UPLOAD,intent:this.state.showDropzone?fe.a.PRIMARY:fe.a.NONE,onClick:this.toggleDropzone,children:Object(a.jsx)("span",{className:"hidden-xs",children:"Upload assessment"})}),Object(a.jsx)(Cc,{}),Object(a.jsx)(K.b,{icon:Y.a.REFRESH,onClick:this.props.handleAssessmentOverviewFetch,children:Object(a.jsx)("span",{className:"hidden-xs",children:"Refresh assessments"})})]}),t=Object(a.jsx)(K.f,{isOpen:this.state.showDropzone,keepChildrenMounted:!0,children:Object(a.jsx)(Ac,{handleUploadAssessment:this.props.handleUploadAssessment})}),s=Object(a.jsx)("div",{className:"Grid ag-grid-parent ag-theme-balham",children:Object(a.jsx)(ka.AgGridReact,{domLayout:"autoHeight",columnDefs:this.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,onGridSizeChanged:this.resizeGrid,rowData:this.props.assessmentOverviews,rowHeight:30,suppressCellSelection:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0})}),n=Object(a.jsxs)("div",{className:"GroundControl",children:[e,t,Object(a.jsx)(K.h,{}),s]});return Object(a.jsx)("div",{children:Object(a.jsx)(ba,{display:n,loadContentDispatch:this.conditionallyFetchAssessmentOverviews})})}}var Pc=Nc;var Rc=Object(d.c)((e=>({assessmentOverviews:e.session.assessmentOverviews})),(e=>Object(u.b)({handleAssessmentChangeDate:fc.changeDateAssessment,handleAssessmentOverviewFetch:st.fetchAssessmentOverviews,handleDeleteAssessment:fc.deleteAssessment,handleUploadAssessment:fc.uploadAssessment,handlePublishAssessment:fc.publishAssessment},e)))(Pc),Mc=s(172),Lc=s(81),_c=s(105);function Dc(e){return Object(ct.useMediaQuery)({maxWidth:768})?Object(a.jsxs)(a.Fragment,{children:[e.isRunning&&It("Stop",Y.a.STOP,e.handleInterruptEval),!e.pauseDisabled&&e.isRunning&&!e.isDebugging&&It("Pause",Y.a.STOP,e.handleDebuggerPause)||!e.isRunning&&e.isDebugging&&It("Resume",Y.a.CHEVRON_RIGHT,e.handleDebuggerResume),e.isDebugging&&It("Stop",Y.a.STOP,e.handleDebuggerReset)]}):Object(a.jsxs)(a.Fragment,{children:[!e.autorunDisabled&&Object(a.jsx)("div",{className:"Switch",children:Object(a.jsx)(K.N,{label:"",checked:e.isEditorAutorun,onChange:e.handleToggleEditorAutorun})}),e.isEditorAutorun&&It("Auto",Y.a.AUTOMATIC_UPDATES)||e.isRunning&&It("Stop",Y.a.STOP,e.handleInterruptEval)||!e.isDebugging&&Object(a.jsx)(_t,{handleEditorEval:e.handleEditorEval},"run"),!e.pauseDisabled&&e.isRunning&&!e.isDebugging&&It("Pause",Y.a.STOP,e.handleDebuggerPause)||!e.isRunning&&e.isDebugging&&It("Resume",Y.a.CHEVRON_RIGHT,e.handleDebuggerResume),e.isDebugging&&It("Stop Debugger",Y.a.STOP,e.handleDebuggerReset)]})}function Gc(e){const t=Array.from(Ct.b.entries()).map(((e,t)=>({name:e[0],key:t,symbols:e[1]}))),s=ie.a.ofType();return Object(a.jsx)(s,{className:it.a.MINIMAL,items:t,onItemSelect:e.handleExternalSelect,itemRenderer:(e,{handleClick:t,modifiers:s,query:n})=>Object(a.jsx)(K.y,{active:!1,onClick:t,text:e.name},e.key),filterable:!1,disabled:e.disabled,children:Object(a.jsx)(K.b,{className:it.a.MINIMAL,text:e.externalLibraryName,rightIcon:Y.a.DOUBLE_CARET_VERTICAL,disabled:e.disabled})})}class Bc extends m.Component{constructor(e){super(e),this.$parent=null,this.tryToLoad=()=>{const e=window.EnvVisualizer;this.$parent&&e?(e.init(this.$parent),this.setState(((e,t)=>({loading:!1})))):window.setTimeout(this.tryToLoad,1e3)},this.state={loading:!0}}componentDidMount(){this.tryToLoad()}render(){return Object(a.jsxs)("div",{ref:e=>this.$parent=e,className:mt()("sa-env-visualizer",it.a.DARK),children:[Object(a.jsxs)("p",{id:"env-visualizer-default-text",className:it.a.RUNNING_TEXT,children:["The environmental visualizer generates the environmental model diagram based on breakpoints set in the editor.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"It is activated by clicking on the gutter of the editor (where all the line numbers are, on the left) to set a breakpoint, and then running the program. Only the first line of a statement can have a breakpoint. The program halts just before the statement is evaluated.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"The environment model diagram follows a notation introduced in"," ",Object(a.jsx)("a",{href:y.a.textbookChapter3_2,rel:"noopener noreferrer",target:"_blank",children:Object(a.jsx)("i",{children:"Structure and Interpretation of Computer Programs, JavaScript Adaptation, Chapter 3, Section 2"})}),"."]}),this.state.loading&&Object(a.jsx)(K.D,{description:"Loading Env Visualizer...",icon:Object(a.jsx)(K.M,{})})]})}}var Uc=Bc;class Fc extends m.Component{constructor(e){super(e),this.$parent=null,this.tryToLoad=()=>{const e=window.Inspector;this.$parent&&e?(e.init(this.$parent),this.setState(((e,t)=>({loading:!1})))):window.setTimeout(this.tryToLoad,1e3)},this.state={loading:!0}}componentDidMount(){this.tryToLoad()}render(){return Object(a.jsxs)("div",{ref:e=>this.$parent=e,className:"sa-inspector bp3-dark",children:[Object(a.jsxs)("p",{id:"inspector-default-text",className:it.a.RUNNING_TEXT,children:["The inspector generates a list of variable bindings based on breakpoints set in the editor.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"It is activated by clicking on the gutter of the editor (where all the line numbers are, on the left) to set a breakpoint, and then running the program. Only the first line of a statement can have a breakpoint. The program halts just before the statement is evaluated."]}),this.state.loading&&Object(a.jsx)(K.D,{description:"Loading Inspector...",icon:Object(a.jsx)(K.M,{})})]})}}var Hc=Fc;const Vc={PREVIOUS_STEP:"left",NEXT_STEP:"right"};class qc extends m.Component{constructor(e){super(e),this.$parent=null,this.onPrevButtonClick=()=>{window.ListVisualizer.previous(),this.setState({})},this.onNextButtonClick=()=>{window.ListVisualizer.next(),this.setState({})},this.tryToLoad=()=>{const e=window.ListVisualizer;this.$parent&&e?(e.init(this.$parent),this.setState(((e,t)=>({loading:!1})))):window.setTimeout(this.tryToLoad,1e3)},this.state={loading:!0}}componentDidMount(){this.tryToLoad()}render(){var e,t,s,n;const i={PREVIOUS_STEP:this.onPrevButtonClick,NEXT_STEP:this.onNextButtonClick},r=window.ListVisualizer;return Object(a.jsx)($t.HotKeys,{keyMap:Vc,handlers:i,children:Object(a.jsxs)("div",{ref:e=>this.$parent=e,className:mt()("sa-list-visualizer",it.a.DARK),children:[(null!==(e=null===r||void 0===r?void 0:r.getStepCount())&&void 0!==e?e:0)>1?Object(a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(a.jsx)(K.b,{large:!0,outlined:!0,icon:Y.a.ARROW_LEFT,onClick:this.onPrevButtonClick,disabled:1===(null!==(t=null===r||void 0===r?void 0:r.getCurrentStep())&&void 0!==t?t:1),children:"Prev"}),Object(a.jsxs)("h3",{className:"bp3-text-large",style:{alignSelf:"center",display:"inline",margin:0},children:["Call ",null!==(s=null===r||void 0===r?void 0:r.getCurrentStep())&&void 0!==s?s:"0","/",null===r||void 0===r?void 0:r.getStepCount()]}),Object(a.jsx)(K.b,{large:!0,outlined:!0,icon:Y.a.ARROW_RIGHT,onClick:this.onNextButtonClick,disabled:!r||r.getCurrentStep()===r.getStepCount(),children:"Next"})]}):null,Object(a.jsxs)("p",{id:"data-visualizer-default-text",className:it.a.RUNNING_TEXT,hidden:null!==(n=null===r||void 0===r?void 0:r.hasDrawing())&&void 0!==n&&n,children:["The data visualizer visualizes data structures.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"It is activated by calling the function ",Object(a.jsx)("code",{children:"draw_data(the_data)"}),", where"," ",Object(a.jsx)("code",{children:"the_data"})," would be the data structure that you want to visualize.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"The data visualizer uses box-and-pointer diagrams, as introduced in"," ",Object(a.jsx)("a",{href:y.a.textbookChapter2_2,rel:"noopener noreferrer",target:"_blank",children:Object(a.jsx)("i",{children:"Structure and Interpretation of Computer Programs, JavaScript Adaptation, Chapter 2, Section 2"})}),"."]}),this.state.loading&&Object(a.jsx)(K.D,{description:"Loading Data Visualizer...",icon:Object(a.jsx)(K.M,{})})]})})}}var Xc=qc;class $c extends m.PureComponent{constructor(e){super(e),this.audio=void 0,this.handleSeeked=()=>{this.stopPreviousPlaybackAndApplyFromStart(this.props.playbackData)},this.handleAudioLoaded=()=>{this.props.handleSetSourcecastDuration(this.audio.current.duration)},this.applyDeltas=e=>{this.props.handleSetCodeDeltasToApply(e)},this.stopPreviousPlaybackAndApplyFromStart=e=>{this.setState({currentDeltaRevision:this.state.currentDeltaRevision+1},(()=>this.applyPlaybackDataFromStart(e)))},this.applyPlaybackDataFromStart=async e=>{const t=e=>new Promise((t=>setTimeout(t,e))),s=this.state.currentDeltaRevision;let a=1e3*this.audio.current.currentTime;this.props.handleEditorValueChange(e.init.editorValue),this.props.handleExternalSelect(e.init.externalLibrary),this.props.handleChapterSelect(e.init.chapter);const n=e.inputs.filter((e=>e.time<=a&&"codeDelta"===e.type)).map((e=>e.data));this.applyDeltas(n);const i=e.inputs.filter((e=>e.time>a)),r=i.length;let o=0;for(;o<r&&this.state.currentDeltaRevision===s;)a=1e3*this.audio.current.currentTime,i[o].time<a?(this.props.handleSetInputToApply(i[o]),o++):await t(20)},this.handlePlayerPausing=()=>{this.audio.current.pause(),this.props.handleSetEditorReadonly(!1),this.props.handleSetSourcecastStatus(St.b.paused),this.stopCurrentPlayback()},this.handlePlayerPlaying=()=>{this.audio.current.play(),this.props.handleSetEditorReadonly(!0),this.props.handleSetSourcecastStatus(St.b.playing),this.stopPreviousPlaybackAndApplyFromStart(this.props.playbackData)},this.handlePlayerStopping=()=>{this.props.handleSetEditorReadonly(!1),this.props.handleSetSourcecastStatus(St.b.paused),this.props.handleSetCurrentPlayerTime(0),this.setState({currentPlayerProgress:0})},this.updatePlayerTime=e=>{const{currentTime:t}=e.target;this.props.handleSetCurrentPlayerTime(t),this.setState({currentPlayerProgress:t/this.props.duration}),this.props.playbackStatus===St.b.forcedPaused&&this.handlePlayerPausing()},this.handlePlayerProgressBarChange=e=>{if(this.audio.current){const t=this.props.duration*e;this.audio.current.currentTime=t,this.props.handleSetCurrentPlayerTime(t),this.setState({currentPlayerProgress:e})}},this.renderLabel=e=>{if(this.props.duration){const t=this.props.duration*e,s=Math.floor(t/60),a=Math.floor(t-60*s);return(s<10?"0"+s:s)+":"+(a<10?"0"+a:a)}return"00:00"},this.audio=m.createRef(),this.state={currentDeltaRevision:0,currentPlayerProgress:0,currentSourcecastItem:null,duration:0}}render(){const e=It("Play",Y.a.PLAY,this.handlePlayerPlaying,{},!this.props.duration),t=It("Pause",Y.a.PAUSE,this.handlePlayerPausing);return Object(a.jsxs)("div",{className:"Bar",children:[Object(a.jsx)("audio",{src:this.props.audioUrl,ref:this.audio,onEnded:this.handlePlayerStopping,onLoadedMetadata:this.handleAudioLoaded,onSeeked:this.handleSeeked,onTimeUpdate:this.updatePlayerTime,preload:"metadata"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:"PlayerControl",children:Object(a.jsxs)("div",{className:"PlayerControl",children:[this.props.playbackStatus===St.b.paused&&e,this.props.playbackStatus===St.b.playing&&t]})}),Object(a.jsx)("div",{className:"Slider",children:Object(a.jsx)(K.L,{min:0,max:1,stepSize:1e-4,onChange:this.handlePlayerProgressBarChange,value:this.state.currentPlayerProgress,labelRenderer:this.renderLabel})})]}),Object(a.jsx)("br",{})]})}stopCurrentPlayback(){this.setState({currentDeltaRevision:this.state.currentDeltaRevision+1})}}var Wc=$c;s(774);class zc extends m.PureComponent{constructor(e){super(e),this.ShareAce=void 0,this.AceEditor=void 0,this.onChangeMethod=void 0,this.onCursorChange=void 0,this.onSelectionChange=void 0,this.getMarkers=()=>{const e=[];for(const t of this.props.highlightedLines)e.push({startRow:t[0],startCol:0,endRow:t[1],endCol:1,className:"myMarker",type:"fullLine"});return e},this.handleGutterClick=e=>{const t=e.domEvent.target;if(-1===t.className.indexOf("ace_gutter-cell")||!e.editor.isFocused()||e.clientX>35+t.getBoundingClientRect().left)return;const s=e.getDocumentPosition().row,a=e.editor.session.getLine(s);void 0!==e.editor.session.getBreakpoints(s,0)[s]||0===a.length||a.includes("//")||a.includes("debugger;")?e.editor.session.clearBreakpoint(s):e.editor.session.setBreakpoint(s),e.stop(),this.props.handleEditorUpdateBreakpoints(e.editor.session.$breakpoints)},this.handleAnnotationChange=e=>()=>{const t=e.getAnnotations();let s=0;for(const e of t)"info"===e.type&&(e.type="error",e.className="ace_error",s++);0!==s&&e.setAnnotations(t)},this.handleEvaluate=()=>{this.props.handleEditorEval(),this.props.isRecording&&this.props.handleRecordInput({type:"keyboardCommand",time:this.props.getTimerDuration(),data:St.a.run})},this.moveCursor=e=>{this.AceEditor.current.editor.selection.clearSelection(),this.AceEditor.current.editor.moveCursorToPosition(e),this.AceEditor.current.editor.renderer.showCursor(),this.AceEditor.current.editor.renderer.scrollCursorIntoView(e,.5)},this.handleDeclarationNavigate=()=>{this.props.handleDeclarationNavigate(this.AceEditor.current.editor.getCursorPosition())},this.AceEditor=m.createRef(),this.ShareAce=null,this.onChangeMethod=(e,t)=>{this.props.handleUpdateHasUnsavedChanges&&this.props.handleUpdateHasUnsavedChanges(!0),this.props.handleEditorValueChange(e),this.props.isRecording&&this.props.handleRecordInput({type:"codeDelta",time:this.props.getTimerDuration(),data:t});const s=this.AceEditor.current.editor.getSession().getAnnotations();this.props.isEditorAutorun&&0===s.length&&this.props.handleEditorEval()},this.onCursorChange=e=>{if(!this.props.isRecording)return;const t=e.getCursor();this.props.handleRecordInput({type:"cursorPositionChange",time:this.props.getTimerDuration(),data:t})},this.onSelectionChange=e=>{if(!this.props.isRecording)return;const t=e.getRange(),s=e.isBackwards();Object(O.isEqual)(t.start,t.end)||this.props.handleRecordInput({type:"selectionRangeData",time:this.props.getTimerDuration(),data:{range:t,isBackwards:s}})}}componentDidUpdate(e){const{codeDeltasToApply:t,inputToApply:s,newCursorPosition:a}=this.props;if(t&&t!==e.codeDeltasToApply&&(this.AceEditor.current.editor.session.getDocument().applyDeltas(t),this.AceEditor.current.editor.selection.clearSelection()),a&&a!==e.newCursorPosition&&this.moveCursor(a),s&&s!==e.inputToApply)switch(s.type){case"codeDelta":this.AceEditor.current.editor.session.getDocument().applyDelta(s.data),this.AceEditor.current.editor.selection.clearSelection();break;case"cursorPositionChange":this.moveCursor(s.data);break;case"selectionRangeData":const{range:e,isBackwards:t}=s.data;this.AceEditor.current.editor.selection.setRange(e,t);break;case"keyboardCommand":switch(s.data){case"run":this.props.handleEditorEval()}}}getBreakpoints(){return this.AceEditor.current.editor.session.getBreakpoints().filter((e=>null!=e))}componentDidMount(){if(!this.AceEditor||!this.AceEditor.current||!this.AceEditor.current.editor)return;const e=this.AceEditor.current.editor,t=e.getSession();e.on("gutterclick",this.handleGutterClick),t.on("changeAnnotation",this.handleAnnotationChange(t))}componentWillUnmount(){null!==this.ShareAce&&this.ShareAce.WS.close(),this.ShareAce=null}render(){return Object(a.jsx)($t.HotKeys,{className:"Editor",handlers:Kc,children:Object(a.jsx)("div",{className:"row editor-react-ace",children:Object(a.jsx)(Xt.a,{className:"react-ace",commands:[{name:"evaluate",bindKey:{win:"Shift-Enter",mac:"Shift-Enter"},exec:this.handleEvaluate},{name:"navigate",bindKey:{win:"Ctrl-B",mac:"Command-B"},exec:this.handleDeclarationNavigate}],editorProps:{$blockScrolling:1/0},ref:this.AceEditor,markers:this.getMarkers(),fontSize:17,height:"100%",highlightActiveLine:!1,mode:"javascript",onChange:this.onChangeMethod,onCursorChange:this.onCursorChange,onSelectionChange:this.onSelectionChange,readOnly:!!this.props.editorReadonly&&this.props.editorReadonly,theme:"source",value:this.props.editorValue,width:"100%",setOptions:{fontFamily:"'Inconsolata', 'Consolas', monospace"}})})})}}const Kc={goGreen:()=>{}};var Yc=zc;class Qc extends m.Component{constructor(e){super(e),this.handleCloseDialog=()=>this.setState({dialogOpen:!1}),this.handleOpenDialog=()=>this.setState({dialogOpen:!0}),this.handleDelete=()=>{const{data:e}=this.props;this.props.handleDeleteSourcecastEntry(e.id)},this.state={dialogOpen:!1}}render(){return Object(a.jsxs)("div",{children:[It("",Y.a.TRASH,this.handleOpenDialog),Object(a.jsxs)(K.g,{icon:"info-sign",isOpen:this.state.dialogOpen,onClose:this.handleCloseDialog,title:"Delete Sourcecast",canOutsideClickClose:!0,children:[Object(a.jsx)("div",{className:it.a.DIALOG_BODY,children:Object(a.jsx)("p",{children:"Are you sure to delete this sourcecast entry?"})}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[It("Confirm Delete",Y.a.TRASH,this.handleDelete),It("Cancel",Y.a.CROSS,this.handleCloseDialog)]})})]})]})}}var Jc=Qc;class Zc extends m.Component{constructor(e){super(e),this.handleSelect=()=>{const{data:e}=this.props;this.props.handleSetSourcecastData(e.title,e.description,e.uid,e.url,JSON.parse(e.playbackData))}}render(){return Object(a.jsx)(ot.a,{content:"Load Sourcecast Recording",children:It(`${this.props.data.title}`,Y.a.PAPERCLIP,this.handleSelect)})}}var ed=Zc,td=s(174);class sd extends m.Component{constructor(e){super(e),this.shareInputElem=void 0,this.shareInputElem=m.createRef(),this.selectShareInputText=this.selectShareInputText.bind(this);const t=`${window.location.protocol}//${window.location.host}/sourcecast/${e.data.uid}`;this.state={shareURL:t}}render(){const e=Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{defaultValue:this.state.shareURL,readOnly:!0,ref:this.shareInputElem}),Object(a.jsx)(ot.a,{content:"Copy link to clipboard",children:Object(a.jsx)(td,{text:this.state.shareURL,children:It("",Y.a.DUPLICATE,this.selectShareInputText)})})]},this.state.shareURL);return Object(a.jsx)(Ds.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:e,children:Object(a.jsx)(ot.a,{content:"Get shareable link",children:It("",Y.a.SHARE)})})}selectShareInputText(){null!==this.shareInputElem.current&&(this.shareInputElem.current.focus(),this.shareInputElem.current.select())}}var ad=sd;class nd extends m.Component{constructor(e){super(e),this.defaultColumnDefs=void 0,this.gridApi=void 0,this.handleFilterChange=e=>{const t=e.target.value;this.setState({filterValue:t}),this.gridApi&&this.gridApi.setQuickFilter(t)},this.onGridReady=e=>{this.gridApi=e.api,this.gridApi.sizeColumnsToFit(),window.onresize=()=>this.gridApi.sizeColumnsToFit()},this.state={columnDefs:[{headerName:"Title",field:"title",cellRendererFramework:ed,cellRendererParams:{handleSetSourcecastData:this.props.handleSetSourcecastData},width:300,suppressMovable:!0,suppressMenu:!0,cellStyle:{"text-align":"left"},hide:!this.props.handleSetSourcecastData},{headerName:"Title",field:"title",width:100,suppressMovable:!0,suppressMenu:!0,hide:!!this.props.handleSetSourcecastData},{headerName:"Uploader",field:"uploader.name",width:200,suppressMovable:!0,suppressMenu:!0,cellStyle:{"text-align":"center"}},{headerName:"Date",valueGetter:e=>{return t=e.data.inserted_at,g()(t).format("MMMM Do YYYY");var t},maxWidth:200,suppressMovable:!0,suppressMenu:!0},{headerName:"Share",field:"uid",cellRendererFramework:ad,width:100,suppressMovable:!0,suppressMenu:!0},{headerName:"Delete",field:"",cellRendererFramework:Jc,cellRendererParams:{handleDeleteSourcecastEntry:this.props.handleDeleteSourcecastEntry},width:100,maxWidth:100,sortable:!1,suppressMovable:!0,suppressMenu:!0,cellStyle:{"text-align":"center"},hide:!this.props.handleDeleteSourcecastEntry},{headerName:"description",field:"description",hide:!0},{headerName:"inserted_at",field:"inserted_at",hide:!0},{headerName:"updated_at",field:"updated_at",hide:!0},{headerName:"audio",field:"audio",hide:!0},{headerName:"playbackData",field:"playbackData",hide:!0},{headerName:"url",field:"url",hide:!0}],filterValue:"",groupFilterEnabled:!1},this.defaultColumnDefs={filter:!0,resizable:!0,sortable:!0}}render(){const e=Object(a.jsx)(K.D,{className:"Sourcecast",description:"Fetching sourcecast index...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_LARGE})}),t=Object(O.sortBy)(this.props.sourcecastIndex,[e=>-e.id]),s=Object(a.jsxs)("div",{className:"SourcecastContainer",children:[Object(a.jsx)("br",{}),Object(a.jsx)("div",{children:Object(a.jsx)(K.l,{label:"",labelFor:"text-input",children:Object(a.jsx)(K.v,{id:"searchBar",large:!1,leftIcon:"search",placeholder:"Search",value:this.state.filterValue,onChange:this.handleFilterChange})})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"SourcecastTable",children:Object(a.jsx)("div",{className:"ag-grid-parent",children:Object(a.jsx)(ka.AgGridReact,{domLayout:"autoHeight",columnDefs:this.state.columnDefs,defaultColDef:this.defaultColumnDefs,onGridReady:this.onGridReady,rowData:t,rowHeight:30,pagination:!1,paginationPageSize:50})})}),Object(a.jsx)("br",{})]});return Object(a.jsx)("div",{children:void 0===this.props.sourcecastIndex?e:s})}}var id=nd,rd=s(296),od=s.n(rd);class cd extends m.PureComponent{constructor(e){super(e),this.recorder=void 0,this.handleCloseDialog=()=>this.setState({dialogOpen:!1}),this.handleOpenDialog=()=>this.setState({dialogOpen:!0}),this.updateTimerDuration=()=>{this.setState({duration:this.props.getTimerDuration()})},this.handleTruncatePlaybackData=()=>{const e=this.props.playbackData.inputs.filter((e=>e.time<=1e3*this.props.currentPlayerTime));this.props.handleResetInputs(e)},this.handleRecorderPausing=()=>{if(!this.recorder)return;const{handleSetEditorReadonly:e,handleSetSourcecastData:t,handleTimerPause:s}=this.props;clearInterval(this.state.updater),e(!0),s(),this.recorder.pause();t("","","",window.URL.createObjectURL(this.recorder.exportWAV()),this.props.playbackData)},this.handleRecorderStarting=()=>{this.recorder=new od.a;const{handleRecordInit:e,handleSetEditorReadonly:t,handleTimerStart:s}=this.props;this.recorder.start().then((()=>{e(),t(!1),s();const a=setInterval(this.updateTimerDuration,100);this.setState({updater:a})}),(e=>{alert("Microphone not found: "+e)}))},this.handleRecorderResuming=()=>{if(!this.recorder)return;const{handleSetEditorReadonly:e,handleTimerResume:t}=this.props;e(!1),t(-1);const s=setInterval(this.updateTimerDuration,100);this.setState({updater:s}),this.recorder.resume()},this.handleRecorderResumingFromCurrent=()=>{if(!this.recorder)return;const{currentPlayerTime:e,handleSetEditorReadonly:t,handleTimerResume:s}=this.props;this.handleTruncatePlaybackData(),t(!1),s(1e3*e);const a=setInterval(this.updateTimerDuration,100);this.setState({updater:a}),this.recorder.resume(e)},this.handleRecorderStopping=()=>{if(!this.recorder)return;const{handleSetEditorReadonly:e,handleTimerStop:t}=this.props;e(!1),t(),clearInterval(this.state.updater),this.recorder.stop(),this.setState({fileDataBlob:this.recorder.exportWAV()}),this.recorder.clear()},this.handleRecorderResetting=()=>{const{handleSetEditorReadonly:e,handleTimerReset:t}=this.props;e(!1),t(),clearInterval(this.state.updater),this.setState({duration:0}),this.recorder&&(this.recorder.stop(),this.recorder.clear())},this.handleRecorderSaving=()=>{this.state.fileDataBlob?this.props.handleSaveSourcecastData(this.state.saveTitle,this.state.saveDescription,this.state.saveUID,this.state.fileDataBlob,this.props.playbackData):alert("No recording found")},this.renderLabel=e=>{const t=Math.floor(e/60),s=Math.floor(e-60*t);return(t<10?"0"+t:t)+":"+(s<10?"0"+s:s)},this.handleSaveTitleInputChange=e=>{this.setState({saveTitle:e.target.value})},this.handleSaveDescriptionInputChange=e=>{this.setState({saveDescription:e.target.value})},this.handleSaveUIDInputChange=e=>{this.setState({saveUID:e.target.value})},this.state={dialogOpen:!1,duration:0,updater:void 0,saveTitle:"",saveDescription:"",saveUID:""}}async componentDidMount(){od.a.getPermission().then((()=>{}),(e=>{alert("Microphone not found: "+e)}))}render(){const e=It("Record Pause",Y.a.SNOWFLAKE,this.props.handleRecordPause),t=It("Pause",Y.a.PAUSE,this.handleRecorderPausing),s=It("Resume",Y.a.PLAY,this.handleRecorderResuming),n=It("Resume Here",Y.a.PLAY,this.handleRecorderResumingFromCurrent),i=It("Record",Y.a.PLAY,this.handleRecorderStarting),r=It("Stop",Y.a.STOP,this.handleRecorderStopping),o=It("Reset",Y.a.REFRESH,this.handleRecorderResetting),c=It("Upload",Y.a.FLOPPY_DISK,this.handleOpenDialog);return Object(a.jsxs)("div",{children:[Object(a.jsxs)(K.g,{icon:"info-sign",isOpen:this.state.dialogOpen,onClose:this.handleCloseDialog,title:"Upload Sourcecast",canOutsideClickClose:!0,children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsx)(K.v,{id:"title",leftIcon:Y.a.HEADER,onChange:this.handleSaveTitleInputChange,placeholder:"Title",value:this.state.saveTitle}),Object(a.jsx)("br",{}),Object(a.jsx)(K.v,{id:"description",leftIcon:Y.a.LIST_DETAIL_VIEW,onChange:this.handleSaveDescriptionInputChange,placeholder:"Description",value:this.state.saveDescription}),Object(a.jsx)("br",{}),Object(a.jsx)(K.v,{id:"uid",leftIcon:Y.a.KEY,onChange:this.handleSaveUIDInputChange,placeholder:"UID (optional, only alphanumeric, dash and underscore allowed)",value:this.state.saveUID})]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[It("Confirm Upload",Y.a.TICK,this.handleRecorderSaving),It("Cancel",Y.a.CROSS,this.handleCloseDialog)]})})]}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{className:"Timer",children:Object(a.jsx)(K.e,{elevation:2,style:{background:"#24323F"},children:Object(a.jsx)(K.m,{children:this.renderLabel(this.props.recordingStatus!==St.c.paused?this.state.duration/1e3:this.props.currentPlayerTime)})})}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{className:"RecorderControl",children:[this.props.recordingStatus===St.c.notStarted&&i,this.props.recordingStatus===St.c.paused&&s,this.props.recordingStatus===St.c.paused&&n,this.props.recordingStatus===St.c.recording&&t,this.props.recordingStatus===St.c.recording&&e,this.props.recordingStatus===St.c.paused&&r,this.props.recordingStatus===St.c.finished&&c,this.props.recordingStatus!==St.c.notStarted&&o]}),Object(a.jsx)("br",{})]})}}var dd=cd;class ld extends m.Component{constructor(...e){super(...e),this.getTimerDuration=()=>this.props.timeElapsedBeforePause+Date.now()-this.props.timeResumed,this.handleRecordInit=()=>this.props.handleRecordInit({chapter:this.props.sourceChapter,externalLibrary:this.props.externalLibraryName,editorValue:this.props.editorValue}),this.handleRecordPause=()=>this.props.handleRecordInput({time:this.getTimerDuration(),type:"forcePause",data:null})}componentDidMount(){this.props.handleFetchSourcecastIndex()}componentDidUpdate(e){const{inputToApply:t}=this.props;if(t&&t!==e.inputToApply)switch(t.type){case"activeTabChange":this.props.handleActiveTabChange(t.data);break;case"chapterSelect":this.props.handleChapterSelect(t.data);break;case"externalLibrarySelect":this.props.handleExternalSelect(t.data);break;case"forcePause":this.props.handleSetSourcecastStatus(St.b.forcedPaused)}}render(){const e=Object(a.jsx)(Dc,{handleDebuggerPause:this.props.handleDebuggerPause,handleDebuggerReset:this.props.handleDebuggerReset,handleDebuggerResume:this.props.handleDebuggerResume,handleEditorEval:()=>{this.props.handleEditorEval(),this.props.recordingStatus===St.c.recording&&this.props.handleRecordInput({time:this.getTimerDuration(),type:"keyboardCommand",data:St.a.run})},handleInterruptEval:this.props.handleInterruptEval,handleToggleEditorAutorun:this.props.handleToggleEditorAutorun,isDebugging:this.props.isDebugging,isEditorAutorun:this.props.isEditorAutorun,isRunning:this.props.isRunning},"autorun"),t=Object(a.jsx)(Et,{handleChapterSelect:({chapter:e},t)=>{this.props.handleChapterSelect(e),this.props.recordingStatus===St.c.recording&&this.props.handleRecordInput({time:this.getTimerDuration(),type:"chapterSelect",data:e})},sourceChapter:this.props.sourceChapter,sourceVariant:this.props.sourceVariant},"chapter"),s=Object(a.jsx)(Tt,{handleReplOutputClear:this.props.handleReplOutputClear},"clear_repl"),n=Object(a.jsx)(kt,{handleReplEval:this.props.handleReplEval,isRunning:this.props.isRunning},"eval_repl"),i=Object(a.jsx)(Gc,{externalLibraryName:this.props.externalLibraryName,handleExternalSelect:({name:e},t)=>{this.props.handleExternalSelect(e),this.props.recordingStatus===St.c.recording&&this.props.handleRecordInput({time:this.getTimerDuration(),type:"externalLibrarySelect",data:e})}},"external_library"),r={codeDeltasToApply:this.props.codeDeltasToApply,editorReadonly:this.props.editorReadonly,editorValue:this.props.editorValue,editorSessionId:"",getTimerDuration:this.getTimerDuration,handleDeclarationNavigate:this.props.handleDeclarationNavigate,handleEditorEval:this.props.handleEditorEval,handleEditorValueChange:this.props.handleEditorValueChange,isEditorAutorun:this.props.isEditorAutorun,inputToApply:this.props.inputToApply,isPlaying:this.props.playbackStatus===St.b.playing,isRecording:this.props.recordingStatus===St.c.recording,breakpoints:this.props.breakpoints,highlightedLines:this.props.highlightedLines,newCursorPosition:this.props.newCursorPosition,handleEditorUpdateBreakpoints:this.props.handleEditorUpdateBreakpoints,handleRecordInput:this.props.handleRecordInput},o={controlBarProps:{editorButtons:[e,t,i]},customEditor:Object(a.jsx)(Yc,{...r}),editorHeight:this.props.editorHeight,editorWidth:this.props.editorWidth,handleEditorHeightChange:this.props.handleEditorHeightChange,handleEditorWidthChange:this.props.handleEditorWidthChange,handleSideContentHeightChange:this.props.handleSideContentHeightChange,replProps:{output:this.props.output,replValue:this.props.replValue,handleBrowseHistoryDown:this.props.handleBrowseHistoryDown,handleBrowseHistoryUp:this.props.handleBrowseHistoryUp,handleReplEval:this.props.handleReplEval,handleReplValueChange:this.props.handleReplValueChange,sourceChapter:this.props.sourceChapter,sourceVariant:this.props.sourceVariant,externalLibrary:this.props.externalLibraryName,replButtons:[n,s]},sideContentHeight:this.props.sideContentHeight,sideContentProps:{handleActiveTabChange:e=>{this.props.handleActiveTabChange(e),this.props.recordingStatus===St.c.recording&&this.props.handleRecordInput({time:this.getTimerDuration(),type:"activeTabChange",data:e})},selectedTabId:this.props.sideContentActiveTab,tabs:[{label:"Recording Panel",iconName:Y.a.COMPASS,body:Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{className:"Multi-line",children:Object(a.jsxs)(K.I,{children:[" ",ud," "]})}),Object(a.jsx)(dd,{currentPlayerTime:this.props.currentPlayerTime,editorValue:this.props.editorValue,getTimerDuration:this.getTimerDuration,playbackData:this.props.playbackData,handleRecordInit:this.handleRecordInit,handleRecordPause:this.handleRecordPause,handleResetInputs:this.props.handleResetInputs,handleSaveSourcecastData:this.props.handleSaveSourcecastData,handleSetSourcecastData:this.props.handleSetSourcecastData,handleSetEditorReadonly:this.props.handleSetEditorReadonly,handleTimerPause:this.props.handleTimerPause,handleTimerReset:this.props.handleTimerReset,handleTimerResume:this.props.handleTimerResume,handleTimerStart:this.props.handleTimerStart,handleTimerStop:this.props.handleTimerStop,recordingStatus:this.props.recordingStatus})]}),id:Os.b.sourcereel,toSpawn:()=>!0},{label:"Sourcecast Table",iconName:Y.a.EDIT,body:Object(a.jsx)("div",{children:Object(a.jsx)(id,{handleDeleteSourcecastEntry:this.props.handleDeleteSourcecastEntry,sourcecastIndex:this.props.sourcecastIndex})}),id:Os.b.introduction,toSpawn:()=>!0},hd,pd,gd],workspaceLocation:"sourcereel"}},c={handleEditorValueChange:this.props.handleEditorValueChange,handlePromptAutocomplete:this.props.handlePromptAutocomplete,handleSetCurrentPlayerTime:this.props.handleSetCurrentPlayerTime,handleSetCodeDeltasToApply:this.props.handleSetCodeDeltasToApply,handleSetEditorReadonly:this.props.handleSetEditorReadonly,handleSetInputToApply:this.props.handleSetInputToApply,handleSetSourcecastDuration:this.props.handleSetSourcecastDuration,handleSetSourcecastStatus:this.props.handleSetSourcecastStatus,audioUrl:this.props.audioUrl,currentPlayerTime:this.props.currentPlayerTime,duration:this.props.playbackDuration,playbackData:this.props.playbackData,playbackStatus:this.props.playbackStatus,handleChapterSelect:this.props.handleChapterSelect,handleExternalSelect:this.props.handleExternalSelect};return Object(a.jsxs)("div",{className:mt()("Sourcereel",it.a.DARK),children:[this.props.recordingStatus===St.c.paused?Object(a.jsx)(Wc,{...c}):void 0,Object(a.jsx)(oa,{...o})]})}}const ud="Welcome to Sourcereel!",hd={label:"Data Visualizer",iconName:Y.a.EYE_OPEN,body:Object(a.jsx)(Xc,{}),id:Os.b.dataVisualiser,toSpawn:()=>!0},pd={label:"Inspector",iconName:Y.a.SEARCH,body:Object(a.jsx)(Hc,{}),id:Os.b.inspector,toSpawn:()=>!0},gd={label:"Env Visualizer",iconName:Y.a.GLOBE,body:Object(a.jsx)(Uc,{}),id:Os.b.envVisualiser,toSpawn:()=>!0};var md=ld;const bd="sourcereel";var jd=Object(d.c)((e=>({audioUrl:e.workspaces.sourcecast.audioUrl,currentPlayerTime:e.workspaces.sourcecast.currentPlayerTime,codeDeltasToApply:e.workspaces.sourcecast.codeDeltasToApply,breakpoints:e.workspaces.sourcereel.breakpoints,editorReadonly:e.workspaces.sourcereel.editorReadonly,editorValue:e.workspaces.sourcereel.editorValue,editorWidth:e.workspaces.sourcereel.editorWidth,enableDebugging:e.workspaces.sourcereel.enableDebugging,externalLibraryName:e.workspaces.sourcereel.externalLibrary,highlightedLines:e.workspaces.sourcereel.highlightedLines,inputToApply:e.workspaces.sourcecast.inputToApply,isDebugging:e.workspaces.sourcereel.isDebugging,isEditorAutorun:e.workspaces.sourcereel.isEditorAutorun,isRunning:e.workspaces.sourcereel.isRunning,newCursorPosition:e.workspaces.sourcereel.newCursorPosition,output:e.workspaces.sourcereel.output,playbackData:e.workspaces.sourcereel.playbackData,playbackDuration:e.workspaces.sourcecast.playbackDuration,playbackStatus:e.workspaces.sourcecast.playbackStatus,recordingStatus:e.workspaces.sourcereel.recordingStatus,replValue:e.workspaces.sourcereel.replValue,sideContentHeight:e.workspaces.sourcereel.sideContentHeight,sideContentActiveTab:e.workspaces.sourcereel.sideContentActiveTab,sourcecastIndex:e.workspaces.sourcecast.sourcecastIndex,sourceChapter:e.workspaces.sourcereel.context.chapter,sourceVariant:e.workspaces.sourcereel.context.variant,timeElapsedBeforePause:e.workspaces.sourcereel.timeElapsedBeforePause,timeResumed:e.workspaces.sourcereel.timeResumed})),(e=>Object(u.b)({handleActiveTabChange:e=>Object(pt.updateActiveTab)(e,bd),handleBrowseHistoryDown:()=>Object(pt.browseReplHistoryDown)(bd),handleBrowseHistoryUp:()=>Object(pt.browseReplHistoryUp)(bd),handleChapterSelect:e=>Object(pt.chapterSelect)(e,"default",bd),handleDeclarationNavigate:e=>Object(pt.navigateToDeclaration)(bd,e),handleDeleteSourcecastEntry:e=>Object(_c.deleteSourcecastEntry)(e,"sourcecast"),handleEditorEval:()=>Object(pt.evalEditor)(bd),handleEditorValueChange:e=>Object(pt.updateEditorValue)(e,bd),handleEditorHeightChange:e=>Object(pt.changeEditorHeight)(e,bd),handleEditorWidthChange:e=>Object(pt.changeEditorWidth)(e.toString(),bd),handleEditorUpdateBreakpoints:e=>Object(pt.setEditorBreakpoint)(e,bd),handleExternalSelect:e=>Object(pt.externalLibrarySelect)(e,bd),handleFetchSourcecastIndex:()=>Object(Mc.fetchSourcecastIndex)("sourcecast"),handleInterruptEval:()=>Object(ht.beginInterruptExecution)(bd),handleRecordInput:e=>Object(_c.recordInput)(e,bd),handleReplEval:()=>Object(pt.evalRepl)(bd),handleReplOutputClear:()=>Object(pt.clearReplOutput)(bd),handleReplValueChange:e=>Object(pt.updateReplValue)(e,bd),handleSaveSourcecastData:(e,t,s,a,n)=>Object(Lc.saveSourcecastData)(e,t,s,a,n,"sourcecast"),handleSetCurrentPlayerTime:e=>Object(Lc.setCurrentPlayerTime)(e,"sourcecast"),handleSetCodeDeltasToApply:e=>Object(Lc.setCodeDeltasToApply)(e,"sourcecast"),handleSetInputToApply:e=>Object(Lc.setInputToApply)(e,"sourcecast"),handleSetSourcecastData:(e,t,s,a,n)=>Object(Lc.setSourcecastData)(e,t,s,a,n,"sourcecast"),handleSetSourcecastDuration:e=>Object(Lc.setSourcecastDuration)(e,"sourcecast"),handleSetSourcecastStatus:e=>Object(Lc.setSourcecastStatus)(e,"sourcecast"),handleSetEditorReadonly:e=>Object(pt.setEditorReadonly)(bd,e),handleResetInputs:e=>Object(_c.resetInputs)(e,bd),handleRecordInit:e=>Object(_c.recordInit)(e,bd),handleSideContentHeightChange:e=>Object(pt.changeSideContentHeight)(e,bd),handleTimerPause:()=>Object(_c.timerPause)(bd),handleTimerReset:()=>Object(_c.timerReset)(bd),handleTimerResume:e=>Object(_c.timerResume)(e,bd),handleTimerStart:()=>Object(_c.timerStart)(bd),handleTimerStop:()=>Object(_c.timerStop)(bd),handleToggleEditorAutorun:()=>Object(pt.toggleEditorAutorun)(bd),handleDebuggerPause:()=>Object(ht.beginDebuggerPause)(bd),handleDebuggerResume:()=>Object(ht.debuggerResume)(bd),handleDebuggerReset:()=>Object(ht.debuggerReset)(bd),handlePromptAutocomplete:(e,t,s)=>Object(pt.promptAutocomplete)(bd,e,t,s)},e)))(md);let yd;!function(e){e.Default="Default",e.ObjectPlacement="ObjectPlacement",e.AssetUploader="AssetUploader",e.CheckpointSim="CheckpointSim",e.ChapterSim="ChapterSim"}(yd||(yd={}));const Od=e=>async(t,s,a={},n={})=>{try{const i=function(e){const t=new Headers;return t.append("Accept","application/json"),t.append("Authorization",`Bearer ${e}`),t}($o.getInstance().getAccountInfo().accessToken||"");Object.entries(a).forEach((([e,t])=>{i.append(e,t)}));const r={method:s,headers:i,...n};return fetch(y.b.backendUrl+`/v1/${e}/`+t,r)}finally{}},vd=Od("assets"),xd=Od("stories");const fd=["locations","objects","images","avatars","ui","sfx","bgm","stories"];const Sd=async()=>(await wd("stories")).filter((e=>e.startsWith("stories")&&e.endsWith("txt"))).map((e=>e.slice(8)));async function Cd(){return(await Promise.all(fd.map((async e=>{const t=await wd(e);return t.length?t:[`${e}`]})))).reduce(((e,t)=>e.concat(t)),[])}async function wd(e){const t=await vd(e,"GET",{"Content-Type":"application/json"});return 200===t.status?t.json():[]}async function Ed(e,t){return(await Promise.all(Array.from(e).map((async e=>{const s=await async function(e,t){const s=new FormData;s.set("upload",e);const a=await vd(`${t}/${e.name}`,"POST",{},{body:s,mode:"cors"});return a?a.text():""}(e,t);return e.name+" => "+s})))).join("\n")}async function Ad(){const e=await xd("","GET"),t=200===e.status?await e.json():[];return v.a.sortBy(t,(e=>new Date(e.openAt)))}async function Id(e,t){const s=await xd(e,"POST",{"Content-Type":"application/json"},{body:JSON.stringify(t)});return 200===s.status?"Chapter successfully created/updated":s.text()}const Td="Specify own folder...";var kd=()=>{const[e,t]=b.a.useState(),[s,n]=b.a.useState(fd[0]),[i,r]=b.a.useState(),[o,c]=b.a.useState(!1);function d(e){e.target.innerText&&(n(e.target.innerText),c(!1))}const l=Object(a.jsxs)(K.w,{children:[fd.map((e=>Object(a.jsx)(K.y,{onClick:d,id:e,text:e},e))),Object(a.jsx)(K.y,{onClick:function(e){e.target.innerText&&(n(e.target.innerText),c(!0))},id:Td,text:Td},Td)]});return Object(a.jsxs)("div",{className:"LeftAlign",children:[Object(a.jsx)("h4",{children:"Choose Folder"}),Object(a.jsx)(Ds.a,{placement:rt.a.BOTTOM,content:l,children:Object(a.jsx)(K.b,{text:s})}),o&&Object(a.jsx)(K.v,{placeholder:"Or specify your own, e.g. 'locations/hallway'",onChange:function(e){r(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("h4",{children:"Choose File"}),Object(a.jsx)("input",{type:"file",multiple:!0,onChange:function(e){if(!e.target.files)return;const s=e.target.files;t(s)}}),Object(a.jsx)(K.b,{onClick:async function(){const t=i||s;if(!e||!t)return;const a=await Ed(e,t);alert(a)},children:"Upload"})]})};function Nd(e,t){e&&e.forEach((e=>{t(e),Nd(e.childNodes,t)}))}function Pd(e,t,s=[]){const a={};return e.forEach((e=>v.a.set(a,e.split("/"),"FILE"))),s.forEach((e=>{a[e]&&"FILE"!==a[e]||(a[e]=[])})),function e(s,a){return Object.keys(a).map((n=>{const i="/"+s.join("/")+"/"+n;return{id:i,label:n,secondaryLabel:t(i),childNodes:"FILE"===a[n]?void 0:e([...s,n],a[n])}}))}([],a)}var Rd=Object(m.memo)((({assetPath:e})=>{const t=e||_a.defaultAssetPath;return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("img",{alt:"asset",crossOrigin:"anonymous",src:_a.assetsFolder+t,width:"150px",onError:e=>{e.target.onerror=null,e.target.src=_a.assetsFolder+_a.defaultAssetPath}})})}));const Md=e=>Object(a.jsx)(ot.a,{content:"Delete",children:Object(a.jsx)(K.u,{icon:"trash",onClick:Ld(e)})}),Ld=e=>async()=>{const t=window.confirm(`Are you sure you want to delete ${e}?\nThere is no undoing this action!`);alert(t?await async function(e){const t=await vd(e,"DELETE");return await t.text()||"Successfully Deleted"}(e):"Whew")};var _d=()=>{const{value:e}=zt(Cd,[]),[t,s]=b.a.useState(""),[n,i]=b.a.useState({nodes:[]});b.a.useEffect((()=>{i({nodes:Pd(e,Md,fd)})}),[e]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Rd,{assetPath:t}),Object(a.jsx)(K.U,{contents:n.nodes,onNodeClick:e=>{Nd(n.nodes,(e=>e.isSelected=!1)),e.isSelected=!e.isSelected,e.isExpanded=!e.isExpanded;const t=e.id.toString();e.childNodes||(s(t),sessionStorage.setItem("selectedAsset",t)),i({...n})}})]})},Dd=s(412),Gd=s.n(Dd),Bd=s(298);const Ud=b.a.memo(Object(Bd.b)((({value:e})=>Object(a.jsx)("div",{children:Object(a.jsx)(K.b,{children:e})})))),Fd=b.a.memo(Object(Bd.a)((({items:e})=>Object(a.jsx)("div",{children:e&&e.map(((e,t)=>Object(a.jsx)(Ud,{index:t,value:e},`item-${e}`)))}))));var Hd=b.a.memo((({chapterDetail:e,checkpointFilenames:t})=>{const{id:s}=e,{value:n,setValue:i,inputProps:r}=Kt(""),{value:o,setValue:c,inputProps:d}=Kt(""),{items:l,setItems:u,onSortEnd:h}=(()=>{const[e,t]=b.a.useState([]),s=b.a.useCallback((({oldIndex:e,newIndex:s})=>{t((t=>Gd()(t,e,s)))}),[]);return{items:e,setItems:t,onSortEnd:s}})(),[p,m]=b.a.useState(!1),[j,y]=b.a.useState(new Date),[O,v]=b.a.useState([]),[x,f]=b.a.useState(!1);b.a.useEffect((()=>{i(e.title),c(e.imageUrl),y(new Date(e.openAt)),u(e.filenames),m(e.isPublished),v((t||[]).filter((t=>!e.filenames.includes(t))))}),[e,u,c,y,i,t,x]);const S=b.a.useCallback((e=>{u((t=>t.filter((t=>t!==e)))),v((t=>[...t,e]))}),[u]),C=b.a.useCallback((e=>{u((t=>[...t,e])),v((t=>t.filter((t=>t!==e))))}),[u]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("h4",{children:["Title: ",Object(a.jsx)("input",{className:"bp3-input",type:"text",...r})]}),Object(a.jsx)("b",{children:"Open date: "}),j&&(w=j.toISOString(),g()(w).format("MMMM Do YYYY, HH:mm")),Object(a.jsx)(ue.a,{onChange:e=>{e&&y(e)}}),Object(a.jsxs)("h4",{children:["Image url: ",Object(a.jsx)("input",{className:"bp3-input",type:"text",...d}),Object(a.jsx)(K.b,{onClick:e=>window.open(yn(o)),children:"View"})]}),Object(a.jsx)("b",{children:"Checkpoint Txt Files"}),Object(a.jsx)(Fd,{items:l,onSortEnd:h}),Object(a.jsx)("br",{}),l.length>0&&Object(a.jsx)(K.b,{icon:"delete",onClick:()=>l.map(S),children:"Clear checkpoint files"}),Object(a.jsx)("br",{}),Object(a.jsx)("b",{children:"All Txt Files"}),O&&O.map((e=>Object(a.jsx)("div",{children:Object(a.jsx)(K.b,{onClick:()=>C(e),icon:"add",children:e})},`choice-${e}`))),Object(a.jsx)("br",{}),Object(a.jsx)(K.b,{icon:"play",onClick:async()=>{$o.getInstance().setChapterSimStack(l),await uo()},children:"Simulate Chapter"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(K.N,{checked:p,labelElement:"Published",onChange:()=>m(!p)}),Object(a.jsx)(K.b,{onClick:async()=>{const e={openAt:j.toISOString(),closeAt:Vd(j).toISOString(),title:n,filenames:l,imageUrl:o,isPublished:p};if(!window.confirm(`Are you sure you want to save changes to ${JSON.stringify(e)}`))return;const t=parseInt(s)===qd?await Id("",e):await Id(s,{story:e});alert(t)},children:"Save Changes"}),Object(a.jsx)(K.b,{intent:fe.a.WARNING,onClick:()=>{window.confirm("Are you you want to clear changes for this chapter?")&&(f(!x),alert("Cleared changes"))},children:"Clear Changes"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(K.b,{icon:"trash",intent:fe.a.DANGER,onClick:async()=>{if(window.confirm("Are you sure you want to delete this chapter?")){const e=await async function(e){const t=await xd(e,"DELETE");return 204===t.status?"Chapter successfully deleted":t.text()}(s);alert(e)}},children:"Delete Chapter"})]});var w}));const Vd=e=>(e.setFullYear(e.getFullYear()+1),e),qd=-1,Xd={id:qd,title:"title goes here",imageUrl:"/locations/telebay/emergency.png",openAt:(new Date).toISOString(),closeAt:Vd(new Date).toISOString(),isPublished:!1,filenames:[]};var $d=b.a.memo((()=>{const{value:e}=zt(Sd,[]),{value:t}=zt(Ad,[]),[s,n]=b.a.useState(qd);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h3",{children:"Chapter Simulator"}),Object(a.jsxs)("select",{className:"bp3-menu",onChange:e=>n(e.target.value),children:[t.map(((e,t)=>Object(a.jsx)("option",{value:t,children:`Chapter ${t}: ${e.title}`},t))),Object(a.jsx)("option",{value:qd,children:"Create new chapter"},qd)]}),Object(a.jsx)("hr",{}),Object(a.jsx)(Hd,{chapterDetail:t[s]||Xd,checkpointFilenames:e})]})}));const Wd={key:La.zektonDarkFont.key,size:35,align:Phaser.GameObjects.BitmapText.ALIGN_CENTER};var zd={maxOptButtonsRow:2,optButton:{xSpace:.9*Da.x,ySpace:.5*Da.y},gameTxtStorageName:{defaultChapter:"defaultChapter",checkpointTxt:"checkpointTxt"}};s(778);const Kd=(e,t)=>{const s=new FileReader;s.readAsText(t),s.onloadend=t=>{s.result&&sessionStorage.setItem(e,s.result.toString())}};var Yd=function({storageName:e,s3TxtFiles:t}){const[s,n]=b.a.useState(t[0]),i=Object(a.jsx)("input",{type:"file",onChange:function(t){if(!t.target.files)return;const[s]=t.target.files;Kd(e,s)},style:{width:"250px"}}),r=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("select",{className:"bp3-menu",onChange:async function(t){const s=t.target.value;n(s);const a=await fetch(`${_a.assetsFolder}/stories/${s}`,{headers:Qd()}),i=await a.text();sessionStorage.setItem(e,i)},children:t.map((e=>Object(a.jsx)("option",{value:e,children:e},e)))}),Object(a.jsx)(K.b,{icon:"download",onClick:()=>window.open(Mr(s))})]});return Object(a.jsxs)("div",{className:"LeftAlign",children:[Object(a.jsx)("hr",{}),Object(a.jsxs)(K.P,{id:"Tabs",renderActiveTabPanelOnly:!0,children:[Object(a.jsx)(K.O,{id:"own",title:"Local",panel:i}),Object(a.jsx)(K.O,{id:"s3",title:"S3",panel:r})]},"vertical"),Object(a.jsx)("hr",{})]})};function Qd(){const e=new Headers;return e.append("Access-Control-Allow-Origin","*"),e}function Jd(){const{value:e}=zt(Sd,[]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h3",{children:"Checkpoint Text Loader"}),Object(a.jsx)("b",{children:"Step 1: Choose default checkpoint"}),Object(a.jsx)(Yd,{s3TxtFiles:e,storageName:zd.gameTxtStorageName.defaultChapter}),Object(a.jsx)("b",{children:"Step 2: Choose checkpoint text"}),Object(a.jsx)(Yd,{s3TxtFiles:e,storageName:zd.gameTxtStorageName.checkpointTxt}),Object(a.jsx)("br",{}),Object(a.jsx)(K.b,{onClick:function(){$o.getInstance().getCurrentSceneRef().simulateCheckpoint()},icon:"play",children:"Simulate Checkpoint"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(K.b,{onClick:Zd,children:"Reset All Files"}),Object(a.jsx)("br",{})]})}function Zd(e){sessionStorage.setItem(zd.gameTxtStorageName.checkpointTxt,""),sessionStorage.setItem(zd.gameTxtStorageName.defaultChapter,"")}var el={storySimBg:{type:cn.Image,key:"student-room",path:"/locations/deathCube_ext/shields-down.png"},shortButton:{type:cn.Image,key:"short-button",path:"/ui/shortButton.png"},invertedButton:{type:cn.Image,key:"inverted-button",path:"/ui/invertedColorButton.png"},blueUnderlay:{type:cn.Image,key:"blue-underlay",path:"/ui/blueUnderlay.png"},topButton:{type:cn.Image,key:"top-button",path:"/ui/topButton.png"},colorIcon:{type:cn.Image,key:"color-icon",path:"/ui/colorIcon.png"},imageIcon:{type:cn.Image,key:"image-icon",path:"/ui/imageIcon.png"},bboxIcon:{type:cn.Image,key:"bbox-icon",path:"/ui/bboxIcon.png"},handIcon:{type:cn.Image,key:"hand-icon",path:"/ui/handIcon.png"},listIcon:{type:cn.Image,key:"list-icon",path:"/ui/listIcon.png"},eraseIcon:{type:cn.Image,key:"erase-icon",path:"/ui/eraserIcon.png"},iconBg:{type:cn.Image,key:"icon-bg",path:"/ui/modeIconBg.png"}};class tl extends Phaser.Scene{constructor(){super("StorySimulatorMenu"),this.layerManager=void 0,this.getLayerManager=()=>On(this.layerManager)}preload(){$o.getInstance().setCurrentSceneRef(this),this.layerManager=new Mi(this),xi(this),Object.values(ln).forEach((e=>this.load.image(e.key,yn(e.path)))),Object.values(el).forEach((e=>this.load.image(e.key,yn(e.path)))),Object.values(La).forEach((e=>this.load.bitmapFont(e.key,e.pngPath,e.fntPath))),$o.getInstance().getSoundManager().loadSoundAssetMap(pn)}async create(){"student"!==$o.getInstance().getAccountInfo().role?(this.renderBackground(),this.renderOptionButtons()):console.log("Students cannot use story sim")}renderOptionButtons(){const e=new Phaser.GameObjects.Container(this,0,0),t=this.getOptionButtons(),s=Ha({numOfItems:t.length,maxXSpace:zd.optButton.xSpace,maxYSpace:zd.optButton.ySpace,numItemLimit:zd.maxOptButtonsRow,redistributeLast:!0});e.add(t.map(((e,t)=>this.createOptButton(e.text,s[t][0],s[t][1],e.callback)))),this.getLayerManager().addToLayer(gn.UI,e)}getOptionButtons(){return[{text:"Object Placement",callback:()=>{$o.getInstance().setStorySimState(yd.ObjectPlacement),this.getLayerManager().clearAllLayers(),this.scene.start("ObjectPlacement")}},{text:"Checkpoint Simulator",callback:()=>{$o.getInstance().setStorySimState(yd.CheckpointSim)}},{text:"Asset Uploader",callback:()=>{$o.getInstance().setStorySimState(yd.AssetUploader)}},{text:"Chapter Simulator",callback:()=>{$o.getInstance().setStorySimState(yd.ChapterSim)}}]}createOptButton(e,t,s,a){return Fn(this,{assetKey:el.invertedButton.key,message:e,textConfig:{x:0,y:0,oriX:.5,oriY:.5},bitMapTextStyle:Wd,onUp:a}).setPosition(t,s)}simulateCheckpoint(){const e=sessionStorage.getItem(zd.gameTxtStorageName.defaultChapter)||"",t=sessionStorage.getItem(zd.gameTxtStorageName.checkpointTxt)||"";if(""===e&&""===t)return;this.getLayerManager().clearAllLayers(),co.parse(e),t&&co.parse(t,!0);const s=co.checkpoint;this.scene.start("GameManager",{gameCheckpoint:s,chapterNum:-1,checkpointNum:-1})}renderBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,el.storySimBg.key);e.setDisplaySize(Da.x,Da.y);const t=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,el.blueUnderlay.key).setAlpha(.5);this.getLayerManager().addToLayer(gn.Background,e),this.getLayerManager().addToLayer(gn.Background,t)}}var sl=tl;class al{constructor(){this.backgroundAssetPath=void 0,this.objectPlacement=void 0,this.x=void 0,this.y=void 0,this.getObjectPlacement=()=>On(this.objectPlacement),this.x=Ga.x,this.y=Ga.y}initialise(e){this.objectPlacement=e}async loadBackground(){const e=sessionStorage.getItem("selectedAsset");if(!e||!e.startsWith("/locations/"))return;this.backgroundAssetPath=e;const t=`!${e}`;this.getObjectPlacement().addAsset(t,e);const s=await Tr(this.getObjectPlacement(),t,_a.assetsFolder+e);this.renderBackground(s)}renderBackground(e){if("!"!==e[0])return;this.getObjectPlacement().getLayerManager().clearLayerContents(gn.Background);const t=new Phaser.GameObjects.Image(this.getObjectPlacement(),Ga.x,Ga.y,e).setInteractive();this.getObjectPlacement().getLayerManager().addToLayer(gn.Background,t)}getBackgroundAssetPath(){return this.backgroundAssetPath}screenLog(){return this.backgroundAssetPath+"\n"}}let nl;!function(e){e[e.DrawBBox=0]="DrawBBox",e[e.DragResizeObj=1]="DragResizeObj"}(nl||(nl={}));class il{constructor(){this.checkpointTitle="boundingBoxes",this.objectPlacement=void 0,this.bboxBeingDrawn=void 0,this.startingCoordinates=void 0,this.bboxDetailMap=void 0,this.getObjectPlacement=()=>On(this.objectPlacement),this.bboxDetailMap=new Map}initialise(e){this.objectPlacement=e,this.addBBoxListeners(e)}addBBoxListeners(e){this.getObjectPlacement().getInputManager().registerEventListener("pointerdown",(()=>{this.getObjectPlacement().isCursorMode(nl.DrawBBox)&&(this.bboxBeingDrawn=this.createNewBBox())})),this.getObjectPlacement().getInputManager().registerEventListener("pointerup",(()=>{if(this.getObjectPlacement().isCursorMode(nl.DrawBBox)&&this.bboxBeingDrawn){if(this.bboxBeingDrawn.displayWidth<=2||this.bboxBeingDrawn.displayHeight<=2)return void this.bboxBeingDrawn.destroy();this.bboxBeingDrawn.x+=this.bboxBeingDrawn.displayWidth/2,this.bboxBeingDrawn.y+=this.bboxBeingDrawn.displayHeight/2,this.bboxBeingDrawn.setOrigin(.5),this.registerBBox(this.bboxBeingDrawn),e.input.setDraggable(this.bboxBeingDrawn),this.getObjectPlacement().setActiveSelection(this.bboxBeingDrawn),this.startingCoordinates=void 0,this.bboxBeingDrawn=void 0}}))}createNewBBox(){const[e,t]=this.getObjectPlacement().getCoordinates(),s=new Phaser.GameObjects.Rectangle(this.getObjectPlacement(),e,t,1,1,Ua.white).setOrigin(0).setAlpha(.1).setInteractive().setDataEnabled();return this.startingCoordinates=[e,t],this.getObjectPlacement().getLayerManager().addToLayer(gn.BBox,s),s}registerBBox(e){const t="bbox"+this.getObjectPlacement().generateItemIdNumber(),s={id:t,x:e.x,y:e.y,width:e.displayWidth,height:e.displayHeight};this.bboxDetailMap.set(t,s),e.data.set("itemId",t),e.data.set("type","bbox")}getLoggables(){return[...this.bboxDetailMap.values()]}getItemById(e){return this.bboxDetailMap.get(e)}resizeWhileBeingDrawn(e){if(!this.getObjectPlacement().isCursorMode(nl.DrawBBox)||!this.startingCoordinates||!this.bboxBeingDrawn)return;const[t,s]=this.startingCoordinates,a=e.input.x,n=e.input.y;ai(this.bboxBeingDrawn,a-t,n-s)}checkpointTxtLog(){const e=[];return this.bboxDetailMap.forEach((t=>{const s=["+"+t.id,gi.toIntString(t.x),gi.toIntString(t.y),gi.toIntString(t.width),gi.toIntString(t.height)];e.push(s.join(", ")),e.push("    show_dialogue*(click)")})),e}setAttribute(e,t,s){const a=e.data.get("itemId"),n=this.bboxDetailMap.get(a);n&&(n[t]=s)}deleteAll(){this.bboxDetailMap.clear()}delete(e){const t=e.data.get("itemId");this.bboxDetailMap.delete(t)}}var rl={icon:{bgSize:55,size:40,yInterval:15},alpha:{inactive:.7,hover:1,active:.9}};class ol extends Phaser.GameObjects.Container{constructor(e,t,s,a=nl.DragResizeObj){super(e,t,s),this.isModes=void 0,this.currCursorMode=void 0,this.cursorModes=void 0,this.currActiveModeIdx=void 0,this.currCursorMode=a,this.isModes=new Array,this.cursorModes=new Array,this.currActiveModeIdx=_a.nullSequenceNumber}getCurrCursorMode(){return this.currCursorMode}setCursorMode(e){this.currCursorMode=e}addCursorMode(e,t,s=!0,a="",n=_a.nullFunction,i=_a.nullFunction,r=_a.nullFunction){const o=new Phaser.GameObjects.Container(e,0,0);this.isModes.push(s),this.cursorModes.push(o);const c=this.cursorModes.length-1,d=new Wa(e,0,0,a),l=Fn(e,{assetKey:el.iconBg.key,onUp:()=>{this.isModes[c]&&(this.currActiveModeIdx=c),n(),this.renderCursorModesContainer()},onHover:()=>{""!==a&&d.setVisible(!0),o.setAlpha(rl.alpha.hover),i()},onOut:()=>{d.setVisible(!1);const e=c===this.currActiveModeIdx&&this.isModes[c];o.setAlpha(e?rl.alpha.active:rl.alpha.inactive),r()},onPointerMove:e=>{d.x=e.x-o.x-100,d.y=e.y-o.y-100},onHoverEffect:!1}),u=new Phaser.GameObjects.Sprite(e,0,0,t).setDisplaySize(rl.icon.size,rl.icon.size);l.add(u),o.add([l,d])}renderCursorModesContainer(){this.removeAll(!1);let e=0;this.cursorModes.forEach(((t,s)=>{t.setPosition(0,e);const a=s===this.currActiveModeIdx&&this.isModes[s];t.setAlpha(a?rl.alpha.active:rl.alpha.inactive),this.add(t),e+=rl.icon.bgSize+rl.icon.yInterval}))}}const cl={key:La.zektonFont.key,size:27,align:Phaser.GameObjects.BitmapText.ALIGN_LEFT};function dl(e){return e.split("/").pop().split(".")[0]}const ll=e=>"    "+e;class ul{constructor(){this.detailMapContainer=void 0,this.objectPlacement=void 0,this.getObjectPlacement=()=>On(this.objectPlacement)}initialise(e){this.objectPlacement=e}printCheckpoint(e="/locations/yourRoom-dim/normal.png",t){const s=""===e?"default":dl(e),a=t.map((e=>{const t=e.checkpointTxtLog();if(!t)return"";return`${e.checkpointTitle}\n${t.map(ll).map(ll).join("\n")}`})),n=`\nstartingLoc: ${s}\n\nobjectives\n    talk\n\nlocations\n    ${s}, ${e}, ${gi.toCapitalizedWords(e)}\n\n${s}\n    modes: explore\n    actions\n        show_dialogue(welcome)\n${a.map(ll).join("\n")}\n\ndialogues\n    welcome\n        Congrats on creating your scene\n    click\n        Invisible bounding box is right here\n`;alert("Chapter ready!"),console.log(n)}showDetailMap(e){this.detailMapContainer=new Phaser.GameObjects.Container(this.getObjectPlacement(),0,0),e.forEach((e=>{const t=new Phaser.GameObjects.Rectangle(this.getObjectPlacement(),e.x,e.y,400,210,Ua.darkBlue).setOrigin(0,.5).setAlpha(.9),s=za(this.getObjectPlacement(),this.formatObjectDetails(e),{x:e.x+20,y:e.y+10,oriX:0,oriY:.6},cl).setLetterSpacing(3);this.detailMapContainer.add([t,s])})),this.getObjectPlacement().add.existing(this.detailMapContainer)}formatObjectDetails(e){return Object.entries(e).map((([e,t])=>`${e}: ${"number"===typeof t?gi.toIntString(t):t.toString()}`)).join("\n")}hideDetailMap(){this.detailMapContainer&&this.detailMapContainer.destroy()}}class hl{constructor(){this.checkpointTitle="objects",this.objectPlacement=void 0,this.objectDetailMap=void 0,this.getObjectPlacement=()=>On(this.objectPlacement),this.objectDetailMap=new Map}initialise(e){this.objectPlacement=e,this.objectDetailMap=new Map}async loadObject(){const e=sessionStorage.getItem("selectedAsset");if(!e)return;const t=`#${e}`;this.getObjectPlacement().addAsset(t,e);const s=await Tr(this.getObjectPlacement(),t,_a.assetsFolder+e);this.renderObject(s)}renderObject(e){if("#"!==e[0])return;const t=new Phaser.GameObjects.Image(this.getObjectPlacement(),Ga.x,Ga.y,e).setInteractive().setDataEnabled();this.getObjectPlacement().input.setDraggable(t),this.getObjectPlacement().getLayerManager().addToLayer(gn.Objects,t),this.registerObject(e,t)}registerObject(e,t){const s=this.generateItemId(e,this.getObjectPlacement().generateItemIdNumber()),a={id:s,assetKey:e,assetPath:On(this.getObjectPlacement().getAssetPath(e)),x:Ga.x,y:Ga.y};this.objectDetailMap.set(s,a),t.data.set("itemId",s),t.data.set("type","object"),this.getObjectPlacement().setActiveSelection(t)}generateItemId(e,t){return`${dl(e)}${t}`}getLoggables(){return[...this.objectDetailMap.values()]}checkpointTxtLog(){return Array.from(this.objectDetailMap.values()).map((e=>{const t=["+"+e.id,e.assetPath,gi.toIntString(e.x),gi.toIntString(e.y)];return e.width&&(t.push(gi.toIntString(e.width)),t.push(gi.toIntString(e.height))),t.join(", ")}))}setAttribute(e,t,s){const a=e.data.get("itemId"),n=this.objectDetailMap.get(a);n&&(n[t]=s)}deleteAll(){this.objectDetailMap.clear()}delete(e){const t=e.data.get("itemId");this.objectDetailMap.delete(t)}}var pl={activeSelectMargin:30,scaleFactor:1.02};class gl{constructor(){this.activeSelection=void 0,this.activeSelectRect=void 0,this.objectPlacement=void 0,this.getObjectPlacement=()=>On(this.objectPlacement)}initialise(e){this.objectPlacement=e,this.trackDraggables(e),this.drawActiveSelectRect(),this.bindDeleteKey()}drawActiveSelectRect(){this.activeSelectRect=new Phaser.GameObjects.Rectangle(this.getObjectPlacement(),0,0,1,1,0).setAlpha(.3),this.getObjectPlacement().getLayerManager().addToLayer(gn.Selector,this.activeSelectRect)}trackDraggables(e){e.getInputManager().registerEventListener("drag",((t,s,a,n)=>{e.isCursorMode(nl.DrawBBox)||(e.getCursorManager().setCursorMode(nl.DragResizeObj),s.x=a,s.y=n),"object"===s.data.get("type")&&(e.setObjAttribute(s,"x",a),e.setObjAttribute(s,"y",n),this.setActiveSelection(s)),"bbox"===s.data.get("type")&&(e.setBBoxAttribute(s,"x",a),e.setBBoxAttribute(s,"y",n),this.setActiveSelection(s))}))}resizeActive(e){const t=this.getObjectPlacement();if(!this.activeSelection||!this.activeSelectRect)return;const s=e?pl.scaleFactor:1/pl.scaleFactor;!function(e,t){e.displayWidth*=t,e.displayHeight*=t}(this.activeSelection,s),this.activeSelectRect.displayHeight=this.activeSelection.displayHeight+pl.activeSelectMargin,this.activeSelectRect.displayWidth=this.activeSelection.displayWidth+pl.activeSelectMargin,"object"===this.activeSelection.data.get("type")&&(t.setObjAttribute(this.activeSelection,"width",Math.abs(this.activeSelection.displayWidth)),t.setObjAttribute(this.activeSelection,"height",Math.abs(this.activeSelection.displayHeight))),"bbox"===this.activeSelection.data.get("type")&&(t.setBBoxAttribute(this.activeSelection,"width",Math.abs(this.activeSelection.displayWidth)),t.setBBoxAttribute(this.activeSelection,"height",Math.abs(this.activeSelection.displayHeight)))}setActiveSelection(e){this.activeSelectRect&&(this.activeSelectRect.setAlpha(.3),this.activeSelection=e,this.activeSelectRect.x=e.x,this.activeSelectRect.y=e.y,this.activeSelectRect.displayHeight=e.displayHeight+pl.activeSelectMargin,this.activeSelectRect.displayWidth=e.displayWidth+pl.activeSelectMargin)}deselect(){this.activeSelectRect.setAlpha(0),this.activeSelection=void 0}bindDeleteKey(){[Phaser.Input.Keyboard.KeyCodes.BACKSPACE,Phaser.Input.Keyboard.KeyCodes.DELETE].forEach((e=>this.getObjectPlacement().getInputManager().registerKeyboardListener(e,"up",(()=>{this.deleteActiveSelection(),this.deselect()}))))}deleteActiveSelection(){if(this.activeSelection){switch(this.getType(this.activeSelection)){case"object":this.getObjectPlacement().deleteObj(this.activeSelection);break;case"bbox":this.getObjectPlacement().deleteBBox(this.activeSelection)}this.activeSelection.destroy()}}getType(e){var t;return null===(t=this.activeSelection)||void 0===t?void 0:t.data.get("type")}}var ml={cursor:{x:100,y:100}};class bl extends Phaser.Scene{constructor(){super("ObjectPlacement"),this.layerManager=void 0,this.inputManager=void 0,this.transformManager=void 0,this.cursorModes=void 0,this.bboxManager=void 0,this.objectManager=void 0,this.backgroundManager=void 0,this.logManager=void 0,this.assetMap=void 0,this.itemIdNumber=void 0,this.openBracket=void 0,this.closedBracket=void 0,this.getCursorManager=()=>On(this.cursorModes),this.getInputManager=()=>On(this.inputManager),this.getLayerManager=()=>On(this.layerManager),this.objectManager=new hl,this.bboxManager=new il,this.backgroundManager=new al,this.logManager=new ul,this.transformManager=new gl,this.cursorModes=void 0,this.itemIdNumber=0,this.assetMap=new Map}init(){this.layerManager=new Mi(this),this.inputManager=new Ri(this),this.objectManager=new hl,this.bboxManager=new il,this.backgroundManager=new al,this.logManager=new ul,this.transformManager=new gl,this.cursorModes=void 0,this.itemIdNumber=0,this.assetMap=new Map}create(){$o.getInstance().setCurrentSceneRef(this),this.renderBackground(),this.createUIButtons(),this.backgroundManager.initialise(this),this.objectManager.initialise(this),this.bboxManager.initialise(this),this.transformManager.initialise(this),this.logManager.initialise(this),this.openBracket=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.OPEN_BRACKET),this.closedBracket=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.CLOSED_BRACKET)}update(){this.openBracket&&this.openBracket.isDown&&this.transformManager.resizeActive(!1),this.closedBracket&&this.closedBracket.isDown&&this.transformManager.resizeActive(!0),this.bboxManager.resizeWhileBeingDrawn(this)}createUIButtons(){const e=new Phaser.GameObjects.Container(this,0,0),t=new $i(this,(()=>{this.cleanUp(),$o.getInstance().setStorySimState(yd.Default),this.scene.start("StorySimulatorMenu")}));this.cursorModes=new ol(this,ml.cursor.x,ml.cursor.y),this.populateCursorModes(),e.add(this.cursorModes),e.add(t),this.getLayerManager().addToLayer(gn.UI,e)}renderBackground(){const e=new Phaser.GameObjects.Image(this,Ga.x,Ga.y,el.storySimBg.key);e.setDisplaySize(Da.x,Da.y),this.getLayerManager().addToLayer(gn.Background,e)}populateCursorModes(){this.cursorModes&&(this.cursorModes.addCursorMode(this,el.colorIcon.key,!1,"Set background",(async()=>await this.backgroundManager.loadBackground())),this.cursorModes.addCursorMode(this,el.imageIcon.key,!1,"Add selected object",(async()=>await this.objectManager.loadObject())),this.cursorModes.addCursorMode(this,el.bboxIcon.key,!0,"Draw bounding boxes",(()=>this.cursorModes.setCursorMode(nl.DrawBBox))),this.cursorModes.addCursorMode(this,el.handIcon.key,!0,"Drag or resize",(()=>this.cursorModes.setCursorMode(nl.DragResizeObj))),this.cursorModes.addCursorMode(this,el.listIcon.key,!1,"Print coordinates",(()=>this.logManager.printCheckpoint(this.backgroundManager.getBackgroundAssetPath(),[this.objectManager,this.bboxManager])),(()=>this.logManager.showDetailMap([...this.objectManager.getLoggables(),...this.bboxManager.getLoggables()])),(()=>this.logManager.hideDetailMap())),this.cursorModes.addCursorMode(this,el.eraseIcon.key,!1,"Erase all",(()=>{window.confirm("Are you sure you want to delete?")&&(this.getLayerManager().clearSeveralLayers([gn.Background,gn.BBox,gn.Objects]),this.objectManager.deleteAll(),this.bboxManager.deleteAll(),this.transformManager.deselect(),this.renderBackground())})),this.cursorModes.renderCursorModesContainer())}getCoordinates(){return[this.input.x,this.input.y]}isCursorMode(e){return this.getCursorManager().getCurrCursorMode()===e}cleanUp(){this.getInputManager().clearListeners(),this.getLayerManager().clearAllLayers()}addAsset(e,t){this.assetMap.set(e,t)}getAssetPath(e){return this.assetMap.get(e)}generateItemIdNumber(){return this.itemIdNumber++}setActiveSelection(e){this.transformManager.setActiveSelection(e)}setObjAttribute(e,t,s){this.objectManager.setAttribute(e,t,s)}deleteObj(e){this.objectManager.delete(e)}setBBoxAttribute(e,t,s){this.bboxManager.setAttribute(e,t,s)}deleteBBox(e){this.bboxManager.delete(e)}}const jl={debug:!0,type:Ma.CANVAS,width:Da.x,height:Da.y,physics:{default:"arcade"},scale:{mode:Ma.Scale.FIT,parent:"game-display"},fps:{target:24}};var yl=function(){const e=Object(d.f)((e=>e.session)),[t,s]=m.useState(yd.Default);return m.useEffect((()=>{(()=>{const e=new $o(jl,Xo.Simulator);return e.scene.add("StorySimulatorMenu",sl,!0),e.scene.add("ObjectPlacement",bl),e.scene.add("GameManager",cr),e.scene.add("CheckpointTransition",Oo),e})().setStorySimStateSetter(s)}),[]),m.useEffect((()=>{$o.getInstance().setAccountInfo(e)}),[e]),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"StorySimulatorWrapper",children:[Object(a.jsx)("div",{id:"game-display"}),Object(a.jsxs)("div",{className:"LeftAlign StorySimulatorPanel",children:[t===yd.Default&&Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("h3",{children:"Welcome to story simulator!"})}),t===yd.CheckpointSim&&Object(a.jsx)(Jd,{}),t===yd.ObjectPlacement&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h3",{children:"Asset Selection"}),Object(a.jsx)(_d,{})]}),t===yd.AssetUploader&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h3",{children:"Asset uploader"}),Object(a.jsx)(kd,{}),Object(a.jsx)("h3",{children:"Asset Viewer"}),Object(a.jsx)(_d,{})]}),t===yd.ChapterSim&&Object(a.jsx)($d,{})]})]})})};class Ol extends m.Component{constructor(...e){super(...e),this.assessmentRenderFactory=e=>t=>Object(a.jsx)(Aa,{assessmentCategory:e}),this.dynamicRedirect=e=>{const t=e.historyHelper.lastGeneralLocations[0],s=e.historyHelper.lastAcademyLocations[0];return null!=t&&null==at.b.exec(t)&&null!=s?()=>Object(a.jsx)(l.b,{to:s}):this.redirectToGame},this.redirectTo404=()=>Object(a.jsx)(l.b,{to:"/404"}),this.redirectToGame=()=>Object(a.jsx)(l.b,{to:"/academy/game"})}componentDidMount(){this.props.handleFetchNotifications()}render(){const e="student"!==this.props.role?[Object(a.jsx)(l.c,{path:"/academy/groundcontrol",component:Rc},0),Object(a.jsx)(l.c,{path:`/academy/grading/${Ia.c}`,component:xc},1),Object(a.jsx)(l.c,{path:"/academy/sourcereel",component:jd},2),Object(a.jsx)(l.c,{path:"/academy/storysimulator",component:yl},3)]:null;return Object(a.jsx)("div",{className:"Academy",children:Object(a.jsxs)(l.e,{children:[Object(a.jsx)(l.c,{path:`/academy/${ta(wt.a.Contest)}/${Ia.b}`,render:this.assessmentRenderFactory(wt.a.Contest)}),Object(a.jsx)(l.c,{path:"/academy/game",component:Yo}),Object(a.jsx)(l.c,{path:`/academy/${ta(wt.a.Mission)}/${Ia.b}`,render:this.assessmentRenderFactory(wt.a.Mission)}),Object(a.jsx)(l.c,{path:`/academy/${ta(wt.a.Path)}/${Ia.b}`,render:this.assessmentRenderFactory(wt.a.Path)}),Object(a.jsx)(l.c,{path:`/academy/${ta(wt.a.Sidequest)}/${Ia.b}`,render:this.assessmentRenderFactory(wt.a.Sidequest)}),Object(a.jsx)(l.c,{path:`/academy/${ta(wt.a.Practical)}/${Ia.b}`,render:this.assessmentRenderFactory(wt.a.Practical)}),Object(a.jsx)(l.c,{path:"/academy/dashboard",component:Ra}),Object(a.jsx)(l.c,{exact:!0,path:"/academy",component:this.dynamicRedirect(this.props)}),e,Object(a.jsx)(l.c,{component:this.redirectTo404})]})})}}var vl=Ol;var xl=Object(l.h)(Object(d.c)((e=>({historyHelper:e.session.historyHelper})),(e=>Object(u.b)({handleFetchNotifications:st.fetchNotifications},e)))(vl));const fl=Object(a.jsx)("span",{className:"dot",children:"\u2022"});class Sl extends m.Component{render(){return Object(a.jsx)("div",{className:"outsideDetails",children:Object(a.jsxs)(K.e,{className:"contributorsDetails",elevation:nt.a.ONE,children:[Object(a.jsx)(K.o,{children:"The People behind Source Academy"}),Object(a.jsxs)("p",{children:["The ",Object(a.jsx)("i",{children:"Source Academy"}),' is designed by and for students of the National University of Singapore. Students who completed the CS1101S module come back to coach their juniors as "Avengers" or to further develop and improve the Academy. This page includes all developers who contributed to the Source Academy ',Object(a.jsx)("i",{children:"Knight"})," (2020) and its its precursor, ",Object(a.jsx)("i",{children:"Cadet"})," (2018). Both of these succeeded Source Academy 2 (2017) and ultimately the original Source Academy (2016)."]}),Object(a.jsxs)("div",{className:"leadership",children:[Object(a.jsx)(K.q,{children:Object(a.jsx)("strong",{children:Object(a.jsx)("u",{children:"2021 Leadership"})})}),Object(a.jsxs)("p",{children:["Tiffany Chong",Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"(Game)"})]}),fl,Object(a.jsxs)("p",{children:["Anthony Halim",Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"(Frontend)"})]}),fl,Object(a.jsxs)("p",{className:"wider",children:["Daryl Tan,",Object(a.jsx)("br",{}),"Thomas Tan",Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"(Source)"})]}),fl,Object(a.jsxs)("p",{className:"wider",children:["Tee Hao Wei",Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"(Backend & DevOps)"})]}),fl,Object(a.jsxs)("p",{children:["Martin Henz,",Object(a.jsx)("br",{}),"Boyd Anderson,",Object(a.jsx)("br",{}),"Low Kok Lim,",Object(a.jsx)("br",{}),"Eldric Liew",Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"(Coordination)"})]})]}),Object(a.jsxs)("div",{className:"hallOfFame",children:[Object(a.jsx)(K.q,{children:Object(a.jsx)("strong",{children:Object(a.jsx)("u",{children:"Hall of Fame"})})}),Object(a.jsx)("p",{children:Object(a.jsx)("strong",{children:"Cadet architect"})}),Object(a.jsx)("p",{children:"Evan Sebastian"}),Object(a.jsx)("p",{children:Object(a.jsx)("strong",{children:"Cadet core team"})}),Object(a.jsxs)("p",{children:["Julius Putra Tanu Setiaji ",fl," Lee Ning Yuan ",fl," Vignesh Shankar ",fl," Thomas Tan"," ",fl," Chen Shaowei"]}),Object(a.jsx)("p",{children:Object(a.jsx)("strong",{children:"Graphic design"})}),Object(a.jsxs)("p",{children:["Ng Tse Pei ",fl," Joey Yeo ",fl," Tan Yu Wei ",fl," Sigmund Chianasta"]})]}),Object(a.jsxs)("div",{className:"leadership",children:[Object(a.jsx)("p",{children:Object(a.jsx)("strong",{children:"2019 Leadership"})}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["Liow Jia Chen",Object(a.jsx)("br",{}),"(Backend)"]}),fl,Object(a.jsxs)("p",{children:["Ge Shuming",Object(a.jsx)("br",{}),"(Frontend)"]}),fl,Object(a.jsxs)("p",{children:["Rahul Rajesh",Object(a.jsx)("br",{}),"(DevOps)"]}),fl,Object(a.jsxs)("p",{children:["Daryl Tan",Object(a.jsx)("br",{}),"(Source)"]}),fl,Object(a.jsxs)("p",{children:["She Jiayu",Object(a.jsx)("br",{}),"(Tools)"]})]}),Object(a.jsxs)("div",{className:"leadership",children:[Object(a.jsx)("p",{children:Object(a.jsx)("strong",{children:"2020 Leadership"})}),Object(a.jsx)("br",{}),Object(a.jsxs)("p",{children:["Tiffany Chong",Object(a.jsx)("br",{}),"(Game)"]}),fl,Object(a.jsxs)("p",{children:["Anthony Halim",Object(a.jsx)("br",{}),"(Architecture)"]}),fl,Object(a.jsxs)("p",{children:["Kan Yip Keng, Jet",Object(a.jsx)("br",{}),"(Frontend)"]}),fl,Object(a.jsxs)("p",{children:["Low Jun Kai, Sean",Object(a.jsx)("br",{}),"(Frontend)"]}),fl,Object(a.jsxs)("p",{children:["Daryl Tan",Object(a.jsx)("br",{}),"(Source)"]}),fl,Object(a.jsxs)("p",{className:"wider",children:["Tee Hao Wei",Object(a.jsx)("br",{}),"(Backend & DevOps)"]})]}),Object(a.jsxs)("div",{className:"contributors",children:[Object(a.jsx)(K.q,{children:Object(a.jsx)("strong",{children:Object(a.jsx)("u",{children:"All Contributors"})})}),Object(a.jsxs)("p",{children:["Below are all contributors to the"," ",Object(a.jsx)("a",{href:y.a.githubOrg,children:"GitHub repositories of the Source Academy"}),"."]})]})]})})}}var Cl=Sl;const wl=["assessments","tools","source-academy2"],El=["dependabot[bot]","dependabot-preview[bot]"];class Al extends m.Component{constructor(e){super(e),this.state={repos:[],contributors:[]}}componentDidMount(){(async()=>{const e=await fetch("https://api.github.com/orgs/source-academy/repos"),t=await e.json();return await t.filter((e=>!wl.includes(e.name))).map((e=>({key:e.id,name:e.name,description:e.description,link:e.contributors_url})))})().then((e=>(this.setState({repos:e}),e))).then((e=>{(async e=>{const t=await Promise.all(e.map((e=>fetch(e.link)))),s=await Promise.all(t.map((e=>e.json())));return await Promise.all(s.map((e=>e.filter((e=>!El.includes(e.login))).map((e=>({key:e.id,photo:e.avatar_url,githubPage:e.html_url,githubName:e.login,commits:e.contributions}))))))})(e).then((e=>{this.setState({contributors:e})}))}))}render(){const{contributors:e,repos:t}=this.state,s=e.length?e.map(((e,s)=>{const n=t[s],i=e.map((e=>Object(a.jsxs)("div",{children:[Object(a.jsx)("img",{src:e.photo,alt:"Contributor"}),Object(a.jsx)("p",{children:Object(a.jsx)("a",{href:e.githubPage,rel:"noopener noreferrer",target:"_blank",children:e.githubName})}),Object(a.jsxs)("p",{children:["Commits: ",e.commits]})]},e.key)));return Object(a.jsxs)(K.e,{className:"containerPermalink",elevation:nt.a.ONE,children:[Object(a.jsxs)("div",{className:"repoDetailsPermalink",children:[Object(a.jsx)(K.o,{children:n.name}),Object(a.jsx)(K.q,{children:n.description})]}),Object(a.jsx)("div",{className:"inPermalink",children:i})]},n.key)})):Object(a.jsx)(K.n,{children:"Loading..."});return Object(a.jsx)("div",{children:s})}}var Il=Al;class Tl extends m.Component{render(){return Object(a.jsx)("div",{className:"fullpage",children:Object(a.jsxs)(K.e,{className:"fullpage-content",elevation:nt.a.THREE,children:[Object(a.jsx)(Cl,{}),Object(a.jsx)(Il,{})]})})}}var kl=Tl;var Nl=({reason:e})=>Object(a.jsx)("div",{className:mt()("NoPage",it.a.DARK),children:Object(a.jsx)(K.D,{icon:Y.a.ERROR,title:"Disabled",description:`The Source Academy has been disabled${e?` for this reason: ${e}`:""}.`})}),Pl=s(173);var Rl=function(){const[e,t]=Object(m.useState)("You have reached the GitHub callback page");return Object(m.useEffect)((()=>{const e=window.location.search,s=new URLSearchParams(e).get("code")||"";const a=y.b.githubClientId,n=y.b.githubOAuthProxyUrl;if(""===s)return void t("Access code not found in callback URL. Please try again or contact the website administrator.");if(""===a)return void t("Client ID not included with deployment. Please try again or contact the website administrator.");!async function(e,t,s){const a=await async function(e,t){return await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:t})}(e,t);let n;try{if(n=await a.json(),"undefined"===typeof n.access_token)throw new Error("Access Token not found in payload")}catch(i){return void s("Connection with server was denied, or incorrect payload received. Please try again or contact the website administrator.")}s("Log-in successful! This window will close soon.");try{new BroadcastChannel("GitHubOAuthAccessToken").postMessage(n.access_token)}catch(i){}setTimeout((()=>{window.close()}),1e3)}(n,Pl.stringify({code:s,clientId:a}),t)}),[]),Object(a.jsx)("div",{children:e})};const Ml=({handleClick:e,id:t,name:s})=>Object(a.jsx)(K.b,{className:it.a.LARGE,rightIcon:Y.a.LOG_IN,onClick:m.useCallback((()=>e(t)),[e,t]),children:`Log in with ${s}`}),Ll=Object(a.jsx)(lt.b,{to:"/playground",children:Object(a.jsx)(K.b,{className:it.a.LARGE,rightIcon:Y.a.CODE,children:"Try out the playground"})});var _l=e=>{const{code:t,providerId:s,handleFetchAuth:n}=e;return m.useEffect((()=>{t&&n(t,s)}),[t,s,n]),t?Object(a.jsx)("div",{className:mt()("Login",it.a.DARK),children:Object(a.jsx)(K.e,{className:mt()("login-card",it.a.ELEVATION_4),children:Object(a.jsx)("div",{className:"login-body",children:Object(a.jsx)(K.D,{description:"Logging In...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_LARGE})})})})}):Object(a.jsx)("div",{className:mt()("Login",it.a.DARK),children:Object(a.jsxs)(K.e,{className:mt()("login-card",it.a.ELEVATION_4),children:[Object(a.jsx)("div",{className:"login-header",children:Object(a.jsxs)(K.p,{children:[Object(a.jsx)(K.u,{icon:Y.a.LOCK}),"LOGIN"]})}),Object(a.jsx)("div",{className:"login-body",children:Object(a.jsxs)(K.c,{fill:!0,vertical:!0,children:[e.providers.map((({id:t,name:s})=>Object(a.jsx)(Ml,{handleClick:e.handleLogin,name:s,id:t},t))),Ll]})})]})})};var Dl=e=>{const t=Object(d.e)(),s=m.useMemo((()=>Object(u.b)({handleFetchAuth:st.fetchAuth,handleLogin:st.login},t)),[t]);return Object(a.jsx)(_l,{...s,...e})},Gl=s(238),Bl=s(237);const Ul=e=>e.charAt(0).toUpperCase()+e.slice(1),Fl=()=>{const e=localStorage.getItem("MissionEditingAssessmentSA");return e?JSON.parse(e):null},Hl=()=>{const e=localStorage.getItem("MissionEditingOverviewSA");return e?JSON.parse(e):null},Vl=e=>{localStorage.setItem("MissionEditingAssessmentSA",JSON.stringify(e))},ql=e=>{localStorage.setItem("MissionEditingOverviewSA",JSON.stringify(e))},Xl=(e,t,s)=>{const a=e.CONTENT.TASK[0],n=a.$;return{category:Ul(n.kind),closeAt:n.duedate,coverImage:n.coverimage,grade:1,id:-1,maxGrade:t,maxXp:s,number:n.number||"",openAt:n.startdate,title:n.title,reading:a.READING?a.READING[0]:"",shortSummary:a.WEBSUMMARY?a.WEBSUMMARY[0]:"",status:wt.b.attempting,story:n.story,xp:0,gradingStatus:"none"}},$l=e=>{const t=e.CONTENT.TASK[0],s=t.$,a=zl(t);return[{category:Ul(s.kind),id:-1,globalDeployment:Wl(t.DEPLOYMENT),graderDeployment:Wl(t.GRADERDEPLOYMENT),longSummary:t.TEXT[0],missionPDF:"google.com",questions:a[0],title:s.title},a[1],a[2]]},Wl=e=>{if(void 0===e)return{chapter:-1,external:{name:"NONE",symbols:[]},globals:[]};{const t=e[0],s=t.IMPORT||t.EXTERNAL,a=s?s[0].$.name:"NONE",n=s&&s[0].SYMBOL||[],i=t.GLOBAL?t.GLOBAL.map((e=>{return[e.IDENTIFIER[0],(t=e.VALUE[0],Function('"use strict";return ('+t+")")()),e.VALUE[0]];var t})):[];return{chapter:parseInt(t.$.interpreter,10),external:{name:a,symbols:n},globals:i}}},zl=e=>{let t=0,s=0;const a=[];return e.PROBLEMS[0].PROBLEM.forEach(((e,n)=>{const i=e.$.maxxp?parseInt(e.$.maxxp,10):0,r={answer:null,roomId:null,content:e.TEXT[0],id:n,library:Wl(e.DEPLOYMENT),graderLibrary:Wl(e.GRADERDEPLOYMENT),type:e.$.type,xp:0,grade:0,maxGrade:parseInt(e.$.maxgrade,10),maxXp:i};t+=parseInt(e.$.maxgrade,10),s+=i,"programming"===r.type&&a.push(Yl(e,r)),"mcq"===r.type&&a.push(Kl(e,r))})),[a,t,s]},Kl=(e,t)=>{const s=[],a=e.SNIPPET?e.SNIPPET[0].SOLUTION:void 0;let n=0;return e.CHOICE.forEach(((e,t)=>{s.push({content:e.TEXT[0],hint:null}),n="true"===e.$.correct?t:n})),{...t,type:"mcq",answer:a?parseInt(a[0],10):0,choices:s,solution:n}},Yl=(e,t)=>{const s=e.SNIPPET[0].TESTCASES,a=s&&s[0].PUBLIC||[],n=s&&s[0].PRIVATE||[],i=e.SNIPPET[0].PREPEND,r=e.SNIPPET[0].POSTPEND,o=e.SNIPPET[0].SOLUTION,c={...t,autogradingResults:[],prepend:i?i[0].trim():"",solutionTemplate:e.SNIPPET[0].TEMPLATE[0].trim(),postpend:r?r[0].trim():"",testcases:a.map((e=>Ql(e))),testcasesPrivate:n.map((e=>Ql(e))),answer:o?o[0].trim():"",type:"programming"};return e.SNIPPET[0].GRADER&&(c.graderTemplate=e.SNIPPET[0].GRADER[0]),c},Ql=e=>({type:wt.g.public,answer:e.$.answer,score:parseInt(e.$.score,10),program:e._}),Jl=(e,t)=>{const s=document.createElement("a");s.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),s.setAttribute("download",e),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)},Zl=e=>{const t={$:{interpreter:e.chapter.toString()},EXTERNAL:{$:{name:e.external.name}}};return 0!==e.external.symbols.length&&(t.EXTERNAL.SYMBOL=e.external.symbols),0!==e.globals.length&&(t.GLOBAL=e.globals.map((e=>({IDENTIFIER:e[0],VALUE:e[2]})))),t},eu=(e,t)=>{const s={},a={coverimage:t.coverImage,duedate:t.closeAt,kind:t.category.toLowerCase(),number:t.number||"",startdate:t.openAt,story:t.story,title:t.title};return s.$=a,t.reading&&""!==t.reading&&(s.READING=t.reading),s.WEBSUMMARY=t.shortSummary,s.TEXT=e.longSummary,s.PROBLEMS={PROBLEM:[]},s.DEPLOYMENT=Zl(e.globalDeployment),-1!==e.graderDeployment.chapter&&(s.GRADERDEPLOYMENT=Zl(e.graderDeployment)),e.questions.forEach((e=>{const t={$:{type:e.type,maxgrade:e.maxGrade},SNIPPET:{SOLUTION:e.answer},TEXT:e.content,CHOICE:[]};if(-1!==e.library.chapter&&(t.$.DEPLOYMENT=Zl(e.library)),-1!==e.graderLibrary.chapter&&(t.$.GRADERDEPLOYMENT=Zl(e.graderLibrary)),e.maxXp&&(t.$.maxxp=e.maxXp),"programming"===e.type){e.graderTemplate&&(t.SNIPPET.GRADER=e.graderTemplate);const s={...t.SNIPPET,TEMPLATE:e.solutionTemplate,PREPEND:e.prepend,POSTPEND:e.postpend,TESTCASES:""};if(e.testcases.length||e.testcasesPrivate.length){if(s.TESTCASES={},e.testcases.length){const t=e.testcases.map((e=>({$:{answer:e.answer,score:e.score},_:e.program})));s.TESTCASES.PUBLIC=t}if(e.testcasesPrivate&&e.testcasesPrivate.length){const t=e.testcasesPrivate.map((e=>({$:{answer:e.answer,score:e.score},_:e.program})));s.TESTCASES.PRIVATE=t}}t.SNIPPET=s}"mcq"===e.type&&e.choices.forEach(((s,a)=>{t.CHOICE.push({$:{correct:e.solution===a?"true":"false"},TEXT:s.content})})),s.PROBLEMS.PROBLEM.push(t)})),s};class tu extends m.Component{constructor(e){super(e),this.saveEditOverview=e=>t=>{const s={...this.props.overview,[e]:this.state.fieldValue};this.setState({editingOverviewField:"",fieldValue:""}),ql(s),this.props.updateEditingOverview(s)},this.handleEditOverview=()=>e=>{this.setState({fieldValue:e.target.value})},this.toggleEditField=e=>t=>{this.state.editingOverviewField!==e&&this.setState({editingOverviewField:e,fieldValue:this.props.overview[e]})},this.toggleOptionsOverlay=()=>{this.setState({showOptionsOverlay:!this.state.showOptionsOverlay})},this.handleExportXml=e=>{(()=>{const e=localStorage.getItem("MissionEditingAssessmentSA"),t=localStorage.getItem("MissionEditingOverviewSA");if(e&&t){const s=JSON.parse(e),a=JSON.parse(t),n=a.fileName||a.title,i=new Bl.Builder,r={CONTENT:{$:{"xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},TASK:eu(s,a)}};let o=i.buildObject(r);o=o.replace(/(&#xD;)+/g,""),Jl(n+".xml",o)}})()},this.makeEditingOverviewTextarea=e=>Object(a.jsx)(Gl.a,{autoFocus:!0,className:"editing-textarea",onChange:this.handleEditOverview(),onBlur:this.saveEditOverview(e),value:this.state.fieldValue}),this.makeEditingOverviewCard=e=>Object(a.jsx)("div",{children:Object(a.jsxs)(K.e,{className:"row listing",elevation:nt.a.ONE,children:[Object(a.jsx)("div",{className:"col-xs-3 listing-picture",onClick:this.toggleEditField("coverImage"),children:"coverImage"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("coverImage"):Object(a.jsx)("img",{alt:"Assessment cover",className:`cover-image-${e.status}`,src:e.coverImage?e.coverImage:ut})}),Object(a.jsxs)("div",{className:"col-xs-9 listing-text",children:[this.makeEditingOverviewCardTitle(e,e.title),Object(a.jsx)("div",{className:"row listing-grade",children:Object(a.jsxs)(K.r,{children:[" ",`Max Grade: ${e.maxGrade}`," "]})}),Object(a.jsx)("div",{className:"row listing-xp",children:Object(a.jsxs)(K.r,{children:[" ",`Max XP: ${e.maxXp}`," "]})}),Object(a.jsx)("div",{className:"row listing-description",onClick:this.toggleEditField("shortSummary"),children:"shortSummary"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("shortSummary"):Object(a.jsx)(Ut,{content:su(e.shortSummary)})}),Object(a.jsxs)("div",{className:"listing-controls",children:[Object(a.jsxs)(K.R,{className:"listing-due-date",children:[Object(a.jsx)(K.u,{className:"listing-due-icon",iconSize:12,icon:Y.a.TIME}),Object(a.jsx)("div",{className:"date-container",children:"Opens at:\xa0"}),Object(a.jsx)("div",{className:"date-container",onClick:this.toggleEditField("openAt"),children:"openAt"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("openAt"):`${da(e.openAt)}`}),Object(a.jsx)("div",{className:"date-container",children:"\xa0\xa0Due:\xa0"}),Object(a.jsx)("div",{className:"date-container",onClick:this.toggleEditField("closeAt"),children:"closeAt"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("closeAt"):`${da(e.closeAt)}`})]}),this.makeOptionsButton(),au(e,this.props.listingPath)]})]})]})}),this.makeEditingOverviewCardTitle=(e,t)=>Object(a.jsxs)("div",{className:"row listing-title",children:[Object(a.jsx)(K.R,{ellipsize:!0,className:"col-xs-10",children:Object(a.jsx)(K.p,{onClick:this.toggleEditField("title"),children:"title"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("title"):su(t)})}),Object(a.jsx)("div",{className:"col-xs-2",children:this.makeExportButton(e)})]}),this.makeExportButton=e=>Object(a.jsx)(K.b,{icon:Y.a.EXPORT,intent:fe.a.DANGER,minimal:!0,onClick:this.handleExportXml,children:"Save as XML"}),this.makeOptionsButton=()=>Object(a.jsx)(K.b,{icon:Y.a.WRENCH,minimal:!0,onClick:this.toggleOptionsOverlay,children:"Other Options"}),this.saveCategory=(e,t)=>{const s={...this.props.overview,category:e};ql(s),this.props.updateEditingOverview(s)},this.optionsOverlay=()=>Object(a.jsx)(K.g,{canOutsideClickClose:!1,className:"assessment-reset",icon:Y.a.WRENCH,isCloseButtonShown:!0,isOpen:this.state.showOptionsOverlay,onClose:this.toggleOptionsOverlay,title:"Other options",children:Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsx)(K.o,{children:"Category"}),iu(this.props.overview.category,this.saveCategory),Object(a.jsx)(K.o,{children:"Number"}),Object(a.jsx)("div",{onClick:this.toggleEditField("number"),children:"number"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("number"):su(this.props.overview.number||"")}),Object(a.jsx)(K.o,{children:"Story"}),Object(a.jsx)("div",{onClick:this.toggleEditField("story"),children:"story"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("story"):su(this.props.overview.story||"")}),Object(a.jsx)("br",{}),Object(a.jsx)(K.o,{children:"Filename"}),Object(a.jsx)("div",{onClick:this.toggleEditField("fileName"),children:"fileName"===this.state.editingOverviewField?this.makeEditingOverviewTextarea("fileName"):su(this.props.overview.fileName||"")})]})}),this.state={editingOverviewField:"",fieldValue:"",showOptionsOverlay:!1}}render(){return Object(a.jsxs)("div",{children:[this.optionsOverlay(),this.makeEditingOverviewCard(this.props.overview)]})}}const su=e=>e.match("^(\n| )*$")?"Enter Value Here (If Applicable)":e,au=(e,t)=>(t=t||"/academy/"+ta(e.category),Object(a.jsx)(lt.b,{to:t+`/${e.id.toString()}/${y.b.defaultQuestionId}`,children:It("Edit mission",Y.a.EDIT)})),nu=[wt.a.Mission,wt.a.Path,wt.a.Sidequest,wt.a.Contest],iu=(e,t=((e,t)=>{}))=>Object(a.jsx)(ru,{className:it.a.MINIMAL,items:nu,onItemSelect:t,itemRenderer:ou,filterable:!1,children:Object(a.jsx)(K.b,{className:it.a.MINIMAL,text:e,rightIcon:Y.a.DOUBLE_CARET_VERTICAL})}),ru=ie.a.ofType(),ou=(e,{handleClick:t,modifiers:s,query:n})=>Object(a.jsx)(K.y,{active:!1,onClick:t,text:e},e);function cu(e){const t="question"===e.editingMode?"Global":"Question Specific";return Object(a.jsx)(ot.a,{content:"Switch to "+t+" Editing Mode",children:It(t+" Editing Mode",Y.a.REFRESH,e.toggleEditMode)})}const du=(e,t)=>{for(const s of e)t=t[s];return t},lu=(e,t,s)=>{let a=0;for(a=0;a<e.length-1;a++)s=s[e[a]];s[e[a]]=t},uu=(e=0,t=null)=>s=>{let a;return s="string"===typeof s?parseInt(s,10):s,a=null!==e&&s<e?e:null!==t&&s>t?t:s,a};class hu extends m.Component{constructor(e){super(e),this.saveEditAssessment=e=>{let t;this.state.isNumber?(t=parseInt(this.state.fieldValue,10),isNaN(t)&&(t=du(this.props.path,this.props.assessment))):t=this.state.fieldValue;const s=du(this.props.path,this.props.assessment);if(this.props.processResults&&(t=this.props.processResults(t)),t!==s){const e=this.props.assessment;lu(this.props.path,t,e),this.props.updateAssessment(e)}this.setState({isEditing:!1})},this.handleEditAssessment=e=>{this.setState({fieldValue:e.target.value})},this.makeEditingTextarea=()=>Object(a.jsx)(Gl.a,{autoFocus:!0,className:"editing-textarea",onChange:this.handleEditAssessment,onBlur:this.saveEditAssessment,value:this.state.fieldValue}),this.toggleEditField=()=>e=>{if(!this.state.isEditing){const e=du(this.props.path,this.props.assessment)||"";this.setState({isEditing:!0,fieldValue:"string"===typeof e?e:e.toString()})}};const t=this.props.isNumber||!1;this.state={isEditing:!1,isNumber:t,fieldValue:"",useRawValue:this.props.useRawValue||t}}render(){let e;if(this.state.isEditing)e=this.makeEditingTextarea();else{const t="Please enter value (if applicable)";let s=du(this.props.path,this.props.assessment);this.props.isNumber||(s=s||"",s=s.match(/^\s*$/)?t:s),e=this.state.useRawValue?s:Object(a.jsx)(Ut,{content:s})}return Object(a.jsx)("div",{onClick:this.toggleEditField(),children:e})}}var pu=hu;class gu extends m.Component{constructor(...e){super(...e),this.addTestcase=e=>()=>{e.push(Object(wt.m)()),this.props.updateAssessment(this.props.assessment)},this.removeTestcase=(e,t)=>{e.splice(t,1),this.props.updateAssessment(this.props.assessment)},this.autograderCard=(e,t)=>{const s=du(e,this.props.assessment),n=s[t];return Object(a.jsx)("div",{children:Object(a.jsx)(K.e,{className:"row listing",elevation:nt.a.ONE,children:Object(a.jsxs)("div",{className:"col-xs-9 listing-text",children:[Object(a.jsx)("div",{className:"row listing-program",children:Object(a.jsxs)(K.r,{children:["Test Program:",Object(a.jsx)(pu,{assessment:this.props.assessment,path:e.concat([t,"program"]),useRawValue:!0,updateAssessment:this.props.updateAssessment})]})}),Object(a.jsx)("div",{className:"row listing-expected",children:Object(a.jsxs)(K.r,{children:["Score:",Object(a.jsx)(pu,{assessment:this.props.assessment,isNumber:!0,path:e.concat([t,"score"]),updateAssessment:this.props.updateAssessment})]})}),Object(a.jsx)("div",{className:"row listing-expected",children:Object(a.jsxs)(K.r,{children:["Expected Answer:",Object(a.jsx)(pu,{assessment:this.props.assessment,path:e.concat([t,"answer"]),useRawValue:!0,updateAssessment:this.props.updateAssessment})]})}),Object(a.jsx)("div",{className:"listing-controls",children:Object(a.jsxs)("div",{children:[It("Test",Y.a.PLAY,(()=>this.props.handleTestcaseEval(n))),It("Delete",Y.a.DELETE,(()=>this.removeTestcase(s,t)))]})})]})})})}}render(){const e=this.props.assessment.questions[this.props.questionId],t=["questions",this.props.questionId,"testcases"],s=e.testcases.map(((e,s)=>Object(a.jsx)("div",{children:this.autograderCard(t,s)},s))),n=["questions",this.props.questionId,"testcasesPrivate"],i=e.testcasesPrivate.map(((e,t)=>Object(a.jsx)("div",{children:this.autograderCard(n,t)},t)));return Object(a.jsxs)("div",{children:["Public Testcases",s,It("New public testcase",Y.a.PLUS,this.addTestcase(e.testcases)),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"Private Testcases",i,It("New private testcase",Y.a.PLUS,this.addTestcase(e.testcasesPrivate))]})}}class mu extends m.Component{constructor(...e){super(...e),this.deploymentTab=()=>{const e=this.props.pathToLibrary,t=du(e,this.props.assessment),s=t.external.symbols.map(((t,s)=>Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:this.textareaContent(e.concat(["external","symbols",s]))}),Object(a.jsx)("td",{style:{width:"100px"},children:It("Delete",Y.a.MINUS,this.handleSymbolDelete(s))})]},s))),n=t.globals.map(((t,s)=>Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{style:{width:"170px"},children:this.textareaContent(e.concat(["globals",s,0]))}),Object(a.jsx)("td",{children:this.globalValueTextareaContent(s)}),Object(a.jsx)("td",{style:{width:"90px"},children:It("Delete",Y.a.MINUS,this.handleGlobalDelete(s))})]},s))),i=It("Use this Library",Y.a.REFRESH,(()=>this.props.handleRefreshLibrary(t))),r=Object(a.jsxs)(m.Fragment,{children:["External Library:",Object(a.jsx)("br",{}),fu(t.external.name,this.handleExternalSelect),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{children:"Symbols:"}),Object(a.jsx)("br",{}),Object(a.jsx)("table",{style:{width:"100%"},children:Object(a.jsx)("tbody",{children:s})}),It("New Symbol",Y.a.PLUS,this.handleNewSymbol)]}),o=Object(a.jsxs)(m.Fragment,{children:[Object(a.jsx)("div",{children:"Globals:"}),Object(a.jsx)("br",{}),Object(a.jsx)("table",{style:{width:"100%",borderSpacing:"5px"},children:Object(a.jsx)("tbody",{children:n})}),It("New Global",Y.a.PLUS,this.handleNewGlobal)]});return Object(a.jsxs)("div",{children:[Object(a.jsx)(K.h,{}),i,Object(a.jsx)(K.h,{}),"Interpreter:",Object(a.jsx)("br",{}),yu(t.chapter,t.variant,this.handleChapterSelect),Object(a.jsx)(K.h,{}),r,Object(a.jsx)(K.h,{}),o]})},this.textareaContent=e=>Object(a.jsx)(pu,{assessment:this.props.assessment,path:e,processResults:bu,updateAssessment:this.props.updateAssessment,useRawValue:!0}),this.globalValueTextareaContent=e=>{const t=this.props.pathToLibrary.concat(["globals",e,2]);return Object(a.jsx)(pu,{assessment:this.props.assessment,path:t,updateAssessment:this.handleGlobalValueUpdate(e),useRawValue:!0})},this.handleGlobalValueUpdate=e=>t=>{const s=du(this.props.pathToLibrary,this.props.assessment).globals[e];try{s[1]=ju(s[2]),this.props.updateAssessment(t)}catch(a){s[2]='"Invalid Expression"'}},this.handleSymbolDelete=e=>()=>{const t=this.props.assessment;du(this.props.pathToLibrary,t).external.symbols.splice(e,1),this.props.updateAssessment(t)},this.handleNewSymbol=()=>{const e=this.props.assessment;du(this.props.pathToLibrary,e).external.symbols.push("new_symbol"),this.props.updateAssessment(e)},this.handleGlobalDelete=e=>()=>{const t=this.props.assessment;du(this.props.pathToLibrary,t).globals.splice(e,1),this.props.updateAssessment(t)},this.handleNewGlobal=()=>{const e=this.props.assessment;du(this.props.pathToLibrary,e).globals.push(["new_global",null,"null"]),this.props.updateAssessment(e)},this.handleChapterSelect=(e,t)=>{const s=this.props.assessment;du(this.props.pathToLibrary,s).chapter=e.chapter,this.props.updateAssessment(s)},this.handleExternalSelect=(e,t)=>{const s=this.props.assessment,a=du(this.props.pathToLibrary,s);a.external.name=e.name,a.external.symbols=JSON.parse(JSON.stringify(Ct.b.get(e.name))),this.props.updateAssessment(s)},this.handleSwitchDeployment=()=>{const e=this.props.assessment;if(this.isEmptyLibrary()){let t=du(this.props.pathToCopy||["globalDeployment"],e);-1===t.chapter&&(t=e.globalDeployment),t=JSON.parse(JSON.stringify(t)),lu(this.props.pathToLibrary,t,e)}else lu(this.props.pathToLibrary,Object(wt.i)(),e);this.props.updateAssessment(e)},this.isEmptyLibrary=(e=this.props.pathToLibrary)=>-1===du(e.concat(["chapter"]),this.props.assessment)}render(){return this.props.isOptionalDeployment?Object(a.jsxs)("div",{children:[Object(a.jsx)(K.N,{checked:!this.isEmptyLibrary(),label:"Enable "+this.props.label+" Deployment",onChange:this.handleSwitchDeployment}),this.isEmptyLibrary()?null:this.deploymentTab()]}):Object(a.jsxs)("div",{children:[this.props.label+" Deployment",Object(a.jsx)("br",{}),this.deploymentTab()]})}}const bu=e=>"string"===typeof e?e.replace(/\s+/g,""):e,ju=e=>Function('"use strict";return ('+e+")")(),yu=(e,t="default",s=((e,t)=>{}))=>Object(a.jsx)(Ou,{className:it.a.MINIMAL,items:j.m,onItemSelect:s,itemRenderer:vu,filterable:!1,children:Object(a.jsx)(K.b,{className:it.a.MINIMAL,text:Object(j.n)(e,t),rightIcon:Y.a.DOUBLE_CARET_VERTICAL})}),Ou=ie.a.ofType(),vu=(e,{handleClick:t,modifiers:s,query:n})=>Object(a.jsx)(K.y,{active:!1,onClick:t,text:e.displayName},e.displayName),xu=Array.from(Ct.b.entries()).map(((e,t)=>({name:e[0],key:t,symbols:e[1]}))),fu=(e,t)=>Object(a.jsx)(Su,{className:it.a.MINIMAL,items:xu,onItemSelect:t,itemRenderer:Cu,filterable:!1,children:Object(a.jsx)(K.b,{className:it.a.MINIMAL,text:e,rightIcon:Y.a.DOUBLE_CARET_VERTICAL})}),Su=ie.a.ofType(),Cu=(e,{handleClick:t,modifiers:s,query:n})=>Object(a.jsx)(K.y,{active:!1,onClick:t,text:e.name},e.key);class wu extends m.Component{constructor(e){super(e),this.textareaContent=e=>Object(a.jsx)(pu,{assessment:this.props.assessment,isNumber:!0,path:e,processResults:uu(0),updateAssessment:this.props.updateAssessment}),this.gradingTab=()=>Object(a.jsxs)("div",{children:["Max Grade:",this.textareaContent(this.props.path.concat(["maxGrade"])),Object(a.jsx)("br",{}),"Max Xp:",this.textareaContent(this.props.path.concat(["maxXp"]))]})}render(){return this.gradingTab()}}class Eu extends m.Component{constructor(e){super(e),this.manageQuestionTab=e=>Object(a.jsxs)("div",{children:[It("Clone",Y.a.DOCUMENT,this.confirmSave(this.makeQuestion((()=>Au(this.props.assessment.questions[e])),e))),It("Delete",Y.a.REMOVE,this.confirmSave(this.deleteQuestion(e))),It("Shift Up",Y.a.CARET_UP,this.confirmSave(this.shiftQuestion(-1,e)),{},0===e),It("Shift Down",Y.a.CARET_DOWN,this.confirmSave(this.shiftQuestion(1,e)),{},e>=this.props.assessment.questions.length-1),Object(a.jsx)("br",{}),It("Insert Programming Question",Y.a.FONT,this.confirmSave(this.makeQuestion(wt.l,e))),It("Insert MCQ Question",Y.a.CONFIRM,this.confirmSave(this.makeQuestion(wt.j,e)))]}),this.shiftQuestion=(e,t)=>()=>{const s=this.props.assessment,a=t+e;if(a>=0&&a<s.questions.length){const e=s.questions[t],n=s.questions;n[t]=n[a],n[a]=e,s.questions=n,this.props.updateAssessment(s),ea.a.push("/mission-control/-1/"+a.toString())}},this.makeQuestion=(e,t)=>()=>{const s=this.props.assessment;t+=1;const a=s.questions;a.splice(t,0,e()),s.questions=a,this.props.updateAssessment(s),ea.a.push("/mission-control/-1/"+t.toString())},this.deleteQuestion=e=>()=>{const t=this.props.assessment;let s=t.questions;s.length>1&&(s=s.slice(0,e).concat(s.slice(e+1))),t.questions=s,this.props.updateAssessment(t)},this.confirmSave=e=>()=>{this.props.hasUnsavedChanges?this.setState({showSaveOverlay:!0,modifyAssessment:e}):e()},this.confirmSaveOverlay=()=>Object(a.jsxs)(K.g,{className:"assessment-reset",icon:Y.a.ERROR,isCloseButtonShown:!0,isOpen:this.state.showSaveOverlay,title:"Confirmation: Save unsaved changes?",children:[Object(a.jsx)("div",{className:it.a.DIALOG_BODY,children:Object(a.jsx)(Ut,{content:"Are you sure you want to save over your unsaved changes?"})}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)(K.c,{children:[It("Cancel",null,(()=>this.setState({showSaveOverlay:!1})),{minimal:!1}),It("Confirm",null,(()=>{this.state.modifyAssessment(),this.setState({showSaveOverlay:!1})}),{minimal:!1,intent:fe.a.DANGER})]})})]}),this.state={showSaveOverlay:!1,modifyAssessment:()=>{}}}render(){return Object(a.jsxs)("div",{children:[this.confirmSaveOverlay(),this.props.assessment.questions.map(((e,t)=>Object(a.jsxs)("div",{children:["Question ",t+1,Object(a.jsx)("br",{}),Object(a.jsx)(K.b,{className:"mcq-option col-xs-12",minimal:!0,children:Object(a.jsx)(Ut,{content:e.content.length>200?e.content.substring(0,300)+"...":e.content})}),this.manageQuestionTab(t),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]},t)))]})}}const Au=e=>JSON.parse(JSON.stringify(e));class Iu extends m.Component{constructor(e){super(e),this.mcqTab=()=>{const e=this.props.questionId,t=this.props.assessment.questions[e],s=t.choices.map(((t,s)=>Object(a.jsxs)("div",{className:"mcq-option col-xs-12",children:["Option ",s,":",this.textareaContent(["questions",e,"choices",s,"content"]),Object(a.jsx)("br",{}),"Hint:",this.textareaContent(["questions",e,"choices",s,"hint"])]},s))),n=It("Delete Option",Y.a.REMOVE,this.delOption);return Object(a.jsx)("div",{className:"MCQChooser row",children:Object(a.jsx)(K.e,{className:"mcq-content-parent col-xs-12 middle-xs",children:Object(a.jsxs)("div",{className:"row mcq-options-parent between-xs",children:[s,"Solution:",this.textareaContent(["questions",e,"solution"],!0,[0,t.choices.length]),Object(a.jsx)("br",{}),It("Add Option",Y.a.CONFIRM,this.addOption),t.choices.length>0?n:void 0]})})})},this.addOption=()=>{const e=this.props.assessment,t=this.props.questionId,s=e.questions[t],a=s.choices.concat([{content:"A",hint:null}]);s.choices=a,e.questions[t]=s,this.props.updateAssessment(e)},this.delOption=()=>{const e=this.props.assessment,t=this.props.questionId,s=e.questions[t],a=s.choices.slice(0,s.choices.length-1);s.choices=a,e.questions[t]=s,this.props.updateAssessment(e)},this.textareaContent=(e,t=!1,s=[0])=>t?Object(a.jsx)(pu,{assessment:this.props.assessment,isNumber:!0,path:e,processResults:uu(s[0],s[1]),updateAssessment:this.props.updateAssessment}):Object(a.jsx)(pu,{assessment:this.props.assessment,path:e,updateAssessment:this.props.updateAssessment})}render(){return this.mcqTab()}}const Tu=ie.a.ofType(),ku=[{label:"Prepend",icon:Y.a.CHEVRON_UP,id:"prepend"},{label:"Postpend",icon:Y.a.CHEVRON_DOWN,id:"postpend"},{label:"Solution Template",icon:Y.a.MANUAL,id:"solutionTemplate"},{label:"Suggested Answer",icon:Y.a.TICK,id:"answer"}];class Nu extends m.Component{constructor(e){super(e),this.programmingTab=()=>{const e=["questions",this.props.questionId].concat(this.state.activeEditor.id),t=It("Copy from Editor",Y.a.IMPORT,this.handleCopyFromEditor(e)),s=It("Copy to Editor",Y.a.EXPORT,this.handleCopyToEditor(e)),n=Object(a.jsxs)("div",{children:[t,s,Object(a.jsx)(K.h,{}),this.editor(e)]}),i=(e,{handleClick:t})=>Object(a.jsx)(K.y,{active:!1,onClick:t,text:e.label,icon:e.icon},e.id);return Object(a.jsx)("div",{className:"side-content",children:Object(a.jsxs)(K.e,{children:[(r=this.state.activeEditor,o=this.handleChangeActiveEditor,Object(a.jsx)(Tu,{className:it.a.MINIMAL,items:ku,itemRenderer:i,onItemSelect:o,filterable:!1,children:Object(a.jsx)(K.b,{className:it.a.MINIMAL,text:r.label,icon:Y.a.EDIT,rightIcon:Y.a.DOUBLE_CARET_VERTICAL})})),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"side-content-text",children:n})]})});var r,o},this.editor=e=>{const t=this.state.templateFocused?this.state.templateValue:du(e,this.props.assessment);return Object(a.jsx)("div",{onClick:this.focusEditor(e),onBlur:this.unFocusEditor(e),children:Object(a.jsx)(Xt.a,{className:"react-ace",editorProps:{$blockScrolling:1/0},fontSize:14,highlightActiveLine:!1,mode:"javascript",onChange:this.handleTemplateChange,theme:"source",value:t,width:"100%"})})},this.handleChangeActiveEditor=e=>{this.setState({activeEditor:e})},this.handleTemplateChange=e=>{this.setState({templateValue:e})},this.focusEditor=e=>t=>{this.state.templateFocused||this.setState({templateValue:du(e,this.props.assessment),templateFocused:!0})},this.unFocusEditor=e=>t=>{if(this.state.templateFocused){if(du(e,this.props.assessment)!==this.state.templateValue){const t=this.props.assessment;lu(e,this.state.templateValue,t),this.props.updateAssessment(t)}if("prepend"===this.state.activeEditor.id){const e=this.state.templateValue;this.props.handleUpdateWorkspace({editorPrepend:e})}else if("postpend"===this.state.activeEditor.id){const e=this.state.templateValue;this.props.handleUpdateWorkspace({editorPostpend:e})}this.setState({templateValue:"",templateFocused:!1})}},this.handleCopyFromEditor=e=>()=>{const t=this.props.assessment;lu(e,this.props.editorValue,t),this.props.updateAssessment(t)},this.handleCopyToEditor=e=>()=>{const t=du(e,this.props.assessment);this.props.handleEditorValueChange(t)},this.state={activeEditor:ku[0],templateValue:"",templateFocused:!1}}render(){return this.programmingTab()}}class Pu extends m.Component{constructor(e){super(e),this.formatedQuestionId=()=>{let e=this.props.questionId;return e<0?e=0:e>=this.state.assessment.questions.length&&(e=this.state.assessment.questions.length-1),e},this.resetTemplateOverlay=()=>Object(a.jsxs)(K.g,{className:"assessment-reset",icon:Y.a.ERROR,isCloseButtonShown:!0,isOpen:this.state.showResetTemplateOverlay,title:"Confirmation: Reset editor?",children:[Object(a.jsx)("div",{className:it.a.DIALOG_BODY,children:Object(a.jsx)(Ut,{content:"Are you sure you want to reset to your last save?"})}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)(K.c,{children:[It("Cancel",null,(()=>this.setState({showResetTemplateOverlay:!1})),{minimal:!1}),It("Confirm",null,(()=>{const e=Fl();this.setState({assessment:e,hasUnsavedChanges:!1,showResetTemplateOverlay:!1,originalMaxGrade:this.getMaxMarks("maxGrade"),originalMaxXp:this.getMaxMarks("maxXp")}),this.handleRefreshLibrary(),this.resetWorkspaceValues()}),{minimal:!1,intent:fe.a.DANGER})]})})]}),this.handleRefreshLibrary=e=>{const t=this.state.assessment.questions[this.formatedQuestionId()];if(e||(e=-1===t.library.chapter?this.state.assessment.globalDeployment:t.library),e&&e.globals.length>0){const t=e.globals.map((e=>e[0])),s=e.external.symbols.concat(t);e={...e,external:{name:e.external.name,symbols:Ru(s)}}}this.props.handleClearContext(e,!0)},this.resetWorkspaceValues=()=>{const e=this.state.assessment.questions[this.formatedQuestionId()];let t,s="",a="";e.type===wt.e.programming?(t=e.editorValue?e.editorValue:e.solutionTemplate,s=e.prepend,a=e.postpend):t="//If you see this, this is a bug. Please report bug.",this.props.handleResetWorkspace({editorPrepend:s,editorValue:t,editorPostpend:a}),this.props.handleEditorValueChange(t)},this.handleTestcaseEval=e=>{const t=[e];this.props.handleUpdateWorkspace({editorTestcases:t}),this.props.handleTestcaseEval(0)},this.handleSave=()=>{const e=this.state.assessment;e.questions[this.formatedQuestionId()].editorValue=this.props.editorValue,this.setState({assessment:e,hasUnsavedChanges:!1}),Vl(e),this.handleSaveGradeAndXp()},this.handleSaveGradeAndXp=()=>{const e=this.getMaxMarks("maxGrade"),t=e-this.state.originalMaxGrade,s=this.getMaxMarks("maxXp"),a=s-this.state.originalMaxXp;if(0!==t||0!==a){const n=this.props.assessmentOverview;0!==t&&(n.maxGrade=e),0!==a&&(n.maxXp=s),this.setState({originalMaxGrade:e,originalMaxXp:s}),this.props.updateAssessmentOverview(n),ql(n)}},this.getMaxMarks=e=>{let t=0;const s=this.state.assessment.questions;for(const a of s)t+=a[e];return t},this.updateEditAssessmentState=e=>{this.setState({assessment:e,hasUnsavedChanges:!0})},this.updateAndSaveAssessment=e=>{this.setState({assessment:e}),this.handleRefreshLibrary(),this.handleSave(),this.resetWorkspaceValues()},this.handleActiveTabChange=e=>{this.setState({activeTab:e})},this.toggleEditingMode=()=>{const e="question"===this.state.editingMode?"global":"question";this.setState({editingMode:e})},this.sideContentProps=(e,t)=>{const s=this.state.assessment;let n;if("question"===this.state.editingMode){const e=this.state.assessment.questions[this.props.questionId].type,i="mcq"===e?Object(a.jsx)(Iu,{assessment:s,questionId:t,updateAssessment:this.updateEditAssessmentState}):Object(a.jsx)(Nu,{assessment:s,questionId:t,updateAssessment:this.updateEditAssessmentState,editorValue:this.props.editorValue,handleEditorValueChange:this.props.handleEditorValueChange,handleUpdateWorkspace:this.props.handleUpdateWorkspace});n=[{label:`Task ${t+1}`,iconName:Y.a.NINJA,body:Object(a.jsx)(hu,{assessment:s,path:["questions",t,"content"],updateAssessment:this.updateEditAssessmentState}),id:Os.b.editorQuestionOverview,toSpawn:()=>!0},{label:"Question Template",iconName:Y.a.DOCUMENT,body:i,id:Os.b.editorQuestionTemplate,toSpawn:()=>!0},{label:"Manage Local Deployment",iconName:Y.a.HOME,body:Object(a.jsx)(mu,{assessment:s,label:"Question Specific",handleRefreshLibrary:this.handleRefreshLibrary,pathToLibrary:["questions",t,"library"],updateAssessment:this.updateEditAssessmentState,isOptionalDeployment:!0}),id:Os.b.editorLocalDeployment,toSpawn:()=>!0},{label:"Manage Local Grader Deployment",iconName:Y.a.CONFIRM,body:Object(a.jsx)(mu,{assessment:s,label:"Question Specific Grader",handleRefreshLibrary:this.handleRefreshLibrary,pathToLibrary:["questions",t,"graderLibrary"],pathToCopy:["questions",t,"library"],updateAssessment:this.updateEditAssessmentState,isOptionalDeployment:!0}),id:Os.b.editorLocalGraderDeployment,toSpawn:()=>!0},{label:"Grading",iconName:Y.a.TICK,body:Object(a.jsx)(wu,{assessment:s,path:["questions",t],updateAssessment:this.updateEditAssessmentState}),id:Os.b.editorGrading,toSpawn:()=>!0}],"programming"===e&&n.push({label:"Autograder",iconName:Y.a.AIRPLANE,body:Object(a.jsx)(gu,{assessment:s,questionId:t,handleTestcaseEval:this.handleTestcaseEval,updateAssessment:this.updateEditAssessmentState}),id:Os.b.editorAutograder,toSpawn:()=>!0});s.globalDeployment.external.symbols.includes("get_matrix")&&n.push({label:"Tone Matrix",iconName:Y.a.GRID_VIEW,body:Object(a.jsx)(Qs,{}),id:Os.b.toneMatrix,toSpawn:()=>!0})}else n=[{label:`${s.category} Briefing`,iconName:Y.a.BRIEFCASE,body:Object(a.jsx)(hu,{assessment:s,path:["longSummary"],updateAssessment:this.updateEditAssessmentState}),id:Os.b.editorBriefing,toSpawn:()=>!0},{label:"Manage Question",iconName:Y.a.WRENCH,body:Object(a.jsx)(Eu,{assessment:s,hasUnsavedChanges:this.state.hasUnsavedChanges,questionId:t,updateAssessment:this.updateAndSaveAssessment}),id:Os.b.editorManageQuestion,toSpawn:()=>!0},{label:"Manage Global Deployment",iconName:Y.a.GLOBE,body:Object(a.jsx)(mu,{assessment:s,label:"Global",handleRefreshLibrary:this.handleRefreshLibrary,pathToLibrary:["globalDeployment"],updateAssessment:this.updateEditAssessmentState,isOptionalDeployment:!1}),id:Os.b.editorGlobalDeployment,toSpawn:()=>!0},{label:"Manage Global Grader Deployment",iconName:Y.a.CONFIRM,body:Object(a.jsx)(mu,{assessment:s,label:"Global Grader",handleRefreshLibrary:this.handleRefreshLibrary,pathToLibrary:["graderDeployment"],updateAssessment:this.updateEditAssessmentState,isOptionalDeployment:!0}),id:Os.b.editorGlobalGraderDeployment,toSpawn:()=>!0}];return{handleActiveTabChange:this.handleActiveTabChange,tabs:n}},this.controlBarProps=e=>{const t="/mission-control",s=`/mission-control/${this.state.assessment.id.toString()}`,n=[e+1,this.state.assessment.questions.length],i=Object(a.jsx)(Pt,{onClickNext:()=>ea.a.push(s+`/${(e+1).toString()}`),onClickReturn:()=>ea.a.push(t),questionProgress:n},"next_question"),r=Object(a.jsx)(Rt,{onClick:()=>ea.a.push(s+`/${(e-1).toString()}`),questionProgress:n},"previous_question"),o=Object(a.jsx)(Mt,{questionProgress:n},"question_view"),c=Object(a.jsx)(Lt,{onClick:()=>{this.setState((e=>({...e,showResetTemplateOverlay:e.hasUnsavedChanges})))}},"reset_template");return{editorButtons:[Object(a.jsx)(_t,{handleEditorEval:this.props.handleEditorEval},"run"),Object(a.jsx)(Dt,{hasUnsavedChanges:this.state.hasUnsavedChanges,onClickSave:this.handleSave},"save"),c],flowButtons:[r,o,i],editingWorkspaceButtons:[Object(a.jsx)(cu,{editingMode:this.state.editingMode,toggleEditMode:this.toggleEditingMode},"toggle_edit_mode")]}},this.state={assessment:Fl(),activeTab:Os.b.editorQuestionOverview,editingMode:"question",hasUnsavedChanges:!1,showResetTemplateOverlay:!1,originalMaxGrade:0,originalMaxXp:0}}componentDidMount(){this.state.assessment&&(this.resetWorkspaceValues(),this.setState({originalMaxGrade:this.getMaxMarks("maxGrade"),originalMaxXp:this.getMaxMarks("maxXp")}))}componentDidUpdate(){this.checkWorkspaceReset(this.props)}render(){var e,t,s;if(null===this.state.assessment||0===this.state.assessment.questions.length)return Object(a.jsx)(K.D,{className:mt()("WorkspaceParent",it.a.DARK),description:"Getting mission ready...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_LARGE})});const n=this.formatedQuestionId(),i=this.state.assessment.questions[n],r={controlBarProps:this.controlBarProps(n),editorProps:i.type===wt.e.programming?{editorSessionId:"",editorValue:this.props.editorValue||i.editorValue||i.solutionTemplate,handleDeclarationNavigate:this.props.handleDeclarationNavigate,handleEditorEval:this.props.handleEditorEval,handleEditorValueChange:this.props.handleEditorValueChange,breakpoints:this.props.breakpoints,highlightedLines:this.props.highlightedLines,newCursorPosition:this.props.newCursorPosition,handleEditorUpdateBreakpoints:this.props.handleEditorUpdateBreakpoints,handleUpdateHasUnsavedChanges:this.props.handleUpdateHasUnsavedChanges,handlePromptAutocomplete:this.props.handlePromptAutocomplete,isEditorAutorun:!1}:void 0,editorHeight:this.props.editorHeight,editorWidth:this.props.editorWidth,handleEditorHeightChange:this.props.handleEditorHeightChange,handleEditorWidthChange:this.props.handleEditorWidthChange,handleSideContentHeightChange:this.props.handleSideContentHeightChange,hasUnsavedChanges:this.state.hasUnsavedChanges,mcqProps:{mcq:i,handleMCQSubmit:e=>this.props.handleSave(this.state.assessment.questions[n].id,e)},sideContentHeight:this.props.sideContentHeight,sideContentProps:this.sideContentProps(this.props,n),replProps:{handleBrowseHistoryDown:this.props.handleBrowseHistoryDown,handleBrowseHistoryUp:this.props.handleBrowseHistoryUp,handleReplEval:this.props.handleReplEval,handleReplValueChange:this.props.handleReplValueChange,output:this.props.output,replValue:this.props.replValue,sourceChapter:(null===i||void 0===i||null===(e=i.library)||void 0===e?void 0:e.chapter)||4,sourceVariant:"default",externalLibrary:(null===i||void 0===i||null===(t=i.library)||void 0===t||null===(s=t.external)||void 0===s?void 0:s.name)||"NONE",replButtons:this.replButtons()}};return Object(a.jsxs)("div",{className:mt()("WorkspaceParent",it.a.DARK),children:[this.resetTemplateOverlay(),Object(a.jsx)(oa,{...r})]})}checkWorkspaceReset(e){if(void 0===this.state.assessment)return;const t=this.formatedQuestionId();-1===this.props.storedAssessmentId&&this.props.storedQuestionId===t||(this.resetWorkspaceValues(),this.props.handleUpdateCurrentAssessmentId(-1,t),this.props.handleUpdateHasUnsavedChanges(!1),this.state.hasUnsavedChanges&&this.setState({assessment:Fl(),hasUnsavedChanges:!1}),this.handleRefreshLibrary())}replButtons(){const e=Object(a.jsx)(Tt,{handleReplOutputClear:this.props.handleReplOutputClear},"clear_repl");return[Object(a.jsx)(kt,{handleReplEval:this.props.handleReplEval,isRunning:this.props.isRunning},"eval_repl"),e]}}function Ru(e){const t={};return e.filter((e=>!t.hasOwnProperty(e)&&(t[e]=!0)))}var Mu=Pu;const Lu="assessment";var _u=Object(d.c)(((e,t)=>({editorValue:e.workspaces.assessment.editorValue,editorHeight:e.workspaces.assessment.editorHeight,editorWidth:e.workspaces.assessment.editorWidth,breakpoints:e.workspaces.assessment.breakpoints,highlightedLines:e.workspaces.assessment.highlightedLines,hasUnsavedChanges:e.workspaces.assessment.hasUnsavedChanges,isRunning:e.workspaces.assessment.isRunning,isDebugging:e.workspaces.assessment.isDebugging,enableDebugging:e.workspaces.assessment.enableDebugging,newCursorPosition:e.workspaces.assessment.newCursorPosition,output:e.workspaces.assessment.output,replValue:e.workspaces.assessment.replValue,sideContentHeight:e.workspaces.assessment.sideContentHeight,storedAssessmentId:e.workspaces.assessment.currentAssessment,storedQuestionId:e.workspaces.assessment.currentQuestion})),(e=>Object(u.b)({handleBrowseHistoryDown:()=>Object(pt.browseReplHistoryDown)(Lu),handleBrowseHistoryUp:()=>Object(pt.browseReplHistoryUp)(Lu),handleChapterSelect:(e,t)=>Object(pt.chapterSelect)(e,"default",Lu),handleClearContext:(e,t)=>Object(pt.beginClearContext)(Lu,e,t),handleDeclarationNavigate:e=>Object(pt.navigateToDeclaration)(Lu,e),handleEditorEval:()=>Object(pt.evalEditor)(Lu),handleEditorValueChange:e=>Object(pt.updateEditorValue)(e,Lu),handleEditorHeightChange:e=>Object(pt.changeEditorHeight)(e,Lu),handleEditorWidthChange:e=>Object(pt.changeEditorWidth)(e.toString(),Lu),handleEditorUpdateBreakpoints:e=>Object(pt.setEditorBreakpoint)(e,Lu),handleInterruptEval:()=>Object(ht.beginInterruptExecution)(Lu),handleReplEval:()=>Object(pt.evalRepl)(Lu),handleReplOutputClear:()=>Object(pt.clearReplOutput)(Lu),handleReplValueChange:e=>Object(pt.updateReplValue)(e,Lu),handleResetWorkspace:e=>Object(pt.resetWorkspace)(Lu,e),handleUpdateWorkspace:e=>Object(pt.updateWorkspace)(Lu,e),handleSave:st.submitAnswer,handleSideContentHeightChange:e=>Object(pt.changeSideContentHeight)(e,Lu),handleTestcaseEval:e=>Object(pt.evalTestcase)(Lu,e),handleUpdateHasUnsavedChanges:e=>Object(pt.updateHasUnsavedChanges)(Lu,e),handleUpdateCurrentAssessmentId:pt.updateCurrentAssessmentId,handleDebuggerPause:()=>Object(ht.beginDebuggerPause)(Lu),handleDebuggerResume:()=>Object(ht.debuggerResume)(Lu),handleDebuggerReset:()=>Object(ht.debuggerReset)(Lu),handlePromptAutocomplete:(e,t,s)=>Object(pt.promptAutocomplete)(Lu,e,t,s)},e)))(Mu);class Du extends m.Component{constructor(e){super(e),this.fileReader=void 0,this.handleFileRead=e=>t=>{if(!this.fileReader)return;const s=this.fileReader.result;s&&Object(Bl.parseString)(s,((t,s)=>{console.dir(e);try{const t=(e=>{const t=$l(e);return[Xl(e,t[1],t[2]),t[0]]})(s);t[0].fileName=e.name.slice(0,-4),ql(t[0]),this.props.updateEditingOverview(t[0]),Vl(t[1]),this.props.newAssessment(t[1]),this.setState({fileInputText:"Success!"})}catch(t){console.log(t),this.setState({fileInputText:"Invalid XML!"})}}))},this.handleChangeFile=e=>{const t=e.target.files;e.target.files&&(this.fileReader=new FileReader,this.fileReader.onloadend=this.handleFileRead(t[0]),this.fileReader.readAsText(t[0]))},this.makeMission=()=>{ql(Object(wt.k)()),this.props.updateEditingOverview(Object(wt.k)()),Vl(Object(wt.h)()),this.props.newAssessment(Object(wt.h)())},this.handleFileRead=this.handleFileRead.bind(this),this.handleChangeFile=this.handleChangeFile.bind(this),this.makeMission=this.makeMission.bind(this),this.state={fileInputText:"Import XML"}}componentDidMount(){const e=Fl();e&&this.props.newAssessment(e)}render(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:"Please ensure that the xml uploaded is trustable."}),Object(a.jsx)("div",{children:Object(a.jsx)(K.k,{text:this.state.fileInputText,inputProps:{accept:".xml"},onChange:this.handleChangeFile})}),Object(a.jsx)("div",{children:It("Make New Mission",Y.a.NEW_OBJECT,this.makeMission)})]})}}var Gu=Du;var Bu=Object(d.c)(((e,t)=>t),(e=>Object(u.b)({newAssessment:st.updateAssessment},e)))(Gu);class Uu extends m.Component{constructor(e){super(e),this.updateEditingOverview=e=>{this.setState({editingOverview:e})},this.state={editOverview:"",editingOverview:Hl()}}render(){const e=sa(this.props.match.params.assessmentId),t=sa(this.props.match.params.questionId)||y.b.defaultQuestionId;if(-1===e&&this.state.editingOverview){const s=this.state.editingOverview,n={assessmentId:e,questionId:t,assessmentOverview:s,updateAssessmentOverview:this.updateEditingOverview,notAttempted:s.status===wt.b.not_attempted,closeDate:s.closeAt};return Object(a.jsx)("div",{className:"Academy",children:Object(a.jsx)(_u,{...n})})}const s=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Bu,{updateEditingOverview:this.updateEditingOverview}),this.state.editingOverview&&Object(a.jsx)(tu,{overview:this.state.editingOverview,updateEditingOverview:this.updateEditingOverview,listingPath:"/mission-control"})]});return Object(a.jsx)("div",{className:"Assessment Academy",children:Object(a.jsx)(ba,{display:s,loadContentDispatch:this.props.handleAssessmentOverviewFetch})})}}var Fu=Uu;var Hu=Object(l.h)(Object(d.c)(null,(e=>Object(u.b)({handleAssessmentOverviewFetch:st.fetchAssessmentOverviews},e)))(Fu));var Vu=()=>Object(a.jsx)("div",{className:mt()("NoPage",it.a.DARK),children:Object(a.jsx)(K.D,{icon:Y.a.ERROR,title:"404 Not Found",description:"The requested resource could not be found"})}),qu=s(201),Xu=s(9),$u=s(119);const Wu=()=>Object(Xu.action)($u.b),zu=e=>Object(Xu.action)($u.c,e),Ku=()=>Object(Xu.action)($u.d),Yu=()=>Object(Xu.action)($u.a);var Qu=s(156),Ju=s(97),Zu=s(191),eh=s(152);function th(e){return Object(a.jsx)(ot.a,{content:"Execution Time",placement:rt.a.TOP,children:Object(a.jsx)(K.E,{leftIcon:Y.a.TIME,style:{width:80},min:1e3,value:e.execTime,onValueChange:e.handleChangeExecTime})})}var sh=s(86);const ah={LOGGED_OUT:fe.a.NONE,LOGGED_IN:fe.a.NONE},nh=e=>{const t=Object(ct.useMediaQuery)({maxWidth:768}),s=void 0!==sh.a.getState().session.githubOctokitInstance,n=!s,i=s?"LOGGED_IN":"LOGGED_OUT",r=It("GitHub",Y.a.GIT_BRANCH,null,{intent:ah[i]}),o=It("Open",Y.a.DOCUMENT_OPEN,e.onClickOpen,void 0,n),c=It("Save",Y.a.FLOPPY_DISK,e.onClickSave,void 0,n),d=It("Save as",Y.a.SEND_TO,e.onClickSaveAs,void 0,n),l=s?It("Log Out",Y.a.LOG_OUT,e.onClickLogOut):It("Log In",Y.a.LOG_IN,e.onClickLogIn);return Object(a.jsx)(Ds.a,{autoFocus:!1,content:Object(a.jsx)("div",{children:Object(a.jsxs)(K.c,{large:!t,children:[o,c,d,l]})}),onOpening:e.onPopoverOpening,popoverClassName:it.a.POPOVER_DISMISS,children:r})},ih={INACTIVE:fe.a.NONE,SAVED:fe.a.PRIMARY,DIRTY:fe.a.WARNING},rh=e=>{const t=Object(ct.useMediaQuery)({maxWidth:768}),s=e.currentFile?e.isDirty?"DIRTY":"SAVED":"INACTIVE",n=It(e.currentFile&&e.currentFile.name||"Google Drive",Y.a.CLOUD,null,{intent:ih[s]}),i=It("Open",Y.a.DOCUMENT_OPEN,e.onClickOpen),r=It("Save",Y.a.FLOPPY_DISK,e.onClickSave,void 0,"INACTIVE"===s),o=It("Save as",Y.a.SEND_TO,e.onClickSaveAs),c=e.loggedInAs&&Object(a.jsx)(ot.a,{content:`Logged in as ${e.loggedInAs}`,children:It("Log out",Y.a.LOG_OUT,e.onClickLogOut)});return Object(a.jsx)(Ds.a,{autoFocus:!1,content:Object(a.jsx)("div",{children:Object(a.jsxs)(K.c,{large:!t,children:[i,r,o,c]})}),onOpening:e.onPopoverOpening,popoverClassName:it.a.POPOVER_DISMISS,children:n})};function oh(e){Object(f.e)(`Could not connect: ${e&&e.message||e||"Unknown error"}`)}class ch extends m.PureComponent{constructor(e){super(e),this.inviteInputElem=void 0,this.state={joinElemValue:""},this.handleChange=this.handleChange.bind(this),this.inviteInputElem=m.createRef(),this.selectInviteInputText=this.selectInviteInputText.bind(this)}render(){const e=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",{value:this.props.editorSessionId,readOnly:!0,ref:this.inviteInputElem}),Object(a.jsx)(td,{text:""+this.props.editorSessionId,children:It("",Y.a.DUPLICATE,this.selectInviteInputText)})]}),t=Object(a.jsx)(Ds.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:e,children:It("Invite",Y.a.GRAPH,(()=>{""===this.props.editorSessionId&&async function(e){const t=await fetch(y.b.sharedbBackendUrl,{method:"POST",body:e,headers:{"Content-Type":"text/plain"}});if(!t||!t.ok)throw new Error(t?`Could not create new session: ${await t.text()}`:"Unknown error creating session");return t.text()}(this.props.editorValue||"").then((e=>{this.props.handleSetEditorSessionId(e)}),oh)}))}),s=Object(a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),rs(this.state.joinElemValue).then((e=>{e?this.props.handleSetEditorSessionId(this.state.joinElemValue):(this.props.handleSetEditorSessionId(""),Object(f.e)("Could not find a session with that ID."))}),(e=>{this.props.handleSetEditorSessionId(""),oh(e)}))},children:[Object(a.jsx)("input",{type:"text",value:this.state.joinElemValue,onChange:this.handleChange}),Object(a.jsx)("span",{className:it.a.POPOVER_DISMISS,children:It("",Y.a.KEY_ENTER,null,{type:"submit"})})]}),n=Object(a.jsx)(Ds.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:s,children:It("Join",Y.a.LOG_IN)}),i=It("Leave",Y.a.FEED,(()=>{this.props.handleSetEditorSessionId(""),this.setState({joinElemValue:""})}));return Object(a.jsx)(Ds.a,{content:Object(a.jsxs)(K.w,{large:!0,children:[t,""===this.props.editorSessionId?n:i]}),children:It("Session",Y.a.SOCIAL_MEDIA,void 0,{iconColor:""===this.props.editorSessionId?void 0:this.props.sharedbConnected?Qo.a.GREEN3:Qo.a.RED3})})}selectInviteInputText(){null!==this.inviteInputElem.current&&(this.inviteInputElem.current.focus(),this.inviteInputElem.current.select())}handleChange(e){this.setState({joinElemValue:e.target.value})}}class dh extends m.PureComponent{constructor(e){super(e),this.shareInputElem=void 0,this.selectShareInputText=this.selectShareInputText.bind(this),this.handleChange=this.handleChange.bind(this),this.toggleButton=this.toggleButton.bind(this),this.shareInputElem=m.createRef(),this.state={keyword:"",isLoading:!1}}render(){let e="";const{urlShortener:t}=y.b;t&&(e=t.split("/").slice(0,-1).join("/")+"/");const s=void 0===this.props.queryString?Object(a.jsx)(K.R,{children:"Share your programs! Type something into the editor (left), then click on this button again."}):Object(a.jsx)(a.Fragment,{children:this.props.shortURL&&"ERROR"!==this.props.shortURL?Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{defaultValue:this.props.shortURL,readOnly:!0,ref:this.shareInputElem}),Object(a.jsx)(ot.a,{content:"Copy link to clipboard",children:Object(a.jsx)(td,{text:this.props.shortURL,children:It("",Y.a.DUPLICATE,this.selectShareInputText)})})]},this.props.shortURL):this.state.isLoading&&"ERROR"!==this.props.shortURL?Object(a.jsx)("div",{children:Object(a.jsx)(K.D,{description:"Generating Shareable Link...",icon:Object(a.jsx)(K.M,{size:K.M.SIZE_SMALL})})}):Object(a.jsxs)("div",{children:[e,"\xa0",Object(a.jsx)("input",{placeholder:"custom string (optional)",onChange:this.handleChange,style:{width:175}}),It("Get Link",Y.a.SHARE,(()=>{this.props.handleShortenURL(this.state.keyword),this.setState({isLoading:!0})}))]})});return Object(a.jsx)(Ds.a,{popoverClassName:"Popover-share",inheritDarkTheme:!1,content:s,children:Object(a.jsx)(ot.a,{content:"Get shareable link",placement:rt.a.TOP,children:It("Share",Y.a.SHARE,(()=>this.toggleButton()))})})}componentDidUpdate(e){this.props.shortURL!==e.shortURL&&this.setState({keyword:"",isLoading:!1})}toggleButton(){this.props.handleGenerateLz&&this.props.handleGenerateLz(),this.props.handleUpdateShortURL(""),this.setState({keyword:"",isLoading:!1})}handleChange(e){this.setState({keyword:e.currentTarget.value})}selectShareInputText(){null!==this.shareInputElem.current&&(this.shareInputElem.current.focus(),this.shareInputElem.current.select())}}function lh(e){return Object(a.jsx)(ot.a,{content:"Step Limit",placement:rt.a.TOP,children:Object(a.jsx)(K.E,{leftIcon:Y.a.VERTICAL_BAR_CHART_ASC,style:{width:80},min:500,max:5e3,value:e.stepLimit,onValueChange:e.handleChangeStepLimit})})}class uh extends m.Component{constructor(e){super(e),this.state={width:window._WIDTH,height:window._HEIGHT}}takePhotoA(){window.video.takePhotoA()}takePhotoB(){window.video.takePhotoB()}takePhotoC(){window.video.takePhotoC()}resetPhotoA(){window.resetPhotoA()}resetPhotoB(){window.resetPhotoB()}resetPhotoC(){window.resetPhotoC()}render(){return Object(a.jsxs)("div",{className:"sa-video",children:[Object(a.jsxs)("div",{className:"sa-video-element",children:[Object(a.jsx)("video",{id:"video",style:{position:"absolute"},autoPlay:!0,width:333,height:250}),Object(a.jsx)("canvas",{id:"canvas",style:{position:"relative",top:0,left:0},width:333,height:250})]}),Object(a.jsx)(K.h,{}),Object(a.jsxs)("div",{className:"sa-video-header",children:[Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)(K.b,{className:"sa-live-video-button",style:{height:20},icon:Y.a.CAMERA,onClick:this.takePhotoA,text:"Take picture"})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)("canvas",{id:"canvas-capture-a",style:{height:30}})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)(K.b,{className:"sa-still-image-button",style:{height:20},icon:Y.a.RESET,onClick:this.resetPhotoA,text:"Reset"})})]}),Object(a.jsxs)("div",{className:"sa-video-header",children:[Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)(K.b,{className:"sa-live-video-button",style:{height:20},icon:Y.a.CAMERA,onClick:this.takePhotoB,text:"Take picture"})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)("canvas",{id:"canvas-capture-b",style:{height:20}})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)(K.b,{className:"sa-still-image-button",style:{height:20},icon:Y.a.RESET,onClick:this.resetPhotoB,text:"Reset"})})]}),Object(a.jsxs)("div",{className:"sa-video-header",children:[Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)(K.b,{className:"sa-live-video-button",style:{height:20},icon:Y.a.CAMERA,onClick:this.takePhotoC,text:"Take picture"})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)("canvas",{id:"canvas-capture-c",style:{height:20}})}),Object(a.jsx)(K.h,{}),Object(a.jsx)("div",{className:"sa-video-header-element",children:Object(a.jsx)(K.b,{className:"sa-still-image-button",style:{height:20},icon:Y.a.RESET,onClick:this.resetPhotoC,text:"Reset"})})]})]})}}var hh=uh,ph=s(16);function gh(e){const t=b.a.useRef(null),[s,a]=b.a.useState(!0),n=b.a.useCallback((()=>{var n;const i=!e||e(null===(n=t.current)||void 0===n?void 0:n.value);return s!==i&&a(i),i}),[s,e]),i=b.a.useCallback((()=>{n()}),[n]);return{ref:t,isValid:s,setIsValid:a,validate:n,onChange:i}}function mh(...e){return-1===e.findIndex((({isValid:e})=>!e))}function bh(e){return"string"===typeof e&&e.length>0}var jh=s(63);function yh({isOpen:e,onClose:t,deviceToEdit:s}){const n=Object(d.e)(),i=gh(bh),r=gh(),o=gh(bh),[c,l]=b.a.useState(!1),[u,h]=b.a.useState();return Object(a.jsxs)(K.g,{icon:s?"edit":"add",title:s?`Edit ${s.title} (${s.type})`:"Add new device",isOpen:e,className:it.a.DARK,onClose:t,canEscapeKeyClose:!c,canOutsideClickClose:!c,isCloseButtonShown:!c,onOpening:()=>{h(void 0),i.setIsValid(!0),o.setIsValid(!0)},children:[Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsx)(K.l,{label:"Name",labelFor:"sa-remote-execution-name",helperText:"Shown to you only. You can key in a different name from other users.",children:Object(a.jsx)("input",{id:"sa-remote-execution-name",className:mt()(it.a.INPUT,it.a.FILL,i.isValid||it.a.INTENT_DANGER),type:"text",ref:i.ref,onChange:i.onChange,disabled:c,...s?{defaultValue:s.title}:void 0})}),Object(a.jsx)(K.l,{label:"Type",labelFor:"sa-remote-execution-type",children:Object(a.jsx)(K.s,{id:"sa-remote-execution-type",className:mt()(it.a.FILL),elementRef:e=>{r.ref.current=e},disabled:c||!!s,...s?{value:s.type}:void 0,children:jh.h.map((({id:e,name:t})=>Object(a.jsx)("option",{value:e,children:t},e)))})}),Object(a.jsx)(K.l,{label:"Secret",labelFor:"sa-remote-execution-secret",children:Object(a.jsx)("input",{id:"sa-remote-execution-secret",className:mt()(it.a.INPUT,it.a.FILL,o.isValid||it.a.INTENT_DANGER),type:"text",ref:o.ref,onChange:o.onChange,disabled:c,readOnly:!!s,...s?{value:s.secret}:void 0})}),u&&Object(a.jsx)(K.d,{intent:"danger",children:u})]}),Object(a.jsx)("div",{className:it.a.DIALOG_FOOTER,children:Object(a.jsxs)("div",{className:it.a.DIALOG_FOOTER_ACTIONS,children:[Object(a.jsx)(K.b,{onClick:t,disabled:c,children:"Cancel"}),Object(a.jsx)(K.b,{intent:"primary",onClick:async()=>{const e=function(...e){let t=!0;const s=[];for(const n of e)if(n.ref.current){var a;const e=n.validate();t=t&&e,s.push(null===(a=n.ref.current)||void 0===a?void 0:a.value)}else t=!1;return t?s:null}(i,r,o);if(!e)return;const[a,c,d]=e;try{h(void 0),l(!0),s?await Object(No.h)({id:s.id,title:a}):await Object(No.J)({title:a,type:c,secret:d})}catch(u){return h((null===u||void 0===u?void 0:u.message)||"Unknown error occurred."),void l(!1)}n(ph.a.remoteExecFetchDevices()),t(),l(!1)},disabled:c||!mh(i,o),children:s?"Edit":"Add"})]})})]})}const Oh=({isConnected:e,device:t,dispatch:s,onEditDevice:n})=>Object(a.jsxs)(a.Fragment,{children:[e&&Object(a.jsx)(a.Fragment,{children:"Connected"}),Object(a.jsxs)("div",{className:"edit-buttons",children:[Object(a.jsx)(K.b,{icon:"edit",small:!0,minimal:!0,onClick:e=>{e.stopPropagation(),n(t)}}),Object(a.jsx)(K.b,{intent:"danger",icon:"trash",small:!0,minimal:!0,onClick:async a=>{a.stopPropagation();if(await Object(ee.a)({title:"Really delete device?",contents:`Are you sure you want to delete ${t.title} (${t.type})?`,positiveLabel:"Delete",positiveIntent:"danger",negativeLabel:"No",icon:"trash"})){try{await Object(No.e)(t)}catch(a){return void Object(f.e)(a.message||"Unknown error occurred.")}e&&s(ph.a.remoteExecDisconnect()),s(ph.a.remoteExecFetchDevices())}}})]})]}),vh=({session:e})=>{if(!e)return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("p",{children:"Not connected to a device\u2014programs are run in your local browser."}),Object(a.jsx)("p",{children:"Select a device from the right."})]});const{device:t,connection:s}=e;switch(s.status){case"CONNECTED":return Object(a.jsxs)("p",{children:["Connected to ",t.title," (",t.type,")."]});case"CONNECTING":return Object(a.jsx)(K.D,{description:"Connecting...",icon:Object(a.jsx)(K.M,{})});default:case"FAILED":return Object(a.jsxs)(K.d,{intent:"danger",children:["Could not connect to ",t.title,": ",s.error||"unknown error"]})}};var xh=e=>{const[t,s]=b.a.useState(void 0),[n,i,r]=Object(d.f)((e=>[!!e.session.accessToken&&!!e.session.role,e.session.remoteExecutionDevices,e.session.remoteExecutionSession]),d.d),o=Object(d.e)(),c="CONNECTED"===(null===r||void 0===r?void 0:r.connection.status);if(b.a.useEffect((()=>{r&&r.workspace!==e.workspace&&o(ph.a.remoteExecUpdateSession({...r,workspace:e.workspace}))}),[r,o,e.workspace]),b.a.useEffect((()=>{!i&&n&&o(ph.a.remoteExecFetchDevices())}),[o,i,n]),b.a.useEffect((()=>()=>{o(ph.a.remoteExecDisconnect())}),[o]),!n)return Object(a.jsxs)(K.d,{intent:"danger",children:["Please ",Object(a.jsx)(lt.b,{to:"/login",children:"log in"})," to execute on a remote device."]});const l=null===r||void 0===r?void 0:r.device;return Object(a.jsxs)("div",{className:"sa-remote-execution row",children:[Object(a.jsx)("div",{className:"col-xs-6",children:Object(a.jsx)(vh,{session:r})}),Object(a.jsx)("div",{className:"col-xs-6 devices-menu-container",children:Object(a.jsxs)(K.w,{className:mt()(it.a.ELEVATION_0),children:[Object(a.jsx)(K.y,{text:"Browser",onClick:()=>o(ph.a.remoteExecDisconnect()),icon:l?void 0:"tick",intent:l?void 0:"success"}),i&&i.map((t=>{const n=(null===l||void 0===l?void 0:l.id)===t.id;return Object(a.jsx)(K.y,{onClick:()=>o(ph.a.remoteExecConnect(e.workspace,t)),text:`${t.title} (${t.type})`,icon:n?"tick":void 0,labelElement:Object(a.jsx)(Oh,{onEditDevice:s,isConnected:n&&c,device:t,dispatch:o}),intent:n&&c?"success":void 0},t.id)})),Object(a.jsx)(K.x,{}),Object(a.jsx)(K.y,{text:"Add new device...",icon:"add",onClick:()=>s(!0)})]})}),Object(a.jsx)(yh,{isOpen:!!t,deviceToEdit:"object"===typeof t?t:void 0,onClose:()=>s(void 0)})]})};const fh=()=>Object(a.jsx)("div",{children:Object(a.jsxs)("div",{id:"substituter-default-text",className:it.a.RUNNING_TEXT,children:["Welcome to the Stepper!",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"On this tab, the REPL will be hidden from view, so do check that your code has no errors before running the stepper. You may use this tool by writing your program on the left, then dragging the slider above to see its evaluation.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"On even-numbered steps, the part of the program that will be evaluated next is highlighted in yellow. On odd-numbered steps, the result of the evaluation is highlighted in green. You can change the maximum steps limit (500-5000, default 1000) in the control bar.",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(K.h,{}),"Some useful keyboard shortcuts:",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),It("(Comma)",Y.a.LESS_THAN),": Move to the first step",Object(a.jsx)("br",{}),It("(Period)",Y.a.GREATER_THAN),": Move to the last step",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"Note that the first and last step shortcuts are only active when the browser focus is on this panel (click on the slider or the text!).",Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),"When the focus is on the slider, the arrow keys may also be used to move a single step."]})}),Sh={FIRST_STEP:",",LAST_STEP:"."},Ch=e=>Object(a.jsx)(K.e,{children:Object(a.jsx)(K.I,{className:"resultOutput",children:e.content})});class wh extends m.Component{constructor(e){super(e),this.getDiffMarkers=e=>{const t=e<=this.props.content.length?e-1:0,s=this.props.content[t],a=s.code,n=s.redex.split("\n"),i=[];if(n.length>0){const t=a.split("$");let s=t[0],r=s.split("\n"),o=r.length-1,c=r[o].length;for(let a=0;a<t.length-1;a++){const d=o+n.length-1,l=1===n.length?c+n[n.length-1].length:n[n.length-1].length;i.push({startRow:o,startCol:c,endRow:d,endCol:l,className:e%2===0?"beforeMarker":"afterMarker",type:"background"}),s=s+n+t[a+1],r=s.split("\n"),o=r.length-1,c=r[o].length}}return i},this.sliderShift=e=>{this.setState((t=>({value:e})))},this.stepFirst=()=>{this.sliderShift(1)},this.stepLast=e=>()=>{this.sliderShift(e)},this.state={value:1},Object(ds.HighlightRulesSelector)(2),Object(ds.ModeSelector)(2)}render(){const e=this.props.content.length,t=0!==e,s=t?{FIRST_STEP:this.stepFirst,LAST_STEP:this.stepLast(e)}:{FIRST_STEP:()=>{},LAST_STEP:()=>{}};return Object(a.jsx)($t.HotKeys,{keyMap:Sh,handlers:s,children:Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"sa-substituter bp3-dark",children:[Object(a.jsx)(K.L,{disabled:!t,min:1,max:this.props.content.length,onChange:this.sliderShift,value:this.state.value<=e?this.state.value:1}),t?Object(a.jsx)(Xt.a,{className:"react-ace",mode:"source2defaultNONE",theme:"source",fontSize:17,highlightActiveLine:!1,wrapEnabled:!0,height:"unset",width:"100%",showGutter:!1,readOnly:!0,maxLines:1/0,value:this.getText(this.state.value),markers:this.getDiffMarkers(this.state.value),setOptions:{fontFamily:"'Inconsolata', 'Consolas', monospace"}}):Object(a.jsx)(fh,{}),t?Object(a.jsx)(Ch,{content:this.state.value<=e?this.props.content[this.state.value-1].explanation:this.props.content[0].explanation}):null]})})})}getText(e){const t=e<=this.props.content.length?e-1:0,s=this.props.content[t],a=s.code,n=s.redex,i=s.code.split("$");if(i.length>1){let e=i[0];for(let t=1;t<i.length;t++)e=e+n+i[t];return e}return a}}var Eh=wh;const Ah=`\nWelcome to the Source Academy playground!\n\nThe language [_Source_](${y.a.sourceDocs}) is the official language of the textbook [_Structure and\nInterpretation of Computer Programs, JavaScript Adaptation_](${y.a.textbook}). `,Ih=`\n\nIn the editor on the left, you can use the [_Ace keyboard shortcuts_](${y.a.aceHotkeys}) \nand also the [_Source Academy keyboard shortcuts_](${y.a.sourceHotkeys}).\n\n`,Th=e=>Ah+(e=>{switch(e){case"1 default":return`You have chosen the sublanguage [_Source \xa71_](${y.a.source_1}).`;case"1 wasm":return`You have chosen the sublanguage [_Source \xa71 WebAssembly_](${y.a.source_1_Wasm}).`;case"1 lazy":return`You have chosen the sublanguage [_Source \xa71 Lazy_](${y.a.source_1_Lazy}).`;case"2 default":return`You have chosen the sublanguage [_Source \xa72_](${y.a.source_2}).`;case"2 lazy":return`You have chosen the sublanguage [_Source \xa72 Lazy_](${y.a.source_2_Lazy}).`;case"3 default":return`You have chosen the sublanguage [_Source \xa73_](${y.a.source_3}).`;case"3 non-det":return`You have chosen the sublanguage [_Source \xa73 Non-Det_](${y.a.source_3_Nondet}).`;case"3 concurrent":return`You have chosen the sublanguage [_Source \xa73 Concurrent_](${y.a.source_3_Concurrent}).`;case"4 default":return`You have chosen the sublanguage [_Source \xa74_](${y.a.source_4}).`;case"4 gpu":return`You have chosen the sublanguage [_Source \xa74 GPU_](${y.a.source_4_Gpu}).`;default:return"You have chosen an invalid sublanguage. Please pick a sublanguage from the dropdown instead."}})(e)+Ih;var kh=s(413);function Nh(e){const t=Pl.parse(e);for(const[s,a]of Object.entries(t))Object(kh.isArray)(a)?t[s]=a.join(","):null===a&&delete t[s];return t}const Ph={goGreen:"h u l k"};const Rh={label:"Data Visualizer",iconName:Y.a.EYE_OPEN,body:Object(a.jsx)(Xc,{}),id:Os.b.dataVisualiser,toSpawn:()=>!0},Mh={label:"Face API Display",iconName:Y.a.MUGSHOT,body:Object(a.jsx)(hh,{}),toSpawn:()=>!0},Lh={label:"Inspector",iconName:Y.a.SEARCH,body:Object(a.jsx)(Hc,{}),id:Os.b.inspector,toSpawn:()=>!0},_h={label:"Env Visualizer",iconName:Y.a.GLOBE,body:Object(a.jsx)(Uc,{}),id:Os.b.envVisualiser,toSpawn:()=>!0},Dh={label:"Remote Execution",iconName:Y.a.SATELLITE,body:Object(a.jsx)(xh,{workspace:"playground"}),id:Os.b.remoteExecution,toSpawn:()=>!0};var Gh=e=>{const t=Object(ct.useMediaQuery)({maxWidth:768}),s=m.useRef(e);s.current=e;const[n,i]=m.useState(new Date),[r,o]=m.useState(!1),[c,l]=m.useState(Os.b.introduction),[u,h]=m.useState(!1),[p,g]=m.useState((()=>vt("playground",{editorValue:s.current.editorValue,externalLibrary:s.current.externalLibraryName,chapter:s.current.sourceChapter}))),b=Object(d.f)((e=>!!e.session.remoteExecutionSession));m.useEffect((()=>{s.current.handleExternalSelect(s.current.externalLibraryName,!0),s.current.location.hash||s.current.handleFetchSublanguage()}),[]),m.useEffect((()=>{g(vt("playground",{editorValue:s.current.editorValue,externalLibrary:s.current.externalLibraryName,chapter:s.current.sourceChapter}))}),[e.editorSessionId]),m.useEffect((()=>{b||Ct.b.has(e.externalLibraryName)||s.current.handleExternalSelect(Ct.a.NONE,!0)}),[b,e.externalLibraryName]);const y=e.location.hash;m.useEffect((()=>{y&&function(e,t){var s,a,n;const i=Nh(e),r=null!==(s=i.lz)&&void 0!==s?s:i.prgrm,o=r&&Object(eh.decompressFromEncodedURIComponent)(r);o&&t.handleEditorValueChange(o);const c=sa(i.chap)||void 0,d=null!==(a=null===(n=j.m.find((e=>e.chapter===c&&e.variant===i.variant)))||void 0===n?void 0:n.variant)&&void 0!==a?a:"default";c&&t.handleChapterSelect(c,d);const l=Object.values(Ct.a).find((e=>e===i.ext))||Ct.a.NONE;l&&t.handleExternalSelect(l,!0);const u=Math.max(sa(i.exec||"1000")||1e3,1e3);u&&t.handleChangeExecTime(u)}(y,s.current)}),[y]),m.useEffect((()=>{!t||c!==Os.b.introduction&&c!==Os.b.remoteExecution?t||c!==Os.b.mobileEditor&&c!==Os.b.mobileEditorRun||(l(Os.b.introduction),e.handleActiveTabChange(Os.b.introduction)):(e.handleActiveTabChange(Os.b.mobileEditor),l(Os.b.mobileEditor))}),[t,e,c]);const v=m.useMemo((()=>({goGreen:()=>o(!r)})),[r]),x=m.useCallback((e=>{i(new Date),s.current.handleEditorValueChange(e)}),[]),f=m.useCallback(((e,t,a)=>{if(e===t)return;const{handleUsingSubst:n,handleReplOutputClear:i,sourceChapter:r}=s.current;t===Os.b.substVisualizer&&e===Os.b.mobileEditorRun||(r<=2&&e===Os.b.substVisualizer&&n(!0),t!==Os.b.substVisualizer||u||(i(),n(!1)),l(e))}),[u]),S=e=>{const t=e[0];return t&&"result"===t.type&&t.value instanceof Array&&t.value[0]===Object(t.value[0])&&Object(Zu.isStepperOutput)(t.value[0])?t.value:[]},C=m.useCallback((e=>{Ot(p,e)}),[p]),w=m.useMemo((()=>Object(a.jsx)(Dc,{handleDebuggerPause:e.handleDebuggerPause,handleDebuggerReset:e.handleDebuggerReset,handleDebuggerResume:e.handleDebuggerResume,handleEditorEval:e.handleEditorEval,handleInterruptEval:e.handleInterruptEval,handleToggleEditorAutorun:e.handleToggleEditorAutorun,isDebugging:e.isDebugging,isEditorAutorun:e.isEditorAutorun,isRunning:e.isRunning,autorunDisabled:b,pauseDisabled:b},"autorun")),[e.handleDebuggerPause,e.handleDebuggerReset,e.handleDebuggerResume,e.handleEditorEval,e.handleInterruptEval,e.handleToggleEditorAutorun,e.isDebugging,e.isEditorAutorun,e.isRunning,b]),E=m.useCallback((({chapter:e,variant:t},a)=>{const{handleUsingSubst:n,handleReplOutputClear:i,handleChapterSelect:r}=s.current;(e<=2&&u||c===Os.b.substVisualizer)&&n(!0),e>2&&(i(),n(!1));const o={time:Date.now(),type:"chapterSelect",data:e};C(o),r(e,t)}),[u,c,C]),A=m.useMemo((()=>Object(a.jsx)(Et,{handleChapterSelect:E,sourceChapter:e.sourceChapter,sourceVariant:e.sourceVariant,disabled:b},"chapter")),[E,e.sourceChapter,e.sourceVariant,b]),I=m.useMemo((()=>c===Os.b.substVisualizer?null:Object(a.jsx)(Tt,{handleReplOutputClear:e.handleReplOutputClear},"clear_repl")),[e.handleReplOutputClear,c]),T=m.useMemo((()=>c===Os.b.substVisualizer?null:Object(a.jsx)(kt,{handleReplEval:e.handleReplEval,isRunning:e.isRunning},"eval_repl")),[e.handleReplEval,e.isRunning,c]),{persistenceUser:k,persistenceFile:N,handlePersistenceUpdateFile:P}=e,R=N&&(!N.lastSaved||N.lastSaved<n),M=m.useMemo((()=>Object(a.jsx)(rh,{currentFile:N,loggedInAs:k,isDirty:R,onClickSaveAs:e.handlePersistenceSaveFile,onClickOpen:e.handlePersistenceOpenPicker,onClickSave:N?()=>P(N):void 0,onClickLogOut:e.handlePersistenceLogOut,onPopoverOpening:e.handlePersistenceInitialise},"googledrive")),[k,N,R,e.handlePersistenceSaveFile,e.handlePersistenceOpenPicker,e.handlePersistenceLogOut,e.handlePersistenceInitialise,P]),{githubOctokitInstance:L,githubFile:_,handleGitHubUpdateFile:D}=e,G=_&&(!_.lastSaved||_.lastSaved<n),B=m.useMemo((()=>Object(a.jsx)(nh,{currentFile:_,loggedInAs:L,isDirty:G,onClickOpen:e.handleGitHubOpenPicker,onClickSave:_?()=>D(_):void 0,onClickSaveAs:e.handleGitHubSaveFile,onClickLogIn:e.handleGitHubLogIn,onClickLogOut:e.handleGitHubLogOut,onPopoverOpening:e.handleGitHubInitialise},"github")),[L,_,G,e.handleGitHubSaveFile,e.handleGitHubOpenPicker,e.handleGitHubLogIn,e.handleGitHubLogOut,e.handleGitHubInitialise,D]),U=m.useMemo((()=>Object(a.jsx)(th,{execTime:e.execTime,handleChangeExecTime:e.handleChangeExecTime},"execution_time")),[e.execTime,e.handleChangeExecTime]),F=m.useMemo((()=>Object(a.jsx)(lh,{stepLimit:e.stepLimit,handleChangeStepLimit:e.handleChangeStepLimit},"step_limit")),[e.handleChangeStepLimit,e.stepLimit]),{handleExternalSelect:H,externalLibraryName:V,handleEditorValueChange:q}=e,X=m.useCallback((e=>{H(e);const t={time:Date.now(),type:"externalLibrarySelect",data:e};C(t)}),[H,C]),$=m.useMemo((()=>Object(a.jsx)(Gc,{externalLibraryName:V,handleExternalSelect:({name:e},t)=>X(e),disabled:b},"external_library")),[V,X,b]),W=Object(a.jsx)(ch,{editorSessionId:e.editorSessionId,editorValue:e.editorValue,handleSetEditorSessionId:e.handleSetEditorSessionId,sharedbConnected:e.sharedbConnected},"session"),z=m.useMemo((()=>Object(a.jsx)(dh,{handleGenerateLz:e.handleGenerateLz,handleShortenURL:e.handleShortenURL,handleUpdateShortURL:e.handleUpdateShortURL,queryString:e.queryString,shortURL:e.shortURL},"share")),[e.handleGenerateLz,e.handleShortenURL,e.handleUpdateShortURL,e.queryString,e.shortURL]),K=m.useMemo((()=>{return{label:"Introduction",iconName:Y.a.HOME,body:Object(a.jsx)(Ut,{content:(t=e.sourceChapter,s=e.sourceVariant,Th(`${t} ${s}`)),openLinksInNewWindow:!0}),id:Os.b.introduction,toSpawn:()=>!0};var t,s}),[e.sourceChapter,e.sourceVariant]),Q=m.useMemo((()=>{const t=[K];return e.externalLibraryName!==Ct.a.PIXNFLIX&&e.externalLibraryName!==Ct.a.ALL||t.push({label:"Video Display",iconName:Y.a.MOBILE_VIDEO,body:Object(a.jsx)(Zs,{replChange:e.handleSendReplInputToOutput}),toSpawn:()=>!0}),e.externalLibraryName===Ct.a.MACHINELEARNING&&t.push(Mh),e.sourceChapter>=2&&!b&&t.push(Rh),e.sourceChapter>=3&&"concurrent"!==e.sourceVariant&&"non-det"!==e.sourceVariant&&!b&&(t.push(Lh),t.push(_h)),e.sourceChapter<=2&&"default"===e.sourceVariant&&t.push({label:"Stepper",iconName:Y.a.FLOW_REVIEW,body:Object(a.jsx)(Eh,{content:S(e.output)}),id:Os.b.substVisualizer,toSpawn:()=>!0}),t.push(Dh),t}),[K,e.externalLibraryName,e.handleSendReplInputToOutput,e.output,e.sourceChapter,e.sourceVariant,b]),J=[...Q];J.shift(),J.pop();const Z=m.useCallback(((e,t)=>{q(e);const s={time:Date.now(),type:"codeDelta",data:t};C(s)}),[q,C]),ee=m.useCallback((e=>{const t={time:Date.now(),type:"cursorPositionChange",data:e.getCursor()};C(t)}),[C]),te=m.useCallback((e=>{const t=e.getRange(),s=e.isBackwards();if(!Object(O.isEqual)(t.start,t.end)){const e={time:Date.now(),type:"selectionRangeData",data:{range:t,isBackwards:s}};C(e)}}),[C]),se=m.useCallback((e=>{const t=e.filter((e=>!!e)).length;t>0&&(h(!0),s.current.sourceChapter<=2&&s.current.handleUsingSubst(!0)),0===t&&(h(!1),c!==Os.b.substVisualizer&&(s.current.handleReplOutputClear(),s.current.handleUsingSubst(!1))),s.current.handleEditorUpdateBreakpoints(e)}),[c]),ae="concurrent"===e.sourceVariant||"wasm"===e.sourceVariant||b,ne={onChange:Z,onCursorChange:ee,onSelectionChange:te,sourceChapter:e.sourceChapter,externalLibraryName:e.externalLibraryName,sourceVariant:e.sourceVariant,editorValue:e.editorValue,editorSessionId:e.editorSessionId,handleDeclarationNavigate:e.handleDeclarationNavigate,handleEditorEval:e.handleEditorEval,handleEditorValueChange:x,handleSendReplInputToOutput:e.handleSendReplInputToOutput,handlePromptAutocomplete:e.handlePromptAutocomplete,isEditorAutorun:e.isEditorAutorun,breakpoints:e.breakpoints,highlightedLines:e.highlightedLines,newCursorPosition:e.newCursorPosition,handleEditorUpdateBreakpoints:se,handleSetSharedbConnected:e.handleSetSharedbConnected},ie={sourceChapter:e.sourceChapter,sourceVariant:e.sourceVariant,externalLibrary:e.externalLibraryName,output:e.output,replValue:e.replValue,handleBrowseHistoryDown:e.handleBrowseHistoryDown,handleBrowseHistoryUp:e.handleBrowseHistoryUp,handleReplEval:e.handleReplEval,handleReplValueChange:e.handleReplValueChange,hidden:c===Os.b.substVisualizer,inputHidden:ae,usingSubst:e.usingSubst,replButtons:[ae?null:T,I]},re={controlBarProps:{editorButtons:[w,z,A,"concurrent"!==e.sourceVariant?$:null,W,M,B,b?null:e.usingSubst?F:U]},editorProps:ne,editorHeight:e.editorHeight,editorWidth:e.editorWidth,handleEditorHeightChange:e.handleEditorHeightChange,handleEditorWidthChange:e.handleEditorWidthChange,handleSideContentHeightChange:e.handleSideContentHeightChange,replProps:ie,sideContentHeight:e.sideContentHeight,sideContentProps:{defaultSelectedTabId:c,selectedTabId:c,handleActiveTabChange:e.handleActiveTabChange,onChange:f,tabs:Q,workspaceLocation:"playground"},sideContentIsResizeable:c!==Os.b.substVisualizer},oe={editorProps:ne,replProps:ie,mobileSideContentProps:{mobileControlBarProps:{editorButtons:[w,A,"concurrent"!==e.sourceVariant?$:null,z,W,M,B]},defaultSelectedTabId:c,selectedTabId:c,handleActiveTabChange:e.handleActiveTabChange,onChange:f,tabs:J,workspaceLocation:"playground",handleEditorEval:e.handleEditorEval}};return t?Object(a.jsx)(Us,{...oe}):Object(a.jsx)($t.HotKeys,{className:mt()("Playground",it.a.DARK,r?"GreenScreen":void 0),keyMap:Ph,handlers:v,children:Object(a.jsx)(oa,{...re})})};const Bh="playground";var Uh=Object(l.h)(Object(d.c)((e=>({editorSessionId:e.workspaces.playground.editorSessionId,editorWidth:e.workspaces.playground.editorWidth,editorValue:e.workspaces.playground.editorValue,execTime:e.workspaces.playground.execTime,stepLimit:e.workspaces.playground.stepLimit,isEditorAutorun:e.workspaces.playground.isEditorAutorun,breakpoints:e.workspaces.playground.breakpoints,highlightedLines:e.workspaces.playground.highlightedLines,isRunning:e.workspaces.playground.isRunning,isDebugging:e.workspaces.playground.isDebugging,enableDebugging:e.workspaces.playground.enableDebugging,newCursorPosition:e.workspaces.playground.newCursorPosition,output:e.workspaces.playground.output,queryString:e.playground.queryString,shortURL:e.playground.shortURL,replValue:e.workspaces.playground.replValue,sideContentHeight:e.workspaces.playground.sideContentHeight,sourceChapter:e.workspaces.playground.context.chapter,sourceVariant:e.workspaces.playground.context.variant,sharedbConnected:e.workspaces.playground.sharedbConnected,externalLibraryName:e.workspaces.playground.externalLibrary,usingSubst:e.playground.usingSubst,persistenceUser:e.session.googleUser,persistenceFile:e.playground.persistenceFile,githubOctokitInstance:e.session.githubOctokitInstance,githubFile:e.playground.githubFile})),(e=>Object(u.b)({handleActiveTabChange:e=>Object(pt.updateActiveTab)(e,Bh),handleBrowseHistoryDown:()=>Object(pt.browseReplHistoryDown)(Bh),handleBrowseHistoryUp:()=>Object(pt.browseReplHistoryUp)(Bh),handleChangeExecTime:e=>Object(pt.changeExecTime)(e.toString(),Bh),handleChangeStepLimit:e=>Object(pt.changeStepLimit)(e,Bh),handleChapterSelect:(e,t)=>Object(pt.chapterSelect)(e,t,Bh),handleDeclarationNavigate:e=>Object(pt.navigateToDeclaration)(Bh,e),handleFetchSublanguage:pt.fetchSublanguage,handleEditorEval:()=>Object(pt.evalEditor)(Bh),handleEditorValueChange:e=>Object(pt.updateEditorValue)(e,Bh),handleEditorHeightChange:e=>Object(pt.changeEditorHeight)(e,Bh),handleEditorWidthChange:e=>Object(pt.changeEditorWidth)(e.toString(),Bh),handleEditorUpdateBreakpoints:e=>Object(pt.setEditorBreakpoint)(e,Bh),handleGenerateLz:Ju.generateLzString,handleShortenURL:e=>Object(Ju.shortenURL)(e),handleUpdateShortURL:e=>Object(Ju.updateShortURL)(e),handleInterruptEval:()=>Object(ht.beginInterruptExecution)(Bh),handleExternalSelect:(e,t)=>Object(pt.externalLibrarySelect)(e,Bh,t),handleReplEval:()=>Object(pt.evalRepl)(Bh),handleReplOutputClear:()=>Object(pt.clearReplOutput)(Bh),handleReplValueChange:e=>Object(pt.updateReplValue)(e,Bh),handleSetEditorSessionId:e=>Object(qu.setEditorSessionId)(Bh,e),handleSendReplInputToOutput:e=>Object(pt.sendReplInputToOutput)(e,Bh),handleSetSharedbConnected:e=>Object(qu.setSharedbConnected)(Bh,e),handleSideContentHeightChange:e=>Object(pt.changeSideContentHeight)(e,Bh),handleToggleEditorAutorun:()=>Object(pt.toggleEditorAutorun)(Bh),handleUsingSubst:e=>Object(Ju.toggleUsingSubst)(e),handleDebuggerPause:()=>Object(ht.beginDebuggerPause)(Bh),handleDebuggerResume:()=>Object(ht.debuggerResume)(Bh),handleDebuggerReset:()=>Object(ht.debuggerReset)(Bh),handleFetchChapter:pt.fetchSublanguage,handlePromptAutocomplete:(e,t,s)=>Object(pt.promptAutocomplete)(Bh,e,t,s),handlePersistenceOpenPicker:Qu.persistenceOpenPicker,handlePersistenceSaveFile:Qu.persistenceSaveFileAs,handlePersistenceUpdateFile:Qu.persistenceSaveFile,handlePersistenceInitialise:Qu.persistenceInitialise,handlePersistenceLogOut:st.logoutGoogle,handleGitHubOpenPicker:Wu,handleGitHubSaveFile:Ku,handleGitHubUpdateFile:zu,handleGitHubInitialise:Yu,handleGitHubLogIn:st.loginGitHub,handleGitHubLogOut:st.logoutGitHub},e)))(Gh));class Fh extends m.Component{componentDidMount(){this.props.handleFetchSourcecastIndex()}componentDidUpdate(e){this.handleQueryParam();const{inputToApply:t}=this.props;if(t&&t!==e.inputToApply)switch(t.type){case"activeTabChange":this.props.handleActiveTabChange(t.data);break;case"chapterSelect":this.props.handleChapterSelect(t.data);break;case"externalLibrarySelect":this.props.handleExternalSelect(t.data);break;case"forcePause":this.props.handleSetSourcecastStatus(St.b.forcedPaused)}}render(){const e=Object(a.jsx)(Dc,{handleDebuggerPause:this.props.handleDebuggerPause,handleDebuggerReset:this.props.handleDebuggerReset,handleDebuggerResume:this.props.handleDebuggerResume,handleEditorEval:this.props.handleEditorEval,handleInterruptEval:this.props.handleInterruptEval,handleToggleEditorAutorun:this.props.handleToggleEditorAutorun,isDebugging:this.props.isDebugging,isEditorAutorun:this.props.isEditorAutorun,isRunning:this.props.isRunning},"autorun"),t=Object(a.jsx)(Et,{handleChapterSelect:({chapter:e},t)=>this.props.handleChapterSelect(e),sourceChapter:this.props.sourceChapter,sourceVariant:this.props.sourceVariant},"chapter"),s=Object(a.jsx)(Tt,{handleReplOutputClear:this.props.handleReplOutputClear},"clear_repl"),n=Object(a.jsx)(kt,{handleReplEval:this.props.handleReplEval,isRunning:this.props.isRunning},"eval_repl"),i=Object(a.jsx)(Gc,{externalLibraryName:this.props.externalLibraryName,handleExternalSelect:({name:e},t)=>this.props.handleExternalSelect(e)},"external_library"),r={codeDeltasToApply:this.props.codeDeltasToApply,editorReadonly:this.props.editorReadonly,editorValue:this.props.editorValue,editorSessionId:"",handleDeclarationNavigate:this.props.handleDeclarationNavigate,handleEditorEval:this.props.handleEditorEval,handleEditorValueChange:this.props.handleEditorValueChange,isEditorAutorun:this.props.isEditorAutorun,inputToApply:this.props.inputToApply,isPlaying:this.props.playbackStatus===St.b.playing,breakpoints:this.props.breakpoints,highlightedLines:this.props.highlightedLines,newCursorPosition:this.props.newCursorPosition,handleEditorUpdateBreakpoints:this.props.handleEditorUpdateBreakpoints},o={controlBarProps:{editorButtons:[e,t,i]},customEditor:Object(a.jsx)(Yc,{...r}),editorHeight:this.props.editorHeight,editorWidth:this.props.editorWidth,handleEditorHeightChange:this.props.handleEditorHeightChange,handleEditorWidthChange:this.props.handleEditorWidthChange,handleSideContentHeightChange:this.props.handleSideContentHeightChange,replProps:{output:this.props.output,replValue:this.props.replValue,handleBrowseHistoryDown:this.props.handleBrowseHistoryDown,handleBrowseHistoryUp:this.props.handleBrowseHistoryUp,handleReplEval:this.props.handleReplEval,handleReplValueChange:this.props.handleReplValueChange,sourceChapter:this.props.sourceChapter,sourceVariant:this.props.sourceVariant,externalLibrary:this.props.externalLibraryName,replButtons:[n,s]},sideContentHeight:this.props.sideContentHeight,sideContentProps:{handleActiveTabChange:this.props.handleActiveTabChange,selectedTabId:this.props.sideContentActiveTab,tabs:[{label:"Sourcecast Table",iconName:Y.a.COMPASS,body:Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{className:"Multi-line",children:Object(a.jsx)(K.I,{children:this.props.title?"Title: "+this.props.title+"\nDescription: "+this.props.description:Hh})}),Object(a.jsx)(id,{handleSetSourcecastData:this.props.handleSetSourcecastData,sourcecastIndex:this.props.sourcecastIndex})]}),id:Os.b.introduction,toSpawn:()=>!0},Vh,qh,Xh],workspaceLocation:"sourcecast"}},c={handleEditorValueChange:this.props.handleEditorValueChange,handlePromptAutocomplete:this.props.handlePromptAutocomplete,handleSetCurrentPlayerTime:this.props.handleSetCurrentPlayerTime,handleSetCodeDeltasToApply:this.props.handleSetCodeDeltasToApply,handleSetEditorReadonly:this.props.handleSetEditorReadonly,handleSetInputToApply:this.props.handleSetInputToApply,handleSetSourcecastDuration:this.props.handleSetSourcecastDuration,handleSetSourcecastStatus:this.props.handleSetSourcecastStatus,audioUrl:this.props.audioUrl,currentPlayerTime:this.props.currentPlayerTime,duration:this.props.playbackDuration,playbackData:this.props.playbackData,playbackStatus:this.props.playbackStatus,handleChapterSelect:this.props.handleChapterSelect,handleExternalSelect:this.props.handleExternalSelect};return Object(a.jsxs)("div",{className:mt()("Sourcecast",it.a.DARK),children:[Object(a.jsx)(Wc,{...c}),Object(a.jsx)(oa,{...o})]})}handleQueryParam(){const e=this.props.match.params.sourcecastId;if(e&&e!==this.props.uid&&this.props.sourcecastIndex){const t=this.props.sourcecastIndex.find((t=>t.uid===e));t&&this.props.handleSetSourcecastData(t.title,t.description,t.uid,t.url,JSON.parse(t.playbackData))}}}const Hh="Welcome to Sourcecast!",Vh={label:"Data Visualizer",iconName:Y.a.EYE_OPEN,body:Object(a.jsx)(Xc,{}),id:Os.b.dataVisualiser,toSpawn:()=>!0},qh={label:"Inspector",iconName:Y.a.SEARCH,body:Object(a.jsx)(Hc,{}),id:Os.b.inspector,toSpawn:()=>!0},Xh={label:"Env Visualizer",iconName:Y.a.GLOBE,body:Object(a.jsx)(Uc,{}),id:Os.b.envVisualiser,toSpawn:()=>!0};var $h=Fh;const Wh="sourcecast";var zh=Object(l.h)(Object(d.c)((e=>({audioUrl:e.workspaces.sourcecast.audioUrl,currentPlayerTime:e.workspaces.sourcecast.currentPlayerTime,codeDeltasToApply:e.workspaces.sourcecast.codeDeltasToApply,title:e.workspaces.sourcecast.title,description:e.workspaces.sourcecast.description,editorReadonly:e.workspaces.sourcecast.editorReadonly,editorWidth:e.workspaces.sourcecast.editorWidth,editorValue:e.workspaces.sourcecast.editorValue,externalLibraryName:e.workspaces.sourcecast.externalLibrary,isEditorAutorun:e.workspaces.sourcecast.isEditorAutorun,inputToApply:e.workspaces.sourcecast.inputToApply,breakpoints:e.workspaces.sourcecast.breakpoints,highlightedLines:e.workspaces.sourcecast.highlightedLines,isRunning:e.workspaces.sourcecast.isRunning,isDebugging:e.workspaces.sourcecast.isDebugging,enableDebugging:e.workspaces.sourcecast.enableDebugging,newCursorPosition:e.workspaces.sourcecast.newCursorPosition,output:e.workspaces.sourcecast.output,playbackDuration:e.workspaces.sourcecast.playbackDuration,playbackData:e.workspaces.sourcecast.playbackData,playbackStatus:e.workspaces.sourcecast.playbackStatus,replValue:e.workspaces.sourcecast.replValue,sideContentActiveTab:e.workspaces.sourcecast.sideContentActiveTab,sideContentHeight:e.workspaces.sourcecast.sideContentHeight,sourcecastIndex:e.workspaces.sourcecast.sourcecastIndex,sourceChapter:e.workspaces.sourcecast.context.chapter,sourceVariant:e.workspaces.sourcecast.context.variant,uid:e.workspaces.sourcecast.uid})),(e=>Object(u.b)({handleActiveTabChange:e=>Object(pt.updateActiveTab)(e,Wh),handleBrowseHistoryDown:()=>Object(pt.browseReplHistoryDown)(Wh),handleBrowseHistoryUp:()=>Object(pt.browseReplHistoryUp)(Wh),handleChapterSelect:e=>Object(pt.chapterSelect)(e,"default",Wh),handleDeclarationNavigate:e=>Object(pt.navigateToDeclaration)(Wh,e),handleEditorEval:()=>Object(pt.evalEditor)(Wh),handleEditorValueChange:e=>Object(pt.updateEditorValue)(e,Wh),handleEditorHeightChange:e=>Object(pt.changeEditorHeight)(e,Wh),handleEditorWidthChange:e=>Object(pt.changeEditorWidth)(e.toString(),Wh),handleEditorUpdateBreakpoints:e=>Object(pt.setEditorBreakpoint)(e,Wh),handleExternalSelect:e=>Object(pt.externalLibrarySelect)(e,Wh),handleFetchSourcecastIndex:()=>Object(Mc.fetchSourcecastIndex)(Wh),handleInterruptEval:()=>Object(ht.beginInterruptExecution)(Wh),handleReplEval:()=>Object(pt.evalRepl)(Wh),handleReplOutputClear:()=>Object(pt.clearReplOutput)(Wh),handleReplValueChange:e=>Object(pt.updateReplValue)(e,Wh),handleSetCurrentPlayerTime:e=>Object(Lc.setCurrentPlayerTime)(e,Wh),handleSetCodeDeltasToApply:e=>Object(Lc.setCodeDeltasToApply)(e,Wh),handleSetEditorReadonly:e=>Object(pt.setEditorReadonly)(Wh,e),handleSetInputToApply:e=>Object(Lc.setInputToApply)(e,Wh),handleSetSourcecastData:(e,t,s,a,n)=>Object(Lc.setSourcecastData)(e,t,s,a,n,Wh),handleSetSourcecastDuration:e=>Object(Lc.setSourcecastDuration)(e,Wh),handleSetSourcecastStatus:e=>Object(Lc.setSourcecastStatus)(e,Wh),handleSideContentHeightChange:e=>Object(pt.changeSideContentHeight)(e,Wh),handleToggleEditorAutorun:()=>Object(pt.toggleEditorAutorun)(Wh),handleDebuggerPause:()=>Object(ht.beginDebuggerPause)(Wh),handleDebuggerResume:()=>Object(ht.debuggerResume)(Wh),handleDebuggerReset:()=>Object(ht.debuggerReset)(Wh),handlePromptAutocomplete:(e,t,s)=>Object(pt.promptAutocomplete)(Wh,e,t,s)},e)))($h)),Kh=s(192);class Yh extends m.Component{render(){const{item:e}=this.props,t=e.category!==wt.a.Mission||e.maxGrade<=0&&0===e.grade,s=e.maxXp<=0&&0===e.xp,n=Object(a.jsxs)("div",{className:"grade-details",children:[Object(a.jsx)("div",{className:"title",children:"Grade"}),Object(a.jsxs)("div",{className:"value",children:[e.grade," / ",e.maxGrade]}),Object(a.jsx)(K.J,{animate:!1,className:"value-bar"+this.props.parseColour(this.props.getFrac(e.grade,e.maxGrade)),stripes:!1,value:this.props.getFrac(e.grade,e.maxGrade)})]}),i=Object(a.jsxs)("div",{className:"xp-details",children:[Object(a.jsx)("div",{className:"title",children:"XP"}),Object(a.jsxs)("div",{className:"value",children:[e.xp," / ",e.maxXp]}),Object(a.jsx)(K.J,{animate:!1,className:"value-bar"+this.props.parseColour(this.props.getFrac(e.xp,e.maxXp)),stripes:!1,value:this.props.getFrac(e.xp,e.maxXp)})]});return Object(a.jsx)(lt.b,{className:"profile-summary-navlink",target:"_blank",to:`/academy/${ta(e.category)}/${e.id}/0`,activeClassName:"profile-summary-navlink",children:Object(a.jsxs)(K.d,{className:"profile-summary-callout",icon:this.props.renderIcon(e.category),title:e.title,children:[t?"":n,s?"":i]},`${e.title}-${e.id}`)},`${e.title}-${e.id}`)}}var Qh=Yh;class Jh extends m.Component{componentDidMount(){this.props.name&&this.props.role&&!this.props.assessmentOverviews&&this.props.handleAssessmentOverviewFetch()}render(){let e;if(this.props.name&&this.props.role&&this.props.assessmentOverviews){const t=this.props.assessmentOverviews.filter((e=>e.status===wt.b.submitted)).length,s=Object(a.jsx)("div",{className:"profile-header",children:Object(a.jsxs)("div",{className:"profile-username",children:[Object(a.jsx)("div",{className:"name",children:this.props.name}),Object(a.jsx)("div",{className:"role",children:this.props.role})]})});if(0===t)e=Object(a.jsxs)("div",{className:"profile-content",children:[s,Object(a.jsx)("div",{className:"profile-placeholder",children:"There are no closed assessments to render grade and XP of."})]});else{const[t,n,i,r]=this.props.assessmentOverviews.reduce(((e,t)=>t.status===wt.b.submitted?t.category===wt.a.Mission&&t.gradingStatus===wt.d.graded?[e[0]+t.grade/t.maxGrade,e[1]+t.xp,e[2]+1,e[3]+t.maxXp]:[e[0],e[1]+t.xp,e[2],e[3]+t.maxXp]:e),[0,0,0,0]),o=(e,t)=>t<=0||e/t>1?1:e/t,c=e=>e<0?"":e>=.8?" progress-steelblue":e>=.45?" progress-deepskyblue":" progress-skyblue",d=e=>{switch(e){case wt.a.Mission:return Y.a.FLAME;case wt.a.Sidequest:return Y.a.LIGHTBULB;case wt.a.Path:return Y.a.PREDICTIVE_ANALYSIS;case wt.a.Contest:return Y.a.COMPARISON;default:return Y.a.PULSE}},l=this.props.assessmentOverviews.filter((e=>e.status===wt.b.submitted)).map(((e,t)=>Object(a.jsx)(Qh,{item:e,getFrac:o,parseColour:c,renderIcon:d},t)));e=Object(a.jsxs)("div",{className:"profile-content",children:[s,Object(a.jsxs)("div",{className:"profile-progress",children:[Object(a.jsxs)("div",{className:"profile-grade",children:[Object(a.jsx)(K.M,{className:"profile-spinner"+c(o(t,i)),size:144,value:o(t,i)}),Object(a.jsx)("div",{className:"type",children:"Grade"}),Object(a.jsxs)("div",{className:"total-value",children:[t.toFixed(2)," / ",i.toFixed(2)]}),Object(a.jsxs)("div",{className:"percentage",children:[(100*o(t,i)).toFixed(2),"%"]})]}),Object(a.jsxs)("div",{className:"profile-xp",children:[Object(a.jsx)(K.M,{className:"profile-spinner"+c(o(n,r)),size:144,value:o(n,r)}),Object(a.jsx)("div",{className:"type",children:"XP"}),Object(a.jsxs)("div",{className:"total-value",children:[n," / ",r]}),Object(a.jsxs)("div",{className:"percentage",children:[(100*o(n,r)).toFixed(2),"%"]})]})]}),Object(a.jsx)("div",{className:"profile-callouts",children:l})]})}}else e=Object(a.jsx)(K.D,{description:"Loading...",icon:Object(a.jsx)(K.M,{})});return Object(a.jsx)(K.i,{className:"profile",icon:Y.a.USER,isCloseButtonShown:!0,isOpen:this.props.isOpen,onClose:this.props.onClose,title:"User Profile",position:"left",size:"30%",children:e})}}var Zh=Jh;var ep=Object(d.c)((e=>({assessmentOverviews:e.session.assessmentOverviews,name:e.session.name,role:e.session.role})),(e=>Object(u.b)({handleAssessmentOverviewFetch:st.fetchAssessmentOverviews},e)))(Zh);var tp=e=>Object(a.jsx)(K.g,{className:"about",icon:Y.a.HELP,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"About",children:Object(a.jsx)("div",{className:it.a.DIALOG_BODY,children:Object(a.jsxs)("div",{className:"abt",children:[Object(a.jsxs)("p",{children:["The ",Object(a.jsx)("i",{children:"Source Academy"})," is a computer-mediated learning environment for studying the structure and interpretation of computer programs. Students write and run their programs in their web browser, using sublanguages of JavaScript called"," ",Object(a.jsx)("a",{href:y.a.sourceDocs,children:"Source"}),", designed for the textbook"," ",Object(a.jsx)("a",{href:y.a.textbook,children:"Structure and Interpretation of Computer Programs, JavaScript Adaptation"}),"."]}),Object(a.jsxs)("p",{children:["The Source Academy is available under the Apache License 2.0 at our GitHub organisation,"," ",Object(a.jsx)("a",{href:y.a.githubOrg,children:"Source Academy"}),". The National University of Singapore uses the Source Academy for teaching Programming Methodology to freshmen Computer Science students in the course ",Object(a.jsx)("a",{href:y.a.moduleDetails,children:"CS1101S"}),"."]})]})})});var sp=e=>Object(a.jsx)(K.g,{className:"help",icon:Y.a.ERROR,isCloseButtonShown:!0,isOpen:e.isOpen,onClose:e.onClose,title:"Help",children:Object(a.jsxs)("div",{className:it.a.DIALOG_BODY,children:[Object(a.jsx)("p",{children:"Please use the following resources when you encounter issues with this system."}),Object(a.jsxs)("p",{children:["As of August 2020, we recommend the browsers ",Object(a.jsx)("b",{children:"Google Chrome"})," or ",Object(a.jsx)("b",{children:"Microsoft Edge"}),", Version 83 or higher, or ",Object(a.jsx)("b",{children:"Mozilla Firefox"}),", Version 78 or higher, to visit the Source Academy. If you encounter issues with the Source Academy using these browsers, please use the following resources."]}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{children:["For critical technical issues that seriously affect your learning experience, email the Technical Services of the NUS School of Computing at"," ",Object(a.jsx)("a",{href:y.a.techSVC,children:new URL(y.a.techSVC).pathname})," or call"," ",y.a.techSVCNumber,"."]}),Object(a.jsxs)("li",{children:["For non-critical technical issues, such as enhancement suggestions, please use the issue system of the ",Object(a.jsx)("a",{href:y.a.githubIssues,children:"Source Academy repositories on GitHub"}),"."]}),Object(a.jsxs)("li",{children:["For issues related to the content of missions, quests, paths and contests, use the respective forum at ",Object(a.jsx)("a",{href:y.a.piazza,children:"Piazza"}),", or approach your Avenger, Reflection instructor or lecturer."]})]})]})});class ap extends m.Component{constructor(e){super(e),this.toggleAboutOpen=()=>{this.setState({...this.state,isAboutOpen:!this.state.isAboutOpen})},this.toggleHelpOpen=()=>this.setState({...this.state,isHelpOpen:!this.state.isHelpOpen}),this.toggleProfileOpen=()=>this.setState({...this.state,isProfileOpen:!this.state.isProfileOpen}),this.state={isAboutOpen:!1,isHelpOpen:!1,isProfileOpen:!1}}render(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Ds.a,{content:this.menu(this.props),inheritDarkTheme:!1,placement:rt.a.BOTTOM,children:It("",Y.a.CARET_DOWN)}),Object(a.jsx)(tp,{isOpen:this.state.isAboutOpen,onClose:this.toggleAboutOpen}),Object(a.jsx)(sp,{isOpen:this.state.isHelpOpen,onClose:this.toggleHelpOpen}),this.props.name?Object(a.jsx)(ep,{isOpen:this.state.isProfileOpen,onClose:this.toggleProfileOpen}):null]})}menu(e){const t=this.props.name?Object(a.jsx)(K.y,{icon:Y.a.USER,onClick:this.toggleProfileOpen,text:np(this.props.name)}):null,s=this.props.name?Object(a.jsx)(K.y,{icon:Y.a.LOG_OUT,text:"Logout",onClick:this.props.handleLogOut}):null;return Object(a.jsxs)(K.w,{children:[t,Object(a.jsx)(K.y,{icon:Y.a.HELP,onClick:this.toggleAboutOpen,text:"About"}),Object(a.jsx)(K.y,{icon:Y.a.ERROR,onClick:this.toggleHelpOpen,text:"Help"}),s]})}}const np=e=>e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()));var ip=ap;var rp=e=>Object(a.jsxs)(K.z,{className:"NavigationBar secondary-navbar",children:[Object(a.jsxs)(K.B,{align:Kh.a.LEFT,children:[Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Mission)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.FLAME}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Missions"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Mission),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Sidequest)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.LIGHTBULB}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Quests"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Sidequest),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Path)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.PREDICTIVE_ANALYSIS}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Paths"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Path),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Contest)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.COMPARISON}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Contests"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Contest),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Practical)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.MANUAL}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Others"})]})]}),e.role===j.a.Admin||e.role===j.a.Staff?Object(a.jsxs)(K.B,{align:Kh.a.RIGHT,children:[Object(a.jsxs)(lt.b,{to:"/academy/groundcontrol",activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:"satellite"}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Ground Control"})]}),Object(a.jsxs)(lt.b,{to:"/academy/dashboard",activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:"globe"}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Dashboard"})]}),Object(a.jsxs)(lt.b,{to:"/academy/sourcereel",activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.MOBILE_VIDEO}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Sourcereel"})]}),Object(a.jsxs)(lt.b,{to:"/academy/grading",activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.ENDORSED}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm",children:"Grading"}),Object(a.jsx)(Sa,{notificationFilter:Oa("Grading"),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:"/academy/storysimulator",activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),children:[Object(a.jsx)(K.u,{icon:Y.a.CROWN}),Object(a.jsx)("div",{className:"navbar-button-text hidden-xs hidden-sm hidden-md",children:"Story Simulator"})]})]}):null]});var op=e=>Object(a.jsxs)(K.i,{isOpen:e.isOpen,position:"left",onClose:e.onClose,title:"",className:it.a.DARK,children:[e.role&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Mission)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.FLAME}),Object(a.jsx)("div",{children:"Missions"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Mission),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Sidequest)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.LIGHTBULB}),Object(a.jsx)("div",{children:"Quests"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Sidequest),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Path)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.PREDICTIVE_ANALYSIS}),Object(a.jsx)("div",{children:"Paths"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Path),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Contest)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.COMPARISON}),Object(a.jsx)("div",{children:"Contests"}),Object(a.jsx)(Sa,{notificationFilter:Oa(wt.a.Contest),disableHover:!0})]}),Object(a.jsxs)(lt.b,{to:`/academy/${ta(wt.a.Practical)}`,activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.MANUAL}),Object(a.jsx)("div",{children:"Others"})]})]}),Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),to:"/sourcecast",onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.MUSIC}),Object(a.jsx)("div",{children:"Sourcecast"})]}),Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),to:"/playground",onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.CODE}),Object(a.jsx)("div",{children:"Playground"})]}),e.role&&Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL,it.a.LARGE),to:"/achievement",onClick:e.onClose,children:[Object(a.jsx)(K.u,{icon:Y.a.MOUNTAIN}),Object(a.jsx)("div",{children:"Achievement"})]})]});var cp=e=>{const[t,s]=m.useState(!1),[n,i]=m.useState(!0),r=Object(ct.useMediaQuery)({maxWidth:768});Ft.a.onlyShowFocusOnTabs();const o=Object(a.jsx)(K.B,{align:Kh.a.LEFT,children:Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link__mobile",it.a.BUTTON,it.a.MINIMAL),to:"/playground",children:[Object(a.jsx)(K.u,{icon:Y.a.CODE}),Object(a.jsx)("div",{children:"Source Academy Playground"})]})}),c=Object(a.jsxs)(K.B,{align:Kh.a.LEFT,children:[Object(a.jsx)(K.b,{onClick:()=>s(!t),icon:Y.a.MENU,large:!0,minimal:!0}),Object(a.jsxs)(lt.b,{className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),to:"/academy",children:[Object(a.jsx)(K.u,{icon:Y.a.SYMBOL_DIAMOND}),Object(a.jsx)(K.C,{style:{paddingBottom:"0px"},children:"Source Academy"})]}),Object(a.jsx)(op,{role:e.role,isOpen:t,onClose:()=>s(!1)})]}),d=Object(a.jsxs)(K.B,{align:Kh.a.LEFT,children:[Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),to:"/academy",children:[Object(a.jsx)(K.u,{icon:Y.a.SYMBOL_DIAMOND}),Object(a.jsx)(K.C,{style:{paddingBottom:"0px"},children:"Source Academy"})]}),Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),to:"/sourcecast",children:[Object(a.jsx)(K.u,{icon:Y.a.MUSIC}),Object(a.jsx)("div",{className:"navbar-button-text",children:"Sourcecast"})]}),Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),to:"/playground",children:[Object(a.jsx)(K.u,{icon:Y.a.CODE}),Object(a.jsx)("div",{className:"navbar-button-text",children:"Playground"})]}),e.role&&Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),to:"/achievement",children:[Object(a.jsx)(K.u,{icon:Y.a.MOUNTAIN}),Object(a.jsx)("div",{className:"navbar-button-text",children:"Achievement"})]})]}),l=Object(a.jsxs)(K.B,{align:Kh.a.RIGHT,children:[Object(a.jsxs)(lt.b,{activeClassName:it.a.ACTIVE,className:mt()("NavigationBar__link",it.a.BUTTON,it.a.MINIMAL),to:"/contributors",children:[Object(a.jsx)(K.u,{icon:Y.a.HEART}),Object(a.jsx)("div",{className:"navbar-button-text hidden-sm hidden-xs",children:"Contributors"})]}),!y.b.playgroundOnly&&e.role&&!r&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(K.A,{className:"default-divider"}),Object(a.jsx)(ot.a,{content:"Toggle Menu",placement:rt.a.BOTTOM,children:Object(a.jsx)(K.b,{onClick:()=>i(!n),icon:Y.a.COMPASS,minimal:!0,style:{outline:"none"}})})]}),Object(a.jsx)("div",{className:"visible-xs",children:Object(a.jsx)(K.A,{className:"thin-divider"})}),Object(a.jsx)("div",{className:"hidden-xs",children:Object(a.jsx)(K.A,{className:"default-divider"})}),Object(a.jsx)(ip,{handleLogOut:e.handleLogOut,name:e.name})]});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(K.z,{className:mt()("NavigationBar","primary-navbar",it.a.DARK),children:[y.b.playgroundOnly?o:r?c:d,l]}),!y.b.playgroundOnly&&e.role&&!r&&n&&Object(a.jsx)(rp,{role:e.role})]})};const dp=()=>Object(a.jsx)(l.b,{to:"/playground"}),lp=()=>Object(a.jsx)(l.b,{to:"/academy"}),up=()=>Object(a.jsx)(l.b,{to:"/login"}),hp=({role:e})=>void 0===e?up:()=>Object(a.jsx)(xl,{role:e}),pp=({role:e})=>void 0===e?up:()=>Object(a.jsx)(tt,{}),gp=e=>()=>{const t=Nh(e.location.search);return Object(a.jsx)(Dl,{code:t.code,providerId:t.provider,providers:[...y.b.authProviders.entries()].map((([e,{name:t}])=>({id:e,name:t})))})},mp=()=>Object(a.jsx)(Hu,{});function bp(){const e=g()();for(const{start:t,end:s,reason:a}of y.b.disablePeriods)if(t.isBefore(e)&&s.isAfter(e))return a||!0;return!1}var jp=e=>{const t=m.useRef(void 0),[s,n]=m.useState(bp()),i=/iPhone|iPad|Android/.test(navigator.userAgent),r=window.matchMedia("(display-mode: standalone)").matches,o=m.useRef({height:0,width:0});m.useEffect((()=>(y.b.disablePeriods.length>0&&(t.current=window.setInterval((()=>{const e=bp();s!==e&&n(e)}),5e3)),()=>{t.current&&window.clearInterval(t.current)})),[s]),m.useEffect((()=>{const e=()=>{window.innerHeight<o.current.height&&window.innerWidth===o.current.width||document.documentElement.style.setProperty("--application-height",window.innerHeight+"px"),o.current={height:window.innerHeight,width:window.innerWidth}};return!r&&i&&(e(),window.addEventListener("resize",e)),()=>{!r&&i&&window.removeEventListener("resize",e)}}),[r,i]);const c=Object(a.jsx)(l.c,{path:"/login",render:gp(e)},"login"),d=y.b.playgroundOnly?null:[Object(a.jsx)(l.c,{path:"/academy",render:hp(e)},0),Object(a.jsx)(l.c,{path:"/mission-control/:assessmentId(-?\\d+)?/:questionId(\\d+)?",render:mp},1),Object(a.jsx)(l.c,{path:"/achievement",render:pp(e)},2),c],u=!["staff","admin"].includes(e.role)&&s;return Object(a.jsxs)("div",{className:"Application",children:[Object(a.jsx)(cp,{handleLogOut:e.handleLogOut,role:e.role,name:e.name,title:e.title}),Object(a.jsxs)("div",{className:"Application__main",children:[u&&Object(a.jsxs)(l.e,{children:[!y.b.playgroundOnly&&c,e.role||y.b.playgroundOnly?[]:[Object(a.jsx)(l.c,{path:"/academy",render:up},0),Object(a.jsx)(l.c,{exact:!0,path:"/",render:up},1)],Object(a.jsx)(l.c,{render:()=>Object(a.jsx)(Nl,{reason:"string"===typeof s?s:void 0})})]}),!u&&Object(a.jsxs)(l.e,{children:[Object(a.jsx)(l.c,{path:"/playground",component:Uh}),Object(a.jsx)(l.c,{path:"/contributors",component:kl}),Object(a.jsx)(l.c,{path:"/sourcecast/:sourcecastId?",component:zh}),Object(a.jsx)(l.c,{path:"/callback/github",component:Rl}),d,Object(a.jsx)(l.c,{exact:!0,path:"/",render:y.b.playgroundOnly?dp:lp}),Object(a.jsx)(l.c,{component:Vu})]})]})]})};var yp=Object(l.h)(Object(d.c)((e=>({title:e.application.title,role:e.session.role,name:e.session.name})),(e=>Object(u.b)({handleLogOut:h.logOut},e)))(jp));const Op=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function vp(e,t){navigator.serviceWorker.register(e).then((e=>{setInterval((()=>{try{e.update()}catch{}}),3e5),e.onupdatefound=()=>{const s=e.installing;null!=s&&(s.onstatechange=()=>{"installed"===s.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}if(y.b.sentryDsn){n.a({dsn:y.b.sentryDsn,environment:y.b.sourceAcademyEnvironment,release:`cadet-frontend@${y.b.sourceAcademyVersion}`});const e=sh.a.getState().session.userId;i.b("undefined"!==typeof e?{id:e.toString()}:null)}const xp=document.getElementById("root");if(window.__REDUX_STORE__=sh.a,console.log(`%cSource Academy ${y.b.sourceAcademyEnvironment}-${y.b.sourceAcademyVersion}; Please visit ${y.a.githubIssues} to report bugs or issues.`,"font-weight: bold;"),Object(o.setModulesStaticURL)(y.b.moduleBackendUrl),console.log(`Using module backend: ${y.b.moduleBackendUrl}`),Object(c.render)(Object(a.jsx)(d.a,{store:sh.a,children:Object(a.jsx)(r.a,{history:ea.a,children:Object(a.jsx)(yp,{})})}),xp),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/service-worker.js";Op?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((s=>{const a=s.headers.get("content-type");404===s.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):vp(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):vp(t,e)}))}}({onUpdate:()=>{Object(f.e)("A new version of Source Academy is available. Please refresh the browser.",0)}}),y.b.cadetLoggerUrl){const e=()=>function(e){var t;e&&(null===(t=navigator.serviceWorker.controller)||void 0===t||t.postMessage({type:"SYNC_LOGS",accessToken:e}))}(sh.a.getState().session.accessToken);navigator.serviceWorker.ready.then((()=>{setInterval(e,y.b.cadetLoggerInterval)}))}},124:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n}));const a="FETCH_GROUP_GRADING_SUMMARY",n="UPDATE_GROUP_GRADING_SUMMARY"},15:function(e,t,s){"use strict";s.r(t),s.d(t,"browseReplHistoryDown",(function(){return c})),s.d(t,"browseReplHistoryUp",(function(){return d})),s.d(t,"changeExternalLibrary",(function(){return l})),s.d(t,"changeEditorHeight",(function(){return u})),s.d(t,"changeEditorWidth",(function(){return h})),s.d(t,"changeExecTime",(function(){return p})),s.d(t,"changeSideContentHeight",(function(){return g})),s.d(t,"changeStepLimit",(function(){return m})),s.d(t,"chapterSelect",(function(){return b})),s.d(t,"externalLibrarySelect",(function(){return j})),s.d(t,"toggleEditorAutorun",(function(){return y})),s.d(t,"updateActiveTab",(function(){return O})),s.d(t,"beginClearContext",(function(){return v})),s.d(t,"clearReplInput",(function(){return x})),s.d(t,"clearReplOutput",(function(){return f})),s.d(t,"clearReplOutputLast",(function(){return S})),s.d(t,"endClearContext",(function(){return C})),s.d(t,"evalEditor",(function(){return w})),s.d(t,"evalRepl",(function(){return E})),s.d(t,"evalTestcase",(function(){return A})),s.d(t,"updateEditorValue",(function(){return I})),s.d(t,"setEditorBreakpoint",(function(){return T})),s.d(t,"highlightEditorLine",(function(){return k})),s.d(t,"updateReplValue",(function(){return N})),s.d(t,"sendReplInputToOutput",(function(){return P})),s.d(t,"resetTestcase",(function(){return R})),s.d(t,"navigateToDeclaration",(function(){return M})),s.d(t,"moveCursor",(function(){return L})),s.d(t,"resetWorkspace",(function(){return _})),s.d(t,"updateWorkspace",(function(){return D})),s.d(t,"setEditorReadonly",(function(){return G})),s.d(t,"updateCurrentAssessmentId",(function(){return B})),s.d(t,"updateCurrentSubmissionId",(function(){return U})),s.d(t,"updateHasUnsavedChanges",(function(){return F})),s.d(t,"fetchSublanguage",(function(){return H})),s.d(t,"changeSublanguage",(function(){return V})),s.d(t,"updateSublanguage",(function(){return q})),s.d(t,"promptAutocomplete",(function(){return X})),s.d(t,"notifyProgramEvaluated",(function(){return $}));var a=s(9),n=s(111),i=s(47),r=s(23),o=s(24);const c=e=>Object(a.action)(o.b,{workspaceLocation:e}),d=e=>Object(a.action)(o.c,{workspaceLocation:e}),l=(e,t)=>Object(a.action)(o.g,{newExternal:e,workspaceLocation:t}),u=(e,t)=>Object(a.action)(o.d,{height:e,workspaceLocation:t}),h=(e,t)=>Object(a.action)(o.e,{widthChange:e,workspaceLocation:t}),p=(e,t)=>Object(a.action)(o.f,{execTime:e,workspaceLocation:t}),g=(e,t)=>Object(a.action)(o.h,{height:e,workspaceLocation:t}),m=(e,t)=>Object(a.action)(o.i,{stepLimit:e,workspaceLocation:t}),b=(e,t,s)=>Object(a.action)(o.k,{chapter:e,variant:t,workspaceLocation:s}),j=(e,t,s)=>Object(a.action)(o.w,{externalLibraryName:e,workspaceLocation:t,initialise:s||!1}),y=e=>Object(a.action)(o.B,{workspaceLocation:e}),O=(e,t)=>Object(a.action)(o.C,{activeTab:e,workspaceLocation:t}),v=(e,t,s)=>Object(a.action)(o.a,{library:t,workspaceLocation:e,shouldInitLibrary:s}),x=e=>Object(a.action)(o.l,{workspaceLocation:e}),f=e=>Object(a.action)(o.m,{workspaceLocation:e}),S=e=>Object(a.action)(o.n,{workspaceLocation:e}),C=(e,t)=>Object(a.action)(o.o,{library:e,workspaceLocation:t}),w=e=>Object(a.action)(o.p,{workspaceLocation:e}),E=e=>Object(a.action)(o.q,{workspaceLocation:e}),A=(e,t)=>Object(a.action)(o.s,{workspaceLocation:e,testcaseId:t}),I=(e,t)=>Object(a.action)(o.G,{newEditorValue:e,workspaceLocation:t}),T=(e,t)=>Object(a.action)(o.F,{breakpoints:e,workspaceLocation:t}),k=(e,t)=>Object(a.action)(i.l,{highlightedLines:e,workspaceLocation:t}),N=(e,t)=>Object(a.action)(o.I,{newReplValue:e,workspaceLocation:t}),P=(e,t)=>Object(a.action)(o.A,{type:"code",workspaceLocation:t,value:e}),R=(e,t)=>Object(a.action)(o.y,{workspaceLocation:e,index:t}),M=(e,t)=>Object(a.action)(o.v,{workspaceLocation:e,cursorPosition:t}),L=(e,t)=>Object(a.action)(o.u,{workspaceLocation:e,cursorPosition:t}),_=(e,t)=>Object(a.action)(o.z,{workspaceLocation:e,workspaceOptions:t}),D=(e,t)=>Object(a.action)(o.K,{workspaceLocation:e,workspaceOptions:t}),G=(e,t)=>Object(a.action)(n.b,{workspaceLocation:e,editorReadonly:t}),B=(e,t)=>Object(a.action)(o.D,{assessmentId:e,questionId:t}),U=(e,t)=>Object(a.action)(o.E,{submissionId:e,questionId:t}),F=(e,t)=>Object(a.action)(o.H,{workspaceLocation:e,hasUnsavedChanges:t}),H=()=>Object(a.action)(o.t),V=e=>Object(a.action)(o.j,{sublang:e}),q=e=>Object(a.action)(o.J,{sublang:e}),X=(e,t,s,n)=>Object(a.action)(o.x,{workspaceLocation:e,row:t,column:s,callback:n}),$=(e,t,s,n,i)=>Object(a.action)(r.a,{result:e,lastDebuggerResult:t,code:s,context:n,workspaceLocation:i})},151:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var a=s(40),n=s(63),i=s(38);const r={};function o(e){return e.length<=27?e:e.substring(0,24)+"..."}function c(e){return e in a.SourceDocumentation.ext_lib?{caption:o(e),value:e,meta:a.SourceDocumentation.ext_lib[e].meta,docHTML:a.SourceDocumentation.ext_lib[e].description}:{caption:o(e),value:e,meta:"const"}}for(const[u,h]of i.b)r[u]=h.map(c);for(const u of n.h)r[u.deviceLibraryName]=u.internalFunctions.map(c);const d={};Object.entries(a.SourceDocumentation.builtins).forEach((e=>{const[t,s]=e;d[t]=Object.entries(s).map((e=>{const[t,s]=e;return{caption:o(t),value:t,meta:s.meta,docHTML:s.description}}))}));const l={builtins:d,externalLibraries:r}},155:function(e,t,s){"use strict";s.r(t),s.d(t,"changeDateAssessment",(function(){return i})),s.d(t,"deleteAssessment",(function(){return r})),s.d(t,"publishAssessment",(function(){return o})),s.d(t,"uploadAssessment",(function(){return c}));var a=s(9),n=s(117);const i=(e,t,s)=>Object(a.action)(n.a,{id:e,openAt:t,closeAt:s}),r=e=>Object(a.action)(n.b,e),o=(e,t)=>Object(a.action)(n.c,{id:t,togglePublishTo:e}),c=(e,t)=>Object(a.action)(n.d,{file:e,forceUpdate:t})},156:function(e,t,s){"use strict";s.r(t),s.d(t,"persistenceOpenPicker",(function(){return i})),s.d(t,"persistenceSaveFile",(function(){return r})),s.d(t,"persistenceSaveFileAs",(function(){return o})),s.d(t,"persistenceInitialise",(function(){return c}));var a=s(9),n=s(118);const i=()=>Object(a.action)(n.b),r=e=>Object(a.action)(n.c,e),o=()=>Object(a.action)(n.d),c=()=>Object(a.action)(n.a)},16:function(e,t,s){"use strict";s.d(t,"a",(function(){return E}));var a={};s.r(a),s.d(a,"saveCanvas",(function(){return h}));var n={};s.r(n),s.d(n,"remoteExecFetchDevices",(function(){return O})),s.d(n,"remoteExecUpdateDevices",(function(){return v})),s.d(n,"remoteExecUpdateSession",(function(){return x})),s.d(n,"remoteExecConnect",(function(){return f})),s.d(n,"remoteExecDisconnect",(function(){return S})),s.d(n,"remoteExecRun",(function(){return C})),s.d(n,"remoteExecReplInput",(function(){return w}));var i=s(227),r=s(51),o=s(42),c=s(201),d=s(15),l=s(9),u=s(113);const h=e=>Object(l.action)(u.a,e);var p=s(104),g=s(236),m=s(155),b=s(156),j=s(97),y=s(63);const O=()=>Object(l.action)(y.c),v=e=>Object(l.action)(y.f,e),x=e=>Object(l.action)(y.g,e),f=(e,t)=>Object(l.action)(y.a,{workspace:e,device:t}),S=()=>Object(l.action)(y.b),C=e=>Object(l.action)(y.e,e),w=e=>Object(l.action)(y.d,e);const E={...p,...i,...c,...g,...r,...j,...o,...s(172),...s(81),...s(105),...d,...m,...a,...b,...n}},172:function(e,t,s){"use strict";s.r(t),s.d(t,"fetchSourcecastIndex",(function(){return i})),s.d(t,"updateSourcecastIndex",(function(){return r}));var a=s(9),n=s(111);const i=e=>Object(a.action)(n.a,{workspaceLocation:e}),r=(e,t)=>Object(a.action)(n.c,{index:e,workspaceLocation:t})},180:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n}));const a="SET_EDITOR_SESSION_ID",n="SET_SHAREDB_CONNECTED"},19:function(e,t,s){"use strict";s.d(t,"a",(function(){return E}));var a=s(102),n=s.n(a);function i(e){return"string"===typeof e&&"TRUE"===e.toUpperCase()}const r=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_VERSION||"local",o=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_ENVIRONMENT||"dev",c=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_BACKEND_URL,d=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CADET_LOGGER,l=parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_CADET_LOGGER_INTERVAL||"10000",10),u=i(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_USE_BACKEND),h=i(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_USE_ACHIEVEMENT_BACKEND),p=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_URL_SHORTENER_DOMAIN,g=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_URL_SHORTENER_SIGNATURE,m=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_MODULE_BACKEND_URL||"modules",b=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_SHAREDB_BACKEND_URL||"",j=i(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_PLAYGROUND_ONLY),y=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_SENTRY_DSN,O=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GOOGLE_CLIENT_ID,v=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GOOGLE_API_KEY,x=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GOOGLE_APP_ID,f=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GITHUB_CLIENT_ID||"",S=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GITHUB_OAUTH_PROXY_URL||"",C=new Map;for(let I=1;;++I){const e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_OAUTH2_PROVIDER${I}`];if(!e)break;const t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_OAUTH2_PROVIDER${I}_NAME`]||"Unnamed provider",s=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_OAUTH2_PROVIDER${I}_ENDPOINT`]||"";C.set(e,{name:t,endpoint:s,isDefault:1===I})}const w=[];for(let I=1;;++I){const e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_DISABLE${I}_START`],t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_DISABLE${I}_END`];if(!e||!t)break;const s=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0})[`REACT_APP_DISABLE${I}_REASON`],a=n()(e),i=n()(t);i.isBefore(a)||n()().isAfter(i)||w.push({start:a,end:i,reason:s})}let E;!function(e){e.githubIssues="https://github.com/source-academy/cadet-frontend/issues",e.githubOrg="https://github.com/source-academy",e.moduleDetails="https://www.comp.nus.edu.sg/~cs1101s",e.luminus="https://luminus.nus.edu.sg/modules/41d42e9a-5880-43b5-8ee6-75f5a41355e3/announcements/active",e.piazza="https://piazza.com/class/kas136yscf8605",e.sourceAcademyAssets="https://source-academy-assets.s3-ap-southeast-1.amazonaws.com",e.sourceDocs="https://source-academy.github.io/source/",e.techSVC="mailto:techsvc@comp.nus.edu.sg",e.techSVCNumber="6516 2736",e.textbook="https://source-academy.github.io/sicp/",e.textbookChapter2_2="https://source-academy.github.io/sicp/chapters/2.2.html",e.textbookChapter3_2="https://source-academy.github.io/sicp/chapters/3.2.html",e.aceHotkeys="https://github.com/ajaxorg/ace/wiki/Default-Keyboard-Shortcuts",e.sourceHotkeys="https://github.com/source-academy/cadet-frontend/wiki/Source-Academy-Keyboard-Shortcuts",e.source_1="https://source-academy.github.io/source/source_1/",e.source_1_Lazy="https://source-academy.github.io/source/source_1_lazy/",e.source_1_Wasm="https://source-academy.github.io/source/source_1_wasm/",e.source_2="https://source-academy.github.io/source/source_2/",e.source_2_Lazy="https://source-academy.github.io/source/source_2_lazy/",e.source_3="https://source-academy.github.io/source/source_3/",e.source_3_Concurrent="https://source-academy.github.io/source/source_3_concurrent/",e.source_3_Nondet="https://source-academy.github.io/source/source_3_non-det/",e.source_4="https://source-academy.github.io/source/source_4/",e.source_4_Gpu="https://source-academy.github.io/source/source_4_gpu/"}(E||(E={}));const A={sourceAcademyVersion:r,sourceAcademyEnvironment:o,backendUrl:c,cadetLoggerUrl:d,useBackend:u,useAchievementBackend:h,defaultSourceChapter:4,defaultSourceVariant:"default",defaultQuestionId:0,maxBrowseIndex:50,urlShortener:p,urlShortenerSignature:g,moduleBackendUrl:m,authProviders:C,playgroundOnly:j,sentryDsn:y,googleClientId:O,googleApiKey:v,googleAppId:x,githubClientId:f,githubOAuthProxyUrl:S,sharedbBackendUrl:b,disablePeriods:w,cadetLoggerInterval:l};t.b=A},201:function(e,t,s){"use strict";s.r(t),s.d(t,"setEditorSessionId",(function(){return i})),s.d(t,"setSharedbConnected",(function(){return r}));var a=s(9),n=s(180);const i=(e,t)=>Object(a.action)(n.a,{workspaceLocation:e,editorSessionId:t}),r=(e,t)=>Object(a.action)(n.b,{workspaceLocation:e,connected:t})},21:function(e,t,s){"use strict";s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return n})),s.d(t,"e",(function(){return i})),s.d(t,"f",(function(){return r})),s.d(t,"h",(function(){return o})),s.d(t,"i",(function(){return c})),s.d(t,"j",(function(){return d})),s.d(t,"l",(function(){return l})),s.d(t,"m",(function(){return u})),s.d(t,"n",(function(){return h})),s.d(t,"o",(function(){return p})),s.d(t,"p",(function(){return g})),s.d(t,"a",(function(){return m})),s.d(t,"b",(function(){return b})),s.d(t,"g",(function(){return j})),s.d(t,"q",(function(){return y})),s.d(t,"k",(function(){return O}));const a="BULK_UPDATE_ACHIEVEMENTS",n="BULK_UPDATE_GOALS",i="EDIT_ACHIEVEMENT",r="EDIT_GOAL",o="GET_ACHIEVEMENTS",c="GET_GOALS",d="GET_OWN_GOALS",l="REMOVE_ACHIEVEMENT",u="REMOVE_GOAL",h="SAVE_ACHIEVEMENTS",p="SAVE_GOALS",g="UPDATE_GOAL_PROGRESS";let m,b,j;!function(e){e.CORE="Core",e.EFFORT="Effort",e.EXPLORATION="Exploration",e.COMMUNITY="Community",e.FLEX="Flex"}(m||(m={})),function(e){e.ACTIVE="ACTIVE",e.COMPLETED="COMPLETED",e.EXPIRED="EXPIRED"}(b||(b={})),function(e){e.ALL="ALL",e.ACTIVE="ACTIVE",e.COMPLETED="COMPLETED"}(j||(j={}));const y={xp:0,maxXp:0,completed:!1};let O;!function(e){e.ASSESSMENT="Assessment",e.BINARY="Binary",e.MANUAL="Manual"}(O||(O={}))},227:function(e,t,s){"use strict";s.r(t),s.d(t,"logOut",(function(){return i}));var a=s(9),n=s(115);const i=()=>Object(a.action)(n.a)},23:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n}));const a="NOTIFY_PROGRAM_EVALUATED";let n;!function(e){e.autograder="autograder",e.briefing="briefing",e.dataVisualiser="data_visualiser",e.editorGrading="editor_grading",e.editorAutograder="editor_autograder",e.editorBriefing="editor_briefing",e.editorGlobalDeployment="editor_global_deployment",e.editorGlobalGraderDeployment="editor_global_grader_deployment",e.editorLocalDeployment="editor_local_deployment",e.editorLocalGraderDeployment="editor_local_grader_deployment",e.editorManageQuestion="editor_manage_question",e.editorQuestionOverview="editor_question_overview",e.editorQuestionTemplate="editor_question_template",e.envVisualiser="env_visualiser",e.grading="grading",e.introduction="introduction",e.inspector="inspector",e.module="module",e.questionOverview="question_overview",e.remoteExecution="remote_execution",e.mobileEditor="mobile_editor",e.mobileEditorRun="mobile_editor_run",e.sourcereel="sourcereel",e.substVisualizer="subst_visualiser",e.toneMatrix="tone_matrix",e.videoDisplay="video_display"}(n||(n={}))},233:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return c}));var a=s(63),n=s(30),i=s(115),r=s(28);const o=(e=n.j,t)=>{switch(t.type){case i.a:return n.j;case r.q:return{...e,accessToken:t.payload.accessToken,refreshToken:t.payload.refreshToken};case r.r:return{...e,...t.payload};case r.p:return{...e,googleUser:t.payload};case r.o:return{...e,githubOctokitInstance:t.payload};case r.B:const s=e.historyHelper,o=null!=c.exec(t.payload)?[s.lastAcademyLocations[1],t.payload]:[...s.lastAcademyLocations],d=[s.lastGeneralLocations[1],t.payload];return{...e,historyHelper:{lastAcademyLocations:o,lastGeneralLocations:d}};case r.x:const l=new Map(e.assessments);return l.set(t.payload.id,t.payload),{...e,assessments:l};case r.y:return{...e,assessmentOverviews:t.payload};case r.z:const u=new Map(e.gradings);return u.set(t.payload.submissionId,t.payload.grading),{...e,gradings:u};case r.A:return{...e,gradingOverviews:t.payload};case r.C:return{...e,notifications:t.payload};case a.f:return{...e,remoteExecutionDevices:t.payload};case a.g:return{...e,remoteExecutionSession:t.payload};case r.n:return{...e,githubOctokitInstance:void 0};default:return e}},c=new RegExp("^/academy.*","i")},236:function(e,t,s){"use strict";s.r(t),s.d(t,"fetchGroupGradingSummary",(function(){return i})),s.d(t,"updateGroupGradingSummary",(function(){return r}));var a=s(9),n=s(124);const i=()=>Object(a.action)(n.a),r=e=>Object(a.action)(n.b,e)},24:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"d",(function(){return r})),s.d(t,"e",(function(){return o})),s.d(t,"f",(function(){return c})),s.d(t,"g",(function(){return d})),s.d(t,"h",(function(){return l})),s.d(t,"i",(function(){return u})),s.d(t,"k",(function(){return h})),s.d(t,"l",(function(){return p})),s.d(t,"m",(function(){return g})),s.d(t,"n",(function(){return m})),s.d(t,"o",(function(){return b})),s.d(t,"p",(function(){return j})),s.d(t,"q",(function(){return y})),s.d(t,"x",(function(){return O})),s.d(t,"r",(function(){return v})),s.d(t,"s",(function(){return x})),s.d(t,"u",(function(){return f})),s.d(t,"v",(function(){return S})),s.d(t,"w",(function(){return C})),s.d(t,"y",(function(){return w})),s.d(t,"z",(function(){return E})),s.d(t,"A",(function(){return A})),s.d(t,"B",(function(){return I})),s.d(t,"C",(function(){return T})),s.d(t,"D",(function(){return k})),s.d(t,"E",(function(){return N})),s.d(t,"G",(function(){return P})),s.d(t,"F",(function(){return R})),s.d(t,"H",(function(){return M})),s.d(t,"I",(function(){return L})),s.d(t,"K",(function(){return _})),s.d(t,"t",(function(){return D})),s.d(t,"J",(function(){return G})),s.d(t,"j",(function(){return B}));const a="BEGIN_CLEAR_CONTEXT",n="BROWSE_REPL_HISTORY_DOWN",i="BROWSE_REPL_HISTORY_UP",r="CHANGE_EDITOR_HEIGHT",o="CHANGE_EDITOR_WIDTH",c="CHANGE_EXEC_TIME",d="CHANGE_EXTERNAL_LIBRARY",l="CHANGE_SIDE_CONTENT_HEIGHT",u="CHANGE_STEP_LIMIT",h="CHAPTER_SELECT",p="CLEAR_REPL_INPUT",g="CLEAR_REPL_OUTPUT",m="CLEAR_REPL_OUTPUT_LAST",b="END_CLEAR_CONTEXT",j="EVAL_EDITOR",y="EVAL_REPL",O="PROMPT_AUTOCOMPLETE",v="EVAL_SILENT",x="EVAL_TESTCASE",f="MOVE_CURSOR",S="NAV_DECLARATION",C="PLAYGROUND_EXTERNAL_SELECT ",w="RESET_TESTCASE",E="RESET_WORKSPACE",A="SEND_REPL_INPUT_TO_OUTPUT",I="TOGGLE_EDITOR_AUTORUN",T="UPDATE_ACTIVE_TAB",k="UPDATE_CURRENT_ASSESSMENT_ID",N="UPDATE_CURRENT_SUBMISSION_ID",P="UPDATE_EDITOR_VALUE",R="UPDATE_EDITOR_BREAKPOINTS",M="UPDATE_HAS_UNSAVED_CHANGES",L="UPDATE_REPL_VALUE",_="UPDATE_WORKSPACE",D="FETCH_SUBLANGUAGE",G="UPDATE_SUBLANGUAGE",B="CHANGE_SUBLANGUAGE"},26:function(e,t,s){"use strict";s.d(t,"d",(function(){return o})),s.d(t,"e",(function(){return c})),s.d(t,"b",(function(){return d})),s.d(t,"c",(function(){return l})),s.d(t,"a",(function(){return u}));var a=s(1214),n=s(56),i=s(112);const r=a.S.create({position:n.a.TOP}),o=(e,t=2e3,s)=>r.show({intent:i.a.SUCCESS,message:e,timeout:t},s),c=(e,t=2e3,s)=>r.show({intent:i.a.WARNING,message:e,timeout:t},s),d=(e,t=2e3,s)=>r.show({intent:i.a.DANGER,message:e,timeout:t},s),l=(e,t)=>r.show(e,t),u=e=>r.dismiss(e)},28:function(e,t,s){"use strict";s.d(t,"d",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"e",(function(){return r})),s.d(t,"f",(function(){return o})),s.d(t,"h",(function(){return c})),s.d(t,"k",(function(){return d})),s.d(t,"i",(function(){return l})),s.d(t,"j",(function(){return u})),s.d(t,"q",(function(){return h})),s.d(t,"r",(function(){return p})),s.d(t,"p",(function(){return g})),s.d(t,"o",(function(){return m})),s.d(t,"s",(function(){return b})),s.d(t,"t",(function(){return j})),s.d(t,"u",(function(){return y})),s.d(t,"v",(function(){return O})),s.d(t,"m",(function(){return v})),s.d(t,"l",(function(){return x})),s.d(t,"n",(function(){return f})),s.d(t,"w",(function(){return S})),s.d(t,"B",(function(){return C})),s.d(t,"y",(function(){return w})),s.d(t,"x",(function(){return E})),s.d(t,"A",(function(){return A})),s.d(t,"z",(function(){return I})),s.d(t,"g",(function(){return T})),s.d(t,"a",(function(){return k})),s.d(t,"C",(function(){return N}));const a="FETCH_AUTH",n="FETCH_ASSESSMENT",i="FETCH_ASSESSMENT_OVERVIEWS",r="FETCH_GRADING",o="FETCH_GRADING_OVERVIEWS",c="LOGIN",d="LOGOUT_GOOGLE",l="LOGIN_GITHUB",u="LOGOUT_GITHUB",h="SET_TOKENS",p="SET_USER",g="SET_GOOGLE_USER",m="SET_GITHUB_OCTOKIT_INSTANCE",b="SUBMIT_ANSWER",j="SUBMIT_ASSESSMENT",y="SUBMIT_GRADING",O="SUBMIT_GRADING_AND_CONTINUE",v="REAUTOGRADE_SUBMISSION",x="REAUTOGRADE_ANSWER",f="REMOVE_GITHUB_OCTOKIT_INSTANCE",S="UNSUBMIT_SUBMISSION",C="UPDATE_HISTORY_HELPERS",w="UPDATE_ASSESSMENT_OVERVIEWS",E="UPDATE_ASSESSMENT",A="UPDATE_GRADING_OVERVIEWS",I="UPDATE_GRADING",T="FETCH_NOTIFICATIONS",k="ACKNOWLEDGE_NOTIFICATIONS",N="UPDATE_NOTIFICATIONS"},29:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return c}));var a=s(88),n=s(3);function i(e){a.a(e),console.error(e)}function r(e){return e&&"function"===typeof e.next&&"function"===typeof e.throw}function o(e,t,...s){return Object(n.h)(e,(function*(...e){try{const s=t(...e);r(s)&&(yield*s)}catch(s){i(s)}}),...s)}function c(e,t,...s){return Object(n.i)(e,(function*(...e){try{const s=t(...e);r(s)&&(yield*s)}catch(s){i(s)}}),...s)}},30:function(e,t,s){"use strict";s.d(t,"a",(function(){return d})),s.d(t,"n",(function(){return u})),s.d(t,"m",(function(){return h})),s.d(t,"h",(function(){return p})),s.d(t,"o",(function(){return g})),s.d(t,"c",(function(){return m})),s.d(t,"e",(function(){return b})),s.d(t,"f",(function(){return j})),s.d(t,"d",(function(){return y})),s.d(t,"i",(function(){return O})),s.d(t,"g",(function(){return v})),s.d(t,"b",(function(){return x})),s.d(t,"l",(function(){return f})),s.d(t,"j",(function(){return S})),s.d(t,"k",(function(){return C}));var a=s(33),n=s(23),i=s(19),r=s(73),o=s(38);let c,d;!function(e){e.Development="development",e.Production="production",e.Test="test"}(c||(c={})),function(e){e.Student="student",e.Staff="staff",e.Admin="admin"}(d||(d={}));const l=new Map([["wasm","WebAssembly"],["non-det","Non-Det"],["concurrent","Concurrent"],["lazy","Lazy"],["gpu","GPU"]]),u=(e,t="default")=>`Source \xa7${e}${l.has(t)?` ${l.get(t)}`:""}`,h=[{chapter:1,variant:"default"},{chapter:1,variant:"wasm"},{chapter:1,variant:"lazy"},{chapter:2,variant:"default"},{chapter:2,variant:"lazy"},{chapter:3,variant:"default"},{chapter:3,variant:"concurrent"},{chapter:3,variant:"non-det"},{chapter:4,variant:"default"},{chapter:4,variant:"gpu"}].map((e=>({...e,displayName:u(e.chapter,e.variant)}))),p=h.filter((e=>"default"===e.variant)),g=h.filter((e=>"default"!==e.variant)),m={gameCanvas:void 0},b={title:"Cadet",environment:c.Production},j={gradingSummary:[]},y={achievements:[],goals:[]},O={usingSubst:!1},v="// Type your program in here!",x=e=>({autogradingResults:[],breakpoints:[],context:Object(r.a)(i.b.defaultSourceChapter,[],e,i.b.defaultSourceVariant),editorPrepend:"",editorSessionId:"",editorValue:v,editorPostpend:"",editorReadonly:!1,editorTestcases:[],editorHeight:150,editorWidth:"50%",externalLibrary:o.a.NONE,execTime:1e3,highlightedLines:[],output:[],replHistory:{browseIndex:null,records:[],originalValue:""},replValue:"",sharedbConnected:!1,sideContentActiveTab:n.b.questionOverview,stepLimit:1e3,globals:[],isEditorAutorun:!1,isRunning:!1,isDebugging:!1,enableDebugging:!0,debuggerContext:{}}),f={assessment:{...x("assessment"),currentAssessment:void 0,currentQuestion:void 0,hasUnsavedChanges:!1},grading:{...x("grading"),currentSubmission:void 0,currentQuestion:void 0,hasUnsavedChanges:!1},playground:{...x("playground"),usingSubst:!1},sourcecast:{...x("sourcecast"),audioUrl:"",codeDeltasToApply:null,currentPlayerTime:0,description:null,inputToApply:null,playbackData:{init:{editorValue:"",chapter:1,externalLibrary:o.a.NONE},inputs:[]},playbackDuration:0,playbackStatus:a.b.paused,sourcecastIndex:null,title:null,uid:null},sourcereel:{...x("sourcereel"),playbackData:{init:{editorValue:"",chapter:1,externalLibrary:o.a.NONE},inputs:[]},recordingStatus:a.c.notStarted,timeElapsedBeforePause:0,timeResumed:0}},S={accessToken:void 0,assessments:new Map,assessmentOverviews:void 0,grade:0,gradingOverviews:void 0,gradings:new Map,group:null,historyHelper:{lastAcademyLocations:[null,null],lastGeneralLocations:[null,null]},maxGrade:0,maxXp:0,refreshToken:void 0,role:void 0,name:void 0,story:{story:"",playStory:!1},gameState:{completed_quests:[],collectibles:{}},xp:0,notifications:[]},C={academy:m,achievement:y,application:b,dashboard:j,playground:O,session:S,workspaces:f}},32:function(e,t,s){"use strict";s.d(t,"B",(function(){return h})),s.d(t,"w",(function(){return p})),s.d(t,"k",(function(){return g})),s.d(t,"o",(function(){return m})),s.d(t,"t",(function(){return b})),s.d(t,"a",(function(){return j})),s.d(t,"b",(function(){return y})),s.d(t,"g",(function(){return O})),s.d(t,"i",(function(){return v})),s.d(t,"N",(function(){return x})),s.d(t,"K",(function(){return f})),s.d(t,"L",(function(){return S})),s.d(t,"m",(function(){return C})),s.d(t,"l",(function(){return w})),s.d(t,"z",(function(){return E})),s.d(t,"A",(function(){return A})),s.d(t,"q",(function(){return I})),s.d(t,"p",(function(){return T})),s.d(t,"C",(function(){return k})),s.d(t,"E",(function(){return N})),s.d(t,"D",(function(){return P})),s.d(t,"H",(function(){return R})),s.d(t,"s",(function(){return M})),s.d(t,"y",(function(){return L})),s.d(t,"f",(function(){return _})),s.d(t,"u",(function(){return D})),s.d(t,"F",(function(){return G})),s.d(t,"c",(function(){return B})),s.d(t,"d",(function(){return U})),s.d(t,"I",(function(){return F})),s.d(t,"O",(function(){return H})),s.d(t,"r",(function(){return V})),s.d(t,"v",(function(){return q})),s.d(t,"G",(function(){return X})),s.d(t,"j",(function(){return $})),s.d(t,"n",(function(){return W})),s.d(t,"J",(function(){return z})),s.d(t,"h",(function(){return K})),s.d(t,"e",(function(){return Y})),s.d(t,"M",(function(){return J})),s.d(t,"x",(function(){return Z}));var a=s(3),n=s(30),i=s(8),r=s(86),o=s(21);const c=e=>({maxXp:e.meta.type===o.k.ASSESSMENT?0:e.meta.maxXp,meta:e.meta,text:e.text,type:e.meta.type,uuid:e.uuid});var d=s(16);var l=s(19),u=s(26);const h=async(e,t,s,a)=>{const n=await J("auth","POST",{body:{code:e,provider:t,...s?{client_id:s}:{},...a?{redirect_uri:a}:{}},errorMessage:"Could not login. Please contact the module administrator."});if(!n)return null;const i=await n.json();return{accessToken:i.access_token,refreshToken:i.refresh_token}},p=async e=>{const t=await J("user","GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():null},g=async e=>{const t=await J("achievements","GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>({uuid:e.uuid||"",title:e.title||"",ability:e.ability,deadline:e.deadline&&new Date(e.deadline),release:e.release&&new Date(e.release),isTask:e.isTask,position:e.position,prerequisiteUuids:e.prerequisiteUuids,goalUuids:e.goalUuids,cardBackground:e.cardBackground||"",view:{coverImage:e.view.coverImage||"",completionText:e.view.completionText||"",description:e.view.description||""}})))},m=async(e,t)=>{const s=await J(`achievements/goals/${t}`,"GET",{...e,shouldRefresh:!0});if(!s||!s.ok)return null;return(await s.json()).map((e=>({uuid:e.uuid||"",text:e.text||"",meta:e.meta,xp:e.xp,maxXp:e.maxXp,completed:e.completed})))},b=async e=>{const t=await J("self/goals","GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>({uuid:e.uuid||"",text:e.text||"",meta:e.meta,xp:e.xp,maxXp:e.maxXp,completed:e.completed})))};async function j(e,t){return await J("admin/achievements","PUT",{accessToken:t.accessToken,body:{achievements:e},noHeaderAccept:!0,refreshToken:t.refreshToken,shouldAutoLogout:!1,shouldRefresh:!0})}async function y(e,t){return await J("admin/goals","PUT",{accessToken:t.accessToken,body:{goals:e.map((e=>c(e)))},noHeaderAccept:!0,refreshToken:t.refreshToken,shouldAutoLogout:!1,shouldRefresh:!0})}const O=async(e,t)=>await J(`achievements/${e.uuid}`,"POST",{...t,body:{achievement:e},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),v=async(e,t)=>await J(`achievements/goals/${e.uuid}`,"POST",{...t,body:{definition:c(e)},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),x=async(e,t,s)=>await J(`achievements/goals/${t.uuid}/${e}`,"POST",{...s,body:{progress:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),f=async(e,t)=>await J(`admin/achievements/${e}`,"DELETE",{...t,body:{uuid:e},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),S=async(e,t)=>await J(`admin/goals/${e}`,"DELETE",{...t,body:{uuid:e},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),C=async e=>{const t=await J("assessments","GET",{...e,shouldRefresh:!0});if(!t||!t.ok)return null;return(await t.json()).map((e=>(e.category=ee(e.type),delete e.type,e.gradingStatus=te(e.category,e.status,e.gradedCount,e.questionCount),delete e.gradedCount,delete e.questionCount,e)))},w=async(e,t)=>{let s=await J(`assessments/${e}`,"POST",{...t,shouldAutoLogout:!1,shouldRefresh:!0});for(;s&&403===s.status;){const a=window.prompt("Please enter password.","");if(!a)return s=null,window.history.back(),null;s=await J(`assessments/${e}`,"POST",{...t,body:{password:a},shouldAutoLogout:!1,shouldRefresh:!0})}if(!s||!s.ok)return null;const a=await s.json();return a.category=ee(a.type),delete a.type,a.questions=a.questions.map((e=>{if(e.type===i.e.programming){const t=e;t.autogradingResults=t.autogradingResults||[],t.prepend=t.prepend||"",t.postpend=t.postpend||"",t.testcases=t.testcases||[],e=t}return null===e.grader&&(delete e.grader,delete e.gradedAt),e.library.external.name=e.library.external.name.toUpperCase(),e.library.globals=Object.entries(e.library.globals).map((e=>{try{e[1]=window.eval(e[1])}catch(t){}return e})),e})),a},E=async(e,t,s)=>await J(`assessments/question/${e}/submit`,"POST",{...s,body:{answer:`${t}`},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),A=async(e,t)=>await J(`assessments/${e}/submit`,"POST",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),I=async(e,t)=>{const s=await J(`grading?group=${t}`,"GET",{...e,shouldRefresh:!0});if(!s)return null;return(await s.json()).map((e=>{const t={assessmentId:e.assessment.id,assessmentName:e.assessment.title,assessmentCategory:ee(e.assessment.type),studentId:e.student.id,studentName:e.student.name,submissionId:e.id,submissionStatus:e.status,groupName:e.student.groupName,groupLeaderId:e.student.groupLeaderId,initialGrade:e.grade,gradeAdjustment:e.adjustment,currentGrade:e.grade+e.adjustment,maxGrade:e.assessment.maxGrade,gradingStatus:"none",questionCount:e.assessment.questionCount,gradedCount:e.gradedCount,initialXp:e.xp,xpAdjustment:e.xpAdjustment,currentXp:e.xp+e.xpAdjustment,maxXp:e.assessment.maxXp,xpBonus:e.xpBonus};return t.gradingStatus=te(t.assessmentCategory,t.submissionStatus,t.gradedCount,t.questionCount),t})).sort(((e,t)=>e.assessmentId!==t.assessmentId?t.assessmentId-e.assessmentId:t.submissionId-e.submissionId))},T=async(e,t)=>{const s=await J(`grading/${e}`,"GET",{...t,shouldRefresh:!0});if(!s)return null;return(await s.json()).map((e=>{const{student:t,question:s,grade:a}=e,n={question:{answer:s.answer,autogradingResults:s.autogradingResults||[],choices:s.choices,content:s.content,roomId:null,id:s.id,library:(i=s.library,{chapter:i.chapter,external:{name:i.external.name.toUpperCase(),symbols:i.external.symbols},globals:Object.entries(i.globals).map((e=>{try{e[1]=window.eval(e[1])}catch(t){}return e}))}),solution:e.solution||s.solution||null,solutionTemplate:s.solutionTemplate,prepend:s.prepend||"",postpend:s.postpend||"",testcases:s.testcases||[],type:s.type,maxGrade:s.maxGrade,maxXp:s.maxXp},student:t,grade:{grade:a.grade,xp:a.xp,roomId:a.roomId||"",gradeAdjustment:a.adjustment,xpAdjustment:a.xpAdjustment,comments:a.comments}};var i;return null!==e.grade.grader&&(n.grade.grader=e.grade.grader,n.grade.gradedAt=e.grade.gradedAt),n}))},k=async(e,t,s,a,n,i)=>await J(`grading/${e}/${t}`,"POST",{...n,body:{grading:{adjustment:s,xpAdjustment:a,comments:i}},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),N=async(e,t)=>await J(`grading/${e}/autograde`,"POST",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),P=async(e,t,s)=>await J(`grading/${e}/${t}/autograde`,"POST",{...s,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),R=async(e,t)=>await J(`grading/${e}/unsubmit`,"POST",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),M=async e=>{const t=await J("notification","GET",{...e,shouldAutoLogout:!1});let s=[];if(!t||!t.ok)return s;return s=(await t.json()).map((e=>({id:e.id,type:e.type,assessment_id:e.assessment_id||void 0,assessment_type:e.assessment?ee(e.assessment.type):void 0,assessment_title:e.assessment?e.assessment.title:void 0,submission_id:e.submission_id||void 0}))),s},L=async(e,t)=>await J("notification/acknowledge","POST",{...e,body:{notificationIds:t},shouldAutoLogout:!1}),_=async(e,t)=>await J(`sourcecast/${e}`,"DELETE",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),D=async e=>{const t=await J("sourcecast","GET",{...e,shouldAutoLogout:!1,shouldRefresh:!0});return t&&t.ok?await t.json():null},G=async(e,t,s,a,n,i)=>{const r=new FormData,o=Date.now().toString()+".wav";r.append("sourcecast[title]",e),r.append("sourcecast[description]",t),r.append("sourcecast[uid]",s),r.append("sourcecast[audio]",a,o),r.append("sourcecast[playbackData]",JSON.stringify(n));return await J("sourcecast","POST",{...i,body:r,noContentType:!0,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0})},B=async(e,t,s,a)=>await J(`assessments/update/${e}`,"POST",{...a,body:{closeAt:t,openAt:s},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),U=async(e,t)=>await J(`assessments/${e}`,"DELETE",{...t,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),F=async(e,t,s)=>await J(`assessments/publish/${e}`,"POST",{...s,body:{togglePublishTo:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0}),H=async(e,t,s)=>{const a=new FormData;a.append("assessment[file]",e),a.append("forceUpdate",String(s));return await J("assessments","POST",{...t,body:a,noContentType:!0,noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0})},V=async e=>{const t=await J("grading/summary","GET",{...e,shouldRefresh:!0});return t&&t.ok?await t.json():null},q=async()=>{const e=await J("settings/sublanguage","GET",{noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0});if(!e||!e.ok)return null;const t=(await e.json()).sublanguage;return{...t,displayName:Object(n.n)(t.chapter,t.variant)}},X=async(e,t,s)=>await J("settings/sublanguage","PUT",{...s,body:{chapter:e,variant:t},noHeaderAccept:!0,shouldAutoLogout:!1,shouldRefresh:!0});async function $(e){const t=await J("devices","GET",{accessToken:e.accessToken,refreshToken:e.refreshToken,shouldRefresh:!0});return t&&t.ok?t.json():null}async function W(e,t){const s=await J(`devices/${e.id}/ws_endpoint`,"GET",{accessToken:t.accessToken,refreshToken:t.refreshToken,shouldRefresh:!0,shouldAutoLogout:!1});return s&&s.ok?s.json():null}async function z(e,t){t=Q(t);const s=await J("devices","POST",{accessToken:t.accessToken,refreshToken:t.refreshToken,shouldRefresh:!0,shouldAutoLogout:!1,body:e});if(!s)throw new Error("Unknown error occurred.");if(!s.ok){const e=await s.text();throw new Error(`Failed to register: ${e}`)}return s.json()}async function K(e,t){t=Q(t);const s=await J(`devices/${e.id}`,"POST",{accessToken:t.accessToken,refreshToken:t.refreshToken,shouldRefresh:!0,shouldAutoLogout:!1,body:{title:e.title}});if(!s)throw new Error("Unknown error occurred.");if(!s.ok){const e=await s.text();throw new Error(`Failed to edit: ${e}`)}return!0}async function Y(e,t){t=Q(t);const s=await J(`devices/${e.id}`,"DELETE",{accessToken:t.accessToken,refreshToken:t.refreshToken,shouldRefresh:!0});if(!s)throw new Error("Unknown error occurred.");if(!s.ok){const e=await s.text();throw new Error(`Failed to delete: ${e}`)}return!0}function Q(e){if(!(e=e||function(){const{accessToken:e,refreshToken:t}=r.a.getState().session;return e&&t?{accessToken:e,refreshToken:t}:void 0}()))throw new Error("Not logged in.");return e}const J=async(e,t,s)=>{const a=new Headers;s.noHeaderAccept||a.append("Accept","application/json"),s.accessToken&&a.append("Authorization",`Bearer ${s.accessToken}`);const n={method:t,headers:a};s.body&&(s.noContentType?n.body=s.body:(a.append("Content-Type","application/json"),n.body=JSON.stringify(s.body)));try{const a=await fetch(`${l.b.backendUrl}/v1/${e}`,n);if(s.shouldRefresh&&a&&401===a.status){const a=await(async e=>{const t=await J("auth/refresh","POST",{body:{refresh_token:e}});if(!t)return null;const s=await t.json();return{accessToken:s.access_token,refreshToken:s.refresh_token}})(s.refreshToken);r.a.dispatch(d.a.setTokens(a));const n={...s,accessToken:a.accessToken,shouldRefresh:!1};return J(e,t,n)}if(a&&!a.ok&&!1===s.shouldAutoLogout)return a;if(!a||!a.ok)throw new Error("API call failed or got non-OK response");return a}catch(i){return r.a.dispatch(d.a.logOut()),Object(u.e)(s.errorMessage?s.errorMessage:"Please login again."),null}};function*Z(e){if(!e)return void(yield Object(a.a)(u.e,"Couldn't reach our servers. Are you online?"));let t=yield e.text();t.length>100&&e.status&&(t=`Something went wrong (got ${e.status} response)`),yield Object(a.a)(u.e,t)}const ee=e=>e.charAt(0).toUpperCase()+e.slice(1),te=(e,t,s,a)=>["Mission","Sidequest","Practical"].includes(e)&&"submitted"===t?0===s?"none":s===a?"graded":"grading":"excluded"},33:function(e,t,s){"use strict";s.d(t,"d",(function(){return a})),s.d(t,"f",(function(){return n})),s.d(t,"e",(function(){return i})),s.d(t,"g",(function(){return r})),s.d(t,"h",(function(){return o})),s.d(t,"i",(function(){return c})),s.d(t,"j",(function(){return d})),s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return h}));const a="SAVE_SOURCECAST_DATA",n="SET_CURRENT_PLAYER_TIME",i="SET_CODE_DELTAS_TO_APPLY",r="SET_INPUT_TO_APPLY",o="SET_SOURCECAST_DATA",c="SET_SOURCECAST_PLAYBACK_DURATION",d="SET_SOURCECAST_PLAYBACK_STATUS";let l,u,h;!function(e){e.run="run"}(l||(l={})),function(e){e.forcedPaused="forcedPaused",e.playing="playing",e.paused="paused"}(u||(u={})),function(e){e.notStarted="notStarted",e.recording="recording",e.paused="paused",e.finished="finished"}(h||(h={}))},38:function(e,t,s){"use strict";let a;s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return l})),function(e){e.NONE="NONE",e.RUNES="RUNES",e.CURVES="CURVES",e.SOUNDS="SOUNDS",e.BINARYTREES="BINARYTREES",e.PIXNFLIX="PIXNFLIX",e.MACHINELEARNING="MACHINELEARNING",e.EV3="EV3",e.ALL="ALL"}(a||(a={}));const n=["show","color","random_color","red","pink","purple","indigo","blue","green","yellow","orange","brown","black","white","scale_independent","scale","translate","rotate","stack_frac","stack","stackn","quarter_turn_right","quarter_turn_left","turn_upside_down","beside_frac","beside","flip_vert","flip_horiz","make_cross","repeat_pattern","square","blank","rcross","sail","corner","nova","circle","heart","pentagram","ribbon","anaglyph","overlay_frac","overlay","hollusion","picture_mse"],i=["make_point","make_3D_point","make_color_point","make_3D_color_point","draw_connected","draw_connected_full_view","draw_connected_full_view_proportional","draw_points_on","draw_points_full_view_proportional","draw_3D_connected","draw_3D_connected_full_view","draw_3D_connected_full_view_proportional","draw_3D_points_on","draw_3D_points_full_view_proportional","x_of","y_of","z_of","r_of","g_of","b_of","unit_line","unit_line_at","unit_circle","connect_rigidly","connect_ends","put_in_standard_position","translate_curve","scale_proportional","scale_curve","repeated","rotate_around_origin","arc","invert","alternative_unit_circle","full_view_proportional","squeeze_full_view","squeeze_rectangular_portion"],r=["make_sound","get_wave","get_duration","is_sound","play","play_concurrently","stop","consecutively","simultaneously","noise_sound","sine_sound","silence_sound","letter_name_to_midi_note","letter_name_to_frequency","midi_note_to_frequency","square_sound","triangle_sound","sawtooth_sound","play_unsafe","display_waveform","init_record","record","record_for","adsr","stacking_adsr","trombone","piano","bell","violin","cello"],o=["make_empty_tree","is_tree","make_tree","is_empty_tree","entry","left_branch","right_branch"],c=["red_of","green_of","blue_of","alpha_of","set_rgba","copy_image","compose_filter","install_filter","reset_filter","video_height","video_width"],d=[[a.NONE,[]],[a.RUNES,n],[a.CURVES,i],[a.SOUNDS,r],[a.BINARYTREES,o],[a.PIXNFLIX,c],[a.MACHINELEARNING,["init_webcam","train_recognition","load_faceapi","change_label","array_push","normalise_data"]],[a.ALL,n.concat(i,r,o,c)]],l=new Map(d)},409:function(e,t,s){"use strict";(function(e){var a=s(410),n=s(40),i=s(90),r=s(3),o=s(63),c=s(86),d=s(38),l=s(47),u=s(16),h=s(32),p=s(29);const g={start:{line:0,column:0},end:{line:0,column:0}};const m="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",b=()=>new Array(16).fill(void 0).map((e=>m[Math.floor(Math.random()*m.length)])).join("");t.a=function*(){yield Object(p.b)(o.c,(function*(){const[e,t]=yield Object(r.f)((e=>[{accessToken:e.session.accessToken,refreshToken:e.session.refreshToken},e.session.remoteExecutionSession])),s=yield Object(r.a)(h.j,e);if(yield Object(r.d)(u.a.remoteExecUpdateDevices(s)),!t)return;const a=s.find((({id:e})=>e===t.device.id));a&&(yield Object(r.d)(u.a.remoteExecUpdateSession({...t,device:a})))})),yield Object(p.a)(o.a,(function*(e){const[t,s]=yield Object(r.f)((e=>[{accessToken:e.session.accessToken,refreshToken:e.session.refreshToken},e.session.remoteExecutionSession])),{device:n,workspace:l}=e.payload;yield Object(r.d)(u.a.remoteExecUpdateSession({device:n,workspace:l,connection:{status:"CONNECTING"}}));const p=yield Object(r.a)(h.n,n,t);if(!p)return void(yield Object(r.d)(u.a.remoteExecUpdateSession({...e.payload,connection:{status:"FAILED",error:"Could not retrieve MQTT endpoint"}})));const m=null===s||void 0===s?void 0:s.connection.client;if(m)try{m.disconnect()}catch{}const j=new a.SlingClient({clientId:`${p.clientNamePrefix}${b()}`,deviceId:p.thingName,websocketEndpoint:p.endpoint});j.on("statusChange",(e=>{c.a.dispatch(u.a.updateWorkspace(l,{isRunning:e}))})),j.on("display",((e,t)=>{switch(t){case"output":c.a.dispatch(u.a.handleConsoleLog(`${e}`,l));break;case"error":{const t=new i.ExceptionError(new Error(`${e}`),g);c.a.dispatch(u.a.evalInterpreterError([t],l));break}case"result":c.a.dispatch(u.a.evalInterpreterSuccess(e,l))}}));const y=o.i.get(n.type);yield Object(r.d)(u.a.remoteExecUpdateSession({device:n,workspace:l,connection:{status:"CONNECTING",client:j,endpoint:p}})),yield Object(r.d)(u.a.updateWorkspace(l,{isRunning:!1,isEditorAutorun:!1,isDebugging:!1,externalLibrary:null===y||void 0===y?void 0:y.deviceLibraryName,output:[]})),yield Object(r.d)(u.a.beginClearContext(l,{chapter:(null===y||void 0===y?void 0:y.languageChapter)||3,variant:"default",external:{name:(null===y||void 0===y?void 0:y.deviceLibraryName)||d.a.NONE,symbols:(null===y||void 0===y?void 0:y.internalFunctions)||[]},globals:[]},!1));try{const t=new Promise(((e,t)=>{try{j.once("connect",(()=>e(!0))),j.once("error",t),j.connect()}catch{t()}}));(yield Object(r.e)({connect:t,reconnect:Object(r.g)(o.a),disconnect:Object(r.g)(o.b)})).connect?yield Object(r.d)(u.a.remoteExecUpdateSession({...e.payload,connection:{status:"CONNECTED",client:j,endpoint:p}})):j.disconnect()}catch(O){j.disconnect(),yield Object(r.d)(u.a.remoteExecUpdateSession({...e.payload,connection:{status:"FAILED",client:j,error:O.toString()}}))}})),yield Object(p.b)(o.b,(function*(e){const t=yield Object(r.f)((e=>e.session.remoteExecutionSession));if(!t)return;const s=t.connection.client;s&&s.disconnect(),yield Object(r.d)(u.a.remoteExecUpdateSession(void 0)),yield Object(r.d)(u.a.externalLibrarySelect(d.a.NONE,t.workspace,!0))})),yield Object(p.a)(o.e,(function*({payload:t}){var s;const a=yield Object(r.f)((e=>e.session.remoteExecutionSession));if(!a)return;if("CONNECTED"!==a.connection.status)return void(yield Object(r.d)(u.a.updateWorkspace(a.workspace,{isRunning:!1})));yield Object(r.d)(u.a.clearReplOutput(a.workspace));const i=a.connection.client,c=yield Object(r.f)((e=>e.workspaces[a.workspace].context));c.errors.length=0;const d=yield Object(r.a)(n.compile,t,c,null===(s=o.i.get(a.device.type))||void 0===s?void 0:s.internalFunctions);if(!d)return void(yield Object(r.d)(u.a.evalInterpreterError(c.errors,a.workspace)));const l=Object(n.assemble)(d);i.sendRun(e.from(l))})),yield Object(p.a)(l.b,(function*(){const e=yield Object(r.f)((e=>e.session.remoteExecutionSession));e&&"CONNECTED"===e.connection.status&&e.connection.client.sendStop()}))}}).call(this,s(60).Buffer)},42:function(e,t,s){"use strict";s.r(t),s.d(t,"fetchAuth",(function(){return r})),s.d(t,"fetchAssessment",(function(){return o})),s.d(t,"fetchAssessmentOverviews",(function(){return c})),s.d(t,"fetchGrading",(function(){return d})),s.d(t,"fetchGradingOverviews",(function(){return l})),s.d(t,"login",(function(){return u})),s.d(t,"logoutGoogle",(function(){return h})),s.d(t,"loginGitHub",(function(){return p})),s.d(t,"logoutGitHub",(function(){return g})),s.d(t,"setTokens",(function(){return m})),s.d(t,"setUser",(function(){return b})),s.d(t,"setGoogleUser",(function(){return j})),s.d(t,"setGitHubOctokitInstance",(function(){return y})),s.d(t,"removeGitHubOctokitInstance",(function(){return O})),s.d(t,"submitAnswer",(function(){return v})),s.d(t,"submitAssessment",(function(){return x})),s.d(t,"submitGrading",(function(){return f})),s.d(t,"submitGradingAndContinue",(function(){return S})),s.d(t,"reautogradeSubmission",(function(){return C})),s.d(t,"reautogradeAnswer",(function(){return w})),s.d(t,"updateHistoryHelpers",(function(){return E})),s.d(t,"updateAssessmentOverviews",(function(){return A})),s.d(t,"updateAssessment",(function(){return I})),s.d(t,"updateGradingOverviews",(function(){return T})),s.d(t,"updateGrading",(function(){return k})),s.d(t,"unsubmitSubmission",(function(){return N})),s.d(t,"fetchNotifications",(function(){return P})),s.d(t,"acknowledgeNotifications",(function(){return R})),s.d(t,"updateNotifications",(function(){return M}));var a=s(9),n=s(414);var i=s(28);const r=(e,t)=>Object(a.action)(i.d,{code:e,providerId:t}),o=e=>Object(a.action)(i.b,e),c=()=>Object(a.action)(i.c),d=e=>Object(a.action)(i.e,e),l=(e=!0)=>Object(a.action)(i.f,e),u=e=>Object(a.action)(i.h,e),h=()=>Object(a.action)(i.k),p=()=>Object(a.action)(i.i),g=()=>Object(a.action)(i.j),m=({accessToken:e,refreshToken:t})=>Object(a.action)(i.q,{accessToken:e,refreshToken:t}),b=e=>Object(a.action)(i.r,e),j=e=>Object(a.action)(i.p,e),y=e=>Object(a.action)(i.o,function(e){return new n.a({auth:e,userAgent:"Source Academy Playground",baseUrl:"https://api.github.com",log:{debug:()=>{},info:()=>{},warn:console.warn,error:console.error},request:{agent:void 0,fetch:void 0,timeout:0}})}(e||"")),O=()=>Object(a.action)(i.n),v=(e,t)=>Object(a.action)(i.s,{id:e,answer:t}),x=e=>Object(a.action)(i.t,e),f=(e,t,s=0,n=0,r)=>Object(a.action)(i.u,{submissionId:e,questionId:t,gradeAdjustment:s,xpAdjustment:n,comments:r}),S=(e,t,s=0,n=0,r)=>Object(a.action)(i.v,{submissionId:e,questionId:t,gradeAdjustment:s,xpAdjustment:n,comments:r}),C=e=>Object(a.action)(i.m,e),w=(e,t)=>Object(a.action)(i.l,{submissionId:e,questionId:t}),E=e=>Object(a.action)(i.B,e),A=e=>Object(a.action)(i.y,e),I=e=>Object(a.action)(i.x,e),T=e=>Object(a.action)(i.A,e),k=(e,t)=>Object(a.action)(i.z,{submissionId:e,grading:t}),N=e=>Object(a.action)(i.w,{submissionId:e}),P=()=>Object(a.action)(i.g),R=e=>Object(a.action)(i.a,{withFilter:e}),M=e=>Object(a.action)(i.C,e)},47:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"f",(function(){return n})),s.d(t,"g",(function(){return i})),s.d(t,"h",(function(){return r})),s.d(t,"i",(function(){return o})),s.d(t,"j",(function(){return c})),s.d(t,"k",(function(){return d})),s.d(t,"a",(function(){return l})),s.d(t,"e",(function(){return u})),s.d(t,"d",(function(){return h})),s.d(t,"c",(function(){return p})),s.d(t,"l",(function(){return g}));const a="BEGIN_INTERRUPT_EXECUTION",n="END_INTERRUPT_EXECUTION",i="EVAL_INTERPRETER_ERROR",r="EVAL_INTERPRETER_SUCCESS",o="EVAL_TESTCASE_FAILURE",c="EVAL_TESTCASE_SUCCESS",d="HANDLE_CONSOLE_LOG",l="BEGIN_DEBUG_PAUSE",u="END_DEBUG_PAUSE",h="DEBUG_RESUME",p="DEBUG_RESET",g="HIGHLIGHT_LINE"},51:function(e,t,s){"use strict";s.r(t),s.d(t,"handleConsoleLog",(function(){return i})),s.d(t,"evalInterpreterSuccess",(function(){return r})),s.d(t,"evalTestcaseSuccess",(function(){return o})),s.d(t,"evalTestcaseFailure",(function(){return c})),s.d(t,"evalInterpreterError",(function(){return d})),s.d(t,"beginInterruptExecution",(function(){return l})),s.d(t,"endInterruptExecution",(function(){return u})),s.d(t,"beginDebuggerPause",(function(){return h})),s.d(t,"endDebuggerPause",(function(){return p})),s.d(t,"debuggerResume",(function(){return g})),s.d(t,"debuggerReset",(function(){return m}));var a=s(9),n=s(47);const i=(e,t)=>Object(a.action)(n.k,{logString:e,workspaceLocation:t}),r=(e,t)=>Object(a.action)(n.h,{type:"result",value:e,workspaceLocation:t}),o=(e,t,s)=>Object(a.action)(n.j,{type:"result",value:e,workspaceLocation:t,index:s}),c=(e,t,s)=>Object(a.action)(n.i,{type:"errors",value:e,workspaceLocation:t,index:s}),d=(e,t)=>Object(a.action)(n.g,{type:"errors",errors:e,workspaceLocation:t}),l=e=>Object(a.action)(n.b,{workspaceLocation:e}),u=e=>Object(a.action)(n.f,{workspaceLocation:e}),h=e=>Object(a.action)(n.a,{workspaceLocation:e}),p=e=>Object(a.action)(n.e,{workspaceLocation:e}),g=e=>Object(a.action)(n.d,{workspaceLocation:e}),m=e=>Object(a.action)(n.c,{workspaceLocation:e})},547:function(e,t,s){},55:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(91);const n=Object(a.a)()},552:function(e,t){},554:function(e,t){},63:function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"f",(function(){return i})),s.d(t,"g",(function(){return r})),s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return c})),s.d(t,"e",(function(){return d})),s.d(t,"d",(function(){return l})),s.d(t,"h",(function(){return u})),s.d(t,"i",(function(){return h}));var a=s(38);const n="REMOTE_EXEC_FETCH_DEVICES",i="REMOTE_EXEC_UPDATE_DEVICES",r="REMOTE_EXEC_UPDATE_SESSION",o="REMOTE_EXEC_CONNECT",c="REMOTE_EXEC_DISCONNECT",d="REMOTE_EXEC_RUN",l="REMOTE_EXEC_REPL_INPUT",u=[{id:"EV3",name:"Lego Mindstorms EV3",internalFunctions:["ev3_pause","ev3_connected","ev3_motorA","ev3_motorB","ev3_motorC","ev3_motorD","ev3_motorGetSpeed","ev3_motorSetSpeed","ev3_motorStart","ev3_motorStop","ev3_motorSetStopAction","ev3_motorGetPosition","ev3_runForTime","ev3_runToAbsolutePosition","ev3_runToRelativePosition","ev3_colorSensor","ev3_colorSensorRed","ev3_colorSensorGreen","ev3_colorSensorBlue","ev3_reflectedLightIntensity","ev3_ambientLightIntensity","ev3_colorSensorGetColor","ev3_ultrasonicSensor","ev3_ultrasonicSensorDistance","ev3_gyroSensor","ev3_gyroSensorAngle","ev3_gyroSensorRate","ev3_touchSensor1","ev3_touchSensor2","ev3_touchSensor3","ev3_touchSensor4","ev3_touchSensorPressed","ev3_hello","ev3_waitForButtonPress","ev3_speak","ev3_playSequence","ev3_ledLeftGreen","ev3_ledLeftRed","ev3_ledRightGreen","ev3_ledRightRed","ev3_ledGetBrightness","ev3_ledSetBrightness"],languageChapter:3,deviceLibraryName:a.a.EV3}],h=new Map(u.map((e=>[e.id,e])))},71:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"d",(function(){return r})),s.d(t,"e",(function(){return o})),s.d(t,"f",(function(){return c})),s.d(t,"g",(function(){return d})),s.d(t,"h",(function(){return l})),s.d(t,"i",(function(){return u}));const a="DELETE_SOURCECAST_ENTRY",n="RECORD_INIT",i="RECORD_INPUT",r="RESET_INPUTS",o="TIMER_PAUSE",c="TIMER_RESET",d="TIMER_RESUME",l="TIMER_START",u="TIMER_STOP"},714:function(e,t){},716:function(e,t){},725:function(e,t){},727:function(e,t){},73:function(e,t,s){"use strict";s.d(t,"i",(function(){return c})),s.d(t,"f",(function(){return d})),s.d(t,"g",(function(){return l})),s.d(t,"a",(function(){return h})),s.d(t,"h",(function(){return p})),s.d(t,"c",(function(){return g})),s.d(t,"e",(function(){return m})),s.d(t,"d",(function(){return b})),s.d(t,"b",(function(){return j}));var a=s(129),n=s.n(a),i=s(65),r=s(43),o=s(51);function c({context:e}){if(!window.EnvVisualizer)throw new Error("Env visualizer is not enabled");window.EnvVisualizer.draw_env(e)}function d(e){if(!window.Inspector)throw new Error("Inspector not loaded");window.Inspector.highlightClean(),window.Inspector.highlightLine(e)}function l(e){if(!window.Inspector)throw new Error("Inspector not loaded");window.Inspector.updateContext(e,i.stringify)}const u={display:function e(t,s,a){return e((void 0===s?"":s+" ")+Object(i.stringify)(t),"",a),t},rawDisplay:function(e,t,s){const a=(void 0===t?"":t+" ")+String(e);return"undefined"!==typeof window.__REDUX_STORE__&&window.__REDUX_STORE__.dispatch(Object(o.handleConsoleLog)(a,s)),e},prompt:function(e){return prompt(e)},alert:function(e){alert(Object(i.stringify)(e))},visualiseList:function(...e){if(window.ListVisualizer)return window.ListVisualizer.draw(e[0]),e[0];throw new Error("List visualizer is not enabled")}};function h(e,t,s,a="default",i){return n()(e,a,t,s,u,i)}function p(e){function t(){}t.prototype=e.runtime.environments[0].head;const s=new t,n=new Proxy(e.runtime.environments[0],{get:(e,t,a)=>"head"===t?s:e[t]}),i=new Proxy(e.runtime.environments,{get:(e,t,s)=>"0"===t?n:e[t]}),r=new Proxy(e.runtime,{get:(e,t,s)=>"environments"===t?i:e[t]}),o=new Proxy(e,{get(e,t,s){switch(t){case"chapter":return 4;case"runtime":return r;default:return e[t]}}});var c,d;return c=o,d=u,Object(a.importBuiltins)(c,d),Object(a.defineBuiltin)(c,"makeUndefinedErrorFunction",(e=>()=>{throw new Error(`Name ${e} not declared.`)})),o}function g(e,t){const s=e.runtime.environments[0].head,a=t.runtime.environments[0].head;return Object(r.difference)(Object(r.keys)(s),Object(r.keys)(a))}function m(e,t){return`const _____${t} = [${e.join(", ")}];`}function b(e,t){const s=`_____${t}`;return e.map(((e,t)=>"makeUndefinedErrorFunction"===e?"":`const ${e} = ${s}[${t}];`)).join("\n")}function j(e){return e.map((e=>"makeUndefinedErrorFunction"===e?"":`const ${e} = makeUndefinedErrorFunction('${e}');`)).join("\n")}},740:function(e,t){},741:function(e,t){},8:function(e,t,s){"use strict";s.d(t,"c",(function(){return a})),s.d(t,"f",(function(){return n})),s.d(t,"b",(function(){return i})),s.d(t,"d",(function(){return r})),s.d(t,"a",(function(){return o})),s.d(t,"g",(function(){return c})),s.d(t,"e",(function(){return d})),s.d(t,"i",(function(){return l})),s.d(t,"k",(function(){return u})),s.d(t,"l",(function(){return h})),s.d(t,"m",(function(){return p})),s.d(t,"j",(function(){return g})),s.d(t,"h",(function(){return m}));const a="FETCH_ASSESSMENT_OVERVIEWS",n="SUBMIT_ASSESSMENT";let i,r,o,c,d;!function(e){e.attempting="attempting",e.attempted="attempted",e.not_attempted="not_attempted",e.submitted="submitted"}(i||(i={})),function(e){e.excluded="excluded",e.graded="graded",e.grading="grading",e.none="none"}(r||(r={})),function(e){e.Contest="Contest",e.Mission="Mission",e.Path="Path",e.Sidequest="Sidequest",e.Practical="Practical"}(o||(o={})),function(e){e.public="public",e.hidden="hidden",e.private="private"}(c||(c={})),function(e){e.programming="programming",e.mcq="mcq"}(d||(d={}));const l=()=>({chapter:-1,external:{name:"NONE",symbols:[]},globals:[]}),u=()=>({category:o.Mission,closeAt:"2100-12-01T00:00+08",coverImage:"https://fakeimg.pl/300/",grade:1,id:-1,maxGrade:0,maxXp:0,openAt:"2000-01-01T00:00+08",title:"Insert title here",reading:"",shortSummary:"Insert short summary here",status:i.not_attempted,story:"mission",xp:0,gradingStatus:"none"}),h=()=>({autogradingResults:[],answer:"// [Marking Scheme]\n// 1 mark for correct answer",roomId:"19422043",content:"Enter content here",id:0,library:l(),graderLibrary:l(),prepend:"",solutionTemplate:"//This is a mock solution template",postpend:"",testcases:[],testcasesPrivate:[],type:"programming",xp:0,grade:0,maxGrade:0,maxXp:0}),p=()=>({type:c.public,answer:"",score:0,program:""}),g=()=>({answer:3,roomId:null,content:"This is a mock MCQ question",choices:[{content:"A",hint:null},{content:"B",hint:null},{content:"C",hint:null},{content:"D",hint:null}],id:2,library:l(),graderLibrary:l(),type:"mcq",solution:0,xp:0,grade:0,maxGrade:0,maxXp:0}),m=()=>({category:"Mission",globalDeployment:{chapter:1,external:{name:"NONE",symbols:[]},globals:[]},graderDeployment:l(),id:-1,longSummary:"Insert mission briefing here",missionPDF:"www.google.com",questions:[h()],title:"Insert title here"})},80:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n})),s.d(t,"f",(function(){return i})),s.d(t,"e",(function(){return r})),s.d(t,"g",(function(){return o})),s.d(t,"d",(function(){return c})),s.d(t,"c",(function(){return d}));const a="CHANGE_QUERY_STRING",n="GENERATE_LZ_STRING",i="TOGGLE_USING_SUBST",r="SHORTEN_URL",o="UPDATE_SHORT_URL",c="PLAYGROUND_UPDATE_PERSISTENCE_FILE",d="PLAYGROUND_UPDATE_GITHUB_FILE"},81:function(e,t,s){"use strict";s.r(t),s.d(t,"saveSourcecastData",(function(){return i})),s.d(t,"setCurrentPlayerTime",(function(){return r})),s.d(t,"setCodeDeltasToApply",(function(){return o})),s.d(t,"setInputToApply",(function(){return c})),s.d(t,"setSourcecastData",(function(){return d})),s.d(t,"setSourcecastDuration",(function(){return l})),s.d(t,"setSourcecastStatus",(function(){return u}));var a=s(9),n=s(33);const i=(e,t,s,i,r,o)=>Object(a.action)(n.d,{title:e,description:t,uid:s,audio:i,audioUrl:window.URL.createObjectURL(i),playbackData:r,workspaceLocation:o}),r=(e,t)=>Object(a.action)(n.f,{playerTime:e,workspaceLocation:t}),o=(e,t)=>Object(a.action)(n.e,{deltas:e,workspaceLocation:t}),c=(e,t)=>Object(a.action)(n.g,{inputToApply:e,workspaceLocation:t}),d=(e,t,s,i,r,o)=>Object(a.action)(n.h,{title:e,description:t,uid:s,audioUrl:i,playbackData:r,workspaceLocation:o}),l=(e,t)=>Object(a.action)(n.i,{duration:e,workspaceLocation:t}),u=(e,t)=>Object(a.action)(n.j,{playbackStatus:e,workspaceLocation:t})},82:function(e,t,s){"use strict";let a;s.d(t,"a",(function(){return a})),function(e){e.new="new",e.deadline="deadline",e.autograded="autograded",e.graded="graded",e.submitted="submitted",e.unsubmitted="unsubmitted",e.new_message="new_message"}(a||(a={}))},86:function(e,t,s){"use strict";s.d(t,"a",(function(){return mt}));var a=s(380),n=s(43),i=s(35),r=s(417),o=s(30),c=s(196),d=s(115),l=s(113);const u=(e=o.c,t)=>{switch(t.type){case d.a:return o.c;case l.a:return{...e,gameCanvas:t.payload};default:return e}};var h=s(21);const p=(e=o.d,t)=>{switch(t.type){case h.n:return{...e,achievements:t.payload};case h.o:return{...e,goals:t.payload};default:return e}};var g=s(124);const m=(e=o.f,t)=>{switch(t.type){case g.b:return{...e,gradingSummary:t.payload};default:return e}};var b=s(80);const j=(e=o.i,t)=>{switch(t.type){case b.a:return{...e,queryString:t.payload};case b.f:return{...e,usingSubst:t.payload};case b.g:return{...e,shortURL:t.payload};case b.d:return{...e,persistenceFile:t.payload};case b.c:return{...e,githubFile:t.payload};default:return e}};var y=s(33),O=s(111);var v=s(71);var x=s(47),f=s(180),S=s(23),C=s(19),w=s(73),E=s(24);const A=(e=o.l,t)=>{const s=t.payload?t.payload.workspaceLocation:"assessment";let a,n;switch(s){case"sourcecast":const s=((e,t)=>{switch(t.type){case y.d:return{...e,title:t.payload.title,description:t.payload.description,uid:t.payload.uid,audioUrl:t.payload.audioUrl,playbackData:t.payload.playbackData};case y.f:return{...e,currentPlayerTime:t.payload.playerTime};case y.e:return{...e,codeDeltasToApply:t.payload.deltas};case y.g:return{...e,inputToApply:t.payload.inputToApply};case y.h:return{...e,title:t.payload.title,description:t.payload.description,uid:t.payload.uid,audioUrl:t.payload.audioUrl,playbackData:t.payload.playbackData};case y.i:return{...e,playbackDuration:t.payload.duration};case y.j:return{...e,playbackStatus:t.payload.playbackStatus};case O.c:return{...e,sourcecastIndex:t.payload.index};default:return e}})(e.sourcecast,t);if(s===e.sourcecast)break;return{...e,sourcecast:s};case"sourcereel":const a=((e,t)=>{switch(t.type){case v.b:return{...e,playbackData:{init:t.payload.initData,inputs:[]}};case v.c:return{...e,playbackData:{...e.playbackData,inputs:[...e.playbackData.inputs,t.payload.input]}};case v.d:return{...e,playbackData:{...e.playbackData,inputs:t.payload.inputs}};case v.e:return{...e,recordingStatus:y.c.paused,timeElapsedBeforePause:e.timeElapsedBeforePause+t.payload.timeNow-e.timeResumed};case v.f:return{...e,recordingStatus:y.c.notStarted,timeElapsedBeforePause:0,timeResumed:0};case v.g:return{...e,recordingStatus:y.c.recording,timeElapsedBeforePause:t.payload.timeBefore>=0?t.payload.timeBefore:e.timeElapsedBeforePause,timeResumed:t.payload.timeNow};case v.h:return{...e,recordingStatus:y.c.recording,timeElapsedBeforePause:0,timeResumed:t.payload.timeNow};case v.i:return{...e,recordingStatus:y.c.finished,timeElapsedBeforePause:0,timeResumed:0};default:return e}})(e.sourcereel,t);if(a===e.sourcereel)break;return{...e,sourcereel:a}}switch(t.type){case E.b:if(null===e[s].replHistory.browseIndex)return e;if(0!==e[s].replHistory.browseIndex){const t=e[s].replHistory.browseIndex-1,a=e[s].replHistory.records[t];return{...e,[s]:{...e[s],replValue:a,replHistory:{...e[s].replHistory,browseIndex:t}}}}{const t=null,a=e[s].replHistory.originalValue,n=e[s].replHistory.records.slice();return{...e,[s]:{...e[s],replValue:a,replHistory:{browseIndex:t,records:n,originalValue:""}}}}case E.c:const i=e[s].replHistory.records,r=e[s].replHistory.browseIndex;if(0===i.length||null!==r&&void 0===i[r+1])return e;if(null===r){const t=0,a=i.slice(),n=e[s].replValue,r=a[t];return{...e,[s]:{...e[s],replValue:r,replHistory:{...e[s].replHistory,browseIndex:t,records:a,originalValue:n}}}}{const t=r+1,a=i[t];return{...e,[s]:{...e[s],replValue:a,replHistory:{...e[s].replHistory,browseIndex:t}}}}case E.d:return{...e,[s]:{...e[s],editorHeight:t.payload.height}};case E.e:return{...e,[s]:{...e[s],editorWidth:(parseFloat(e[s].editorWidth.slice(0,-1))+parseFloat(t.payload.widthChange)).toString()+"%"}};case E.f:return{...e,[s]:{...e[s],execTime:t.payload.execTime}};case E.h:return{...e,[s]:{...e[s],sideContentHeight:t.payload.height}};case E.i:return{...e,[s]:{...e[s],stepLimit:t.payload.stepLimit}};case E.l:return{...e,[s]:{...e[s],replValue:""}};case E.n:return{...e,[s]:{...e[s],output:e[s].output.slice(0,-1)}};case E.m:return{...e,[s]:{...e[s],output:[]}};case E.o:return{...e,[s]:{...e[s],context:Object(w.a)(t.payload.library.chapter,t.payload.library.external.symbols,s,t.payload.library.variant,t.payload.library.moduleParams),globals:t.payload.library.globals,externalLibrary:t.payload.library.external.name}};case E.A:let c;return a=e[s].output.concat(t.payload),c=""!==t.payload.value?[t.payload.value].concat(e[s].replHistory.records):e[s].replHistory.records,c.length>C.b.maxBrowseIndex&&c.pop(),{...e,[s]:{...e[s],output:a,replHistory:{...e[s].replHistory,records:c}}};case E.g:return{...e,[s]:{...e[s],externalLibrary:t.payload.newExternal}};case x.k:if(n=e[s].output.slice(-1)[0],void 0===n||"running"!==n.type)a=e[s].output.concat({type:"running",consoleLogs:[t.payload.logString]});else{const i={type:n.type,consoleLogs:n.consoleLogs.concat(t.payload.logString)};a=e[s].output.slice(0,-1).concat(i)}return{...e,[s]:{...e[s],output:a}};case d.a:const l=e.playground;return{...o.l,playground:l};case E.p:return{...e,[s]:{...e[s],isRunning:!0,isDebugging:!1}};case E.q:return{...e,[s]:{...e[s],isRunning:!0}};case x.h:return n=e[s].output.slice(-1)[0],a=void 0!==n&&"running"===n.type?e[s].output.slice(0,-1).concat({type:t.payload.type,value:t.payload.value,consoleLogs:n.consoleLogs}):e[s].output.concat({type:t.payload.type,value:t.payload.value,consoleLogs:[]}),{...e,[s]:{...e[s],output:a,isRunning:!1,breakpoints:[],highlightedLines:[]}};case x.j:return{...e,[s]:{...e[s],editorTestcases:e[s].editorTestcases.map(((e,s)=>s===t.payload.index?{...e,result:t.payload.value,errors:void 0}:e)),isRunning:!1}};case x.i:return{...e,[s]:{...e[s],editorTestcases:e[s].editorTestcases.map(((e,s)=>s===t.payload.index?{...e,result:void 0,errors:t.payload.value}:e))}};case x.g:return n=e[s].output.slice(-1)[0],a=void 0!==n&&"running"===n.type?e[s].output.slice(0,-1).concat({type:t.payload.type,errors:t.payload.errors,consoleLogs:n.consoleLogs}):e[s].output.concat({type:t.payload.type,errors:t.payload.errors,consoleLogs:[]}),{...e,[s]:{...e[s],output:a,isRunning:!1,isDebugging:!1}};case x.f:return{...e,[s]:{...e[s],isRunning:!1,isDebugging:!1}};case x.e:return{...e,[s]:{...e[s],isRunning:!1,isDebugging:!0}};case x.d:return{...e,[s]:{...e[s],isRunning:!0,isDebugging:!1}};case x.c:return{...e,[s]:{...e[s],isRunning:!1,isDebugging:!1}};case E.y:return{...e,[s]:{...e[s],editorTestcases:e[s].editorTestcases.map(((e,s)=>s===t.payload.index?{...e,result:void 0,errors:void 0}:e))}};case E.z:return{...e,[s]:{...e[s],...Object(o.b)(s),...t.payload.workspaceOptions}};case E.K:return{...e,[s]:{...e[s],...t.payload.workspaceOptions}};case f.a:return{...e,[s]:{...e[s],editorSessionId:t.payload.editorSessionId}};case O.b:return{...e,[s]:{...e[s],editorReadonly:t.payload.editorReadonly}};case f.b:return{...e,[s]:{...e[s],sharedbConnected:t.payload.connected}};case E.B:return{...e,[s]:{...e[s],isEditorAutorun:!e[s].isEditorAutorun}};case E.C:return{...e,[s]:{...e[s],sideContentActiveTab:t.payload.activeTab}};case E.D:return{...e,assessment:{...e.assessment,currentAssessment:t.payload.assessmentId,currentQuestion:t.payload.questionId}};case E.E:return{...e,grading:{...e.grading,currentSubmission:t.payload.submissionId,currentQuestion:t.payload.questionId}};case E.G:return{...e,[s]:{...e[s],editorValue:t.payload.newEditorValue}};case x.l:return{...e,[s]:{...e[s],highlightedLines:t.payload.highlightedLines}};case E.u:return{...e,[s]:{...e[s],newCursorPosition:t.payload.cursorPosition}};case E.I:return{...e,[s]:{...e[s],replValue:t.payload.newReplValue}};case E.H:return{...e,[s]:{...e[s],hasUnsavedChanges:t.payload.hasUnsavedChanges}};case E.J:return{...e,playground:{...e.playground,context:{...e.playground.context,chapter:t.payload.sublang.chapter,variant:t.payload.sublang.variant}}};case S.a:return{...e,[s]:{...e[s],debuggerContext:{...e[s].debuggerContext,result:t.payload.result,lastDebuggerResult:t.payload.lastDebuggerResult,code:t.payload.code,context:t.payload.context,workspaceLocation:t.payload.workspaceLocation}}};default:return e}},I=(e=o.e,t)=>e;var T=s(233);var k=e=>Object(i.c)({router:Object(c.b)(e),academy:u,achievement:p,application:I,dashboard:m,playground:j,session:T.a,workspaces:A}),N=s(3),P=s(28),R=s(8),M=s(16),L=s(55),_=s(26),D=s(38);const G=[...[{category:R.a.Mission,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/300/",grade:1,id:1,maxGrade:3e3,maxXp:1e3,openAt:"2038-06-18T05:24:26.026Z",title:"An Odessey to Runes (Duplicate)",shortSummary:"This is a test for the UI of the unopened assessment overview. It links to the mock Mission 0",status:R.b.not_attempted,story:"mission-1",xp:0,gradingStatus:R.d.none}],...[{category:R.a.Mission,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/300/",grade:2,id:1,maxGrade:3e3,maxXp:1e3,openAt:"2018-06-18T05:24:26.026Z",title:"An Odessey to Runes",shortSummary:"\n  *Lorem ipsum* dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor\n  incididunt ut labore et dolore magna aliqua.\n  \n  ```\n  const a = 5;\n  ```\n  \n  Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium\n  _doloremque laudantium_, totam rem aperiam, eaque ipsa quae ab illo inventore\n  [veritatis et quasi architecto](google.com) beatae vitae dicta sunt\n  `explicabo`.\n  \n  ",status:R.b.attempted,story:"mission-1",xp:1,gradingStatus:R.d.none},{category:R.a.Mission,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/?text=World&font=lobster",grade:3,id:2,maxGrade:3e3,maxXp:1e3,openAt:"2018-07-18T05:24:26.026Z",title:"The Secret to Streams",shortSummary:"Once upon a time, Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nec vulputate sapien. Fusce vel lacus fermentum, efficitur ipsum.",status:R.b.attempting,story:"mission-2",xp:2,gradingStatus:R.d.none},{category:R.a.Sidequest,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/?text=Hello",grade:4,id:3,maxGrade:3e3,maxXp:1e3,openAt:"2018-07-18T05:24:26.026Z",title:"A sample Sidequest",shortSummary:"Once upon a time, Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nec vulputate sapien. Fusce vel lacus fermentum, efficitur ipsum.",status:R.b.not_attempted,story:"sidequest-2.1",xp:3,gradingStatus:R.d.none},{category:R.a.Path,closeAt:"2069-04-20T01:23:45.111Z",coverImage:"https://fakeimg.pl/700x400/417678,64/?text=%E3%83%91%E3%82%B9&font=noto",grade:0,id:6,maxGrade:0,maxXp:200,openAt:"2018-01-01T00:00:00.000Z",title:"Basic logic gates",shortSummary:"This mock path serves as a demonstration of the support provided for mock programming path functionality.",status:R.b.not_attempted,story:null,xp:0,gradingStatus:R.d.excluded},{category:R.a.Practical,closeAt:"2048-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/?text=Hello",grade:4,id:5,maxGrade:3e3,maxXp:1e3,openAt:"2018-07-18T05:24:26.026Z",title:"A sample Practical",shortSummary:"Once upon a time, Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin nec vulputate sapien. Fusce vel lacus fermentum, efficitur ipsum.",status:R.b.not_attempted,story:"sidequest-2.1",xp:3,gradingStatus:R.d.none,private:!0}],...[{category:R.a.Mission,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000/000",grade:2700,id:4,maxGrade:3e3,maxXp:1e3,openAt:"2007-07-18T05:24:26.026Z",title:"A closed Mission",shortSummary:"This is a test for the grading status tooltip when the assessment is partially graded (undergoing manual grading). It should render as an orange clock.",status:R.b.submitted,story:"mission-3",xp:800,gradingStatus:R.d.grading},{category:R.a.Sidequest,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000,128/000,255",grade:1950,id:5,maxGrade:3e3,maxXp:1e3,openAt:"2007-07-18T05:24:26.026Z",title:"Closed (not graded) Sidequest",shortSummary:"This is a test for the grading status tooltip when the assessment is not graded. It should render as a red cross.",status:R.b.submitted,story:null,xp:500,gradingStatus:R.d.none},{category:R.a.Sidequest,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000,128/000,255",grade:300,id:5,maxGrade:700,maxXp:500,openAt:"2007-07-18T05:24:26.026Z",title:"Closed (fully graded) Sidequest",shortSummary:"This is a test for the grading status tooltip when the assessment is fully graded. It should render as a green tick. This sidequest links to the mock Sidequest 4.",status:R.b.submitted,story:null,xp:150,gradingStatus:R.d.graded},{category:R.a.Sidequest,closeAt:"2008-06-18T05:24:26.026Z",coverImage:"https://fakeimg.pl/350x200/ff0000/000",grade:0,id:5,maxGrade:0,maxXp:0,openAt:"2007-07-18T05:24:26.026Z",title:"Ungraded assessment",shortSummary:"This is a test for the grading status tooltip when the assessment does not require manual grading (e.g. paths and contests). It should render as a blue disable sign. This sidequest links to the mock Sidequest 4.",status:R.b.submitted,story:null,xp:100,gradingStatus:R.d.excluded}]],B=[["testNumber",3.141592653589793],["testString","who dat boi"],["testBooleanTrue",!0],["testBooleanFalse",!1],["testBooleanUndefined",void 0],["testBooleanNull",null],["testObject",{a:1,b:2}],["testArray",[1,2,"a","b"]]],U={chapter:4,external:{name:D.a.SOUNDS,symbols:D.b.get(D.a.SOUNDS)},globals:B},F={chapter:1,external:{name:D.a.RUNES,symbols:D.b.get(D.a.RUNES)},globals:B},H={chapter:4,external:{name:D.a.CURVES,symbols:D.b.get(D.a.CURVES)},globals:B},V={chapter:4,external:{name:D.a.SOUNDS,symbols:["get_matrix"]},globals:B},q=[{autogradingResults:[],answer:null,content:"\n  This question has an id of `0`.\n  \n  ```\n  What's your favourite dinner food?\n  ```\n  ",roomId:null,id:0,library:U,prepend:'const pizza = "pizza";\n  const sushi = "sushi";\n  const chickenrice = "chicken rice";',postpend:"// This is a mock Postpend! You shouldn't be able to see me!",testcases:[{type:R.g.public,program:"answer();",score:1,answer:'"pizza"'},{type:R.g.public,program:"answer();",score:1,answer:'"sushi"'},{type:R.g.public,program:"answer();",score:1,answer:'"chicken rice"'}],solutionTemplate:"function answer() {\n      // Write something here!\n  }\n  ",type:"programming",xp:0,grade:0,maxGrade:2,maxXp:2},{autogradingResults:[],answer:"function areaOfCircle(x) {\n      return square(x) * pi;\n  }\n  \n  function volumeOfSphere(x) {\n      return 4 / 3 * cube(x) * pi;\n  }",roomId:"19422043",content:"Hello and welcome to this assessment! This is the 1st question.",id:1,library:F,prepend:"const square = x => x * x;\n  const cube = x => x * x * x;\n  const pi = 3.1415928;",postpend:"",testcases:[{type:R.g.public,program:"areaOfCircle(5);",score:1,answer:"78.53982"},{type:R.g.public,program:"volumeOfSphere(5);",score:1,answer:"523.5988"}],solutionTemplate:"function areaOfCircle(x) {\n      // return area of circle\n  }\n  \n  function volumeOfSphere(x) {\n      // return volume of sphere\n  }",type:"programming",xp:0,grade:0,maxGrade:2,maxXp:2},{answer:3,roomId:"19422046",content:"This is the 3rd question. Oddly enough, it is an ungraded MCQ question that uses the curves library! Option C has a null hint!",choices:[{content:"**Option** `A`",hint:"_hint_ A is `here`"},{content:"### B",hint:"hint B"},{content:"C",hint:null},{content:"D",hint:"hint D"}],id:2,library:H,type:"mcq",solution:0,xp:0,grade:0,maxGrade:2,maxXp:2},{answer:3,roomId:null,content:"This is the 4rth question. Oddly enough, it is a graded MCQ question that uses the curves library!",choices:[{content:"A",hint:null},{content:"B",hint:null},{content:"C",hint:null},{content:"D",hint:null}],id:3,library:H,type:"mcq",solution:null,xp:0,grade:0,maxGrade:2,maxXp:2},{autogradingResults:[],answer:null,roomId:"19422032",content:"You have reached the last question! Have some fun with the tone matrix...",id:4,library:V,prepend:"",postpend:"",testcases:[],solutionTemplate:"5th question mock solution template",type:"programming",xp:0,grade:0,maxGrade:2,maxXp:2}],X=[{answer:"function fibonacci(n) {\n      if (n <= 2) {\n          return 1;\n      } else {\n          return fibonacci(n-1) + fibonacci(n-2);\n      }\n  }",roomId:"19422032",content:"You can see autograding results!!!",id:0,library:H,prepend:"",postpend:"// This is a mock Postpend! You shouldn't be able to see me!",testcases:[{type:R.g.public,program:"fibonacci(3);",score:1,answer:"2"},{type:R.g.public,program:"fibonacci(4);",score:1,answer:"3"},{type:R.g.public,program:"fibonacci(5);",score:1,answer:"5"}],solutionTemplate:"function fibonacci(n) {\n      // Your answer here\n  }",type:"programming",grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:0,grade:0,maxGrade:2,maxXp:2,comments:"Good job. You are awarded the full marks!\n  \n  ----\n  ## markdown test\n  \n  # header\n  \n  **bold**\n  \n  _italics_\n  \n  * list\n  \n  1. numbered list\n  \n  - [] checkboxes\n  \n  > quote\n  \n      code\n  \n  [link to Source Academy](https://sourceacademy.nus.edu.sg)  \n  \n  ![](image-url-goes-here)",autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:1,location:"student",errorLine:"function fibonacci(n) {",errorExplanation:"Just kidding!"}]}]},{answer:"function recurse(rune, n) {\n      return n <= 1 ? rune : make_cross(recurse(rune, n - 1));\n  }",roomId:"19422033",content:"This is a runes question - there are no testcases nor autograding results.",id:1,library:F,prepend:"",postpend:"",testcases:[],solutionTemplate:"function recurse(rune, n) {\n      // Your answer here\n  }",type:"programming",grader:{name:"some avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:0,grade:0,maxGrade:2,maxXp:2,comments:"You open the Report Card, not knowing what to expect...\n  \n      ## WOW!\n      Amazing grasp of runes. We can now move on to the next assignment.\n      \n      <br/>\n      \n      Robot Dog: `woof`\n      \n      You look at the display of the robot dog.\n      \n          FEED ME\n      1. Bread\n      2. Water\n      \n      <br/>\n      \n      * I am hungry.\n      * I am thirsty.\n      \n      <br/>\n      <br/>\n          \n      New message from **Avenger**!\n      \n      > _Cadet, please meet me at Level X-05, outside the pod bay doors. There is an important mission awaiting us._\n      \n      > _May the [Source](https://sourceacademy.nus.edu.sg) be with you._\n      \n      > Best regards, Avocado A. Avenger\n      \n      #### Upcoming Tasks\n      - [] Meet Avenger Avenger at Level X-05\n      - [] Open the Pod Bay Doors",autogradingResults:[]}],$=[{answer:null,roomId:null,content:"As a recap: which of the following is not a valid logic gate?",choices:[{content:"XOR gate",hint:"This is the exclusive-OR gate!"},{content:"IF gate",hint:"Correct!"},{content:"AND gate",hint:"This logic gate exists!"},{content:"OR gate",hint:"This logic gate exists!"}],id:0,library:F,type:"mcq",solution:1,xp:0,grade:0,maxGrade:0,maxXp:0},{autogradingResults:[],answer:null,roomId:null,content:"An AND gate is a digital logic gate that implements logical conjunction on its inputs. It returns a single output that is HIGH (active) iff all the inputs to the AND gate are HIGH (active).\n  \n  In this question, let us model an AND gate as a function, and treat HIGH (active) inputs as the boolean value `true` and LOW (inactive) inputs as the boolean value `false`.\n  \n  As an AND gate is not restricted to exactly two inputs, our function shall be the same. Implement the function `AND(inputs)` which takes in the list `inputs` (a list of boolean values), and returns the output of the AND gate as a boolean. You may assume the list `inputs` is of minimum length 2.\n  \n  This question makes use of the sentinel function method to throw custom errors for each testcase.",id:1,library:F,prepend:"const OR = (x, y) => x || y;",postpend:"\n  const __AND = (xs) => {\n    if (AND(list(true, true)) === undefined) {\n      error('Your function is empty!');\n    } else {}\n    \n    const result = AND(xs);\n  \n    if (!is_boolean(result)) {\n      error('Your function does not return a boolean!');\n    } else {}\n    \n    if (equal(xs, list(true, false)) && result) {\n      error('Check the truth table for an AND gate again!');\n    } else if (equal(xs, list(true, true, false)) && result) {\n      error('Are you using all inputs in the list?');\n    } else if (equal(xs, list(true, true, true)) && !result) {\n      error('Are you sure your base case is correct?');\n    } else if (AND(list(true, true)) === AND(list(false, false))) {\n      error('Oi! Do not hardcode values!');\n    } else {\n      return result;\n    }\n  };",testcases:[{type:R.g.public,program:"__AND(list(true, false));",score:0,answer:"false"},{type:R.g.public,program:"__AND(list(true, true, false));",score:0,answer:"false"},{type:R.g.public,program:"__AND(list(true, OR(true, false), OR(true, true)));",score:0,answer:"true"},{type:R.g.hidden,program:"__AND(list(true, OR(false, true), AND(list(true, false)), false));",score:0,answer:"false"},{type:R.g.hidden,program:"__AND(list(true, OR(true, false), OR(true, AND(list(false, true))), true));",score:0,answer:"true"}],solutionTemplate:"function AND(inputs) {\n      // Your answer here!\n  }",type:"programming",xp:0,grade:0,maxGrade:0,maxXp:0},{autogradingResults:[],answer:null,roomId:null,content:"The XOR (exclusive-OR) gate is a digital logic gate that accepts two inputs and returns a single output that is HIGH (active) iff one of the inputs are HIGH (active), but not both.\n  \n  In this question, let us model the XOR gate as a function. Implement the function `XOR(x, y)` which takes two boolean inputs `x` and `y` and which returns the output of the XOR gate as a boolean.\n  \n  This question makes use of the wrapping container method to throw custom errors for each testcase.",id:2,library:F,prepend:"",postpend:"\n  const __XOR = (x, y) => {\n    if (XOR(false, false) === undefined) {\n      error('Your function is empty!');\n    } else {}\n    \n    const result = XOR(x, y);\n  \n    if (!is_boolean(result)) {\n      error('Your function does not return a boolean!');\n    } else {}\n    \n    if (((x && !y) || (y && !x)) && !result) {\n      error('Check your truth tables!');\n    } else if (XOR(false, false) === XOR(false, true)) {\n      error('Oi! Do not hardcode values!');\n    } else {\n      return result;\n    }\n  };",testcases:[{type:R.g.public,program:"__XOR(true, false);",score:0,answer:"true"},{type:R.g.public,program:"__XOR(false, true);",score:0,answer:"true"},{type:R.g.hidden,program:"__XOR(true, XOR(true, false));",score:0,answer:"false"}],solutionTemplate:"function XOR(x, y) {\n      // Your answer here!\n  }",type:"programming",xp:0,grade:0,maxGrade:0,maxXp:0},{autogradingResults:[],answer:null,roomId:null,content:"The NOR logic gate is special in that it is an _universal logic gate_, that is to say, they can be composed to form any other logic gate.\n  \n  Implement the AND logic gate **using ONLY the NOR logic gate**, as the `NOR_AND(x, y)` function that takes in two booleans as input.\n  \n  The `NOR` function modeled after a NOR gate is provided for you - it accepts two boolean values and returns `true` iff both inputs are `false`.",id:3,library:F,prepend:"\n  let counter = 0;\n  const NOR = (x, y) => {\n    counter = counter + 1;\n    return !(x || y);\n  };",postpend:"\n  const __NOR_AND = (x, y) => {\n    if (NOR_AND(false, false) === undefined) {\n      error('Your function is empty!');\n    } else {}\n    \n    counter = 0;\n    const result = NOR_AND(x, y);\n  \n    if (!is_boolean(result)) {\n      error('Your function does not return a boolean!');\n    } else {}\n    \n    if (!x && y && result) {\n      error('Check your truth tables!');\n    } else if (x && y && !result && counter > 0) {\n      error('Nope! Try again :)');\n    } else if (x && y && !result) {\n      error('...You did not use NOR and still got it wrong!');\n    } else if (x && y && result && counter !== 3) {\n      error('Did you use NOR in your solution? >:(');\n    } else if (x && !y && counter !== 6) {\n      error('Incorrect number of calls.');\n    } else {\n      return result;\n    }\n  };",testcases:[{type:R.g.public,program:"__NOR_AND(false, true);",score:0,answer:"false"},{type:R.g.public,program:"__NOR_AND(true, true);",score:0,answer:"true"},{type:R.g.hidden,program:"__NOR_AND(true, NOR_AND(false, true));",score:0,answer:"false"}],solutionTemplate:"function NOR_AND(x, y) {\n      // Your answer here!\n  }",type:"programming",xp:0,grade:0,maxGrade:0,maxXp:0}],W=[{category:"Mission",id:1,longSummary:"This is the mission briefing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis vestibulum. Etiam in egestas dolor. Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum, vel ornare metus turpis sed justo. Vivamus at tellus sed ex convallis commodo at in lectus. Pellentesque pharetra pulvinar sapien pellentesque facilisis. Curabitur efficitur malesuada urna sed aliquam. Quisque massa metus, aliquam in sagittis non, cursus in sem. Morbi vel nunc at nunc pharetra lobortis. Aliquam feugiat ultricies ipsum vel sollicitudin. Vivamus nulla massa, hendrerit sit amet nibh quis, porttitor convallis nisi. ",missionPDF:"www.google.com",questions:q,title:"An Odessey to Runes"},{category:"Mission",id:2,longSummary:"This is the mission briefing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis vestibulum. Etiam in egestas dolor. Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum, vel ornare metus turpis sed justo. Vivamus at tellus sed ex convallis commodo at in lectus. Pellentesque pharetra pulvinar sapien pellentesque facilisis. Curabitur efficitur malesuada urna sed aliquam. Quisque massa metus, aliquam in sagittis non, cursus in sem. Morbi vel nunc at nunc pharetra lobortis. Aliquam feugiat ultricies ipsum vel sollicitudin. Vivamus nulla massa, hendrerit sit amet nibh quis, porttitor convallis nisi. ",missionPDF:"www.google.com",questions:q,title:"The Secret to Streams"},{category:R.a.Sidequest,id:3,longSummary:"###This is the sidequest briefing.\n  \n  *Lorem ipsum* dolor sit amet, consectetur adipiscing elit.\n  \n  > Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin\n  enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis\n  vestibulum.\n  \n  - Etiam in egestas dolor.\n  - Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum,\n    vel ornare metus turpis sed justo.\n  - Vivamus at tellus sed ex convallis commodo at in lectus.\n  \n  ```\n  Pellentesque\n  pharetra\n  pulvinar\n  sapien\n  ```",missionPDF:"www.google.com",questions:q,title:"A sample Sidequest"},{category:R.a.Mission,id:4,longSummary:"This is the closed mission briefing. The save button should not be there. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas viverra, sem scelerisque ultricies ullamcorper, sem nibh sollicitudin enim, at ultricies sem orci eget odio. Pellentesque varius et mauris quis vestibulum. Etiam in egestas dolor. Nunc consectetur, sapien sodales accumsan convallis, lectus mi tempus ipsum, vel ornare metus turpis sed justo. Vivamus at tellus sed ex convallis commodo at in lectus. Pellentesque pharetra pulvinar sapien pellentesque facilisis. Curabitur efficitur malesuada urna sed aliquam. Quisque massa metus, aliquam in sagittis non, cursus in sem. Morbi vel nunc at nunc pharetra lobortis. Aliquam feugiat ultricies ipsum vel sollicitudin. Vivamus nulla massa, hendrerit sit amet nibh quis, porttitor convallis nisi. ",missionPDF:"www.google.com",questions:X,title:"A Closed Mission"},{category:R.a.Sidequest,id:5,longSummary:"This is the closed sidequest briefing. The save button should not exist. This is a placeholder sidequest for testing rendering of grading statuses.",missionPDF:"www.google.com",questions:X,title:"A Closed Sidequest"},{category:R.a.Path,id:6,longSummary:"### Basic logic gates\n  \n  This path is intended to demonstrate concepts from the lecture **Logic Circuits**. You are strongly encouraged to attempt this path to check your understanding, prior to the next Studio session. For this, you will be granted a small amount of XP!\n  \n  The path comprises 4 questions and is fully autograded and guided, and there are **no private test cases** - there will be no manual review by default. Please consult your Avenger if you require assistance!</TEXT>",missionPDF:"www.google.com",questions:$,title:"A sample guided path"}];var z=s(82);let K;!function(e){e.student="student",e.trainer="trainer",e.admin="admin"}(K||(K={}));const Y=(e,t=K.trainer)=>t,Q=[{id:1,type:z.a.deadline,assessment_id:3,assessment_type:R.a.Sidequest,assessment_title:"The Secret to Streams"},{id:2,type:z.a.autograded,assessment_id:4,assessment_type:R.a.Mission,assessment_title:"A Closed Mission"},{id:3,type:z.a.graded,assessment_id:4,assessment_type:R.a.Mission,assessment_title:"A Closed Mission"},{id:4,type:z.a.new,assessment_id:6,assessment_type:R.a.Path,assessment_title:"Basic Logic"},{id:5,type:z.a.new,assessment_id:7,assessment_type:R.a.Mission,assessment_title:"Symphony of the Winds"},{id:6,type:z.a.submitted,submission_id:1,assessment_type:R.a.Mission,assessment_title:"Mission 0"},{id:7,type:z.a.submitted,submission_id:2,assessment_type:R.a.Mission,assessment_title:"Mission 1"},{id:8,type:z.a.submitted,submission_id:3,assessment_type:R.a.Mission,assessment_title:"Mission 0"}],J=[{gradeAdjustment:0,xpAdjustment:0,assessmentCategory:"Mission",assessmentId:0,assessmentName:"Mission 0 ",currentGrade:69,currentXp:69,xpBonus:10,initialGrade:69,initialXp:69,maxGrade:100,maxXp:100,studentId:0,studentName:"Al Gorithm",submissionId:1,submissionStatus:"submitted",groupName:"1D",gradingStatus:"graded",questionCount:6,gradedCount:6},{gradeAdjustment:-2,xpAdjustment:-2,assessmentCategory:"Mission",assessmentId:1,assessmentName:"Mission 1",currentGrade:-2,currentXp:-2,xpBonus:12,initialGrade:0,initialXp:0,maxGrade:400,maxXp:400,studentId:0,studentName:"Dee Sign",submissionId:2,submissionStatus:"submitted",groupName:"1F",gradingStatus:"grading",questionCount:6,gradedCount:2},{gradeAdjustment:4,xpAdjustment:4,assessmentCategory:"Mission",assessmentId:0,assessmentName:"Mission 0",currentGrade:1e3,currentXp:1e3,xpBonus:12,initialGrade:996,initialXp:996,maxGrade:1e3,maxXp:1e3,studentId:1,studentName:"May Trix",submissionId:3,submissionStatus:"submitted",groupName:"1F",gradingStatus:"none",questionCount:6,gradedCount:0}],Z=[{question:{answer:"function remainder(n, d) {\n  return (n - d) < 0 ? n : remainder(n - d, d);\n}",content:"\nHello and welcome to this assessment! This is the *0th question*.\n\n```\n>>> import this\n```\n",prepend:"// THIS IS A PREPEND",postpend:"// THIS IS A POSTPEND",testcases:[{type:R.g.public,program:"remainder(12, 7);",score:1,answer:"5"},{type:R.g.public,program:"remainder(6, 1);",score:2,answer:"0"},{type:R.g.private,program:"remainder(-15, 6);",score:2,answer:"-3"},{type:R.g.private,program:"remainder(17, 23) === 17;",score:2,answer:"true"}],roomId:null,id:0,library:F,solutionTemplate:"0th question mock solution template",solution:"This is how the 0th question is solved. [7 points]\n\nfunction remainder(n, d) {\n  return n % d;\n}",type:"programming",maxGrade:1e3,maxXp:1e3,grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:1,grade:1,autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"dummyErrorType"}]},{resultType:"error",errors:[{errorType:"systemError",errorMessage:"Cannot read property 'getUniformLocation' of null"}]},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:2,location:"student",errorLine:"return (n - d) < 0 ? n : remainder(n - d, d)",errorExplanation:"Missing semicolon at the end of statement"}]}]},grade:{gradeAdjustment:0,xpAdjustment:0,grade:0,xp:0,roomId:"19422040",comments:"Good job. You are awarded the full marks!\n\n----\n## markdown test\n\n# header\n\n**bold**\n\n_italics_\n\n* list\n\n1. numbered list\n\n- [] checkboxes\n\n> quote\n\n    code\n\n[link to Source Academy](https://sourceacademy.nus.edu.sg)\n\n![](image-url-goes-here)\n      ",grader:{name:"HARTIN MENZ",id:100},gradedAt:"2019-08-16T13:26:32+00:00"},student:{name:"Al Gorithm",id:0}},{question:{prepend:"",postpend:"",testcases:[],answer:"This student's answer to the 1st question",roomId:null,content:"Hello and welcome to this assessment! This is the 1st question.",id:1,library:F,solutionTemplate:"1st question mock solution template",solution:null,type:"programming",maxGrade:200,maxXp:200,grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:1,grade:1,autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:1,location:"student",errorLine:"function fibonacci(n) {",errorExplanation:"Just kidding!"}]}]},grade:{gradeAdjustment:0,xpAdjustment:0,grade:100,xp:100,roomId:"19422040",comments:"You open the Report Card, not knowing what to expect...\n\n## WOW!\nAmazing grasp of runes. We can now move on to the next assignment.\n\n<br/>\n\nRobot Dog: `woof`\n\nYou look at the display of the robot dog.\n\n    FEED ME\n1. Bread\n2. Water\n\n<br/>\n\n* I am hungry.\n* I am thirsty.\n\n<br/>\n<br/>\n\nNew message from **Avenger**!\n\n> _Cadet, please meet me at Level X-05, outside the pod bay doors. There is an important mission awaiting us._\n\n> _May the [Source](https://sourceacademy.nus.edu.sg) be with you._\n\n> Best regards, Avocado A. Avenger\n\n#### Upcoming Tasks\n- [] Meet Avenger Avenger at Level X-05\n- [] Open the Pod Bay Doors\n      "},student:{name:"Al Gorithm",id:0}},{question:{prepend:"",postpend:"",testcases:[],answer:3,roomId:null,solution:2,content:"Hello and welcome to this assessment! This is the 2nd question. Oddly enough, it is an MCQ question!",choices:[{content:"A",hint:"hint A"},{content:"B",hint:"hint B"},{content:"C",hint:"hint C"},{content:"D",hint:"hint D"}],id:2,library:F,type:"mcq",maxGrade:100,maxXp:100,grader:{name:"avenger",id:1},gradedAt:"2038-06-18T05:24:26.026Z",xp:1,grade:1,autogradingResults:[{resultType:"pass"},{resultType:"fail",expected:"8",actual:"5"},{resultType:"error",errors:[{errorType:"timeout"},{errorType:"syntax",line:1,location:"student",errorLine:"function fibonacci(n) {",errorExplanation:"Just kidding!"}]}]},grade:{gradeAdjustment:0,xpAdjustment:0,grade:50,xp:50,roomId:"19422030"},student:{name:"Al Gorithm",id:0}}],ee=[{leaderName:"John",groupName:"Mock Group 1",ungradedMissions:123,submittedMissions:200,ungradedSidequests:100,submittedSidequests:117},{leaderName:"Molly",groupName:"Mock Group 2",ungradedMissions:1232,submittedMissions:205430,ungradedSidequests:345,submittedSidequests:11547},{leaderName:"Lenny",groupName:"Mock Group 3",ungradedMissions:1532,submittedMissions:22200,ungradedSidequests:134500,submittedSidequests:6777}];function*te(){yield Object(N.h)(P.d,(function*(e){mt.dispatch(M.a.setTokens({accessToken:"accessToken",refreshToken:"refreshToken"})),mt.dispatch(M.a.setUser({userId:123,name:"DevStaff",role:"staff",group:"1F",story:{story:"mission-1",playStory:!0},grade:0,gameState:{}})),yield L.a.push("/academy")})),yield Object(N.h)(R.c,(function*(){yield Object(N.d)(M.a.updateAssessmentOverviews([...G]))})),yield Object(N.h)(P.b,(function*(e){const t=e.payload,s=W[t-1];yield Object(N.d)(M.a.updateAssessment({...s}))})),yield Object(N.h)(P.f,(function*(e){yield Object(N.f)((e=>e.session.accessToken));const t=e.payload,s=yield Object(N.a)((()=>((e,t)=>{const s=[K.admin,K.trainer],a=Y();return null!==a&&s.includes(a)?t?[J[0]]:J.sort(((e,t)=>e.assessmentId!==t.assessmentId?t.assessmentId-e.assessmentId:t.submissionId-e.submissionId)):null})(0,t)));null!==s&&(yield Object(N.d)(M.a.updateGradingOverviews([...s])))})),yield Object(N.h)(P.e,(function*(e){const t=e.payload,s=(yield Object(N.f)((e=>e.session.accessToken)),yield Object(N.a)((()=>((e,t)=>{const s=[K.admin,K.trainer],a=Y();return null!==a&&s.includes(a)?Z:null})())));null!==s&&(yield Object(N.d)(M.a.updateGrading(t,[...s])))})),yield Object(N.h)(P.s,(function*(e){const t=e.payload.id,s=e.payload.answer,a=yield Object(N.f)((e=>e.workspaces.assessment.currentAssessment)),n=yield Object(N.f)((e=>e.session.assessments.get(a))),i=n.questions.slice().map((e=>(e.id===t&&(e.answer=s),e))),r={...n,questions:i};return yield Object(N.d)(M.a.updateAssessment(r)),yield Object(N.a)(_.d,"Saved!",1e3),yield Object(N.d)(M.a.updateHasUnsavedChanges("assessment",!1))})),yield Object(N.h)(P.w,(function*(e){const{submissionId:t}=e.payload,s=yield Object(N.f)((e=>e.session.gradingOverviews||[]));if(-1===s.findIndex((e=>e.submissionId===t&&"submitted"===e.submissionStatus)))return void(yield Object(N.a)(_.e,"400: Bad Request"));const a=s.map((e=>e.submissionId===t?{...e,submissionStatus:"attempted"}:e));yield Object(N.a)(_.d,"Unsubmitted!",1e3),yield Object(N.d)(M.a.updateGradingOverviews(a))}));const e=function*(e){const{submissionId:t,questionId:s,gradeAdjustment:a,xpAdjustment:n,comments:i}=e.payload,r=(yield Object(N.f)((e=>e.session.gradings.get(t)))).slice().map((e=>(e.question.id===s&&(e.grade={gradeAdjustment:a,xpAdjustment:n,roomId:e.grade.roomId,grade:e.grade.grade,xp:e.grade.xp,comments:i}),e)));yield Object(N.d)(M.a.updateGrading(t,r)),yield Object(N.a)(_.d,"Submitted!",1e3)};yield Object(N.h)(P.u,e),yield Object(N.h)(P.v,(function*(t){const{submissionId:s}=t.payload;yield*e(t);const a=yield Object(N.f)((e=>e.workspaces.grading.currentQuestion));yield L.a.push(`/academy/grading/${s}/${(a||0)+1}`)})),yield Object(N.h)(P.a,(function*(e){const t=e.payload.withFilter,s=yield Object(N.f)((e=>e.session.notifications));let a=s;if(t&&(a=t(s)),0===a.length)return;const n=a.map((e=>e.id)),i=s.filter((e=>!n.includes(e.id)));yield Object(N.d)(M.a.updateNotifications(i))})),yield Object(N.h)(P.g,(function*(e){yield Object(N.d)(M.a.updateNotifications(Q))})),yield Object(N.h)(g.a,(function*(){yield Object(N.d)(M.a.updateGroupGradingSummary([...ee]))}))}var se=s(32),ae=s(29);function*ne(){yield Object(ae.a)(h.c,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload;yield Object(N.a)(se.a,s,t)})),yield Object(ae.a)(h.d,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload;yield Object(N.a)(se.b,s,t)})),yield Object(ae.a)(h.e,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload;yield Object(N.a)(se.g,s,t)})),yield Object(ae.a)(h.f,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload;yield Object(N.a)(se.i,s,t)})),yield Object(ae.a)(h.h,(function*(){const e=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),t=yield Object(N.a)(se.k,e);t&&(yield Object(N.d)(M.a.saveAchievements(t)))})),yield Object(ae.a)(h.i,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload,a=yield Object(N.a)(se.o,t,s);a&&(yield Object(N.d)(M.a.saveGoals(a)))})),yield Object(ae.a)(h.j,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=yield Object(N.a)(se.t,t);s&&(yield Object(N.d)(M.a.saveGoals(s)))})),yield Object(ae.a)(h.l,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload;yield Object(N.a)(se.K,s,t)})),yield Object(ae.a)(h.m,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),s=e.payload;yield Object(N.a)(se.L,s,t)})),yield Object(ae.a)(h.p,(function*(e){const t=yield Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken}))),{studentId:s,progress:a}=e.payload;yield Object(N.a)(se.N,s,a,t)}))}var ie=s(117);function re(e){const t=C.b.authProviders.get(e);if(!t)return;const s=""===window.location.port?"":`:${window.location.port}`;return`${window.location.protocol}//${window.location.hostname}${s}/login${t.isDefault?"":"?provider="+encodeURIComponent(e)}`}function oe(){return Object(N.f)((e=>({accessToken:e.session.accessToken,refreshToken:e.session.refreshToken})))}function*ce(e){return e&&e.ok?yield Object(N.a)(_.d,"Autograde job queued successfully."):e&&400===e.status?yield Object(N.a)(_.e,"Cannot reautograde non-submitted submission."):yield Object(N.a)(_.e,"Failed to queue autograde job.")}var de=function*(){yield Object(ae.a)(P.d,(function*(e){const{code:t,providerId:s}=e.payload,a=s||([...C.b.authProviders.entries()].find((([e,{isDefault:t}])=>t))||[null])[0];if(!a)return yield Object(N.a)(_.e,"Could not log in; invalid provider or no providers configured."),yield L.a.push("/");const n=function(e){const t=C.b.authProviders.get(e);if(t)try{return new URL(t.endpoint).searchParams.get("client_id")||void 0}catch(s){return t.endpoint||void 0}}(a),i=re(a),r=yield Object(N.a)(se.B,t,a,n,i);if(!r)return yield L.a.push("/");const o=yield Object(N.a)(se.w,r);if(!o)return yield L.a.push("/");yield Object(N.d)(M.a.setTokens(r)),yield Object(N.d)(M.a.setUser(o)),yield L.a.push("/academy")})),yield Object(ae.a)(R.c,(function*(){const e=yield oe(),t=yield Object(N.a)(se.m,e);t&&(yield Object(N.d)(M.a.updateAssessmentOverviews(t)))})),yield Object(ae.a)(P.b,(function*(e){const t=yield oe(),s=e.payload,a=yield Object(N.a)(se.l,s,t);a&&(yield Object(N.d)(M.a.updateAssessment(a)))})),yield Object(ae.a)(P.s,(function*(e){const t=yield oe(),s=e.payload.id,a=e.payload.answer,n=yield Object(N.a)(se.z,s,a,t);if(!n||!n.ok)return yield Object(se.x)(n);yield Object(N.a)(_.d,"Saved!",1e3);const i=yield Object(N.f)((e=>e.workspaces.assessment.currentAssessment)),r=yield Object(N.f)((e=>e.session.assessments.get(i))),o=r.questions.slice().map((e=>e.id===s?{...e,answer:a}:e)),c={...r,questions:o};return yield Object(N.d)(M.a.updateAssessment(c)),yield Object(N.d)(M.a.updateHasUnsavedChanges("assessment",!1))})),yield Object(ae.a)(R.f,(function*(e){const t=yield oe(),s=e.payload,a=yield Object(N.a)(se.A,s,t);if(!a||!a.ok)return yield Object(se.x)(a);yield Object(N.a)(_.d,"Submitted!",2e3);const n=(yield Object(N.f)((e=>e.session.assessmentOverviews))).map((e=>e.id===s?{...e,status:R.b.submitted}:e));return yield Object(N.d)(M.a.updateAssessmentOverviews(n))})),yield Object(ae.a)(P.f,(function*(e){const t=yield oe(),s=e.payload,a=yield Object(N.a)(se.q,t,s);a&&(yield Object(N.d)(M.a.updateGradingOverviews(a)))})),yield Object(ae.a)(P.e,(function*(e){const t=yield oe(),s=e.payload,a=yield Object(N.a)(se.p,s,t);a&&(yield Object(N.d)(M.a.updateGrading(s,a)))})),yield Object(ae.a)(P.w,(function*(e){const t=yield oe(),{submissionId:s}=e.payload,a=yield Object(se.H)(s,t);if(!a||!a.ok)return yield Object(se.x)(a);const n=(yield Object(N.f)((e=>e.session.gradingOverviews||[]))).map((e=>e.submissionId===s?{...e,submissionStatus:"attempted"}:e));yield Object(N.a)(_.d,"Unsubmit successful",1e3),yield Object(N.d)(M.a.updateGradingOverviews(n))}));const e=function*(e){if((yield Object(N.f)((e=>e.session.role)))===o.a.Student)return yield Object(N.a)(_.e,"Only staff can submit answers.");const{submissionId:t,questionId:s,gradeAdjustment:a,xpAdjustment:n,comments:i}=e.payload,r=yield oe(),c=yield Object(se.C)(t,s,a,n,r,i);if(!c||!c.ok)return yield Object(se.x)(c);yield Object(N.a)(_.d,"Submitted!",1e3);const d=(yield Object(N.f)((e=>e.session.gradings.get(t)))).slice().map((e=>(e.question.id===s&&(e.grade={gradeAdjustment:a,xpAdjustment:n,roomId:e.grade.roomId,grade:e.grade.grade,xp:e.grade.xp,comments:i}),e)));yield Object(N.d)(M.a.updateGrading(t,d))};yield Object(ae.a)(P.u,e),yield Object(ae.a)(P.v,(function*(t){yield*e(t);const{submissionId:s}=t.payload,a=yield Object(N.f)((e=>e.workspaces.grading.currentQuestion));yield L.a.push(`/academy/grading/${s}/${(a||0)+1}`)})),yield Object(ae.a)(P.m,(function*(e){const t=e.payload,s=yield oe(),a=yield Object(N.a)(se.E,t,s);yield Object(N.a)(ce,a)})),yield Object(ae.a)(P.l,(function*(e){const{submissionId:t,questionId:s}=e.payload,a=yield oe(),n=yield Object(N.a)(se.D,t,s,a);yield Object(N.a)(ce,n)})),yield Object(ae.a)(P.g,(function*(e){const t=yield oe(),s=yield Object(N.a)(se.s,t);yield Object(N.d)(M.a.updateNotifications(s))})),yield Object(ae.a)(P.a,(function*(e){const t=yield oe(),s=e.payload.withFilter,a=yield Object(N.f)((e=>e.session.notifications));let n=a;if(s&&(n=s(a)),0===n.length)return;const i=n.map((e=>e.id)),r=a.filter((e=>!i.includes(e.id)));yield Object(N.d)(M.a.updateNotifications(r));const o=yield Object(N.a)(se.y,t,i);return o&&o.ok?void 0:yield Object(se.x)(o)})),yield Object(ae.a)(v.a,(function*(e){if((yield Object(N.f)((e=>e.session.role)))===o.a.Student)return yield Object(N.a)(_.e,"Only staff can delete sourcecasts.");const t=yield oe(),{id:s}=e.payload,a=yield Object(se.f)(s,t);if(!a||!a.ok)return yield Object(se.x)(a);const n=yield Object(N.a)(se.u,t);n&&(yield Object(N.d)(M.a.updateSourcecastIndex(n,e.payload.workspaceLocation))),yield Object(N.a)(_.d,"Deleted successfully!",1e3)})),yield Object(ae.a)(O.a,(function*(e){const t=yield oe(),s=yield Object(N.a)(se.u,t);s&&(yield Object(N.d)(M.a.updateSourcecastIndex(s,e.payload.workspaceLocation)))})),yield Object(ae.a)(y.d,(function*(e){if((yield Object(N.f)((e=>e.session.role)))===o.a.Student)return yield Object(N.a)(_.e,"Only staff can save sourcecasts.");const{title:t,description:s,uid:a,audio:n,playbackData:i}=e.payload,r=yield oe(),c=yield Object(se.F)(t,s,a,n,i,r);if(!c||!c.ok)return yield Object(se.x)(c);yield Object(N.a)(_.d,"Saved successfully!",1e3),yield L.a.push("/sourcecast")})),yield Object(ae.a)(E.t,(function*(e){const t=yield Object(N.a)(se.v);if(!t)return yield Object(N.a)(_.e,"Failed to load default Source sublanguage for Playground!");yield Object(N.d)(M.a.updateSublanguage(t))})),yield Object(ae.a)(E.j,(function*(e){const t=yield oe(),{sublang:s}=e.payload,a=yield Object(N.a)(se.G,s.chapter,s.variant,t);if(!a||!a.ok)return yield Object(se.x)(a);yield Object(N.d)(M.a.updateSublanguage(s)),yield Object(N.a)(_.d,"Updated successfully!",1e3)})),yield Object(ae.a)(g.a,(function*(e){const t=yield oe(),s=yield Object(N.a)(se.r,t);s&&(yield Object(N.d)(M.a.updateGroupGradingSummary(s)))})),yield Object(ae.a)(ie.a,(function*(e){const t=yield oe(),s=e.payload.id,a=e.payload.closeAt,n=e.payload.openAt,i=yield Object(se.c)(s,a,n,t);if(!i||!i.ok)return yield Object(se.x)(i);yield Object(N.d)(M.a.fetchAssessmentOverviews()),yield Object(N.a)(_.d,"Updated successfully!",1e3)})),yield Object(ae.a)(ie.b,(function*(e){const t=yield oe(),s=e.payload,a=yield Object(se.d)(s,t);if(!a||!a.ok)return yield Object(se.x)(a);yield Object(N.d)(M.a.fetchAssessmentOverviews()),yield Object(N.a)(_.d,"Deleted successfully!",1e3)})),yield Object(ae.a)(ie.c,(function*(e){const t=yield oe(),s=e.payload.id,a=e.payload.togglePublishTo,n=yield Object(se.I)(s,a,t);if(!n||!n.ok)return yield Object(se.x)(n);yield Object(N.d)(M.a.fetchAssessmentOverviews()),a?yield Object(N.a)(_.d,"Published successfully!",1e3):yield Object(N.a)(_.d,"Unpublished successfully!",1e3)})),yield Object(ae.a)(ie.d,(function*(e){const t=yield oe(),s=e.payload.file,a=e.payload.forceUpdate,n=yield Object(se.O)(s,t,a);if(!n||!n.ok)return yield Object(se.x)(n);const i=yield n.text();"OK"===i?yield Object(N.a)(_.d,"Uploaded successfully!",2e3):"Force Update OK"===i&&(yield Object(N.a)(_.d,"Assessment force updated successfully!",2e3)),yield Object(N.d)(M.a.fetchAssessmentOverviews())}))},le=s(119);function*ue(){const e=`https://github.com/login/oauth/authorize?client_id=${Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SW_EXCLUDE_REGEXES:void 0}).REACT_APP_GITHUB_CLIENT_ID}`;new BroadcastChannel("GitHubOAuthAccessToken").onmessage=e=>{mt.dispatch(M.a.setGitHubOctokitInstance(e.data))},yield Object(N.a)(window.open,e,"Connect With OAuth","height=600,width=400")}function*he(){yield mt.dispatch(M.a.removeGitHubOctokitInstance())}var pe=function*(){yield Object(N.i)(P.i,ue),yield Object(N.i)(P.j,he),yield Object(N.i)(le.b,(function*(){})),yield Object(N.i)(le.d,(function*(){})),yield Object(N.i)(le.c,(function*(){})),yield Object(N.i)(le.a,(function*(){}))},ge=s(88);function*me(){yield Object(ae.a)(P.h,be),yield Object(ae.a)(P.r,(e=>{ge.b({id:e.payload.userId.toString()})})),yield Object(ae.a)(d.a,(()=>{ge.b(null)}))}function*be({payload:e}){const t=function(e){const t=C.b.authProviders.get(e);if(t)try{const s=new URL(t.endpoint);return s.searchParams.set("redirect_uri",re(e)),s.toString()}catch(s){return t.endpoint||""}}(e);t?window.location.href=t:yield Object(N.a)(_.e,"Could not log in; invalid provider name provided.")}var je=s(0),ye=s(112),Oe=s(118),ve=s(94);const xe=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],fe="https://www.googleapis.com/upload/drive/v3/files",Se="text/plain";let Ce;const we=new Promise((e=>{Ce=e})).then((async function(){await new Promise(((e,t)=>gapi.load("client:auth2",{callback:e,onerror:t}))),await gapi.client.init({apiKey:C.b.googleApiKey,clientId:C.b.googleClientId,discoveryDocs:xe,scope:"profile https://www.googleapis.com/auth/drive.file"}),gapi.auth2.getAuthInstance().currentUser.listen(Ee),Ee(gapi.auth2.getAuthInstance().currentUser.get())}));function Ee(e){mt.dispatch(M.a.setGoogleUser(e.isSignedIn()?e.getBasicProfile().getEmail():void 0))}function*Ae(){Ce(),yield we}function*Ie(){yield Object(N.a)(Ae),gapi.auth2.getAuthInstance().isSignedIn.get()||(yield gapi.auth2.getAuthInstance().signIn())}function Te(e,t){const s="undefined"!==typeof(null===t||void 0===t?void 0:t.pickFolders)&&(null===t||void 0===t?void 0:t.pickFolders),a="undefined"===typeof(null===t||void 0===t?void 0:t.showFolders)||(null===t||void 0===t?void 0:t.showFolders),n="undefined"===typeof(null===t||void 0===t?void 0:t.showFiles)||(null===t||void 0===t?void 0:t.showFiles);return new Promise((i=>{gapi.load("picker",(()=>{const r=new google.picker.DocsView(n?google.picker.ViewId.DOCS:google.picker.ViewId.FOLDERS);(null===t||void 0===t?void 0:t.rootFolder)&&r.setParent(t.rootFolder),r.setOwnedByMe(!0),r.setIncludeFolders(a),r.setSelectFolderEnabled(s),r.setMode(google.picker.DocsViewMode.LIST);(new google.picker.PickerBuilder).setTitle(e).enableFeature(google.picker.Feature.NAV_HIDDEN).addView(r).setOAuthToken(gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token).setAppId(C.b.googleAppId).setDeveloperKey(C.b.googleApiKey).setCallback((e=>{switch(e[google.picker.Response.ACTION]){case google.picker.Action.PICKED:{const{id:t,name:s,mimeType:a,parentId:n}=e.docs[0];i({id:t,name:s,mimeType:a,parentId:n,picked:!0});break}case google.picker.Action.CANCEL:i({picked:!1})}})).build().setVisible(!0)}))}))}function ke(e,t,s,a="",n){const i={name:e,mimeType:s,parents:[t],appProperties:{source:!0,...n}},{body:r,headers:o}=Pe(i,a,s);return gapi.client.request({path:fe,method:"POST",params:{uploadType:"multipart"},headers:o,body:r}).then((({result:e})=>({id:e.id,name:e.name})))}function Ne(e,t,s,a="",n){const i={name:t,mimeType:s,appProperties:{source:!0,...n}},{body:r,headers:o}=Pe(i,a,s);return gapi.client.request({path:fe+"/"+e,method:"PATCH",params:{uploadType:"multipart"},headers:o,body:r})}function Pe(e,t,s){const a=JSON.stringify(e);let n;do{n=Re()}while(a.includes(n)||t.includes(n));return{body:`--${n}\nContent-Type: application/json; charset=utf-8\n\n${JSON.stringify(e)}\n--${n}\nContent-Type: ${s}\n\n${t}\n--${n}--\n`,boundary:n,headers:{"Content-Type":`multipart/related; boundary=${n}`}}}function Re(){let e="--------------------------";for(let t=0;t<24;t++)e+=Math.floor(10*Math.random()).toString(16);return e}var Me=function*(){yield Object(ae.b)(P.k,(function*(){yield Object(N.d)(M.a.playgroundUpdatePersistenceFile(void 0)),yield Object(N.a)(Ae),yield Object(N.a)([gapi.auth2.getAuthInstance(),"signOut"])})),yield Object(ae.b)(Oe.b,(function*(){let e;try{yield Object(N.a)(Ie);const{id:t,name:s,picked:a}=yield Object(N.a)(Te,"Pick a file to open");if(!a)return;if(!(yield Object(N.a)(ve.a,{title:"Opening from Google Drive",contents:Object(je.jsxs)("p",{children:["Opening ",Object(je.jsx)("strong",{children:s})," will overwrite the current contents of your workspace. Are you sure?"]}),positiveLabel:"Open",negativeLabel:"Cancel"})))return;e=yield Object(N.a)(_.c,{message:"Opening file...",timeout:0,intent:ye.a.PRIMARY});const{result:n}=yield Object(N.a)([gapi.client.drive.files,"get"],{fileId:t,fields:"appProperties"}),i=yield Object(N.a)([gapi.client.drive.files,"get"],{fileId:t,alt:"media"});yield Object(N.d)(M.a.updateEditorValue(i.body,"playground")),yield Object(N.d)(M.a.playgroundUpdatePersistenceFile({id:t,name:s,lastSaved:new Date})),n&&n.appProperties&&(yield Object(N.d)(M.a.chapterSelect(parseInt(n.appProperties.chapter||"4",10),n.appProperties.variant||"default","playground")),yield Object(N.d)(M.a.externalLibrarySelect(Object.values(D.a).find((e=>e===n.appProperties.external))||D.a.NONE,"playground"))),yield Object(N.a)(_.d,`Loaded ${s}.`,1e3)}catch(t){console.error(t),yield Object(N.a)(_.e,"Error while opening file.",1e3)}finally{e&&Object(_.a)(e)}})),yield Object(ae.b)(Oe.d,(function*(){let e;try{yield Object(N.a)(Ie);const[t,s,a,n]=yield Object(N.f)((e=>[e.workspaces.playground.editorValue,e.workspaces.playground.context.chapter,e.workspaces.playground.context.variant,e.workspaces.playground.externalLibrary])),i=yield Object(N.a)(Te,"Pick a folder, or cancel to pick the root folder",{pickFolders:!0,showFolders:!0,showFiles:!1}),r=i.picked?i:{id:"root",name:"My Drive"},o=yield Object(N.a)(Te,`Saving to ${r.name}; pick a file to overwrite, or cancel to save as a new file`,{pickFolders:!1,showFolders:!1,showFiles:!0,rootFolder:r.id});if(o.picked){if(!(yield Object(N.a)(ve.a,{title:"Saving to Google Drive",contents:Object(je.jsxs)("span",{children:["Really overwrite ",Object(je.jsx)("strong",{children:o.name}),"?"]})})))return;yield Object(N.d)(M.a.playgroundUpdatePersistenceFile(o)),yield Object(N.d)(M.a.persistenceSaveFile(o))}else{const i=yield Object(N.a)(ve.b,{title:"Saving to Google Drive",contents:Object(je.jsxs)(je.Fragment,{children:[Object(je.jsxs)("p",{children:["Saving to folder ",Object(je.jsx)("strong",{children:r.name}),"."]}),Object(je.jsx)("p",{children:"Save as name?"})]}),positiveLabel:"Save as new file",negativeLabel:"Cancel",props:{validationFunction:e=>!!e}});if(!i.buttonResponse)return;const o={chapter:s,variant:a,external:n};e=yield Object(N.a)(_.c,{message:`Saving as ${i.value}...`,timeout:0,intent:ye.a.PRIMARY});const c=yield Object(N.a)(ke,i.value,r.id,Se,t,o);yield Object(N.d)(M.a.playgroundUpdatePersistenceFile({...c,lastSaved:new Date})),yield Object(N.a)(_.d,`${i.value} successfully saved to Google Drive.`,1e3)}}catch(t){console.error(t),yield Object(N.a)(_.e,"Error while saving file.",1e3)}finally{e&&Object(_.a)(e)}})),yield Object(ae.a)(Oe.c,(function*({payload:{id:e,name:t}}){let s;try{s=yield Object(N.a)(_.c,{message:`Saving as ${t}...`,timeout:0,intent:ye.a.PRIMARY}),yield Object(N.a)(Ie);const[a,n,i,r]=yield Object(N.f)((e=>[e.workspaces.playground.editorValue,e.workspaces.playground.context.chapter,e.workspaces.playground.context.variant,e.workspaces.playground.externalLibrary])),o={chapter:n,variant:i,external:r};yield Object(N.a)(Ne,e,t,Se,a,o),yield Object(N.d)(M.a.playgroundUpdatePersistenceFile({id:e,name:t,lastSaved:new Date})),yield Object(N.a)(_.d,`${t} successfully saved to Google Drive.`,1e3)}catch(a){console.error(a),yield Object(N.a)(_.e,"Error while saving file.",1e3)}finally{s&&Object(_.a)(s)}})),yield Object(ae.a)(Oe.a,Ae)},Le=s(152),_e=s(173),De=s(97);function*Ge(){yield Object(ae.a)(b.b,Be),yield Object(ae.a)(b.e,(function*(e){const t=yield Object(N.f)((e=>e.playground.queryString)),s=e.payload,a="ERROR";let n,i;try{const{result:e,hasTimedOut:a}=yield Object(N.e)({result:Object(N.a)(Ue,t,s),hasTimedOut:Object(N.b)(1e4)});n=e,i=a}catch(r){}return!n||i?(yield Object(N.d)(Object(De.updateShortURL)(a)),yield Object(N.a)(_.e,"Something went wrong trying to create the link.")):"success"===n.status||n.shorturl?("success"!==n.status&&(yield Object(N.a)(_.d,n.message)),void(yield Object(N.d)(Object(De.updateShortURL)(n.shorturl)))):(yield Object(N.d)(Object(De.updateShortURL)(a)),yield Object(N.a)(_.e,n.message))}))}function*Be(){const e=yield Object(N.f)((e=>e.workspaces.playground.editorValue));if(!e||e===o.g)return void(yield Object(N.d)(Object(De.changeQueryString)("")));const t=e,s=yield Object(N.f)((e=>e.workspaces.playground.context.chapter)),a=yield Object(N.f)((e=>e.workspaces.playground.context.variant)),n=yield Object(N.f)((e=>e.workspaces.playground.externalLibrary)),i=yield Object(N.f)((e=>e.workspaces.playground.execTime)),r=_e.stringify({prgrm:Object(Le.compressToEncodedURIComponent)(t),chap:s,variant:a,ext:n,exec:i});yield Object(N.d)(Object(De.changeQueryString)(r))}async function Ue(e,t){const s=`${window.location.protocol}//${window.location.host}/playground#${e}`,a={signature:C.b.urlShortenerSignature,action:"shorturl",format:"json",keyword:t,url:s},n={method:"POST",body:Object.entries(a).reduce(((e,[t,s])=>(e.append(t,s),e)),new FormData)},i=await fetch(C.b.urlShortener,n);if(!i||!i.ok)return null;return await i.json()}var Fe=s(409),He=s(40),Ve=s(87),qe=s(90),Xe=s(114),$e=s(190),We=s(222),ze=s(65),Ke=s(286),Ye=s(125),Qe=s.n(Ye),Je=s(203),Ze=s(151),et=s(1228),tt=s(221);function st(e){let t="";const s=[[e,0]];for(;s.length>0;){if(s.length>1e3)return t+" ...REDACTED]";const e=s.pop(),a=e[0];let n=e[1];for(0===n&&(t+="[");n<a.length;){const e=a[n];if(Array.isArray(e)){s.push([a,n+1]),s.push([e,0]);break}t+="function"===typeof e?e.toString():JSON.stringify(e),n!==a.length-1&&(t+=","),n++}if(n>=a.length){const e=s[s.length-1];t+="]",e&&e[1]!==e[0].length&&(t+=",")}}return t}function at(e,t){const s=function(e){for(const t of e){const e=Object(tt.infiniteLoopErrorType)(t.explain());if(e)return e}return""}(e.errors);if(s){const a=function(e){const t=[];for(;null!==e;){let s="";for(const[t,a]of e.variables.entries()){const e=a.getValue();""!==s&&(s+="\n"),"function"===typeof e?s+=`${e.toString()}`:Array.isArray(e)?s+=`const ${t}=${st(e)};`:s+=`const ${t}=${JSON.stringify(e)};`}t.unshift(s),e=e.previousScope}return t}(e.nativeStorage.globals);a.shift(),e.chapter>=2&&a.shift();let n=a.reduce(((e,t)=>e+t+"\n{"));return n+=t+"}".repeat(a.length-1),[s,n]}return null}function nt(e,t){ge.c((function(s){s.clearBreadcrumbs(),s.setLevel(et.a.Info),s.setTag("code-type",e),s.setExtra("code",t),s.setFingerprint(["INFINITE_LOOP_LOGGING_FINGERPRINT"]);const a=new Error("Infinite Loop");a.stack="",ge.a(a)}))}var it=s(51);var rt=s(15);let ot,ct,dt=[];function*lt(){let e;yield Object(ae.a)(E.p,(function*(t){const s=t.payload.workspaceLocation,[a,n,i,r,o,c,d,l,u]=yield Object(N.f)((e=>[e.workspaces[s].editorPrepend,e.workspaces[s].editorValue,e.workspaces[s].context.chapter,e.workspaces[s].execTime,e.workspaces[s].context.externalSymbols,e.workspaces[s].externalLibrary,e.workspaces[s].globals,e.workspaces[s].context.variant,e.session.remoteExecutionSession])),h={chapter:i,variant:l,external:{name:c,symbols:o},globals:d};if(u&&u.workspace===s)yield Object(N.d)(M.a.remoteExecRun(n));else{yield Object(N.d)(M.a.beginInterruptExecution(s)),yield Object(N.d)(M.a.beginClearContext(s,h,!1)),yield Object(N.d)(M.a.clearReplOutput(s)),e=yield Object(N.f)((e=>e.workspaces[s].context));let t=n;if(Object(Xe.parse)(t,e),!e.errors.length){const a=n.split("\n");for(const n in dt){if("string"!==typeof n)continue;const i=+n;if(e.errors=[],a[i]="debugger;"+a[i],t=a.join("\n"),Object(Xe.parse)(t,e),e.errors.length){const e="Hint: Misplaced breakpoint at line "+(i+1)+".";yield Object(N.d)(M.a.sendReplInputToOutput(e,s))}}}if(a.length){const t=Object(w.h)(e);yield Object(N.a)(pt,a,t,r,s,E.r),yield*ht(t,e,r,s)}yield Object(N.a)(pt,t,e,r,s,E.p)}})),yield Object(ae.a)(E.x,(function*(t){const s=t.payload.workspaceLocation;e=yield Object(N.f)((e=>e.workspaces[s].context));const a=yield Object(N.f)((e=>[e.workspaces[s].editorPrepend,e.workspaces[s].editorValue])),[n,i]=a;let r,o=0;n?(o=n.split("\n").length,r=n+"\n"+i):r=i;const[c,d]=yield Object(N.a)(He.getNames,r,t.payload.row+o,t.payload.column,e);if(!d)return void(yield Object(N.a)(t.payload.callback));const l=c.map((e=>({caption:e.name,value:e.name,meta:e.meta,score:e.score?e.score+1e3:1e3})));let u=e.chapter.toString();"default"!==e.variant&&(u+="_"+e.variant);const h=Ze.a.builtins[u]||[],p=yield Object(N.f)((e=>e.workspaces[s].externalLibrary)),g=Ze.a.externalLibraries[p]||[];yield Object(N.a)(t.payload.callback,null,l.concat(h,g))})),yield Object(ae.a)(E.B,(function*(e){const t=e.payload.workspaceLocation,s=yield Object(N.f)((e=>e.workspaces[t].isEditorAutorun));yield Object(N.a)(_.e,"Autorun "+(s?"Started":"Stopped"),750)})),yield Object(ae.a)(E.q,(function*(t){const s=t.payload.workspaceLocation,a=yield Object(N.f)((e=>e.workspaces[s].replValue)),n=yield Object(N.f)((e=>e.workspaces[s].execTime));yield Object(N.d)(M.a.beginInterruptExecution(s)),yield Object(N.d)(M.a.clearReplInput(s)),yield Object(N.d)(M.a.sendReplInputToOutput(a,s)),e=yield Object(N.f)((e=>e.workspaces[s].context)),yield Object(N.a)(pt,a,e,n,s,E.q)})),yield Object(ae.a)(x.d,(function*(t){const s=t.payload.workspaceLocation,a=yield Object(N.f)((e=>e.workspaces[s].editorValue)),n=yield Object(N.f)((e=>e.workspaces[s].execTime));yield Object(N.d)(M.a.beginInterruptExecution(s)),yield Object(N.d)(M.a.clearReplOutput(s)),e=yield Object(N.f)((e=>e.workspaces[s].context)),yield Object(N.d)(M.a.highlightEditorLine([],s)),yield Object(N.a)(pt,a,e,n,s,x.d)})),yield Object(ae.a)(x.c,(function*(t){const s=t.payload.workspaceLocation;e=yield Object(N.f)((e=>e.workspaces[s].context)),yield Object(N.d)(M.a.clearReplOutput(s)),Object(w.g)(void 0),Object(w.f)(void 0),yield Object(N.d)(M.a.clearReplOutput(s)),e.runtime.break=!1,ot=void 0})),yield Object(ae.a)(x.l,(function*(e){const t=e.payload.highlightedLines;Object(w.f)(t[0]),yield})),yield Object(ae.a)(E.F,(function*(e){dt=e.payload.breakpoints,yield})),yield Object(ae.a)(E.s,(function*(t){const s=t.payload.workspaceLocation,a=t.payload.testcaseId,i=yield Object(N.f)((e=>[e.workspaces[s].editorPrepend,e.workspaces[s].editorValue,e.workspaces[s].editorPostpend,e.workspaces[s].editorTestcases[a].program])),[r,o,c,d]=i,l=yield Object(N.f)((e=>e.workspaces[s].editorTestcases[a].type)),u=yield Object(N.f)((e=>e.workspaces[s].execTime));e=yield Object(N.f)((e=>e.workspaces[s].context));const h=Object(w.h)(e);yield Object(N.a)(pt,r,h,u,s,E.r);const p=String(Object(n.random)(1048576,68719476736));yield*ht(h,e,u,s,p),yield Object(N.a)(pt,o,e,u,s,E.r),e.errors.length||(c&&(yield*function*(e,t,s,a,n){const i=Object(w.c)(e,t),r=Object(w.d)(i,n);yield Object(N.a)(pt,r,e,s,a,E.r)}(h,e,u,s,p),yield Object(N.a)(pt,c,h,u,s,E.r),yield*ht(h,e,u,s,p)),yield*function*(e,t,s,a,n,i){yield Object(N.d)(M.a.resetTestcase(a,n));const{result:r,interrupted:o}=yield Object(N.e)({result:Object(N.a)(He.runInContext,e,t,{scheduler:"preemptive",originalMaxExecTime:s}),interrupted:Object(N.g)(x.b)});if(o)return Object(He.interrupt)(t),t.errors.push(new qe.InterruptedError(t.runtime.nodes[0])),yield Object(N.d)(M.a.endInterruptExecution(a)),void(yield Object(N.a)(_.e,`Execution of testcase ${n} aborted`,750));"error"===r.status?(yield Object(N.d)(M.a.evalInterpreterError(t.errors,a)),yield Object(N.d)(M.a.evalTestcaseFailure(t.errors,a,n))):"finished"===r.status&&(yield Object(N.d)(M.a.evalInterpreterSuccess(r.value,a)),yield Object(N.d)(M.a.evalTestcaseSuccess(r.value,a,n)));i===R.g.hidden&&(yield Object(N.d)(M.a.clearReplOutputLast(a)))}(d,h,u,s,a,l))})),yield Object(ae.a)(E.k,(function*(e){const{workspaceLocation:t,chapter:s,variant:a}=e.payload,[n,i,r,c,d]=yield Object(N.f)((e=>[e.workspaces[t].context.variant,e.workspaces[t].context.chapter,e.workspaces[t].context.externalSymbols,e.workspaces[t].globals,e.workspaces[t].externalLibrary]));if(s!==i||a!==n){const e={chapter:s,variant:a,external:{name:d,symbols:r},globals:c};yield Object(N.d)(M.a.beginClearContext(t,e,!1)),yield Object(N.d)(M.a.clearReplOutput(t)),yield Object(N.d)(M.a.debuggerReset(t)),yield Object(N.a)(_.d,`Switched to ${Object(o.n)(s,a)}`,1e3)}})),yield Object(ae.a)(E.w,(function*(e){const{workspaceLocation:t,externalLibraryName:s}=e.payload,[a,n,i]=yield Object(N.f)((e=>[e.workspaces[t].context.chapter,e.workspaces[t].globals,e.workspaces[t].externalLibrary])),r={chapter:a,external:{name:s,symbols:D.b.get(s)},globals:n};(s!==i||e.payload.initialise)&&(yield Object(N.d)(M.a.changeExternalLibrary(s,t)),yield Object(N.d)(M.a.beginClearContext(t,r,!0)),yield Object(N.d)(M.a.clearReplOutput(t)),e.payload.initialise||(yield Object(N.a)(_.d,`Switched to ${s} library`,1e3)))})),yield Object(ae.a)(E.a,(function*(e){var t;if(yield*function*(){const{loadedScripts:e,timeout:t}=yield Object(N.e)({loadedScripts:Object(N.a)((function*(){for(;void 0===window.getReadyWebGLForCanvas;)yield Object(N.b)(250);return!0})),timeout:Object(N.b)(4e3)});return void 0===t||void 0!==e||(yield Object(N.a)(_.e,"Error loading libraries",750),!1)}(),e.payload.shouldInitLibrary){switch(e.payload.library.external.name){case D.a.RUNES:window.loadLib("RUNES"),window.getReadyWebGLForCanvas("3d"),window.getReadyStringifyForRunes(ze.stringify);break;case D.a.CURVES:window.loadLib("CURVES"),window.getReadyWebGLForCanvas("curve");break;case D.a.MACHINELEARNING:window.loadLib("MACHINELEARNING")}}null===(t=window.ListVisualizer)||void 0===t||t.clear();const s=e.payload.library.globals;for(const[a,n]of s)window[a]=n;yield Object(N.d)(M.a.endClearContext({...e.payload.library,moduleParams:{runes:{},phaser:Qe.a}},e.payload.workspaceLocation)),yield})),yield Object(ae.a)(E.v,(function*(t){const s=t.payload.workspaceLocation,a=yield Object(N.f)((e=>e.workspaces[s].editorValue));e=yield Object(N.f)((e=>e.workspaces[s].context));const n=Object(He.findDeclaration)(a,e,{line:t.payload.cursorPosition.row+1,column:t.payload.cursorPosition.column});n&&(yield Object(N.d)(M.a.moveCursor(t.payload.workspaceLocation,{row:n.start.line-1,column:n.start.column})))}))}function*ut(e){try{const t=ot.context.runtime.nodes[0].loc.start.line-1,s=ot.context.runtime.nodes[0].loc.end.line-1;yield Object(N.d)(M.a.highlightEditorLine([t,s],e)),Object(w.g)(ot),Object(w.i)(ot)}catch(t){yield Object(N.d)(M.a.highlightEditorLine([],e))}}function*ht(e,t,s,a,n){const i=Object(w.c)(e,t);if(n){const t=Object(w.e)(i,n);yield Object(N.a)(pt,t,e,s,a,E.r)}const r=Object(w.b)(i);yield Object(N.a)(pt,r,e,s,a,E.r)}function*pt(e,t,s,a,n){t.runtime.debuggerOn=(n===E.p||n===x.d)&&t.chapter>2,!t.runtime.debuggerOn&&t.chapter>2&&n!==E.r&&Object(w.g)(void 0);const i=yield Object(N.f)((e=>e.playground.usingSubst)),r=yield Object(N.f)((e=>e.workspaces[a].stepLimit)),o=t.chapter<=2&&"playground"===a&&i;if(o){t.executionMethod="interpreter";const e=document.getElementById(S.b.substVisualizer+"-icon");e&&e.classList.add("side-content-tab-alert")}async function c(e,s){return Je.compile(e,s).then((e=>{const t=new Je.Transcoder;return Je.run(e,Je.makePlatformImports(function(e){return{display:t=>{"undefined"!==typeof window.__REDUX_STORE__&&window.__REDUX_STORE__.dispatch(Object(it.handleConsoleLog)(t,e.externalContext))}}}(s),t),t,s)})).then((e=>({status:"finished",context:t,value:e})),(e=>(console.log(e),{status:"error"})))}const d="non-det"===t.variant,l="lazy"===t.variant,u="wasm"===t.variant,{result:h,interrupted:p,paused:g}=yield Object(N.e)({result:n===x.d?Object(N.a)(He.resume,ot):d||l||u?function(a){if("non-det"===a)return e.trim()===Ve.TRY_AGAIN?Object(N.a)(He.resume,ct):Object(N.a)(He.runInContext,e,t,{executionMethod:"interpreter",originalMaxExecTime:s,stepLimit:r,useSubst:o});if("lazy"===a)return Object(N.a)(He.runInContext,e,t,{scheduler:"preemptive",originalMaxExecTime:s,stepLimit:r,useSubst:o});if("wasm"===a)return Object(N.a)(c,e,t);throw new Error("Unknown variant: "+a)}(t.variant):Object(N.a)(He.runInContext,e,t,{scheduler:"preemptive",originalMaxExecTime:s,stepLimit:r,useSubst:o}),interrupted:Object(N.g)(x.b),paused:Object(N.g)(x.a)});if(p)return Object(He.interrupt)(t),t.errors.push(new qe.InterruptedError(t.runtime.nodes[0])),yield Object(N.d)(M.a.debuggerReset(a)),yield Object(N.d)(M.a.endInterruptExecution(a)),void(yield Object(N.a)(_.e,"Execution aborted",750));if(g)return yield Object(N.d)(M.a.endDebuggerPause(a)),ot=Object($e.manualToggleDebugger)(t),yield Object(N.a)(ut,a),void(yield Object(N.a)(_.e,"Execution paused",750));if(n===E.p&&(ot=h),yield Object(N.a)(ut,a),"suspended"===h.status||"finished"===h.status||"suspended-non-det"===h.status){if("suspended"===h.status)return yield Object(N.d)(M.a.endDebuggerPause(a)),void(yield Object(N.d)(M.a.evalInterpreterSuccess("Breakpoint hit!",a)));if(d&&("cut"===h.value&&(h.value=void 0),ct=h),n!==E.r&&(yield Object(N.d)(M.a.evalInterpreterSuccess(h.value,a))),n!==E.p&&n!==E.q||(yield Object(N.d)(Object(rt.notifyProgramEvaluated)(h,ot,e,t,a))),n===E.p){if((yield Object(N.f)((e=>e.workspaces[a].sideContentActiveTab)))===S.b.autograder&&("assessment"===a||"grading"===a)){const e=yield Object(N.f)((e=>e.workspaces[a].editorTestcases));if(e.length>0){yield Object(N.a)(_.d,"Running all testcases!",2e3);for(const t of e.keys()){yield Object(N.d)(M.a.evalTestcase(a,t));const{success:e,error:s}=yield Object(N.e)({success:Object(N.g)(x.j),error:Object(N.g)(x.i)});if(s||!e)return}}}}}else{yield Object(N.d)(M.a.evalInterpreterError(t.errors,a));const s=t.errors;t.errors=[];const n=Object(Xe.parse)(e,t),i=n&&Object(We.typeCheck)(Object(Ke.validateAndAnnotate)(n,t),t)[1];if(t.errors=s,"default"===t.variant){const s=at(t,e);if(s){const[e,t]=s;yield Object(N.a)(nt,e,t)}}i&&i.length>0&&(yield Object(N.d)(M.a.sendReplInputToOutput("Hints:\n"+Object(He.parseError)(i),a)))}}function*gt(){yield Object(N.c)(C.b.useBackend?de:te),yield Object(N.c)(lt),yield Object(N.c)(me),yield Object(N.c)(Ge),yield Object(N.c)(ne),yield Object(N.c)(Me),yield Object(N.c)(pe),yield Object(N.c)(Fe.a)}const mt=function(e){const t=Object(r.a)(),s=[t,Object(a.a)(e)],c=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({serialize:!0,maxAge:300})||i.d,d=function(e){if(!e)return;return{...o.k,session:{...o.k.session,...e.session?e.session:{}},workspaces:{...o.k.workspaces,playground:{...o.k.workspaces.playground,editorValue:e.playgroundEditorValue?e.playgroundEditorValue:o.k.workspaces.playground.editorValue,isEditorAutorun:e.playgroundIsEditorAutorun?e.playgroundIsEditorAutorun:o.k.workspaces.playground.isEditorAutorun,externalLibrary:e.playgroundExternalLibrary?e.playgroundExternalLibrary:o.k.workspaces.playground.externalLibrary,context:{...o.k.workspaces.playground.context,chapter:e.playgroundSourceChapter?e.playgroundSourceChapter:o.k.workspaces.playground.context.chapter,variant:e.playgroundSourceVariant?e.playgroundSourceVariant:o.k.workspaces.playground.context.variant}}}}}((()=>{try{const e=localStorage.getItem("storedState");if(!e)return;const t=Object(Le.decompressFromUTF16)(e);if(!t)return;return JSON.parse(t)}catch(e){return void Object(_.e)("Error loading from local storage")}})())||o.k,l=c(Object(i.a)(...s)),u=Object(i.e)(k(e),d,l);return t.run(gt),u.subscribe(Object(n.throttle)((()=>{(e=>{try{const t={session:{accessToken:e.session.accessToken,refreshToken:e.session.refreshToken,role:e.session.role,name:e.session.name,userId:e.session.userId},achievements:e.achievement.achievements,playgroundEditorValue:e.workspaces.playground.editorValue,playgroundIsEditorAutorun:e.workspaces.playground.isEditorAutorun,playgroundSourceChapter:e.workspaces.playground.context.chapter,playgroundSourceVariant:e.workspaces.playground.context.variant,playgroundExternalLibrary:e.workspaces.playground.externalLibrary},s=Object(Le.compressToUTF16)(JSON.stringify(t));localStorage.setItem("storedState",s)}catch(t){Object(_.e)("Error saving to local storage")}})(u.getState())}),1e3)),u}(L.a)},94:function(e,t,s){"use strict";s.d(t,"a",(function(){return j})),s.d(t,"b",(function(){return y}));var a=s(0),n=s(112),i=s(1),r=s(36),o=s(1214),c=s(5),d=s(4),l=s.n(d);function u(e){const t=e.choices.map(((t,s)=>Object(a.jsx)(o.b,{onClick:()=>e.onResponse&&e.onResponse(t.key),intent:t.intent,fill:e.largeButtons,className:l()(e.largeButtons&&"large-button"),...t.props,children:t.label},s))),{escapeResponse:s}=e,n="undefined"===typeof s?void 0:()=>e.onResponse&&e.onResponse(s);return Object(a.jsxs)(o.g,{className:l()(c.a.DARK,"ConfirmDialog"),title:e.title,isCloseButtonShown:"undefined"===typeof e.title&&void 0,canEscapeKeyClose:!!n,onClose:n,isOpen:e.isOpen,icon:e.icon,...e.props,children:[Object(a.jsx)("div",{className:c.a.DIALOG_BODY,children:e.contents}),Object(a.jsxs)("div",{className:c.a.DIALOG_FOOTER,children:[e.largeButtons&&t,!e.largeButtons&&Object(a.jsx)("div",{className:c.a.DIALOG_FOOTER_ACTIONS,children:t})]})]})}function h(e){const{enterResponse:t,validationFunction:s}=e,r=i.useRef(null),[c,d]=i.useState(!s||s(e.defaultValue||""));i.useEffect((()=>{r.current&&d(!s||s(r.current.value))}),[s]);const l=t=>{var a;t!==e.escapeResponse&&s&&!s(r.current.value)||e.onResponse(t,(null===(a=r.current)||void 0===a?void 0:a.value)||"")},h=e.choices.map((e=>({...e,props:{...e.props,disabled:e.disableOnInvalid&&!c}}))),p=t?e=>{13===e.keyCode&&l(t)}:void 0,g=s?e=>{s(e.target.value)!==c&&d(!c)}:void 0;return Object(a.jsx)(u,{...e,onResponse:l,choices:h,contents:Object(a.jsxs)(a.Fragment,{children:[e.contents,Object(a.jsx)(o.v,{autoFocus:!0,defaultValue:e.defaultValue,inputRef:r,onKeyDown:p,onChange:g,intent:c?n.a.NONE:n.a.DANGER})]})})}class p extends i.PureComponent{constructor(...e){super(...e),this.state={dialog:null,dialogOnClose:null}}static create(){const e=document.createElement("div");document.body.appendChild(e);const t=r.render(Object(a.jsx)(p,{}),e);if(null==t)throw new Error("Could not create DialogHelper - are you in a React lifecycle method?");return t}show(e,t){this.setState((()=>({dialog:e,dialogOnClose:t||null})))}close(){this.state.dialogOnClose&&this.state.dialogOnClose(),this.setState((()=>({dialog:null,dialogOnClose:null})))}render(){return this.state.dialog}}const g=p.create();function m(){g.close()}function b(e,t){return new Promise(((s,n)=>{var i,r;i=Object(a.jsx)(e,{...t(s)}),r=n,g.show(i,r)})).finally(m)}function j(e){return function(e){return b(u,(t=>({...e,onResponse:t,isOpen:!0})))}({title:e.title,contents:e.contents,choices:[{key:!1,label:e.negativeLabel||"No"},{key:!0,label:e.positiveLabel||"Yes",intent:e.positiveIntent||n.a.SUCCESS,props:{type:"submit"}}],escapeResponse:!1,icon:e.icon,...e.props})}function y(e){return b(h,(t=>({title:e.title,contents:e.contents,choices:[{key:!1,label:e.negativeLabel||"Cancel"},{key:!0,label:e.positiveLabel||"Accept",intent:n.a.SUCCESS,disableOnInvalid:!0}],escapeResponse:!1,enterResponse:!0,onResponse:(e,s)=>t({buttonResponse:e,value:s}),isOpen:!0,...e.props})))}},97:function(e,t,s){"use strict";s.r(t),s.d(t,"generateLzString",(function(){return i})),s.d(t,"shortenURL",(function(){return r})),s.d(t,"updateShortURL",(function(){return o})),s.d(t,"toggleUsingSubst",(function(){return c})),s.d(t,"changeQueryString",(function(){return d})),s.d(t,"playgroundUpdatePersistenceFile",(function(){return l})),s.d(t,"playgroundUpdateGitHubFile",(function(){return u}));var a=s(9),n=s(80);const i=()=>Object(a.action)(n.b),r=e=>Object(a.action)(n.e,e),o=e=>Object(a.action)(n.g,e),c=e=>Object(a.action)(n.f,e),d=e=>Object(a.action)(n.a,e),l=e=>Object(a.action)(n.d,e),u=e=>Object(a.action)(n.c,e)}},[[1212,1,2]]]);
//# sourceMappingURL=main.ba71ae24.chunk.js.map